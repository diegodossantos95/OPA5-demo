/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
        (c) Copyright 2009-2017 SAP SE. All rights reserved
    
 */
sap.ui.define(["sap/ui/core/mvc/Controller","sap/ui/model/Sorter","sap/ui/model/json/JSONModel"],function(C,S,J){"use strict";return C.extend("sap.fe.controls._P13nSettings.P13nSettings",{onCancel:function(e){e.getSource().close();this.getView().destroy();},onConfirm:function(e){var p=e.getSource().getPanels(),c=[],s=[],P,d,i;for(i in p){var a=p[i].getMetadata().getName();if(a==="sap.m.P13nSortPanel"){c.sortCondition=p[i]._getConditions();}if(a==="sap.m.P13nGroupPanel"){c.groupCondition=p[i]._getConditions();}}var g=function(o){P=(c.groupCondition&&c.groupCondition[0].keyField);var k=o.getProperty(P);var n=(c.groupCondition[0]&&c.groupCondition[0].text);if(n.indexOf(":")>0){n=n.substr(0,n.indexOf(":"));}return{key:k,text:n+" : "+k};};if(c.groupCondition&&c.groupCondition.length>0){P=c.groupCondition[0]&&c.groupCondition[0].keyField;d=!!(c[0]&&c[0].operation==="GroupDescending");var G=new S(P,d,g);s.push(G);}if(c.sortCondition){for(i in c.sortCondition){P=c.sortCondition[i].keyField;d=!!(c.sortCondition[i].operation==="Descending");s.push(new S(P,d));}}this._saveP13DialogState(c);this.oTableController.applyGroupAndSort(s);e.getSource().close();this.getView().destroy();},_saveP13DialogState:function(c){var p=this.oView.getModel().getData(),i,_;var P=[];for(i in c.sortCondition){_={"columnKey":c.sortCondition[i].keyField,"operation":c.sortCondition[i].operation};P.push(_);}p.p13nSortItems=P;if(c.groupCondition!=undefined&&c.groupCondition!=null){var a=[];for(i in c.groupCondition){_={"columnKey":c.groupCondition[i].keyField,"operation":c.groupCondition[i].operation};a.push(_);}p.p13nGroupItems=a;}this.oTableController.oP13nSettingsPropertyModel=new J(p);}});});
