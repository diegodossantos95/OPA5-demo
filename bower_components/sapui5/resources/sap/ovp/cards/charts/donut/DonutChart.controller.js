(function(){"use strict";sap.ui.controller("sap.ovp.cards.charts.donut.DonutChart",{onInit:function(){},onBeforeRendering:function(){var u=sap.ovp.cards.charts.Utils;var V=sap.ovp.cards.charts.VizAnnotationManager;V.validateCardConfiguration(this);var m=[];var d=[];var v=this.getView().byId("donutChartCard");var n;if(!v){jQuery.sap.log.error(u.constants.ERROR_NO_CHART+": ("+this.getView().getId()+")");}else{n=v.getModel('ovpCardProperties').getProperty("/navigation");if(n=="chartNav"){v.attachBrowserEvent("click",this.onHeaderClick.bind(this));}else{sap.ovp.cards.charts.VizAnnotationManager.getSelectedDataPoint(v,this);}var b=v.getDataset().getBinding("data");if(b.getPath()){b.attachDataReceived(jQuery.proxy(this.onDataReceived,this));b.attachDataRequested(jQuery.proxy(this.onDataRequested,this));}else{var a=sap.ui.xmlfragment("sap.ovp.cards.charts.generic.noData");var c=this.getCardContentContainer();c.removeAllItems();c.addItem(a);}sap.ovp.cards.charts.Utils.validateMeasuresDimensions(v,"Donut");var e=this.getCardPropertiesModel().getProperty("/entityType");var f=u.getAllColumnLabels(e);var g=v.getDataset().getMeasures();var h=v.getDataset().getDimensions();m.push(g[0].getName());var i=f[h[0].getName()];d.push(i?i:h[0].getName());var D=true;var N=v.getModel('ovpCardProperties').getProperty("/navigation");if(N=="chartNav"){D=false;}v.removeAllFeeds();v.addFeed(new sap.viz.ui5.controls.common.feeds.FeedItem({'uid':"size",'type':"Measure",'values':m}));v.addFeed(new sap.viz.ui5.controls.common.feeds.FeedItem({'uid':"color",'type':"Dimension",'values':d}));v.setVizProperties({size:{title:{visible:false}},color:{title:{visible:false}},legend:{isScrollable:false},title:{visible:false},interaction:{noninteractiveMode:D?false:true,selectability:{legendSelection:false,axisLabelSelection:false,mode:"EXCLUSIVE",plotLassoSelection:false,plotStdSelection:true}}});V.formatChartAxes();}},onDataReceived:function(e){var v=this.getView().byId("donutChartCard");if(this.bFlag==true){this.bFlag=false;}else{setTimeout(function(){v.setBusy(false);},0);}sap.ovp.cards.charts.VizAnnotationManager.checkNoData(e,this.getCardContentContainer(),v);},onDataRequested:function(){var v=this.getView().byId("donutChartCard");v.setBusy(true);}});})();
