sap.ui.define(["sap/ui/core/ValueState","sap/ui/model/Filter","sap/ui/model/FilterOperator","sap/m/MessageToast","sap/m/MessageBox"],function(V,F,a,M,b){"use strict";var h={badRequest:"400",unauthorized:"401",forbidden:"403",notFound:"404",methodNotAllowed:"405",preconditionFailed:"428",internalServerError:"500",notImplemented:"501",badGateway:"502",serviceUnavailable:"503",gatewayTimeout:"504",httpVersionNotSupported:"505"};var o={callAction:"callAction",addEntry:"addEntry",saveEntity:"saveEntity",deleteEntity:"deleteEntity",editEntity:"editEntity",modifyEntity:"modifyEntity",activateDraftEntity:"activateDraftEntity",saveAndPrepareDraftEntity:"saveAndPrepareDraftEntity",getCollection:"getCollection"};var m;function g(R){var t=[],j;var k=sap.ui.getCore().getMessageManager();var l=k.getMessageModel().getData();for(var i=0;i<l.length;i++){j=l[i];if(j.getPersistent()){t.push(j);}}jQuery.noop(R);return t;}function c(P,C){var D;D=function(n,i){var j;var k={onMessageDialogClose:function(){i.onMessageDialogClose();j.destroy();}};j=sap.ui.xmlfragment(n,k);if(C){jQuery.sap.syncStyleClass(C,P,j);}P.addDependent(P);return j;};return D;}function d(j){var t=g();var E,k,l,T,s,n;var q=1;var G={};var u={};for(var i=0;i<t.length;i++){s=t[i].target||"";E=s.substring(1,s.indexOf('('));n=j.getODataEntitySet(E);if(n){k=E+"\\((.*?)\\)";l=new RegExp(k);T=t[i].target.match(l);if(T){if(T[0].lastIndexOf("/")>0){T[0]=T[0].substring(0,T[0].lastIndexOf("/"));}T[0]='/'+T[0];if(!u[T[0]]){u[T[0]]=q;q++;}}}}G['groups']=u;G['lastKey']=q;return G;}function e(v,A){var s,t,D,G,j,k;var l=sap.ui.getCore().getLibraryResourceBundle("sap.ui.generic.app");var n={onMessageDialogClose:function(){D.close();r();},grouper:function(x){var y,L;G=d(k);j=G.groups;L=G.lastKey;var z=x.getObject().target||"";if(z.lastIndexOf("/")>0){z=z.substring(0,z.lastIndexOf("/"));}if(j[z]){y=j[z];}else{y=L;}return y;},getGroupHeader:function(x){var y,z,C,E;y=x.key;z='';for(var H in j){if(j[H]==y){z=H;if(m&&(H==m)){z='';}break;}}E=z.substring(1,z.indexOf('('));if(E){C=k.createBindingContext("com.sap.vocabularies.UI.v1.HeaderInfo/Title/Value",k.getMetaContext('/'+E));}var I=(E==''||(!C))?(l.getText("GENERAL_TITLE")):sap.ui.model.odata.AnnotationHelper.format(C);var J=new sap.m.GroupHeaderListItem({title:I,upperCase:false});J.bindElement(z);return J;},onUpdate:function(C){var x;var y=C.getSource().getItems();for(var i=0;i<y.length;i++){if(y[i].getMetadata().getElementName()=="sap.m.StandardListItem"){x=y[i].getInfoState();switch(x){case sap.ui.core.ValueState.Error:y[i].addStyleClass("sapSmartTemplatesListReportSLINegative");break;case sap.ui.core.ValueState.Warning:y[i].addStyleClass("sapSmartTemplatesListReportSLICritical");break;case sap.ui.core.ValueState.Success:y[i].addStyleClass("sapSmartTemplatesListReportSLIPositive");break;default:y[i].addStyleClass("sapSmartTemplatesListReportSLINeutral");break;}}}}};var T=g();if(T.length===0){return false;}else if(T.length===1&&T[0].type===V.Success){M.show(T[0].message,{onClose:r});}else{if(typeof v=="function"){D=v("sap.ui.generic.app.fragments.MessageDialog",n);}else if(typeof v=="object"){D=c(v.owner,v.contentDensityClass)("sap.ui.generic.app.fragments.MessageDialog",n);}else{return undefined;}var q=sap.ui.getCore().getMessageManager().getMessageModel();k=D.getParent().getParent().getModel().getMetaModel();D.setModel(q,"message");var S=new sap.ui.model.json.JSONModel();D.setModel(S,"settings");var u=D.getContent()[0];S.setProperty("/closeButtonText",l.getText("DIALOG_CLOSE"));var B=u.getBinding("items");B.filter(new F("persistent",a.EQ,true));for(var i=0;i<T.length;i++){var w=T[i];if(w.type===sap.ui.core.MessageType.Error){s=sap.ui.core.ValueState.Error;break;}if(w.type===sap.ui.core.MessageType.Warning){s=sap.ui.core.ValueState.Warning;continue;}if(w.type===sap.ui.core.MessageType.Information||w.type===sap.ui.core.MessageType.None){s=sap.ui.core.ValueState.None;continue;}s=sap.ui.core.ValueState.Success;}if(A){t=A;}else{t=l.getText("DIALOG_TITLE");}S.setProperty("/state",s);S.setProperty("/title",t);D.open();}}function r(){var i=sap.ui.getCore().getMessageManager();var t=g();if(t.length>0){i.removeMessages(t);}}function f(s,D,i){var t=new sap.ui.core.message.Message({message:s,description:D,type:sap.ui.core.MessageType.Error,processor:i,target:'',persistent:true});sap.ui.getCore().getMessageManager().addMessages(t);}function p(E){var R;m=E&&E.url;if(m){m="/"+m.substring(0,m.indexOf(")")+1);}var s=sap.ui.getCore().getLibraryResourceBundle("sap.ui.generic.app").getText("ERROR_UNKNOWN");var H;if(E instanceof Error){if(E.message){s=E.message;}}else if(E.response){if(E.response.message){s=E.response.message;}if(E.response.statusCode){H=E.response.statusCode;}if(E.response.headers){for(var i in E.response.headers){if(i.toLowerCase()==="content-type"){var j=E.response.headers[i];if(j.toLowerCase().indexOf("application/json")===0){if(E.response.responseText){var O=JSON.parse(E.response.responseText);if(O&&O.error&&O.error.message&&O.error.message.value){s=O.error.message.value;}}}else if(E.message){s=E.message;}break;}}}}var t=g(E);R={httpStatusCode:H,messageText:s,description:null,containsTransientMessage:(t.length===0)?false:true};return R;}return{operations:o,httpStatusCodes:h,handleTransientMessages:e,removeTransientMessages:r,addTransientErrorMessage:f,parseErrorResponse:p};},true);
