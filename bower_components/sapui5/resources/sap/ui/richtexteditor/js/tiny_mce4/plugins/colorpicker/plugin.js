tinymce.PluginManager.add('colorpicker',function(e){function c(a,v){function s(v){var d=new tinymce.util.Color(v),r=d.toRgb();w.fromJSON({r:r.r,g:r.g,b:r.b,hex:d.toHex().substr(1)});b(d.toHex());}function b(h){w.find('#preview')[0].getEl().style.background=h;}var w=e.windowManager.open({title:'Color',items:{type:'container',layout:'flex',direction:'row',align:'stretch',padding:5,spacing:10,items:[{type:'colorpicker',value:v,onchange:function(){var r=this.rgb();if(w){w.find('#r').value(r.r);w.find('#g').value(r.g);w.find('#b').value(r.b);w.find('#hex').value(this.value().substr(1));b(this.value());}}},{type:'form',padding:0,labelGap:5,defaults:{type:'textbox',size:7,value:'0',flex:1,spellcheck:false,onchange:function(){var d=w.find('colorpicker')[0];var n,v;n=this.name();v=this.value();if(n=="hex"){v='#'+v;s(v);d.value(v);return;}v={r:w.find('#r').value(),g:w.find('#g').value(),b:w.find('#b').value()};d.value(v);s(v);}},items:[{name:'r',label:'R',autofocus:1},{name:'g',label:'G'},{name:'b',label:'B'},{name:'hex',label:'#',value:'000000'},{name:'preview',type:'container',border:1}]}]},onSubmit:function(){a('#'+this.toJSON().hex);}});s(v);}if(!e.settings.color_picker_callback){e.settings.color_picker_callback=c;}});
