define("tinymce/imagetoolsplugin/Proxy",["global!tinymce.util.Promise","global!tinymce.util.Tools","tinymce/imagetoolsplugin/Utils"],function(P,T,U){var i=function(d){return d===400||d===403||d===500;};var h=function(s){return P.reject("ImageProxy HTTP error: "+s);};var p=function(e){P.reject("ImageProxy Service error: "+e);};var a=function(s,d){return U.readBlob(d).then(function(t){var e=U.parseJson(t);var f=U.traverse(e,['error','type']);return f?p(f):p('Invalid JSON');});};var b=function(s,d){return i(s)?a(s,d):h(s);};var r=function(u,d){return U.requestUrlAsBlob(u,{'Content-Type':'application/json;charset=UTF-8','tiny-api-key':d}).then(function(e){return e.status>=400?b(e.status,e.blob):P.resolve(e.blob);});};function c(u){return U.requestUrlAsBlob(u,{}).then(function(d){return d.status>=400?h(d.status):P.resolve(d.blob);});}var g=function(u,d){return d?r(u,d):c(u);};return{getUrl:g};});
