tinymce.PluginManager.add('tabfocus',function(a){var D=tinymce.DOM,b=tinymce.each,c=tinymce.explode;function t(e){if(e.keyCode===9&&!e.ctrlKey&&!e.altKey&&!e.metaKey){e.preventDefault();}}function d(e){var x,f,v,i;if(e.keyCode!==9||e.ctrlKey||e.altKey||e.metaKey||e.isDefaultPrevented()){return;}function g(j){f=D.select(':input:enabled,*[tabindex]:not(iframe)');function k(e){return e.nodeName==="BODY"||(e.type!='hidden'&&e.style.display!="none"&&e.style.visibility!="hidden"&&k(e.parentNode));}function l(f){return/INPUT|TEXTAREA|BUTTON/.test(f.tagName)&&tinymce.get(e.id)&&f.tabIndex!=-1&&k(f);}b(f,function(e,i){if(e.id==a.id){x=i;return false;}});if(j>0){for(i=x+1;i<f.length;i++){if(l(f[i])){return f[i];}}}else{for(i=x-1;i>=0;i--){if(l(f[i])){return f[i];}}}return null;}v=c(a.getParam('tab_focus',a.getParam('tabfocus_elements',':prev,:next')));if(v.length==1){v[1]=v[0];v[0]=':prev';}if(e.shiftKey){if(v[0]==':prev'){f=g(-1);}else{f=D.get(v[0]);}}else{if(v[1]==':next'){f=g(1);}else{f=D.get(v[1]);}}if(f){var h=tinymce.get(f.id||f.name);if(f.id&&h){h.focus();}else{tinymce.util.Delay.setTimeout(function(){if(!tinymce.Env.webkit){window.focus();}f.focus();},10);}e.preventDefault();}}a.on('init',function(){if(a.inline){tinymce.DOM.setAttrib(a.getBody(),'tabIndex',null);}a.on('keyup',t);if(tinymce.Env.gecko){a.on('keypress keydown',d);}else{a.on('keydown',d);}});});
