tinymce.PluginManager.add('autolink',function(a){var A;var b=/^(https?:\/\/|ssh:\/\/|ftp:\/\/|file:\/|www\.|(?:mailto:)?[A-Z0-9._%+\-]+@)(.+)$/i;if(a.settings.autolink_pattern){b=a.settings.autolink_pattern;}a.on("keydown",function(e){if(e.keyCode==13){return d(a);}});if(tinymce.Env.ie){a.on("focus",function(){if(!A){A=true;try{a.execCommand('AutoUrlDetect',false,true);}catch(e){}}});return;}a.on("keypress",function(e){if(e.keyCode==41){return h(a);}});a.on("keyup",function(e){if(e.keyCode==32){return c(a);}});function h(a){p(a,-1,'(',true);}function c(a){p(a,0,'',true);}function d(a){p(a,-1,'',false);}function p(a,e,f){var r,g,s,i,j,t,m,k,l,n;function o(v,w){if(w<0){w=0;}if(v.nodeType==3){var l=v.data.length;if(w>l){w=l;}}return w;}function q(v,w){if(v.nodeType!=1||v.hasChildNodes()){r.setStart(v,o(v,w));}else{r.setStartBefore(v);}}function u(v,w){if(v.nodeType!=1||v.hasChildNodes()){r.setEnd(v,o(v,w));}else{r.setEndAfter(v);}}if(a.selection.getNode().tagName=='A'){return;}r=a.selection.getRng(true).cloneRange();if(r.startOffset<5){k=r.endContainer.previousSibling;if(!k){if(!r.endContainer.firstChild||!r.endContainer.firstChild.nextSibling){return;}k=r.endContainer.firstChild.nextSibling;}l=k.length;q(k,l);u(k,l);if(r.endOffset<5){return;}g=r.endOffset;i=k;}else{i=r.endContainer;if(i.nodeType!=3&&i.firstChild){while(i.nodeType!=3&&i.firstChild){i=i.firstChild;}if(i.nodeType==3){q(i,0);u(i,i.nodeValue.length);}}if(r.endOffset==1){g=2;}else{g=r.endOffset-1-e;}}s=g;do{q(i,g>=2?g-2:0);u(i,g>=1?g-1:0);g-=1;n=r.toString();}while(n!=' '&&n!==''&&n.charCodeAt(0)!=160&&(g-2)>=0&&n!=f);if(r.toString()==f||r.toString().charCodeAt(0)==160){q(i,g);u(i,s);g+=1;}else if(r.startOffset===0){q(i,0);u(i,s);}else{q(i,g);u(i,s);}t=r.toString();if(t.charAt(t.length-1)=='.'){u(i,s-1);}t=r.toString();m=t.match(b);if(m){if(m[1]=='www.'){m[1]='http://www.';}else if(/@$/.test(m[1])&&!/^mailto:/.test(m[1])){m[1]='mailto:'+m[1];}j=a.selection.getBookmark();a.selection.setRng(r);a.execCommand('createlink',false,m[1]+m[2]);if(a.settings.default_link_target){a.dom.setAttrib(a.selection.getNode(),'target',a.settings.default_link_target);}a.selection.moveToBookmark(j);a.nodeChanged();}}});
