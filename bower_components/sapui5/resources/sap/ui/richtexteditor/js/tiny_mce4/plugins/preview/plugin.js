tinymce.PluginManager.add('preview',function(e){var s=e.settings,a=!tinymce.Env.ie;e.addCommand('mcePreview',function(){e.windowManager.open({title:'Preview',width:parseInt(e.getParam("plugin_preview_width","650"),10),height:parseInt(e.getParam("plugin_preview_height","500"),10),html:'<iframe src="javascript:\'\'" frameborder="0"'+(a?' sandbox="allow-scripts"':'')+'></iframe>',buttons:{text:'Close',onclick:function(){this.parent().parent().close();}},onPostRender:function(){var p,h='';h+='<base href="'+e.documentBaseURI.getURI()+'">';tinymce.each(e.contentCSS,function(u){h+='<link type="text/css" rel="stylesheet" href="'+e.documentBaseURI.toAbsolute(u)+'">';});var b=s.body_id||'tinymce';if(b.indexOf('=')!=-1){b=e.getParam('body_id','','hash');b=b[e.id]||b;}var c=s.body_class||'';if(c.indexOf('=')!=-1){c=e.getParam('body_class','','hash');c=c[e.id]||'';}var d=('<script>'+'document.addEventListener && document.addEventListener("click", function(e) {'+'for (var elm = e.target; elm; elm = elm.parentNode) {'+'if (elm.nodeName === "A") {'+'e.preventDefault();'+'}'+'}'+'}, false);'+'</script> ');var f=e.settings.directionality?' dir="'+e.settings.directionality+'"':'';p=('<!DOCTYPE html>'+'<html>'+'<head>'+h+'</head>'+'<body id="'+b+'" class="mce-content-body '+c+'"'+f+'>'+e.getContent()+d+'</body>'+'</html>');if(!a){var g=this.getEl('body').firstChild.contentWindow.document;g.open();g.write(p);g.close();}else{this.getEl('body').firstChild.src='data:text/html;charset=utf-8,'+encodeURIComponent(p);}}});});e.addButton('preview',{title:'Preview',cmd:'mcePreview'});e.addMenuItem('preview',{text:'Preview',cmd:'mcePreview',context:'view'});});
