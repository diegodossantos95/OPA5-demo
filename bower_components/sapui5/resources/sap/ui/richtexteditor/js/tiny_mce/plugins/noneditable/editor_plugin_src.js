(function(){var T=tinymce.dom.TreeWalker;var a='contenteditable',b='data-mce-'+a;var V=tinymce.VK;var c,d,f;function h(i){var k=i.dom,s=i.selection,l='mce_noneditablecaret',m='\uFEFF',o=i.getParam('noneditable_prevent_delete');function p(n){var e;if(n.nodeType===1){e=n.getAttribute(b);if(e&&e!=="inherit"){return e;}e=n.contentEditable;if(e!=="inherit"){return e;}}return null;};function q(n){var e;while(n){e=p(n);if(e){return e==="false"?n:null;}n=n.parentNode;}};function r(n){while(n){if(n.id===l){return n;}n=n.parentNode;}};function t(n){var e;if(n){e=new T(n,n);for(n=e.current();n;n=e.next()){if(n.nodeType===3){return n;}}}};function u(e,n){var y,z;if(p(e)==="false"){if(k.isBlock(e)){s.select(e);return;}}z=k.createRng();if(p(e)==="true"){if(!e.firstChild){e.appendChild(i.getDoc().createTextNode('\u00a0'));}e=e.firstChild;n=true;}y=k.create('span',{id:l,'data-mce-bogus':true},m);if(n){e.parentNode.insertBefore(y,e);}else{k.insertAfter(y,e);}z.setStart(y.firstChild,1);z.collapse(true);s.setRng(z);return y;};function v(e){var n,y,z,A;if(e){A=s.getRng(true);A.setStartBefore(e);A.setEndBefore(e);n=t(e);if(n&&n.nodeValue.charAt(0)==m){n=n.deleteData(0,1);}k.remove(e,true);s.setRng(A);}else{y=r(s.getStart());while((e=k.get(l))&&e!==z){if(y!==e){n=t(e);if(n&&n.nodeValue.charAt(0)==m){n=n.deleteData(0,1);}k.remove(e,true);}z=e;}}};function w(){var n,e,y,z,A;function B(A,C){var D,E,F,G,H;D=z.startContainer;E=z.startOffset;if(D.nodeType==3){H=D.nodeValue.length;if((E>0&&E<H)||(C?E==H:E==0)){return;}}else{if(E<D.childNodes.length){var I=!C&&E>0?E-1:E;D=D.childNodes[I];if(D.hasChildNodes()){D=D.firstChild;}}else{return!C?A:null;}}F=new T(D,A);while(G=F[C?'prev':'next']()){if(G.nodeType===3&&G.nodeValue.length>0){return;}else if(p(G)==="true"){return G;}}return A;};v();y=s.isCollapsed();n=q(s.getStart());e=q(s.getEnd());if(n||e){z=s.getRng(true);if(y){n=n||e;if(B(n,true)){A=B(n,true);u(A,true);}else if(B(n,false)){A=B(n,false);u(A,false);}else{s.select(n);}}else{z=s.getRng(true);if(n){z.setStartBefore(n);}if(e){z.setEndAfter(e);}s.setRng(z);}}};function x(i,e){var y=e.keyCode,z,A,B,C,D,E=false,F;function G(n,R){while(n=n[R?'previousSibling':'nextSibling']){if(n.nodeType!==3||n.nodeValue.length>0){return n;}}};function H(n,R){s.select(n);s.collapse(R);}function I(n){var K,R,S,z;function U(X){var Y=R;while(Y){if(Y===X){return;}Y=Y.parentNode;}k.remove(X);w();}function W(){var X,O,Y=i.schema.getNonEmptyElements();O=new tinymce.dom.TreeWalker(R,i.getBody());while(X=(n?O.prev():O.next())){if(Y[X.nodeName.toLowerCase()]){break;}if(X.nodeType===3&&tinymce.trim(X.nodeValue).length>0){break;}if(p(X)==="false"){if(!o)U(X);return true;}}if(q(X)){return true;}return false;}K=s.getRng(true);R=K.startContainer;S=K.startOffset;R=r(R)||R;if(s.isCollapsed()){if(z=q(R)){U(z);return false;}if(R.nodeType==3&&(n?S>0:S<R.nodeValue.length)){return true;}if(R.nodeType==1){R=R.childNodes[S]||R;}if(W()){return false;}}if(q(R)){z=q(R);U(z);return false;}return true;}function J(y,A,e){var z;var n=(y===V.LEFT)||(y===V.BACKSPACE)?'left':'right';var R=n==='left'?V.LEFT:V.RIGHT;var S=n==='left'?V.BACKSPACE:V.DELETE;var U=n==='left'?true:false;var W=s.getRng(true);if(y===R||y===S){z=G(A,U);if(z&&p(z)==="false"){if(y===R){H(z,U);}if(y===S&&(A.innerHTML===m||!tinymce.trim(A.innerText||A.textContent))){e.preventDefault();H(z,U);if(!o){k.remove(z);return;}}}else if(!o){v(A);}}}B=s.getStart();C=s.getEnd();z=q(B)||q(C);if(o&&!s.isCollapsed()){var K=s.getRng(true);var L=K.cloneContents();var E=false;tinymce.walk(L,function(n){E=p(n)==='false';return!E;},'childNodes');}if(z&&(y<112||y>124)&&y!=V.DELETE&&y!=V.BACKSPACE){if((tinymce.isMac?e.metaKey:e.ctrlKey)&&(y==67||y==88||y==86)){return;}e.preventDefault();if(y==V.LEFT||y==V.RIGHT){var M=y==V.LEFT;if(i.dom.isBlock(z)){var N=M?z.previousSibling:z.nextSibling;var O=new T(N,N);var P=M?O.prev():O.next();H(P,!M);}else{H(z,M);}}}else{if(y==V.LEFT||y==V.RIGHT||y==V.BACKSPACE||y==V.DELETE){A=r(B);if(A){J(y,A,e);}if((y==V.BACKSPACE||y==V.DELETE)&&!I(y==V.BACKSPACE)){e.preventDefault();return false;}if(o&&E){var Q=confirm(i.getLang("noneditable.confirm_delete"));if(!Q){e.preventDefault();return false;}}}}}i.onMouseUp.addToTop(w);i.onMouseDown.addToTop(w);i.onKeyDown.addToTop(x);i.onKeyUp.addToTop(w);};function g(e){return" "+tinymce.trim(e.getParam("noneditable_editable_class","mceEditable"))+" ";}function j(e){return" "+tinymce.trim(e.getParam("noneditable_noneditable_class","mceNonEditable"))+" ";}tinymce.PluginManager.requireLangPack('noneditable');tinymce.create('tinymce.plugins.NonEditablePlugin',{init:function(e){function k(e,l){var i=f.length,m=l.content,n=tinymce.trim(d);if(l.format=="raw"){return;}while(i--){m=m.replace(f[i],function(o){var l=arguments,p=l[l.length-2];if(p>0&&m.charAt(p-1)=='"'){return o;}return'<span class="'+n+'" data-mce-content="'+e.dom.encode(l[0])+'">'+e.dom.encode(typeof(l[1])==="string"?l[1]:l[0])+'</span>';});}l.content=m;}c=g(e);d=j(e);f=e.getParam("noneditable_regexp");if(f&&!f.length){f=[f];}e.onPreInit.add(function(){h(e);if(f){e.selection.onBeforeSetContent.add(k);e.onBeforeSetContent.add(k);}e.parser.addAttributeFilter('class',function(n){var i=n.length,l,m;while(i--){m=n[i];l=" "+m.attr("class")+" ";if(l.indexOf(c)!==-1){m.attr(b,"true");}else if(l.indexOf(d)!==-1){m.attr(b,"false");}}});e.serializer.addAttributeFilter(b,function(n){var i=n.length,l;while(i--){l=n[i];if(f&&l.attr('data-mce-content')){l.name="#text";l.type=3;l.raw=true;l.value=l.attr('data-mce-content');}else{l.attr(a,null);l.attr(b,null);}}});e.parser.addAttributeFilter(a,function(n){var i=n.length,l;while(i--){l=n[i];l.attr(b,l.attr(a));l.attr(a,null);}});});},getInfo:function(){return{longname:'Non editable elements',author:'Moxiecode Systems AB',authorurl:'http://tinymce.moxiecode.com',infourl:'http://wiki.moxiecode.com/index.php/TinyMCE:Plugins/noneditable',version:tinymce.majorVersion+"."+tinymce.minorVersion};}});tinymce.PluginManager.add('noneditable',tinymce.plugins.NonEditablePlugin);})();
