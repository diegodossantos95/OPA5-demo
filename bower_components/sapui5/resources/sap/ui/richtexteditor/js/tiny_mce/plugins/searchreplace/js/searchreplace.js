tinyMCEPopup.requireLangPack();var SearchReplaceDialog={init:function(e){var t=this,f=document.forms[0],m=tinyMCEPopup.getWindowArg("mode");t.switchMode(m);f[m+'_panel_searchstring'].value=tinyMCEPopup.getWindowArg("search_string");f[m+'_panel_searchstring'].focus();mcTabs.onChange.add(function(a,p){t.switchMode(a.substring(0,a.indexOf('_')));});},switchMode:function(m){var f,l=this.lastMode;if(l!=m){f=document.forms[0];if(l){f[m+'_panel_searchstring'].value=f[l+'_panel_searchstring'].value;f[m+'_panel_backwardsu'].checked=f[l+'_panel_backwardsu'].checked;f[m+'_panel_backwardsd'].checked=f[l+'_panel_backwardsd'].checked;f[m+'_panel_casesensitivebox'].checked=f[l+'_panel_casesensitivebox'].checked;}mcTabs.displayTab(m+'_tab',m+'_panel');document.getElementById("replaceBtn").style.display=(m=="replace")?"inline":"none";document.getElementById("replaceAllBtn").style.display=(m=="replace")?"inline":"none";this.lastMode=m;}},searchNext:function(a){var e=tinyMCEPopup.editor,c=e.selection,r=c.getRng(),f,m=this.lastMode,s,b,d=0,w=e.getWin(),g=e.windowManager,h=0;function i(){return e.getDoc().selection?e.getDoc().selection.createRange():e.getDoc().body.createTextRange();}f=document.forms[0];s=f[m+'_panel_searchstring'].value;b=f[m+'_panel_backwardsu'].checked;ca=f[m+'_panel_casesensitivebox'].checked;rs=f['replace_panel_replacestring'].value;if(tinymce.isIE){r=i();}if(s=='')return;function j(){r=c.getRng().cloneRange();e.getDoc().execCommand('SelectAll',false,null);c.setRng(r);};function k(){e.selection.setContent(rs);};if(ca)d=d|4;switch(a){case'all':e.execCommand('SelectAll');e.selection.collapse(true);if(tinymce.isIE){e.focus();r=i();while(r.findText(s,b?-1:1,d)){r.scrollIntoView();r.select();k();h=1;if(b){r.moveEnd("character",-(rs.length));}else{r.moveStart("character",rs.length);}}tinyMCEPopup.storeSelection();}else{while(w.find(s,ca,b,false,false,false,false)){k();h=1;}}if(h)tinyMCEPopup.alert(e.getLang('searchreplace_dlg.allreplaced'));else tinyMCEPopup.alert(e.getLang('searchreplace_dlg.notfound'));return;case'current':if(!e.selection.isCollapsed())k();break;}c.collapse(b);r=c.getRng();if(!s)return;if(tinymce.isIE){e.focus();r=i();if(r.findText(s,b?-1:1,d)){r.scrollIntoView();r.select();}else tinyMCEPopup.alert(e.getLang('searchreplace_dlg.notfound'));tinyMCEPopup.storeSelection();}else{if(!w.find(s,ca,b,false,false,false,false))tinyMCEPopup.alert(e.getLang('searchreplace_dlg.notfound'));else j();}}};tinyMCEPopup.onInit.add(SearchReplaceDialog.init,SearchReplaceDialog);
