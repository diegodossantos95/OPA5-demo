tinyMCEPopup.requireLangPack();var TemplateDialog={preInit:function(){var u=tinyMCEPopup.getParam("template_external_list_url");if(u!=null)document.write('<sc'+'ript language="javascript" type="text/javascript" src="'+tinyMCEPopup.editor.documentBaseURI.toAbsolute(u)+'"></sc'+'ript>');},init:function(){var e=tinyMCEPopup.editor,t,s,x,u;t=e.getParam("template_templates",false);s=document.getElementById('tpath');if(!t&&typeof(tinyMCETemplateList)!='undefined'){for(x=0,t=[];x<tinyMCETemplateList.length;x++)t.push({title:tinyMCETemplateList[x][0],src:tinyMCETemplateList[x][1],description:tinyMCETemplateList[x][2]});}for(x=0;x<t.length;x++)s.options[s.options.length]=new Option(t[x].title,tinyMCEPopup.editor.documentBaseURI.toAbsolute(t[x].src));this.resize();this.tsrc=t;},resize:function(){var w,h,e;if(!self.innerWidth){w=document.body.clientWidth-50;h=document.body.clientHeight-160;}else{w=self.innerWidth-50;h=self.innerHeight-170;}e=document.getElementById('templatesrc');if(e){e.style.height=Math.abs(h)+'px';e.style.width=Math.abs(w-5)+'px';}},loadCSSFiles:function(d){var e=tinyMCEPopup.editor;tinymce.each(e.getParam("content_css",'').split(','),function(u){d.write('<link href="'+e.documentBaseURI.toAbsolute(u)+'" rel="stylesheet" type="text/css" />');});},selectTemplate:function(u,t){var d=window.frames['templatesrc'].document,x,a=this.tsrc;if(!u)return;d.body.innerHTML=this.templateHTML=this.getFileContents(u);for(x=0;x<a.length;x++){if(a[x].title==t)document.getElementById('tmpldesc').innerHTML=a[x].description||'';}},insert:function(){tinyMCEPopup.execCommand('mceInsertTemplate',false,{content:this.templateHTML,selection:tinyMCEPopup.editor.selection.getContent()});tinyMCEPopup.close();},getFileContents:function(u){var x,d,t='text/plain';function g(s){x=0;try{x=new ActiveXObject(s);}catch(s){}return x;};x=window.ActiveXObject?g('Msxml2.XMLHTTP')||g('Microsoft.XMLHTTP'):new XMLHttpRequest();x.overrideMimeType&&x.overrideMimeType(t);x.open("GET",u,false);x.send(null);return x.responseText;}};TemplateDialog.preInit();tinyMCEPopup.onInit.add(TemplateDialog.init,TemplateDialog);
