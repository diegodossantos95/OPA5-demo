/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)

(c) Copyright 2009-2017 SAP SE. All rights reserved
 */
sap.ui.define(["jquery.sap.global","sap/ui/base/Object"],function(q,B){"use strict";var O=B.extend("sap.ui.mdc.OperatorSuggestProvider",{constructor:function(p){B.apply(this);this._bShowAll=true;this._bShowHint=false;if(p){this._bShowAll=p.enableShowAll!==undefined?p.enableShowAll:true;this._bShowHint=p.showHint!==undefined?p.showHint:false;if(p.control){this.associateFilterField(p.control);}}}});O.prototype.destroy=function(){this._oFilterField=null;this._oInput=null;};O.prototype.associateFilterField=function(f){this._oFilterField=f;this._oInput=f.getAggregation("_input");if(!(this._oInput instanceof sap.m.MultiInput)){q.sap.log.error("mdc:OperatorSuggestProvider","associateFilterField for "+this._oInput.getId()+" not possible!");return;}this._oInput.setShowSuggestion(true);this._oInput.setFilterSuggests(true);this._oInput.setEnableSuggestionsHighlighting(false);this._oInput.setMaxLength(0);this._oInput.setMaxSuggestionWidth("auto");if(this._bShowHint){this._oInput.setPlaceholder("press space to get help");}this._aOperators=[];this._oInput.bindAggregation("suggestionItems",{path:"suggest>/",template:new sap.ui.core.ListItem({key:"{suggest>key}",text:"{suggest>text}",additionalText:"{suggest>additionalText}"}),templateShareable:false});this._oInput.attachSuggest(function(e){if(this._aOperators.length===0){var o=this._oFilterField.getFilterOperatorConfig();var a=o.getOperatorsForType(this._oFilterField._getDataType().getMetadata().getName());a.forEach(function(b){var c=o.getOperator(b);if(c.showInSuggest!==undefined&&c.showInSuggest==false){return;}var t=c.textKey||"operators."+c.name+".longText";var T=c.getTypeText(t,this._oFilterField._getDataType().getName().toLowerCase());if(T===t){T=c.longText;}this._aOperators.push({key:b,additionalText:T});},this);var s=new sap.ui.model.json.JSONModel();s.setData(this._aOperators);this._oInput.setModel(s,"suggest");}}.bind(this));this._oInput.addValidator(function(d){});this._oInput.setFilterFunction(function(v,i){var k=i.getKey();var t=this._oFilterField._getDataType();var a=t.getMetadata().getName();var s=true;var e;v=v.trim();var o=this._oFilterField.getFilterOperatorConfig();var b=o.getMatchingOperators(a,v);if(b.length!==0){s=false;}var c=o.getOperator(k);if(c){if(s&&this._bShowAll){var d=v,g="";if(d===""){if(t.getName()==="Date"){d=new Date();}else if(t.getName()==="Integer"){d=123;}else if(t.getName()==="Float"){d=123.45;}else if(t.getName()==="Boolean"){d=true;}else{d="abc";}}if(g===""){if(t.getName()==="Date"){g=new Date();if(typeof d==="string"){g.setFullYear(g.getFullYear()+1);g=t.formatValue(g,"string");}else{g.setFullYear(d.getFullYear()+1);}}else if(t.getName()==="Integer"){g=d+1000;}else if(t.getName()==="Float"){g=d+1000;}else if(t.getName()==="Boolean"){g=false;}else{g="xyz";}}try{e=c.format([d,g],null,typeof d==="string"?null:t);}catch(h){e=c.format([]);}i.setText(e);return true;}if(c.test(v,t)){var V=c.parse(v,t);e=c.format(V,null,t);i.setText(e);return true;}return false;}else{return false;}}.bind(this));};return O;},true);
