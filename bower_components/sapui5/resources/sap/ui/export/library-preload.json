{
"version":"2.0",
"name":"sap.ui.export.library-preload",
"dependencies":["sap.ui.core.library-preload"],
"modules":{
	"sap/ui/export/ExportDialog.js":"/*!\n * SAP UI development toolkit for HTML5 (SAPUI5)\n\n\t\t(c) Copyright 2009-2017 SAP SE. All rights reserved\n\t\n */\nsap.ui.define(['jquery.sap.global'],function(q){'use strict';var r=sap.ui.getCore().getLibraryResourceBundle('sap.ui.export');var p;function c(){var d;var a=new sap.m.Button({text:r.getText('CANCEL_BUTTON'),press:function(){if(d&&d.oncancel){d.oncancel();d.finish();}}});var b=new sap.m.ProgressIndicator({showValue:false,height:'0.75rem'});b.addStyleClass('sapUiMediumMarginTop');d=new sap.m.Dialog({title:r.getText('PROGRESS_TITLE'),type:sap.m.DialogType.Message,contentWidth:'500px',content:[new sap.m.Text({text:r.getText('PROGRESS_FETCHING_MSG')}),b],endButton:a});d.updateStatus=function(n){b.setPercentValue(n);};d.finish=function(){p.close();b.setPercentValue(0);};return d;}function g(){p=p||c();return p;}return{getProgressDialog:g};},true);\n",
	"sap/ui/export/Spreadsheet.js":"/*!\n * SAP UI development toolkit for HTML5 (SAPUI5)\n\n\t\t(c) Copyright 2009-2017 SAP SE. All rights reserved\n\t\n */\nsap.ui.define(['jquery.sap.global','./library','./ExportDialog'],function(q,l,E){'use strict';var S=function(s){this.mSettings=q.extend(true,{},s);};S.prototype.cancel=function(){if(this.process){this.process.cancel();this.process=null;}};S.prototype.onprogress=function(P){q.sap.log.debug('Spreadsheet export: '+P+'% loaded.');};var p=(function(){var r={};for(var k in l.EdmType){r[k.toLowerCase()]=k;}return r;})();function v(P){var a='Spreadsheet export: ';var o='odata';var e='.xlsx';P.fileName=P.fileName||'export';if(!q.sap.endsWith(P.fileName,e)){P.fileName+=e;}var d=P.dataSource;if(typeof d==='string'){var c=P.count||1;P.dataSource={dataUrl:d,type:o,count:c};P.count=c;}else if(Array.isArray(d)){var D=d.map(function(r){return q.extend(true,{},r);});P.dataSource={data:D,type:'array'};}else if(d&&d.dataUrl){var s=(d.type||o).toLowerCase();P.dataSource.type=s;if(d.useBatch){}}var b=P&&P.workbook;b.columns.forEach(function(f){f.label=f.label||f.property||'';var w=f.width;if(typeof w==='string'){var W=w.toLowerCase();w=parseFloat(W);if(W.indexOf('em')>0){w=w*2;}else if(W.indexOf('px')>0){w=w/8;}}if(isNaN(w)||w<1){w=10;}if(f.label.length<30){w=Math.max(f.label.length,w);}f.width=Math.round(w);if(f.type){f.type=f.type.toLowerCase();if(!p[f.type]){q.sap.log.error(a+'insupported property type '+f.type+'. Type string is used.');f.align='';}}var g=f.scale;if(f.type==='number'&&isNaN(g)&&g!=='variable'){q.sap.log.warning(a+'scale parameter for numerical column configuration is missing.');}if(typeof g==='string'){g=parseInt(g,10);}if(isNaN(g)){g=null;}f.scale=g;var t=(f.textAlign+'').toLowerCase();if(t!==''&&['left','right','center','begin','end'].indexOf(t)==-1){q.sap.log.warning(a+'incorrect column alignment property: '+t+'. Default alignment is used.');t='';}f.textAlign=t;});}S.prototype.build=function(){var s=this;var P=q.extend(true,{},this.mSettings);v(P);return new Promise(function(r,R){var a;function o(m){if(!isNaN(m.progress)){if(a){a.updateStatus(m.progress);}s.onprogress(m.progress);}if(m.error||m.finish){s.process=null;if(a){a.finish();}if(m.error){R(m.error);}else if(m.finish){r();}}}if(s.process){R('Cannot start export: the process is already running');return;}if(P.showProgress!==false){a=E.getProgressDialog();a.oncancel=function(){return s.process&&s.process.cancel();};a.open();}s.process=sap.ui.requireSync('sap/ui/export/SpreadsheetExport').execute(P,o);});};return S;},true);\n",
	"sap/ui/export/SpreadsheetExport.js":"/*!\n * SAP UI development toolkit for HTML5 (SAPUI5)\n\n\t\t(c) Copyright 2009-2017 SAP SE. All rights reserved\n\t\n */\nsap.ui.define(['jquery.sap.global'],function(q){'use strict';var L='sap/ui/thirdparty/jszip',a='sap/ui/export/js/XLSXExportUtils',b='sap/ui/export/js/XLSXBuilder';function d(p,c){function f(m){return c&&c(m);}function o(v){f({progress:v});}function g(e){f({error:e});}function h(){f({finish:true});}function i(){var s;var S;var C;var t;function e(X,v){S=X.saveFile;C=X.oData.getConverter(p);s=new v(p.workbook.columns);o(0);t=window.setTimeout(l,0);}function l(){if(s){var D=p.dataSource.data||[];var R=C(D.slice());s.append(R);o(50);t=window.setTimeout(m,0);}}function m(){if(s){s.build().then(r);}}function r(v){if(v){S(new Blob([v]),p.fileName);}h();s=null;}function u(){window.clearTimeout(t);r();}sap.ui.require([a,b,L],e);return{cancel:u};}function n(u){return u?window.URI(u).absoluteTo(window.location.href).toString():u;}function j(){var s,r,S;function e(X,u){S=X.saveFile;s=new u(p.workbook.columns);r=X.oData.fetch(p,l);o(0);}function l(M){if(M.rows){s.append(M.rows);}if(M.progress){o(M.progress);}if(M.error){s=null;return g(M.error);}return M.finished&&s.build().then(m);}function m(u){S(new Blob([u]),p.fileName);h();s=null;}function t(){r.cancel();h();s=null;}sap.ui.require([a,b,L],e);return{cancel:t};}function k(){var l;var s;var m=q.extend(true,{},p);var w=typeof m.worker==='object'?m.worker:{};var C=function(){s.postMessage({cancel:true});h();};function r(x){var y=new Worker(x);y.onmessage=function(e){if(e.data.status){o(e.data.status);}else if(e.data.error){g(e.data.error);}else{l.saveFile(new Blob([e.data]),m.fileName);h();}};y.postMessage(m);return y;}function t(){q.sap.log.warning('Direct worker is not allowed. Load the worker via blob.');var e=window.URI(w.base).absoluteTo().search('').hash('').toString();w.src=e+w.ref;var x='self.origin = \"'+e+'\"; '+'importScripts(\"'+w.src+'\")';var y=new Blob([x]);var z=window.URL.createObjectURL(y);return r(z);}function u(){q.sap.log.warning('Blob worker is not allowed. Use in-process export.');C=j(m).cancel;}function v(X){l=X;try{s=r(w.src);s.addEventListener('error',function(e){s=t();s.addEventListener('error',function(e){u();e.preventDefault();});e.preventDefault();});}catch(x){try{s=t();}catch(y){u();}}}m.dataSource.dataUrl=n(m.dataSource.dataUrl);m.dataSource.serviceUrl=n(m.dataSource.serviceUrl);w.base=w.base||sap.ui.resource('sap.ui.export.js','');w.ref=w.ref||'SpreadsheetWorker.js';w.src=w.base+w.ref;sap.ui.require([a],v);return{cancel:function(){C();}};}if(p.dataSource.type==='array'){return i();}else if(p.worker===false){return j();}else{return k();}}return{execute:d};},true);\n",
	"sap/ui/export/library.js":"/*\n * ! SAP UI development toolkit for HTML5 (SAPUI5)\n\n\t\t(c) Copyright 2009-2017 SAP SE. All rights reserved\n\t\n */\nsap.ui.define(['jquery.sap.global','sap/ui/core/library'],function(q,l){'use strict';sap.ui.getCore().initLibrary({name:'sap.ui.export',dependencies:['sap.ui.core'],types:['sap.ui.export.EdmType'],interfaces:[],controls:[],elements:[],noLibraryCSS:true,version:'1.50.6'});sap.ui.export.EdmType={Boolean:'Boolean',String:'String',Number:'Number',Date:'Date',Time:'Time',DateTime:'DateTime',Currency:'Currency'};q.sap.registerModuleShims({'sap/ui/export/js/XLSXBuilder':{amd:true,exports:'XLSXBuilder'},'sap/ui/export/js/XLSXExportUtils':{amd:true,exports:'XLSXExportUtils'}});return sap.ui.export;});\n",
	"sap/ui/export/manifest.json":"{\n  \"_version\": \"1.2.0\",\n  \"sap.app\": {\n    \"_version\": \"1.2.0\",\n    \"id\": \"sap.ui.export\",\n    \"type\": \"library\",\n    \"embeds\": [],\n    \"applicationVersion\": {\n      \"version\": \"1.50.6\"\n    },\n    \"title\": \"UI5 library: sap.ui.export\",\n    \"description\": \"UI5 library: sap.ui.export\",\n    \"resources\": \"resources.json\",\n    \"offline\": true\n  },\n  \"sap.ui\": {\n    \"_version\": \"1.1.0\",\n    \"technology\": \"UI5\",\n    \"supportedThemes\": [\n      \"base\",\n      \"sap_belize\",\n      \"sap_belize_plus\",\n      \"sap_hcb\"\n    ]\n  },\n  \"sap.ui5\": {\n    \"_version\": \"1.1.0\",\n    \"dependencies\": {\n      \"minUI5Version\": \"1.50\",\n      \"libs\": {\n        \"sap.ui.core\": {\n          \"minVersion\": \"1.50.6\"\n        }\n      }\n    }\n  }\n}"
}}
