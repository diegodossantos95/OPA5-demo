(function(f){if(typeof exports==="object"&&typeof module!=="undefined"){module.exports=f()}else if(typeof define==="function"&&define.amd){define([],f)}else{var g;if(typeof window!=="undefined"){g=window}else if(typeof global!=="undefined"){g=global}else if(typeof self!=="undefined"){g=self}else{g=this}g.XLSXExportUtils=f()}})(function(){var d,m,b;return(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(r,m,b){var O=r("./provider/ODataDataProvider.js");var F=r("./filesaver/FileSaver.js");m.exports={oData:{fetch:O.requestData,getConverter:O.getConverter},saveFile:F.saveFile};},{"./filesaver/FileSaver.js":2,"./provider/ODataDataProvider.js":3}],2:[function(r,m,b){function s(a,n){var l,c,S;if(!(a instanceof Blob)){return}l=document.createElementNS("http://www.w3.org/1999/xhtml","a");c="download"in l;if(c){S=function(f,g){l.download=g;l.href=URL.createObjectURL(f);l.dispatchEvent(new MouseEvent("click"))}}if(typeof S==="undefined"){S=function(f){var g=new FileReader;g.onloadend=function(){var o,u;u=g.result.replace(/^data:[^;]*;/,"data:attachment/file;");o=window.open(u,"_blank");if(!o){window.location.href=u}};g.readAsDataURL(a)}}if(typeof navigator!=="undefined"&&navigator.msSaveOrOpenBlob){S=function(f,g){window.navigator.msSaveOrOpenBlob(f,g)}}S(a,n)}m.exports={saveFile:s};},{}],3:[function(r,m,b){var R=r("./RequestHandler.js");var j=/^\/Date\((-?\d+)(\+|-)?(\d+)?\)\/$/;var M=1e6;function p(v){var i,k,o;if(v==null){return null}if(typeof v==="object"){v=v.valueOf()}if(typeof v==="number"){return v}if(j.test(v)){i=j.exec(v);k=new Date(parseInt(i[1],10));if(i[2]&&i[3]){o=parseInt(i[2]+i[3],10);k.setUTCMinutes(k.getUTCMinutes()-o)}return k.getTime()}if(isFinite(v)){return parseInt(v,10)}k=new Date(v);if(isFinite(k)){return k.getTime()}return null}function g(o,C){var v=C.keys.reduce(function(i,k){return i&&i[k]},o);return v&&(C.type==="date"||C.type==="datetime")?p(v):v}function c(i,C){C.forEach(function(k){i.forEach(function(l){l[k.property]=g(l,k)})});return i}function a(s){return s.workbook.columns.reduce(function(i,k){var K=k.property.split("/");if(K.length>1||k.type==="date"||k.type==="datetime"){i.push({property:k.property,keys:K,type:k.type})}return i},[])}function f(s){var C=a(s);return function(i){return c(i,C)}}function h(s,P){var A=0;var D=s.dataSource;var t=Math.min(D.count||M,M);var B=Math.min(D.sizeLimit||M,s.batchSize||M,t);var C=false;var i=D.dataUrl;var k=f(s);var u;var l;function n(u){if(!u)return"";var U=URI.parse(u);U.path=U.path||"";if(U.path.slice(-1)!=="/"){U.path=U.path+"/"}delete U.query;delete U.hash;delete U.fragment;return(URI.serialize||URI.build)(U)}function o(S,T,N){var v=URI.parse(i);if(N){var w=URI.parse(N);v.query=w.query}else{var Q=(v.query||"").split("&");var x={};Q.forEach(function(z){var E=z.split("=");if(E[0]){x[E[0]]=E[1]}});x["$skip"]=S;x["$top"]=T;Q=[];for(var y in x){Q.push(y+(x[y]==null?"":"="+x[y]))}v.query=Q.join("&")}return(URI.serialize||URI.build)(v)}function O(v){P({error:v})}function q(v){var w,N,F,x,y;var z={};if(C){return}w=v&&v.d&&(v.d.results||v.d)||v;w=Array.isArray(w)?w:[];F=w.length;A+=F;y=t-A;x=A/t;z.finished=F===0||y<=0;z.progress=Math.round(x*100);N=v&&v.d&&v.d.__next||null;if(!z.finished){l.dataUrl=o(A,Math.min(B,y),N);R.sendRequest(l).then(q).catch(O)}z.rows=k(w);P(z)}l={serviceUrl:n(D.serviceUrl),dataUrl:o(0,B),method:D.useBatch?"BATCH":"GET",headers:D.headers};R.sendRequest(l).then(q).catch(O);return{cancel:function(){C=true}}}m.exports={requestData:h,getConverter:f};},{"./RequestHandler.js":4}],4:[function(a,m,b){function s(r){if(typeof r!=="object"||r===null||typeof r.dataUrl!=="string"){throw new Error("Unable to send request - Mandatory parameters missing.")}return(r.method==="BATCH"&&r.serviceUrl?h:f)(r)}function f(r){return new Promise(function(R,c){var x=new XMLHttpRequest;x.onload=function(){if(this.status>=400){c(this.responseText);return}try{R(JSON.parse(this.responseText))}catch(e){c("Server response is not a valid JSON:\n"+this.responseText)}};x.onerror=function(){c(this.responseText)};x.open("GET",r.dataUrl,true);x.setRequestHeader("accept","application/json");x.send()})}function g(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(c){var r=Math.random()*16|0,v=c==="x"?r:r&3|8;return v.toString(16)})}function h(r){return new Promise(function(R,c){var x=new XMLHttpRequest;var i="batch_"+g();var j=r.dataUrl.split(r.serviceUrl)[1];var k=[];x.onload=function(){var n=this.responseText;var L=this.responseText.split("\r\n");var S=0,o=L.length,E=o-1;while(S<o&&L[S].slice(0,1)!=="{"){S++}while(E>0&&L[E].slice(-1)!=="}"){E--}L=L.slice(S,E+1);n=L.join("\r\n");try{var p=JSON.parse(n);R(p)}catch(e){c("Server response is not a valid JSON")}};x.onerror=function(){c(this.responseText)};x.open("POST",r.serviceUrl+"$batch",true);x.setRequestHeader("Accept","multipart/mixed");x.setRequestHeader("Content-Type","multipart/mixed;boundary="+i);for(var l in r.headers){if(l.toLowerCase()!="accept"){x.setRequestHeader(l,r.headers[l])}}k.push("--"+i);k.push("Content-Type: application/http");k.push("Content-Transfer-Encoding: binary");k.push("");k.push("GET "+j+" HTTP/1.1");for(var l in r.headers){k.push(l+":"+r.headers[l])}k.push("");k.push("");k.push("--"+i+"--");k.push("");k=k.join("\r\n");x.send(k)})}m.exports={sendRequest:s};},{}]},{},[1])(1)});
