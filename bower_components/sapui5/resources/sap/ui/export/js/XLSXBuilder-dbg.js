(function(f){if(typeof exports==="object"&&typeof module!=="undefined"){module.exports=f()}else if(typeof define==="function"&&define.amd){define([],f)}else{var g;if(typeof window!=="undefined"){g=window}else if(typeof global!=="undefined"){g=global}else if(typeof self!=="undefined"){g=self}else{g=this}g.XLSXBuilder = f()}})(function(){var define,module,exports;return (function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
var App=require("./objects/App"),Column=require("./binding/Column"),ColumnConfiguration=require("./binding/ColumnConfiguration"),ContentTypes=require("./objects/ContentTypes"),Core=require("./objects/Core"),Relationships=require("./objects/Relationships"),SharedStrings=require("./data/SharedStrings"),Sheet=require("./data/Sheet"),Styles=require("./style/Styles"),Workbook=require("./objects/Workbook");function XLSXBuilder(aBinding,oContext){if(!(aBinding instanceof Array)||!aBinding.length){throw new Error("No binding provided")}this.styles=new this.objects.Styles;this.sheet=new this.objects.Sheet(new this.binding.ColumnConfiguration(aBinding,this.styles));this.app=new this.objects.App(oContext);this.core=new this.objects.Core(oContext)}XLSXBuilder.prototype={binding:{ColumnConfiguration:ColumnConfiguration,Column:Column},objects:{App:App,ContentTypes:ContentTypes,Core:Core,Relationships:Relationships,SharedStrings:SharedStrings,Sheet:Sheet,Styles:Styles,Workbook:Workbook},build:function(){var files,zip,i,j,fileConfig,FileType,xmlObject,relation,zipConfig,promise;files=[{name:"[Content_Types].xml",path:"",type:this.objects.ContentTypes},{name:".rels",path:"_rels/",type:this.objects.Relationships,relationships:[{target:"xl/workbook.xml",type:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument"},{target:"docProps/app.xml",type:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties"},{target:"docProps/core.xml",type:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties"}]},{name:"workbook.xml",path:"xl/",type:this.objects.Workbook},{name:"workbook.xml.rels",path:"xl/_rels/",type:this.objects.Relationships,relationships:[{target:"worksheets/sheet1.xml",type:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet"},{target:"sharedStrings.xml",type:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings"},{target:"styles.xml",type:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles"}]}];zip=new JSZip;for(i=0;i<files.length;i++){fileConfig=files[i];FileType=fileConfig.type;xmlObject=new FileType(fileConfig);if(xmlObject instanceof this.objects.Relationships){for(j=0;j<fileConfig.relationships.length;j++){relation=fileConfig.relationships[j];xmlObject.addRelationship(relation.target,relation.type)}}zip.file(fileConfig.path+fileConfig.name,xmlObject.serialize())}zip.file("docProps/app.xml",this.app.serialize());zip.file("docProps/core.xml",this.core.serialize());zip.file("xl/styles.xml",this.styles.serialize());zip.file("xl/worksheets/sheet1.xml",this.sheet.serialize());zip.file("xl/sharedStrings.xml",this.objects.SharedStrings.getInstance().serialize());zipConfig={compression:"DEFLATE",type:JSZip.support.nodebuffer?"nodebuffer":"arraybuffer"};if(zip.generateAsync){promise=zip.generateAsync(zipConfig)}else{promise=new Promise(function(resolve,reject){var zipped=zip.generate(zipConfig);resolve(zipped)})}return promise},append:function(aData){var array;if(typeof aData==="undefined"||aData===null){return}array=aData instanceof Array?aData:[aData];while(array.length){this.sheet.insert(array.shift())}}};module.exports=XLSXBuilder;

},{"./binding/Column":2,"./binding/ColumnConfiguration":3,"./data/SharedStrings":13,"./data/Sheet":14,"./objects/App":15,"./objects/ContentTypes":16,"./objects/Core":17,"./objects/Relationships":18,"./objects/Workbook":19,"./style/Styles":26}],2:[function(require,module,exports){
var Cell=require("../data/Cell"),CalendarDate=require("../binding/type/CalendarDate"),Numeric=require("../binding/type/Numeric"),Currency=require("../binding/type/Currency"),BooleanType=require("../binding/type/BooleanType"),Text=require("../binding/type/Text");function Column(oData,oStyles){var oColumnData;oColumnData=typeof oData==="string"?{property:oData}:oData;if(!oColumnData||!oColumnData.property){throw new Error("The property for the column is not defined")}this.align=oColumnData.align?oColumnData.align:Column.Align.Left;this.property=oColumnData.property;this.label=oColumnData.label?oColumnData.label:oColumnData.property;this.width=oColumnData.width;this.styles=oStyles;this.type=this._initType(oColumnData)}Column.Align={Left:"left",Center:"center",Right:"right"};Column.prototype._initType=function(oData){var type,sType;sType=oData.type;if(sType==="date"||sType==="datetime"||sType==="time"){type=new CalendarDate({calendar:oData.calendar,format:oData.format,type:sType})}else if(sType==="number"||sType==="percent"||sType==="exponent"){type=new Numeric({delimiter:oData.delimiter,scale:oData.scale,type:oData.type,unit:oData.unit,unitProperty:oData.unitProperty})}else if(sType==="currency"){type=new Currency({type:sType,unitProperty:oData.unitProperty,displayUnit:oData.displayUnit,scale:oData.scale})}else if(sType==="boolean"){type=new BooleanType({trueValue:oData.trueValue,falseValue:oData.falseValue})}else{type=new Text}type.registerAt(this.styles);return type};Column.prototype.getCell=function(){if(!this.cell){this.cell=new Cell(this.type)}return this.cell};Column.prototype.bind=function(oData){this.cell.setValue(oData[this.property],oData)};module.exports=Column;

},{"../binding/type/BooleanType":4,"../binding/type/CalendarDate":5,"../binding/type/Currency":6,"../binding/type/Numeric":7,"../binding/type/Text":8,"../data/Cell":10}],3:[function(require,module,exports){
var Column=require("./Column"),Text=require("./type/Text"),Row=require("../data/Row"),Cell=require("../data/Cell");function ColumnConfiguration(aColumnConfig,oStyles){var column,i;this.columns=[];this.row=null;this.styles=oStyles;for(i=0;i<aColumnConfig.length;i++){column=aColumnConfig[i]instanceof Column?aColumnConfig[i]:new Column(aColumnConfig[i],this.styles);this.columns.push(column)}}ColumnConfiguration.prototype._initBinding=function(){var i;this.row=new Row;for(i=0;i<this.columns.length;i++){this.row.addCell(this.columns[i].getCell())}};ColumnConfiguration.prototype.bind=function(oData){var i;if(this.row===null){this._initBinding()}for(i=0;i<this.columns.length;i++){this.columns[i].bind(oData)}return this.row};ColumnConfiguration.prototype.getHeader=function(){var cell,row,type;row=new Row;type=new Text({font:{name:"Arial",size:11,bold:true},fill:{color:"F7F7F7"}});type.registerAt(this.styles);row.setStyle(type.getStyleId());row.addAttribute({name:"customFormat",value:"1"});this.columns.forEach(function(column,index,array){cell=new Cell(type);cell.setValue(column.label);row.addCell(cell)});return row};ColumnConfiguration.prototype.size=function(){return this.columns.length};module.exports=ColumnConfiguration;

},{"../data/Cell":10,"../data/Row":11,"./Column":2,"./type/Text":8}],4:[function(require,module,exports){
var Type=require("./Type");function BooleanType(oConfig){Type.call(this);this.trueValue=oConfig?oConfig.trueValue:null;this.falseValue=oConfig?oConfig.falseValue:null}BooleanType.prototype=Object.create(Type.prototype);BooleanType.prototype.constructor=BooleanType;BooleanType.DEFAULT={numberFormat:0};BooleanType.prototype.isCustomFormatted=function(){return!!this.trueValue&&typeof this.trueValue==="string"&&!!this.falseValue&&typeof this.falseValue==="string"};BooleanType.prototype._createConfiguration=function(){var result=BooleanType.DEFAULT;if(this.isCustomFormatted()){result={numberFormat:{format:'"'+this.trueValue+'";;"'+this.falseValue+'"'}}}return result};module.exports=BooleanType;

},{"./Type":9}],5:[function(require,module,exports){
var Type=require("./Type");function CalendarDate(oConfig){Type.call(this);this.type=oConfig?oConfig.type:null;this.format=oConfig?oConfig.format:null;this.calendar=oConfig?oConfig.calendar:null}CalendarDate.prototype=Object.create(Type.prototype);CalendarDate.prototype.constructor=CalendarDate;CalendarDate.DEFAULT={numberFormat:14};CalendarDate.builtin={14:"mm-dd-yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0"};CalendarDate.prototype._createConfiguration=function(){var key,result,template;if(!this.type&&!this.format&&!this.calendar){return CalendarDate.DEFAULT}switch(this.type){case"datetime":template=CalendarDate.builtin[22];break;case"time":template=CalendarDate.builtin[21];break;default:template=CalendarDate.builtin[14]}if(typeof this.format==="string"){template=this.format.match(/^[dhmsy\s-,.:\/]+(AM\/PM)?$/)?this.format:template}switch(this.calendar){case"islamic":template="b2d mmmm yyyy";break;case"japanese":template="[$-ja-JP]ge.m.d";break;default:}result={numberFormat:{format:template}};for(key in CalendarDate.builtin){if(CalendarDate.builtin[key]===template){result.numberFormat=parseInt(key,10)}}return result};module.exports=CalendarDate;

},{"./Type":9}],6:[function(require,module,exports){
var Numeric=require("./Numeric");function Currency(oConfig){Numeric.call(this,oConfig);this.displayUnit=typeof oConfig.displayUnit==="boolean"?oConfig.displayUnit:true}Currency.prototype=Object.create(Numeric.prototype);Currency.prototype.constructor=Currency;Currency.DEFAULT_SCALE=3;Currency.DIGITS={ADP:0,AFN:0,ALL:0,AMD:0,BHD:3,BIF:0,BYR:0,CAD:2,CHF:2,CLF:4,CLP:0,COP:0,CRC:0,CZK:0,DEFAULT:2,DJF:0,ESP:0,GNF:0,GYD:0,HUF:0,IDR:0,IQD:0,IRR:0,ISK:0,ITL:0,JOD:3,JPY:0,KMF:0,KPW:0,KRW:0,KWD:3,LAK:0,LBP:0,LUF:0,LYD:3,MGA:0,MGF:0,MMK:0,MNT:0,MRO:0,MUR:0,OMR:3,PKR:0,PYG:0,RSD:0,RWF:0,SLL:0,SOS:0,STD:0,SYP:0,TMM:0,TND:3,TRL:0,TWD:0,TZS:0,UGX:0,UYI:0,UZS:0,VND:0,VUV:0,XAF:0,XOF:0,XPF:0,YER:0,ZMK:0,ZWD:0};Currency.prototype._createConfiguration=function(oData){var i,j,scale,template,unit;template="* #,##0";if(!this.unitProperty&&typeof this.scale==="number"){scale=this.scale}else{scale=Currency.DIGITS[oData[this.unitProperty]]}if(typeof scale!=="number"){scale=Currency.DIGITS.DEFAULT}template+=scale>0?".":"_.";for(i=0;i<scale;i++){template+="0"}for(j=Currency.DEFAULT_SCALE-scale;j>0;j--){template+="_0"}if(this.displayUnit){unit=oData[this.unitProperty];template=template+(unit?' "'+unit+'"':" _E_U_R")}return{numberFormat:{format:template}}};module.exports=Currency;

},{"./Numeric":7}],7:[function(require,module,exports){
var Type=require("./Type");function Numeric(oConfig){Type.call(this);this.unit=oConfig?oConfig.unit:null;this.unitProperty=oConfig?oConfig.unitProperty:null;this.delimiter=oConfig?oConfig.delimiter:false;this.scale=oConfig?oConfig.scale:null;this.styleIds={}}Numeric.prototype=Object.create(Type.prototype);Numeric.prototype.constructor=Numeric;Numeric.DEFAULT={numberFormat:0};Numeric.builtin={1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",37:"#,##0;(#,##0)",38:"#,##0;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",48:"##0.0E+0"};Numeric.prototype._createConfiguration=function(oData){var i,key,result,template=Numeric.builtin[1],unit="";if(!this.delimiter&&typeof this.scale!=="number"){return Numeric.DEFAULT}if(this.delimiter){template="#,##"+template}if(typeof this.scale==="number"&&this.scale>0){template+=".";for(i=0;i<this.scale;i++){template+="0"}}if(typeof this.unitProperty==="string"&&oData){unit=' "'+oData[this.unitProperty]+'"'}else if(typeof this.unit==="string"){unit=' "'+this.unit+'"'}template+=unit;result={numberFormat:{format:template}};for(key in Numeric.builtin){if(Numeric.builtin[key]===template){result.numberFormat=parseInt(key,10)}}return result};Numeric.prototype.getStyleId=function(oData){var styleId,unit;if(!this.unitProperty){return Object.getPrototypeOf(Numeric.prototype).getStyleId.call(this)}if(!oData){return 0}unit=oData[this.unitProperty];styleId=this.styleIds[unit];if(typeof styleId==="undefined"){this.styleIds[unit]=this.styles.addStyle(this._createConfiguration(oData))}return this.styleIds[unit]};module.exports=Numeric;

},{"./Type":9}],8:[function(require,module,exports){
var Type=require("./Type");function Text(oConfig){Type.call(this);this.font=oConfig?oConfig.font:null;this.fill=oConfig?oConfig.fill:null}Text.prototype=Object.create(Type.prototype);Text.prototype.constructor=Text;Text.DEFAULT={font:{size:11,name:"Arial"}};Text.prototype._createConfiguration=function(){return this.font||this.fill?{font:this.font,fill:this.fill}:Text.DEFAULT};module.exports=Text;

},{"./Type":9}],9:[function(require,module,exports){
function Type(){this.styleId=null}Type.prototype._createConfiguration=function(){throw new Error("Abstract method must be implemented by its subclass!")};Type.prototype.getStyleId=function(){if(this.styleId===null){this.styleId=this.styles.addStyle(this._createConfiguration())}return this.styleId};Type.prototype.registerAt=function(oStyles){this.styles=oStyles};module.exports=Type;

},{}],10:[function(require,module,exports){
var XMLNode=require("../xml/XMLNode"),CalendarDate=require("../binding/type/CalendarDate"),Numeric=require("../binding/type/Numeric"),BooleanType=require("../binding/type/BooleanType"),Currency=require("../binding/type/Currency"),SharedStrings=require("../data/SharedStrings");function Cell(oType){XMLNode.call(this,Cell.metadata);this._applyType(oType)}Cell.prototype=Object.create(XMLNode.prototype);Cell.prototype.constructor=Cell;Cell.DataType={Boolean:"b",Date:"d",InlineString:"inlineStr",Number:"n",SharedString:"s",FormularString:"str"};Cell._JsDateToExcel=function(oDate){return oDate.getTime()/(86400*1e3)+(25567+2)};Cell.metadata={tag:"c",attributes:[{id:"reference",name:"r",value:""},{id:"style",name:"s",value:"0"}],properties:[{id:"text",tag:"v"}]};Cell.prototype._applyType=function(oType){Object.defineProperty(this,"type",{value:Cell.DataType.SharedString,writable:true});switch(oType.constructor){case CalendarDate:this.type=Cell.DataType.Date;break;case Numeric:this.type=Cell.DataType.Number;break;case BooleanType:this.type=Cell.DataType.Boolean;if(!oType.isCustomFormatted()){this.addAttribute({name:"t",value:Cell.DataType.Boolean})}break;case Currency:this.type=Cell.DataType.Number;break;default:this.addAttribute({name:"t",value:Cell.DataType.SharedString});this.type=Cell.DataType.SharedString}this.bindingType=oType};Cell.prototype.setStyle=function(nStyle){this.style.value=nStyle};Cell.prototype.setReference=function(sReference){if(typeof sReference!="string"||!sReference.match(/^[A-Z]+[1-9]+[0-9]*$/g)){throw new Error('The given Cell reference "'+sReference+'" does not match the reference pattern.')}this.reference.value=sReference};Cell.prototype.setValue=function(oData,oContext){var shared,date,value;if(!this._isValuePresent(oData)){this.text.value="";return}switch(this.type){case Cell.DataType.Number:this.text.value=oData;break;case Cell.DataType.Boolean:value=oData;if(typeof value==="string"){value=value.toLowerCase()!=="false"&&value!=="0"}this.text.value=value?"1":"0";break;case Cell.DataType.Date:if(oData instanceof Date){date=oData}else if(typeof oData==="number"){date=new Date(oData)}else{date=new Date(parseInt(oData,10))}this.text.value=Cell._JsDateToExcel(date);break;default:shared=SharedStrings.getInstance();this.text.value=shared.insert(oData)}this.setStyle(this.bindingType.getStyleId(oContext))};Cell.prototype._isValuePresent=function(snbData){return typeof snbData==="string"&&!!snbData||typeof snbData==="number"||typeof snbData==="boolean"};module.exports=Cell;

},{"../binding/type/BooleanType":4,"../binding/type/CalendarDate":5,"../binding/type/Currency":6,"../binding/type/Numeric":7,"../data/SharedStrings":13,"../xml/XMLNode":29}],11:[function(require,module,exports){
var XMLNode=require("../xml/XMLNode");var Cell=require("./Cell");function Row(){XMLNode.call(this,Row.metadata)}Row.prototype=Object.create(XMLNode.prototype);Row.prototype.constructor=Row;Row.metadata={tag:"row",attributes:[{id:"reference",name:"r",value:""},{id:"spans",name:"spans",value:"1:1"}]};Row.getColumnReferenceByIndex=function(nIndex){return nIndex<26?String.fromCharCode(65+nIndex):Row.getColumnReferenceByIndex(Math.floor(nIndex/26)-1)+String.fromCharCode(65+nIndex%26)};Row.prototype._updateSpans=function(){this.spans.value="1:"+this.childs.length};Row.prototype.addCell=function(oCell){var count;if(!oCell||!(oCell instanceof Cell)){return}count=this.childs.push(oCell);this._updateSpans();if(this.reference.value){oCell.setReference(Row.getColumnReferenceByIndex(count-1)+this.reference.value)}if(this.style){oCell.setStyle(this.style.value)}};Row.prototype.setReference=function(sReference){var i,reference;reference=typeof sReference=="number"?String(sReference):sReference;if(!reference||!reference.match(/^[1-9]+[0-9]*$/g)){return}if(this.reference.value!=reference){this.reference.value=reference;for(i=0;i<this.childs.length;i++){this.childs[i].setReference(Row.getColumnReferenceByIndex(i)+reference)}}};Row.prototype.setStyle=function(nStyle){var i,style;if(!this.style){style=this.addAttribute({name:"s"});Object.defineProperty(this,"style",{value:style})}this.style.value=nStyle;for(i=0;i<this.childs.length;i++){this.childs[i].setStyle(nStyle)}};module.exports=Row;

},{"../xml/XMLNode":29,"./Cell":10}],12:[function(require,module,exports){
var XMLNode=require("../xml/XMLNode");function SharedString(sValue){XMLNode.call(this,SharedString.metadata);this.setValue(sValue)}SharedString.prototype=Object.create(XMLNode.prototype);SharedString.prototype.constructor=SharedString;SharedString.metadata={tag:"si",properties:[{id:"text",tag:"t"}]};SharedString.prototype.setValue=function(sValue){if(sValue&&typeof sValue=="string"){this.text.value=sValue}else{this.text.value=""+sValue}};module.exports=SharedString;

},{"../xml/XMLNode":29}],13:[function(require,module,exports){
var XMLNode=require("../xml/XMLNode"),SharedString=require("./SharedString");function SharedStrings(){if(SharedStrings.instance instanceof SharedStrings){return SharedStrings.instance}XMLNode.call(this,SharedStrings.metadata);Object.defineProperty(this,"map",{value:new Map,writable:false});Object.defineProperty(this,"_shared",{value:new SharedString(""),writable:false});SharedStrings.instance=this}SharedStrings.prototype=Object.create(XMLNode.prototype);SharedStrings.prototype.constructor=SharedStrings;SharedStrings.getInstance=function(){if(!SharedStrings.instance){SharedStrings.instance=new SharedStrings}return SharedStrings.instance};SharedStrings.metadata={tag:"sst",root:true,attributes:[{name:"xmlns",value:"http://schemas.openxmlformats.org/spreadsheetml/2006/main"}]};SharedStrings.prototype.insert=function(sValue){var index;if(this.map.has(sValue)){return this.map.get(sValue)}this._shared.setValue(sValue);index=this.map.size;this.map.set(sValue,index);this.childs.push(this._shared.serialize());return index};module.exports=SharedStrings;

},{"../xml/XMLNode":29,"./SharedString":12}],14:[function(require,module,exports){
var XMLNode=require("../xml/XMLNode"),Row=require("./Row");function Sheet(oColumnConfiguration){XMLNode.call(this,Sheet.metadata);Object.defineProperty(this,"_columns",{value:oColumnConfiguration,writable:false});this._createCols();this._createHeader()}Sheet.prototype=Object.create(XMLNode.prototype);Sheet.prototype.constructor=Sheet;Sheet.metadata={tag:"worksheet",root:true,attributes:[{name:"xmlns",value:"http://schemas.openxmlformats.org/spreadsheetml/2006/main"},{name:"xmlns",suffix:"r",value:"http://schemas.openxmlformats.org/officeDocument/2006/relationships"}],properties:[{id:"dimension",tag:"dimension",attributes:[{id:"reference",name:"ref",value:"A1"}]},{tag:"sheetViews",properties:[{tag:"sheetView",attributes:[{name:"workbookViewId",value:"0"},{name:"tabSelected",value:"1"}],properties:[{tag:"pane",attributes:[{name:"ySplit",value:"1"},{name:"topLeftCell",value:"A2"},{name:"activePane",value:"bottomLeft"},{name:"state",value:"frozen"}]}]}]},{tag:"sheetFormatPr",attributes:[{name:"defaultRowHeight",value:"15"}]},{id:"columns",tag:"cols"},{id:"data",tag:"sheetData"},{id:"filter",tag:"autoFilter",attributes:[{id:"reference",name:"ref",value:"A1"}]},{tag:"pageMargins",attributes:[{name:"left",value:"0.75"},{name:"right",value:"0.75"},{name:"top",value:"1"},{name:"bottom",value:"1"},{name:"header",value:"0.5"},{name:"footer",value:"0.5"}]}]};Sheet.MAX_ROWS=1048576;Sheet.prototype._createCols=function(){var col,i,minWidth,width,autoFitButtonOffset=2.4;for(i=0;i<this._columns.size();i++){col=this._columns.columns[i];minWidth=this._calculateColumnWidth(col.label.length)+autoFitButtonOffset;width=Math.max(this._calculateColumnWidth(col.width),minWidth);this.columns.addChild({tag:"col",attributes:[{name:"min",value:i+1},{name:"max",value:i+1},{name:"bestFit",value:"1"},{name:"width",value:Math.max(width,minWidth)},{name:"customWidth",value:"1"}]})}};Sheet.prototype._calculateColumnWidth=function(nCharacters){var defaultFontSize=11,defaultPaddingAndBorder=5,scaleFactor=7.33;if(typeof nCharacters!=="number"){return 0}return(nCharacters*2/3*defaultFontSize+defaultPaddingAndBorder)/scaleFactor};Sheet.prototype._createHeader=function(){this._appendRow(this._columns.getHeader())};Sheet.prototype._appendRow=function(oRow){var i,dimension;oRow.setReference(""+(this.data.childs.length+1));this.data.childs.push(oRow.serialize());for(i=0;i<this.childs.length;i++){if(this.childs[i].tag=="dimension"){dimension="A1:"+Row.getColumnReferenceByIndex(this._columns.size()-1)+this.data.childs.length;this.dimension.reference.value=dimension;this.filter.reference.value=dimension}}};Sheet.prototype.insert=function(oData){if(this.data.childs.length==Sheet.MAX_ROWS){throw new Error("Row limit reached.")}this._appendRow(this._columns.bind(oData))};module.exports=Sheet;

},{"../xml/XMLNode":29,"./Row":11}],15:[function(require,module,exports){
var XMLNode=require("../xml/XMLNode");function App(oContext){XMLNode.call(this,App.metadata);if(oContext){if(oContext.application){this.application.value=oContext.application}if(oContext.version){this.version.value=oContext.version}}}App.prototype=Object.create(XMLNode.prototype);App.prototype.constructor=App;App.metadata={tag:"Properties",root:true,attributes:[{name:"xmlns",value:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties"},{name:"xmlns",suffix:"vt",value:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes"}],properties:[{id:"application",tag:"Application",value:"SAP UI5"},{tag:"DocSecurity",value:"0"},{tag:"Company",value:"SAP SE"},{tag:"SharedDoc",value:"false"},{id:"version",tag:"AppVersion",value:"1.52"}]};module.exports=App;

},{"../xml/XMLNode":29}],16:[function(require,module,exports){
var XMLNode=require("../xml/XMLNode");function ContentTypes(){XMLNode.call(this,ContentTypes.metadata)}ContentTypes.prototype=Object.create(XMLNode.prototype);ContentTypes.prototype.constructor=ContentTypes;ContentTypes.metadata={tag:"Types",root:true,attributes:[{name:"xmlns",value:"http://schemas.openxmlformats.org/package/2006/content-types"}],properties:[{tag:"Default",attributes:[{name:"Extension",value:"xml"},{name:"ContentType",value:"application/xml"}]},{tag:"Default",attributes:[{name:"Extension",value:"rels"},{name:"ContentType",value:"application/vnd.openxmlformats-package.relationships+xml"}]},{tag:"Override",attributes:[{name:"PartName",value:"/xl/workbook.xml"},{name:"ContentType",value:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml"}]},{tag:"Override",attributes:[{name:"PartName",value:"/xl/worksheets/sheet1.xml"},{name:"ContentType",value:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml"}]},{tag:"Override",attributes:[{name:"PartName",value:"/xl/styles.xml"},{name:"ContentType",value:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml"}]},{tag:"Override",attributes:[{name:"PartName",value:"/xl/sharedStrings.xml"},{name:"ContentType",value:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml"}]},{tag:"Override",attributes:[{name:"PartName",value:"/docProps/core.xml"},{name:"ContentType",value:"application/vnd.openxmlformats-package.core-properties+xml"}]},{tag:"Override",attributes:[{name:"PartName",value:"/docProps/app.xml"},{name:"ContentType",value:"application/vnd.openxmlformats-officedocument.extended-properties+xml"}]}]};module.exports=ContentTypes;

},{"../xml/XMLNode":29}],17:[function(require,module,exports){
var XMLNode=require("../xml/XMLNode");function Core(oContext){XMLNode.call(this,Core.metadata);if(oContext){if(oContext.title){this.title.value=oContext.title}if(oContext.modifiedBy){this.modifiedBy.value=oContext.modifiedBy}}}Core.prototype=Object.create(XMLNode.prototype);Core.prototype.constructor=Core;Core.metadata={tag:"cp:coreProperties",root:true,attributes:[{name:"xmlns",suffix:"cp",value:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties"},{name:"xmlns",suffix:"dc",value:"http://purl.org/dc/elements/1.1/"},{name:"xmlns",suffix:"dcterms",value:"http://purl.org/dc/terms/"},{name:"xmlns",suffix:"dcmitype",value:"http://purl.org/dc/dcmitype/"},{name:"xmlns",suffix:"xsi",value:"http://www.w3.org/2001/XMLSchema-instance"}],properties:[{id:"title",tag:"dc:title",value:"Table Export"},{tag:"dc:creator",value:"SAP UI5 Document Export"},{tag:"dcterms:created",attributes:[{prefix:"xsi",name:"type",value:"dcterms:W3CDTF"}],value:(new Date).toISOString()},{tag:"cp:keywords",value:"SAP UI5 EXPORT"},{id:"modifiedBy",tag:"cp:lastModifiedBy",value:"SAP UI5"}]};module.exports=Core;

},{"../xml/XMLNode":29}],18:[function(require,module,exports){
var XMLNode=require("../xml/XMLNode");function Relationships(){XMLNode.call(this,Relationships.metadata)}Relationships.prototype=Object.create(XMLNode.prototype);Relationships.prototype.constructor=Relationships;Relationships.metadata={tag:"Relationships",root:true,attributes:[{name:"xmlns",value:"http://schemas.openxmlformats.org/package/2006/relationships"}],properties:[]};Relationships.prototype.addRelationship=function(sTarget,sType){var id="rId"+(this.childs.length+1);this.childs.push(new XMLNode({tag:"Relationship",attributes:[{name:"Id",value:id},{name:"Type",value:sType},{name:"Target",value:sTarget}]}))};module.exports=Relationships;

},{"../xml/XMLNode":29}],19:[function(require,module,exports){
var XMLNode=require("../xml/XMLNode");function Workbook(){XMLNode.call(this,Workbook.metadata);this.addSheet("SAP Document Export")}Workbook.prototype=Object.create(XMLNode.prototype);Workbook.prototype.constructor=Workbook;Workbook.metadata={tag:"workbook",root:true,attributes:[{name:"xmlns",value:"http://schemas.openxmlformats.org/spreadsheetml/2006/main"},{name:"xmlns",suffix:"r",value:"http://schemas.openxmlformats.org/officeDocument/2006/relationships"}],properties:[{tag:"bookViews",properties:[{tag:"workbookView",attributes:[{name:"xWindow",value:"0"},{name:"yWindow",value:"0"},{name:"windowWidth",value:"22260"},{name:"windowHeight",value:"12645"}]}]},{id:"sheets",tag:"sheets"}]};Workbook.prototype.addSheet=function(sName){var count=this.sheets.childs.length+1;var sheet=new XMLNode({tag:"sheet",attributes:[{name:"name",value:sName},{name:"sheetId",value:""+count},{name:"id",prefix:"r",value:"rId"+count}]});this.sheets.addChild(sheet)};module.exports=Workbook;

},{"../xml/XMLNode":29}],20:[function(require,module,exports){
var Alignment={horizontal:{Left:"left",Center:"center",Right:"right",contains:function(sAlign){return _contains(sAlign,Alignment.horizontal)}},vertical:{Top:"top",Middle:"middle",Bottom:"bottom",contains:function(sAlign){return _contains(sAlign,Alignment.vertical)}}};function _contains(sAlign,oAggregation){var key,contained=false;for(key in oAggregation){contained=contained?contained:oAggregation[key]===sAlign&&typeof oAggregation[key]!=="function"}return contained}module.exports=Alignment;

},{}],21:[function(require,module,exports){
var XMLNode=require("../xml/XMLNode");function Border(){XMLNode.call(this,Border.metadata)}Border.prototype=Object.create(XMLNode.prototype);Border.prototype.constructor=Border;Border.metadata={tag:"border",properties:[{tag:"left"},{tag:"right"},{tag:"top"},{tag:"bottom"},{tag:"diagonal"}]};Border.prototype.equals=function(oBorder){return oBorder instanceof Border};module.exports=Border;

},{"../xml/XMLNode":29}],22:[function(require,module,exports){
var XMLNode=require("../xml/XMLNode");function Fill(oData){XMLNode.call(this,Fill.metadata);if(oData){if(oData.color){this.setFill(oData.color)}else if(oData.type){this.setType(oData.type)}}}Fill.prototype=Object.create(XMLNode.prototype);Fill.prototype.constructor=Fill;Fill.DEFAULT_TYPE="none";Fill.metadata={tag:"fill",properties:[{id:"fill",tag:"patternFill",attributes:[{id:"type",name:"patternType",value:Fill.DEFAULT_TYPE}]}]};Fill.prototype.equals=function(oFill){if(!(oFill instanceof Fill)){return false}return this.getType()===oFill.getType()&&this.getFill()===oFill.getFill()};Fill.prototype.getFill=function(){return this.fill.childs.length?this.fill.color.rgb.value.substring(2):null};Fill.prototype.setFill=function(sColor){this.reset();if(sColor&&typeof sColor==="string"&&/^[A-Fa-f0-9]{6}$/.test(sColor)){this.fill.type.value="solid";this.fill.addChild({id:"color",tag:"fgColor",attributes:[{id:"rgb",name:"rgb",value:"FF"+sColor}]});this.fill.addChild({tag:"bgColor",attributes:[{name:"indexed",value:"64"}]})}};Fill.prototype.getType=function(){return this.fill.type.value};Fill.prototype.setType=function(sType){this.reset();this.fill.type.value=sType};Fill.prototype.reset=function(){this.fill.type.value="none";this.fill.childs.length=0};module.exports=Fill;

},{"../xml/XMLNode":29}],23:[function(require,module,exports){
var XMLNode=require("../xml/XMLNode");function Font(oData){XMLNode.call(this,Font.metadata);if(oData&&oData instanceof Object){this.setName(oData.name).setSize(oData.size).setFamily(oData.family).setBold(!!oData.bold)}}Font.prototype=Object.create(XMLNode.prototype);Font.prototype.constructor=Font;Font.DEFAULT_SIZE=11;Font.DEFAULT_NAME="Arial";Font.metadata={tag:"font",properties:[{id:"size",tag:"sz",attributes:[{id:"valueAttribute",name:"val",value:Font.DEFAULT_SIZE}]},{id:"color",tag:"color",attributes:[{id:"valueAttribute",name:"theme",value:"1"}]},{id:"name",tag:"name",attributes:[{id:"valueAttribute",name:"val",value:Font.DEFAULT_NAME}]},{id:"family",tag:"family",attributes:[{id:"valueAttribute",name:"val",value:2}]}]};Font.prototype.equals=function(oFont){if(!(oFont instanceof Font)){return false}return this.getName()==oFont.getName()&&this.getSize()==oFont.getSize()&&this.isBold()==oFont.isBold()&&this.getColor()==oFont.getColor()&&this.getFamily()==oFont.getFamily()};Font.prototype.isBold=function(){return!!this.bold};Font.prototype.getSize=function(){return this.size.valueAttribute.value};Font.prototype.getName=function(){return this.name.valueAttribute.value};Font.prototype.getColor=function(){return this.color.valueAttribute.value};Font.prototype.getFamily=function(){return this.family.valueAttribute.value};Font.prototype.setBold=function(bBold){var boldProperty="bold";if(bBold===!!this[boldProperty]){return this}if(bBold){this.addChild({id:boldProperty,tag:"b"})}else{this.remove(boldProperty)}return this};Font.prototype.setFamily=function(nFamily){if(nFamily>0&&nFamily<15){this.family.valueAttribute.value=nFamily}return this};Font.prototype.setName=function(sName){if(sName&&typeof sName==="string"){this.name.valueAttribute.value=sName}return this};Font.prototype.setSize=function(nSize){if(typeof nSize!=="number"||isNaN(nSize)||nSize<1||nSize>96){throw new Error("The size "+nSize+" is not supported.")}this.size.valueAttribute.value=nSize;return this};module.exports=Font;

},{"../xml/XMLNode":29}],24:[function(require,module,exports){
var XMLNode=require("../xml/XMLNode");function NumberFormat(oData){XMLNode.call(this,NumberFormat.metadata);this.format.value=oData&&oData.format?oData.format:NumberFormat.DEFAULT}NumberFormat.prototype=Object.create(XMLNode.prototype);NumberFormat.prototype.constructor=NumberFormat;NumberFormat.metadata={tag:"numFmt",attributes:[{id:"formatId",name:"numFmtId"},{id:"format",name:"formatCode"}]};NumberFormat.BUILTIN_IDS=[0,1,2,3,4,9,10,11,12,13,14,15,16,17,18,19,20,21,22,37,38,39,40,45,46,47,48,49];NumberFormat.ID_OFFSET=165;NumberFormat.DEFAULT="#,##0.00";NumberFormat.prototype.getId=function(){return this.formatId.value};NumberFormat.prototype.getFormat=function(){return this.format.value};NumberFormat.prototype.setId=function(sId){var iId=typeof sId==="number"?sId:parseInt(sId,10);if(isNaN(iId)||iId<0||NumberFormat._isBuiltin(iId)){return}this.formatId.value=sId};NumberFormat.prototype.setFormat=function(sFormat){this.format.value=sFormat};NumberFormat._isBuiltin=function(iId){return NumberFormat.BUILTIN_IDS.indexOf(iId)>-1};NumberFormat.prototype.equals=function(oNumberFormat){if(!(oNumberFormat instanceof NumberFormat)){return false}return this.getFormat()===oNumberFormat.getFormat()};module.exports=NumberFormat;

},{"../xml/XMLNode":29}],25:[function(require,module,exports){
var XMLNode=require("../xml/XMLNode");var Alignment=require("./Alignment");function Style(){XMLNode.call(this,Style.metadata)}Style.prototype=Object.create(XMLNode.prototype);Style.prototype.constructor=Style;Style.metadata={tag:"xf",attributes:[{id:"numberFormat",name:"numFmtId",value:"0"},{id:"font",name:"fontId",value:"0"},{id:"fill",name:"fillId",value:"0"},{id:"border",name:"borderId",value:"0"}]};Style.DEFAULT={font:{name:"Arial",size:11,family:"2",color:"1",bold:false},fill:{type:"none"}};Style.prototype.getAlignment=function(){var alignProperty="alignment";return alignProperty in this?this[alignProperty][alignProperty].value:null};Style.prototype.getFontId=function(){return this.font.value};Style.prototype.getFillId=function(){return this.fill.value};Style.prototype.getBorderId=function(){return this.border.value};Style.prototype.getNumberFormatId=function(){return this.numberFormat.value};Style.prototype.setAlignment=function(sAlign){var alignProperty="alignment";this._apply(sAlign,"Alignment");if(sAlign===null){this.remove(alignProperty)}if(!Alignment.horizontal.contains(sAlign)){return}if(!(alignProperty in this)){this.addChild({id:alignProperty,tag:"alignment",attributes:[{id:alignProperty,name:"horizontal"}]})}this[alignProperty][alignProperty].value=sAlign};Style.prototype.setFontId=function(nFontId){this._apply(nFontId,"Font");this.font.value=nFontId};Style.prototype.setFillId=function(nFillId){this._apply(nFillId,"Fill");this.fill.value=nFillId};Style.prototype.setBorderId=function(sBorderId){this.border.value=sBorderId};Style.prototype.setNumberFormatId=function(nNumFmtId){this._apply(nNumFmtId,"NumberFormat");this.numberFormat.value=nNumFmtId};Style.prototype._apply=function(nId,sType){var applyProperty="apply"+sType;this.remove(applyProperty);if(nId){this.addAttribute({id:applyProperty,name:applyProperty,value:"1"})}};Style.prototype.equals=function(oStyle){if(!(oStyle instanceof Style)){return false}return this.getFontId()===oStyle.getFontId()&&this.getFillId()===oStyle.getFillId()&&this.getBorderId()===oStyle.getBorderId()&&this.getNumberFormatId()===oStyle.getNumberFormatId()};module.exports=Style;

},{"../xml/XMLNode":29,"./Alignment":20}],26:[function(require,module,exports){
var XMLNode=require("../xml/XMLNode"),Style=require("./Style"),Font=require("./Font"),Fill=require("./Fill"),Border=require("./Border"),NumberFormat=require("./NumberFormat");function Styles(){XMLNode.call(this,Styles.metadata);this.addFill({type:"none"});this.addFill({type:"gray125"});this.addStyle(Style.DEFAULT)}Styles.prototype=Object.create(XMLNode.prototype);Styles.prototype.constructor=Styles;Styles.metadata={tag:"styleSheet",root:true,attributes:[{name:"xmlns",value:"http://schemas.openxmlformats.org/spreadsheetml/2006/main"}],properties:[{id:"numberFormats",tag:"numFmts",attributes:[{id:"count",name:"count",value:"0"}]},{id:"fonts",tag:"fonts",attributes:[{id:"count",name:"count",value:"0"}]},{id:"fills",tag:"fills",attributes:[{id:"count",name:"count",value:"0"}]},{id:"borders",tag:"borders",attributes:[{id:"count",name:"count",value:"0"}]},{tag:"cellStyleXfs",attributes:[{name:"count",value:"1"}],properties:[{tag:"xf",attributes:[{name:"numFmtId",value:"0"},{name:"fontId",value:"0"},{name:"fillId",value:"0"},{name:"borderId",value:"0"}]}]},{id:"cellXfs",tag:"cellXfs",attributes:[{id:"count",name:"count",value:"0"}]},{tag:"cellStyles",attributes:[{name:"count",value:"1"}],properties:[{tag:"cellStyle",attributes:[{name:"name",value:"Normal"},{name:"xfId",value:"0"},{name:"builtinId",value:"0"}]}]},{tag:"dxfs",attributes:[{name:"count",value:"0"}]},{tag:"tableStyles",attributes:[{name:"count",value:"0"},{name:"defaultTableStyle",value:"TableStyleMedium2"},{name:"defaultPivotStyle",value:"PivotStyleLight16"}]}]};Styles.prototype.addStyle=function(oData){var style,fontId,fillId,borderId,numberFormatId;fontId=this.addFont(oData.font);fillId=this.addFill(oData.fill);borderId=this.addBorder(oData.border);if(typeof oData.numberFormat==="undefined"){oData.numberFormat=0}numberFormatId=NumberFormat._isBuiltin(oData.numberFormat)?oData.numberFormat:this.addNumberFormat(oData.numberFormat);style=new Style;style.setFontId(fontId);style.setFillId(fillId);style.getBorderId(borderId);style.setNumberFormatId(numberFormatId);return this._addToAggregation(style,this.cellXfs)};Styles.prototype._addToAggregation=function(oItem,aAggregation){var count,i;i=-1;aAggregation.childs.forEach(function(item,index,array){if(item.equals(oItem)){i=index}});if(i===-1){aAggregation.addChild(oItem);count=aAggregation.childs.length;aAggregation.count.value=count;i=count-1}return i};Styles.prototype.addColor=function(sHexColor){if(!this.colors){this.addChild({id:"colors",tag:"colors",properties:[{id:"mru",tag:"mruColors"}]})}this.colors.mru.addChild({tag:"color",attributes:[{name:"rgb",value:"FF"+sHexColor}]})};Styles.prototype.addFont=function(oData){var oFont=new Font(oData);return this._addToAggregation(oFont,this.fonts)};Styles.prototype.addFill=function(oData){var index,oFill;oFill=new Fill(oData);index=this._addToAggregation(oFill,this.fills);if(oFill.getFill()!==null){this.addColor(oFill.getFill())}return index};Styles.prototype.addBorder=function(oData){var oBorder=new Border(oData);return this._addToAggregation(oBorder,this.borders)};Styles.prototype.addNumberFormat=function(oData){var numberFormat;numberFormat=new NumberFormat(oData);this._addToAggregation(numberFormat,this.numberFormats);numberFormat.setId(NumberFormat.ID_OFFSET+this.numberFormats.count.value);return numberFormat.getId()};module.exports=Styles;

},{"../xml/XMLNode":29,"./Border":21,"./Fill":22,"./Font":23,"./NumberFormat":24,"./Style":25}],27:[function(require,module,exports){
var XMLElement=require("./XMLElement");function XMLAttribute(oConfig){XMLElement.call(this,oConfig);this.name=oConfig.name?oConfig.name:"";this.prefix=oConfig.prefix?oConfig.prefix:"";this.suffix=oConfig.suffix?oConfig.suffix:""}XMLAttribute.prototype=Object.create(XMLElement.prototype);XMLAttribute.prototype.constructor=XMLAttribute;XMLAttribute.prototype.serialize=function(){return" "+(this.prefix?this.prefix+":":"")+this.name+(this.suffix?":"+this.suffix:"")+'="'+this.xmlEncode(this.value)+'"'};module.exports=XMLAttribute;

},{"./XMLElement":28}],28:[function(require,module,exports){
function XMLElement(oConfig){this.value=oConfig&&oConfig.value?oConfig.value:""}XMLElement.prototype.xmlEncode=function(sValue){return typeof sValue==="string"&&sValue.match(/[><"'&]+/)!==null?this._replace(sValue):sValue};XMLElement.prototype._replace=function(sValue){return sValue.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;")};module.exports=XMLElement;

},{}],29:[function(require,module,exports){
var XMLElement=require("./XMLElement");var XMLAttribute=require("./XMLAttribute");function XMLNode(oConfig){var i,j,config;XMLElement.call(this,oConfig);config=typeof oConfig==="string"?{tag:oConfig}:oConfig;Object.defineProperty(this,"root",{value:!!config.root,writable:false});this.tag=typeof config.tag=="string"?config.tag:"";this.attributes=[];this.childs=[];if(config.attributes){for(i=0;i<config.attributes.length;i++){this.addAttribute(config.attributes[i])}}if(config.properties){for(j=0;j<config.properties.length;j++){this.addChild(config.properties[j])}}}XMLNode.prototype=Object.create(XMLElement.prototype);XMLNode.prototype.constructor=XMLNode;XMLNode.processingInformation='<?xml version="1.0" encoding="UTF-8"?>';XMLNode.prototype.addAttribute=function(oConfig){var attribute=oConfig instanceof XMLAttribute?oConfig:new XMLAttribute(oConfig);this.attributes.push(attribute);if(oConfig.id){Object.defineProperty(this,oConfig.id,{value:attribute,writable:false,configurable:true})}return attribute};XMLNode.prototype.addChild=function(oConfig){var node=oConfig instanceof XMLNode?oConfig:new XMLNode(oConfig);this.childs.push(node);if(oConfig.id){Object.defineProperty(this,oConfig.id,{value:node,writable:false,configurable:true})}return node};XMLNode.prototype.remove=function(sProperty){var index,referencedElement,aAggregation;if(!(sProperty in this)){return null}referencedElement=this[sProperty];if(referencedElement instanceof XMLAttribute){aAggregation=this.attributes}else if(referencedElement instanceof XMLNode&&!(sProperty in new XMLNode(""))){aAggregation=this.childs}else{return null}index=aAggregation.indexOf(referencedElement);aAggregation.splice(index,1);delete this[sProperty];return referencedElement};XMLNode.prototype.serialize=function(){var sSerialized,i,j;sSerialized=(this.root?XMLNode.processingInformation:"")+"<"+this.tag;for(i=0;i<this.attributes.length;i++){sSerialized+=this.attributes[i].serialize()}if(this.childs.length||this.value||typeof this.value==="number"){sSerialized+=">";for(j=0;j<this.childs.length;j++){sSerialized+=typeof this.childs[j]==="string"?this.childs[j]:this.childs[j].serialize()}sSerialized+=this.xmlEncode(this.value);sSerialized+="</"+this.tag+">"}else{sSerialized+="/>"}return sSerialized};module.exports=XMLNode;

},{"./XMLAttribute":27,"./XMLElement":28}]},{},[1])(1)
});
//# sourceMappingURL=XLSXBuilder.js.map
