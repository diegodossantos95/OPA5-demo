(function(f){if(typeof exports==="object"&&typeof module!=="undefined"){module.exports=f()}else if(typeof define==="function"&&define.amd){define([],f)}else{var g;if(typeof window!=="undefined"){g=window}else if(typeof global!=="undefined"){g=global}else if(typeof self!=="undefined"){g=self}else{g=this}g.XLSXBuilder=f()}})(function(){var d,m,b;return(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(r,m,b){var A=r("./objects/App"),C=r("./binding/Column"),a=r("./binding/ColumnConfiguration"),c=r("./objects/ContentTypes"),f=r("./objects/Core"),R=r("./objects/Relationships"),S=r("./data/SharedStrings"),g=r("./data/Sheet"),h=r("./style/Styles"),W=r("./objects/Workbook");function X(B,o){if(!(B instanceof Array)||!B.length){throw new Error("No binding provided")}this.styles=new this.objects.Styles;this.sheet=new this.objects.Sheet(new this.binding.ColumnConfiguration(B,this.styles));this.app=new this.objects.App(o);this.core=new this.objects.Core(o)}X.prototype={binding:{ColumnConfiguration:a,Column:C},objects:{App:A,ContentTypes:c,Core:f,Relationships:R,SharedStrings:S,Sheet:g,Styles:h,Workbook:W},build:function(){var k,z,i,j,l,F,x,n,o,p;k=[{name:"[Content_Types].xml",path:"",type:this.objects.ContentTypes},{name:".rels",path:"_rels/",type:this.objects.Relationships,relationships:[{target:"xl/workbook.xml",type:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument"},{target:"docProps/app.xml",type:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties"},{target:"docProps/core.xml",type:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties"}]},{name:"workbook.xml",path:"xl/",type:this.objects.Workbook},{name:"workbook.xml.rels",path:"xl/_rels/",type:this.objects.Relationships,relationships:[{target:"worksheets/sheet1.xml",type:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet"},{target:"sharedStrings.xml",type:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings"},{target:"styles.xml",type:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles"}]}];z=new JSZip;for(i=0;i<k.length;i++){l=k[i];F=l.type;x=new F(l);if(x instanceof this.objects.Relationships){for(j=0;j<l.relationships.length;j++){n=l.relationships[j];x.addRelationship(n.target,n.type)}}z.file(l.path+l.name,x.serialize())}z.file("docProps/app.xml",this.app.serialize());z.file("docProps/core.xml",this.core.serialize());z.file("xl/styles.xml",this.styles.serialize());z.file("xl/worksheets/sheet1.xml",this.sheet.serialize());z.file("xl/sharedStrings.xml",this.objects.SharedStrings.getInstance().serialize());o={compression:"DEFLATE",type:JSZip.support.nodebuffer?"nodebuffer":"arraybuffer"};if(z.generateAsync){p=z.generateAsync(o)}else{p=new Promise(function(q,s){var t=z.generate(o);q(t)})}return p},append:function(D){var i;if(typeof D==="undefined"||D===null){return}i=D instanceof Array?D:[D];while(i.length){this.sheet.insert(i.shift())}}};m.exports=X;},{"./binding/Column":2,"./binding/ColumnConfiguration":3,"./data/SharedStrings":13,"./data/Sheet":14,"./objects/App":15,"./objects/ContentTypes":16,"./objects/Core":17,"./objects/Relationships":18,"./objects/Workbook":19,"./style/Styles":26}],2:[function(r,m,b){var C=r("../data/Cell"),a=r("../binding/type/CalendarDate"),N=r("../binding/type/Numeric"),c=r("../binding/type/Currency"),B=r("../binding/type/BooleanType"),T=r("../binding/type/Text");function f(D,s){var o;o=typeof D==="string"?{property:D}:D;if(!o||!o.property){throw new Error("The property for the column is not defined")}this.align=o.align?o.align:f.Align.Left;this.property=o.property;this.label=o.label?o.label:o.property;this.width=o.width;this.styles=s;this.type=this._initType(o)}f.Align={Left:"left",Center:"center",Right:"right"};f.prototype._initType=function(D){var t,s;s=D.type;if(s==="date"||s==="datetime"||s==="time"){t=new a({calendar:D.calendar,format:D.format,type:s})}else if(s==="number"||s==="percent"||s==="exponent"){t=new N({delimiter:D.delimiter,scale:D.scale,type:D.type,unit:D.unit,unitProperty:D.unitProperty})}else if(s==="currency"){t=new c({type:s,unitProperty:D.unitProperty,displayUnit:D.displayUnit,scale:D.scale})}else if(s==="boolean"){t=new B({trueValue:D.trueValue,falseValue:D.falseValue})}else{t=new T}t.registerAt(this.styles);return t};f.prototype.getCell=function(){if(!this.cell){this.cell=new C(this.type)}return this.cell};f.prototype.bind=function(D){this.cell.setValue(D[this.property],D)};m.exports=f;},{"../binding/type/BooleanType":4,"../binding/type/CalendarDate":5,"../binding/type/Currency":6,"../binding/type/Numeric":7,"../binding/type/Text":8,"../data/Cell":10}],3:[function(r,m,b){var C=r("./Column"),T=r("./type/Text"),R=r("../data/Row"),a=r("../data/Cell");function c(f,s){var g,i;this.columns=[];this.row=null;this.styles=s;for(i=0;i<f.length;i++){g=f[i]instanceof C?f[i]:new C(f[i],this.styles);this.columns.push(g)}}c.prototype._initBinding=function(){var i;this.row=new R;for(i=0;i<this.columns.length;i++){this.row.addCell(this.columns[i].getCell())}};c.prototype.bind=function(D){var i;if(this.row===null){this._initBinding()}for(i=0;i<this.columns.length;i++){this.columns[i].bind(D)}return this.row};c.prototype.getHeader=function(){var f,g,t;g=new R;t=new T({font:{name:"Arial",size:11,bold:true},fill:{color:"F7F7F7"}});t.registerAt(this.styles);g.setStyle(t.getStyleId());g.addAttribute({name:"customFormat",value:"1"});this.columns.forEach(function(h,i,j){f=new a(t);f.setValue(h.label);g.addCell(f)});return g};c.prototype.size=function(){return this.columns.length};m.exports=c;},{"../data/Cell":10,"../data/Row":11,"./Column":2,"./type/Text":8}],4:[function(r,m,b){var T=r("./Type");function B(c){T.call(this);this.trueValue=c?c.trueValue:null;this.falseValue=c?c.falseValue:null}B.prototype=Object.create(T.prototype);B.prototype.constructor=B;B.DEFAULT={numberFormat:0};B.prototype.isCustomFormatted=function(){return!!this.trueValue&&typeof this.trueValue==="string"&&!!this.falseValue&&typeof this.falseValue==="string"};B.prototype._createConfiguration=function(){var a=B.DEFAULT;if(this.isCustomFormatted()){a={numberFormat:{format:'"'+this.trueValue+'";;"'+this.falseValue+'"'}}}return a};m.exports=B;},{"./Type":9}],5:[function(r,m,b){var T=r("./Type");function C(c){T.call(this);this.type=c?c.type:null;this.format=c?c.format:null;this.calendar=c?c.calendar:null}C.prototype=Object.create(T.prototype);C.prototype.constructor=C;C.DEFAULT={numberFormat:14};C.builtin={14:"mm-dd-yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0"};C.prototype._createConfiguration=function(){var k,a,t;if(!this.type&&!this.format&&!this.calendar){return C.DEFAULT}switch(this.type){case"datetime":t=C.builtin[22];break;case"time":t=C.builtin[21];break;default:t=C.builtin[14]}if(typeof this.format==="string"){t=this.format.match(/^[dhmsy\s-,.:\/]+(AM\/PM)?$/)?this.format:t}switch(this.calendar){case"islamic":t="b2d mmmm yyyy";break;case"japanese":t="[$-ja-JP]ge.m.d";break;default:}a={numberFormat:{format:t}};for(k in C.builtin){if(C.builtin[k]===t){a.numberFormat=parseInt(k,10)}}return a};m.exports=C;},{"./Type":9}],6:[function(r,m,b){var N=r("./Numeric");function C(c){N.call(this,c);this.displayUnit=typeof c.displayUnit==="boolean"?c.displayUnit:true}C.prototype=Object.create(N.prototype);C.prototype.constructor=C;C.DEFAULT_SCALE=3;C.DIGITS={ADP:0,AFN:0,ALL:0,AMD:0,BHD:3,BIF:0,BYR:0,CAD:2,CHF:2,CLF:4,CLP:0,COP:0,CRC:0,CZK:0,DEFAULT:2,DJF:0,ESP:0,GNF:0,GYD:0,HUF:0,IDR:0,IQD:0,IRR:0,ISK:0,ITL:0,JOD:3,JPY:0,KMF:0,KPW:0,KRW:0,KWD:3,LAK:0,LBP:0,LUF:0,LYD:3,MGA:0,MGF:0,MMK:0,MNT:0,MRO:0,MUR:0,OMR:3,PKR:0,PYG:0,RSD:0,RWF:0,SLL:0,SOS:0,STD:0,SYP:0,TMM:0,TND:3,TRL:0,TWD:0,TZS:0,UGX:0,UYI:0,UZS:0,VND:0,VUV:0,XAF:0,XOF:0,XPF:0,YER:0,ZMK:0,ZWD:0};C.prototype._createConfiguration=function(D){var i,j,s,t,u;t="* #,##0";if(!this.unitProperty&&typeof this.scale==="number"){s=this.scale}else{s=C.DIGITS[D[this.unitProperty]]}if(typeof s!=="number"){s=C.DIGITS.DEFAULT}t+=s>0?".":"_.";for(i=0;i<s;i++){t+="0"}for(j=C.DEFAULT_SCALE-s;j>0;j--){t+="_0"}if(this.displayUnit){u=D[this.unitProperty];t=t+(u?' "'+u+'"':" _E_U_R")}return{numberFormat:{format:t}}};m.exports=C;},{"./Numeric":7}],7:[function(r,m,b){var T=r("./Type");function N(c){T.call(this);this.unit=c?c.unit:null;this.unitProperty=c?c.unitProperty:null;this.delimiter=c?c.delimiter:false;this.scale=c?c.scale:null;this.styleIds={}}N.prototype=Object.create(T.prototype);N.prototype.constructor=N;N.DEFAULT={numberFormat:0};N.builtin={1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",37:"#,##0;(#,##0)",38:"#,##0;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",48:"##0.0E+0"};N.prototype._createConfiguration=function(D){var i,k,a,t=N.builtin[1],u="";if(!this.delimiter&&typeof this.scale!=="number"){return N.DEFAULT}if(this.delimiter){t="#,##"+t}if(typeof this.scale==="number"&&this.scale>0){t+=".";for(i=0;i<this.scale;i++){t+="0"}}if(typeof this.unitProperty==="string"&&D){u=' "'+D[this.unitProperty]+'"'}else if(typeof this.unit==="string"){u=' "'+this.unit+'"'}t+=u;a={numberFormat:{format:t}};for(k in N.builtin){if(N.builtin[k]===t){a.numberFormat=parseInt(k,10)}}return a};N.prototype.getStyleId=function(D){var s,u;if(!this.unitProperty){return Object.getPrototypeOf(N.prototype).getStyleId.call(this)}if(!D){return 0}u=D[this.unitProperty];s=this.styleIds[u];if(typeof s==="undefined"){this.styleIds[u]=this.styles.addStyle(this._createConfiguration(D))}return this.styleIds[u]};m.exports=N;},{"./Type":9}],8:[function(r,m,b){var T=r("./Type");function a(c){T.call(this);this.font=c?c.font:null;this.fill=c?c.fill:null}a.prototype=Object.create(T.prototype);a.prototype.constructor=a;a.DEFAULT={font:{size:11,name:"Arial"}};a.prototype._createConfiguration=function(){return this.font||this.fill?{font:this.font,fill:this.fill}:a.DEFAULT};m.exports=a;},{"./Type":9}],9:[function(r,m,b){function T(){this.styleId=null}T.prototype._createConfiguration=function(){throw new Error("Abstract method must be implemented by its subclass!")};T.prototype.getStyleId=function(){if(this.styleId===null){this.styleId=this.styles.addStyle(this._createConfiguration())}return this.styleId};T.prototype.registerAt=function(s){this.styles=s};m.exports=T;},{}],10:[function(r,m,b){var X=r("../xml/XMLNode"),C=r("../binding/type/CalendarDate"),N=r("../binding/type/Numeric"),B=r("../binding/type/BooleanType"),a=r("../binding/type/Currency"),S=r("../data/SharedStrings");function c(t){X.call(this,c.metadata);this._applyType(t)}c.prototype=Object.create(X.prototype);c.prototype.constructor=c;c.DataType={Boolean:"b",Date:"d",InlineString:"inlineStr",Number:"n",SharedString:"s",FormularString:"str"};c._JsDateToExcel=function(D){return D.getTime()/(86400*1e3)+(25567+2)};c.metadata={tag:"c",attributes:[{id:"reference",name:"r",value:""},{id:"style",name:"s",value:"0"}],properties:[{id:"text",tag:"v"}]};c.prototype._applyType=function(t){Object.defineProperty(this,"type",{value:c.DataType.SharedString,writable:true});switch(t.constructor){case C:this.type=c.DataType.Date;break;case N:this.type=c.DataType.Number;break;case B:this.type=c.DataType.Boolean;if(!t.isCustomFormatted()){this.addAttribute({name:"t",value:c.DataType.Boolean})}break;case a:this.type=c.DataType.Number;break;default:this.addAttribute({name:"t",value:c.DataType.SharedString});this.type=c.DataType.SharedString}this.bindingType=t};c.prototype.setStyle=function(n){this.style.value=n};c.prototype.setReference=function(R){if(typeof R!="string"||!R.match(/^[A-Z]+[1-9]+[0-9]*$/g)){throw new Error('The given Cell reference "'+R+'" does not match the reference pattern.')}this.reference.value=R};c.prototype.setValue=function(D,o){var s,f,v;if(!this._isValuePresent(D)){this.text.value="";return}switch(this.type){case c.DataType.Number:this.text.value=D;break;case c.DataType.Boolean:v=D;if(typeof v==="string"){v=v.toLowerCase()!=="false"&&v!=="0"}this.text.value=v?"1":"0";break;case c.DataType.Date:if(D instanceof Date){f=D}else if(typeof D==="number"){f=new Date(D)}else{f=new Date(parseInt(D,10))}this.text.value=c._JsDateToExcel(f);break;default:s=S.getInstance();this.text.value=s.insert(D)}this.setStyle(this.bindingType.getStyleId(o))};c.prototype._isValuePresent=function(s){return typeof s==="string"&&!!s||typeof s==="number"||typeof s==="boolean"};m.exports=c;},{"../binding/type/BooleanType":4,"../binding/type/CalendarDate":5,"../binding/type/Currency":6,"../binding/type/Numeric":7,"../data/SharedStrings":13,"../xml/XMLNode":29}],11:[function(r,m,b){var X=r("../xml/XMLNode");var C=r("./Cell");function R(){X.call(this,R.metadata)}R.prototype=Object.create(X.prototype);R.prototype.constructor=R;R.metadata={tag:"row",attributes:[{id:"reference",name:"r",value:""},{id:"spans",name:"spans",value:"1:1"}]};R.getColumnReferenceByIndex=function(n){return n<26?String.fromCharCode(65+n):R.getColumnReferenceByIndex(Math.floor(n/26)-1)+String.fromCharCode(65+n%26)};R.prototype._updateSpans=function(){this.spans.value="1:"+this.childs.length};R.prototype.addCell=function(c){var a;if(!c||!(c instanceof C)){return}a=this.childs.push(c);this._updateSpans();if(this.reference.value){c.setReference(R.getColumnReferenceByIndex(a-1)+this.reference.value)}if(this.style){c.setStyle(this.style.value)}};R.prototype.setReference=function(s){var i,a;a=typeof s=="number"?String(s):s;if(!a||!a.match(/^[1-9]+[0-9]*$/g)){return}if(this.reference.value!=a){this.reference.value=a;for(i=0;i<this.childs.length;i++){this.childs[i].setReference(R.getColumnReferenceByIndex(i)+a)}}};R.prototype.setStyle=function(n){var i,s;if(!this.style){s=this.addAttribute({name:"s"});Object.defineProperty(this,"style",{value:s})}this.style.value=n;for(i=0;i<this.childs.length;i++){this.childs[i].setStyle(n)}};m.exports=R;},{"../xml/XMLNode":29,"./Cell":10}],12:[function(r,m,b){var X=r("../xml/XMLNode");function S(v){X.call(this,S.metadata);this.setValue(v)}S.prototype=Object.create(X.prototype);S.prototype.constructor=S;S.metadata={tag:"si",properties:[{id:"text",tag:"t"}]};S.prototype.setValue=function(v){if(v&&typeof v=="string"){this.text.value=v}else{this.text.value=""+v}};m.exports=S;},{"../xml/XMLNode":29}],13:[function(r,m,b){var X=r("../xml/XMLNode"),S=r("./SharedString");function a(){if(a.instance instanceof a){return a.instance}X.call(this,a.metadata);Object.defineProperty(this,"map",{value:new Map,writable:false});Object.defineProperty(this,"_shared",{value:new S(""),writable:false});a.instance=this}a.prototype=Object.create(X.prototype);a.prototype.constructor=a;a.getInstance=function(){if(!a.instance){a.instance=new a}return a.instance};a.metadata={tag:"sst",root:true,attributes:[{name:"xmlns",value:"http://schemas.openxmlformats.org/spreadsheetml/2006/main"}]};a.prototype.insert=function(v){var i;if(this.map.has(v)){return this.map.get(v)}this._shared.setValue(v);i=this.map.size;this.map.set(v,i);this.childs.push(this._shared.serialize());return i};m.exports=a;},{"../xml/XMLNode":29,"./SharedString":12}],14:[function(r,m,b){var X=r("../xml/XMLNode"),R=r("./Row");function S(c){X.call(this,S.metadata);Object.defineProperty(this,"_columns",{value:c,writable:false});this._createCols();this._createHeader()}S.prototype=Object.create(X.prototype);S.prototype.constructor=S;S.metadata={tag:"worksheet",root:true,attributes:[{name:"xmlns",value:"http://schemas.openxmlformats.org/spreadsheetml/2006/main"},{name:"xmlns",suffix:"r",value:"http://schemas.openxmlformats.org/officeDocument/2006/relationships"}],properties:[{id:"dimension",tag:"dimension",attributes:[{id:"reference",name:"ref",value:"A1"}]},{tag:"sheetViews",properties:[{tag:"sheetView",attributes:[{name:"workbookViewId",value:"0"},{name:"tabSelected",value:"1"}],properties:[{tag:"pane",attributes:[{name:"ySplit",value:"1"},{name:"topLeftCell",value:"A2"},{name:"activePane",value:"bottomLeft"},{name:"state",value:"frozen"}]}]}]},{tag:"sheetFormatPr",attributes:[{name:"defaultRowHeight",value:"15"}]},{id:"columns",tag:"cols"},{id:"data",tag:"sheetData"},{id:"filter",tag:"autoFilter",attributes:[{id:"reference",name:"ref",value:"A1"}]},{tag:"pageMargins",attributes:[{name:"left",value:"0.75"},{name:"right",value:"0.75"},{name:"top",value:"1"},{name:"bottom",value:"1"},{name:"header",value:"0.5"},{name:"footer",value:"0.5"}]}]};S.MAX_ROWS=1048576;S.prototype._createCols=function(){var c,i,a,w,f=2.4;for(i=0;i<this._columns.size();i++){c=this._columns.columns[i];a=this._calculateColumnWidth(c.label.length)+f;w=Math.max(this._calculateColumnWidth(c.width),a);this.columns.addChild({tag:"col",attributes:[{name:"min",value:i+1},{name:"max",value:i+1},{name:"bestFit",value:"1"},{name:"width",value:Math.max(w,a)},{name:"customWidth",value:"1"}]})}};S.prototype._calculateColumnWidth=function(n){var a=11,c=5,s=7.33;if(typeof n!=="number"){return 0}return(n*2/3*a+c)/s};S.prototype._createHeader=function(){this._appendRow(this._columns.getHeader())};S.prototype._appendRow=function(o){var i,a;o.setReference(""+(this.data.childs.length+1));this.data.childs.push(o.serialize());for(i=0;i<this.childs.length;i++){if(this.childs[i].tag=="dimension"){a="A1:"+R.getColumnReferenceByIndex(this._columns.size()-1)+this.data.childs.length;this.dimension.reference.value=a;this.filter.reference.value=a}}};S.prototype.insert=function(D){if(this.data.childs.length==S.MAX_ROWS){throw new Error("Row limit reached.")}this._appendRow(this._columns.bind(D))};m.exports=S;},{"../xml/XMLNode":29,"./Row":11}],15:[function(r,m,b){var X=r("../xml/XMLNode");function A(c){X.call(this,A.metadata);if(c){if(c.application){this.application.value=c.application}if(c.version){this.version.value=c.version}}}A.prototype=Object.create(X.prototype);A.prototype.constructor=A;A.metadata={tag:"Properties",root:true,attributes:[{name:"xmlns",value:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties"},{name:"xmlns",suffix:"vt",value:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes"}],properties:[{id:"application",tag:"Application",value:"SAP UI5"},{tag:"DocSecurity",value:"0"},{tag:"Company",value:"SAP SE"},{tag:"SharedDoc",value:"false"},{id:"version",tag:"AppVersion",value:"1.52"}]};m.exports=A;},{"../xml/XMLNode":29}],16:[function(r,m,b){var X=r("../xml/XMLNode");function C(){X.call(this,C.metadata)}C.prototype=Object.create(X.prototype);C.prototype.constructor=C;C.metadata={tag:"Types",root:true,attributes:[{name:"xmlns",value:"http://schemas.openxmlformats.org/package/2006/content-types"}],properties:[{tag:"Default",attributes:[{name:"Extension",value:"xml"},{name:"ContentType",value:"application/xml"}]},{tag:"Default",attributes:[{name:"Extension",value:"rels"},{name:"ContentType",value:"application/vnd.openxmlformats-package.relationships+xml"}]},{tag:"Override",attributes:[{name:"PartName",value:"/xl/workbook.xml"},{name:"ContentType",value:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml"}]},{tag:"Override",attributes:[{name:"PartName",value:"/xl/worksheets/sheet1.xml"},{name:"ContentType",value:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml"}]},{tag:"Override",attributes:[{name:"PartName",value:"/xl/styles.xml"},{name:"ContentType",value:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml"}]},{tag:"Override",attributes:[{name:"PartName",value:"/xl/sharedStrings.xml"},{name:"ContentType",value:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml"}]},{tag:"Override",attributes:[{name:"PartName",value:"/docProps/core.xml"},{name:"ContentType",value:"application/vnd.openxmlformats-package.core-properties+xml"}]},{tag:"Override",attributes:[{name:"PartName",value:"/docProps/app.xml"},{name:"ContentType",value:"application/vnd.openxmlformats-officedocument.extended-properties+xml"}]}]};m.exports=C;},{"../xml/XMLNode":29}],17:[function(r,m,b){var X=r("../xml/XMLNode");function C(c){X.call(this,C.metadata);if(c){if(c.title){this.title.value=c.title}if(c.modifiedBy){this.modifiedBy.value=c.modifiedBy}}}C.prototype=Object.create(X.prototype);C.prototype.constructor=C;C.metadata={tag:"cp:coreProperties",root:true,attributes:[{name:"xmlns",suffix:"cp",value:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties"},{name:"xmlns",suffix:"dc",value:"http://purl.org/dc/elements/1.1/"},{name:"xmlns",suffix:"dcterms",value:"http://purl.org/dc/terms/"},{name:"xmlns",suffix:"dcmitype",value:"http://purl.org/dc/dcmitype/"},{name:"xmlns",suffix:"xsi",value:"http://www.w3.org/2001/XMLSchema-instance"}],properties:[{id:"title",tag:"dc:title",value:"Table Export"},{tag:"dc:creator",value:"SAP UI5 Document Export"},{tag:"dcterms:created",attributes:[{prefix:"xsi",name:"type",value:"dcterms:W3CDTF"}],value:(new Date).toISOString()},{tag:"cp:keywords",value:"SAP UI5 EXPORT"},{id:"modifiedBy",tag:"cp:lastModifiedBy",value:"SAP UI5"}]};m.exports=C;},{"../xml/XMLNode":29}],18:[function(r,m,b){var X=r("../xml/XMLNode");function R(){X.call(this,R.metadata)}R.prototype=Object.create(X.prototype);R.prototype.constructor=R;R.metadata={tag:"Relationships",root:true,attributes:[{name:"xmlns",value:"http://schemas.openxmlformats.org/package/2006/relationships"}],properties:[]};R.prototype.addRelationship=function(t,T){var i="rId"+(this.childs.length+1);this.childs.push(new X({tag:"Relationship",attributes:[{name:"Id",value:i},{name:"Type",value:T},{name:"Target",value:t}]}))};m.exports=R;},{"../xml/XMLNode":29}],19:[function(r,m,b){var X=r("../xml/XMLNode");function W(){X.call(this,W.metadata);this.addSheet("SAP Document Export")}W.prototype=Object.create(X.prototype);W.prototype.constructor=W;W.metadata={tag:"workbook",root:true,attributes:[{name:"xmlns",value:"http://schemas.openxmlformats.org/spreadsheetml/2006/main"},{name:"xmlns",suffix:"r",value:"http://schemas.openxmlformats.org/officeDocument/2006/relationships"}],properties:[{tag:"bookViews",properties:[{tag:"workbookView",attributes:[{name:"xWindow",value:"0"},{name:"yWindow",value:"0"},{name:"windowWidth",value:"22260"},{name:"windowHeight",value:"12645"}]}]},{id:"sheets",tag:"sheets"}]};W.prototype.addSheet=function(n){var c=this.sheets.childs.length+1;var s=new X({tag:"sheet",attributes:[{name:"name",value:n},{name:"sheetId",value:""+c},{name:"id",prefix:"r",value:"rId"+c}]});this.sheets.addChild(s)};m.exports=W;},{"../xml/XMLNode":29}],20:[function(r,m,b){var A={horizontal:{Left:"left",Center:"center",Right:"right",contains:function(a){return _(a,A.horizontal)}},vertical:{Top:"top",Middle:"middle",Bottom:"bottom",contains:function(a){return _(a,A.vertical)}}};function _(a,o){var k,c=false;for(k in o){c=c?c:o[k]===a&&typeof o[k]!=="function"}return c}m.exports=A;},{}],21:[function(r,m,b){var X=r("../xml/XMLNode");function B(){X.call(this,B.metadata)}B.prototype=Object.create(X.prototype);B.prototype.constructor=B;B.metadata={tag:"border",properties:[{tag:"left"},{tag:"right"},{tag:"top"},{tag:"bottom"},{tag:"diagonal"}]};B.prototype.equals=function(o){return o instanceof B};m.exports=B;},{"../xml/XMLNode":29}],22:[function(r,m,b){var X=r("../xml/XMLNode");function F(D){X.call(this,F.metadata);if(D){if(D.color){this.setFill(D.color)}else if(D.type){this.setType(D.type)}}}F.prototype=Object.create(X.prototype);F.prototype.constructor=F;F.DEFAULT_TYPE="none";F.metadata={tag:"fill",properties:[{id:"fill",tag:"patternFill",attributes:[{id:"type",name:"patternType",value:F.DEFAULT_TYPE}]}]};F.prototype.equals=function(f){if(!(f instanceof F)){return false}return this.getType()===f.getType()&&this.getFill()===f.getFill()};F.prototype.getFill=function(){return this.fill.childs.length?this.fill.color.rgb.value.substring(2):null};F.prototype.setFill=function(c){this.reset();if(c&&typeof c==="string"&&/^[A-Fa-f0-9]{6}$/.test(c)){this.fill.type.value="solid";this.fill.addChild({id:"color",tag:"fgColor",attributes:[{id:"rgb",name:"rgb",value:"FF"+c}]});this.fill.addChild({tag:"bgColor",attributes:[{name:"indexed",value:"64"}]})}};F.prototype.getType=function(){return this.fill.type.value};F.prototype.setType=function(t){this.reset();this.fill.type.value=t};F.prototype.reset=function(){this.fill.type.value="none";this.fill.childs.length=0};m.exports=F;},{"../xml/XMLNode":29}],23:[function(r,m,b){var X=r("../xml/XMLNode");function F(D){X.call(this,F.metadata);if(D&&D instanceof Object){this.setName(D.name).setSize(D.size).setFamily(D.family).setBold(!!D.bold)}}F.prototype=Object.create(X.prototype);F.prototype.constructor=F;F.DEFAULT_SIZE=11;F.DEFAULT_NAME="Arial";F.metadata={tag:"font",properties:[{id:"size",tag:"sz",attributes:[{id:"valueAttribute",name:"val",value:F.DEFAULT_SIZE}]},{id:"color",tag:"color",attributes:[{id:"valueAttribute",name:"theme",value:"1"}]},{id:"name",tag:"name",attributes:[{id:"valueAttribute",name:"val",value:F.DEFAULT_NAME}]},{id:"family",tag:"family",attributes:[{id:"valueAttribute",name:"val",value:2}]}]};F.prototype.equals=function(f){if(!(f instanceof F)){return false}return this.getName()==f.getName()&&this.getSize()==f.getSize()&&this.isBold()==f.isBold()&&this.getColor()==f.getColor()&&this.getFamily()==f.getFamily()};F.prototype.isBold=function(){return!!this.bold};F.prototype.getSize=function(){return this.size.valueAttribute.value};F.prototype.getName=function(){return this.name.valueAttribute.value};F.prototype.getColor=function(){return this.color.valueAttribute.value};F.prototype.getFamily=function(){return this.family.valueAttribute.value};F.prototype.setBold=function(B){var a="bold";if(B===!!this[a]){return this}if(B){this.addChild({id:a,tag:"b"})}else{this.remove(a)}return this};F.prototype.setFamily=function(n){if(n>0&&n<15){this.family.valueAttribute.value=n}return this};F.prototype.setName=function(n){if(n&&typeof n==="string"){this.name.valueAttribute.value=n}return this};F.prototype.setSize=function(n){if(typeof n!=="number"||isNaN(n)||n<1||n>96){throw new Error("The size "+n+" is not supported.")}this.size.valueAttribute.value=n;return this};m.exports=F;},{"../xml/XMLNode":29}],24:[function(r,m,b){var X=r("../xml/XMLNode");function N(D){X.call(this,N.metadata);this.format.value=D&&D.format?D.format:N.DEFAULT}N.prototype=Object.create(X.prototype);N.prototype.constructor=N;N.metadata={tag:"numFmt",attributes:[{id:"formatId",name:"numFmtId"},{id:"format",name:"formatCode"}]};N.BUILTIN_IDS=[0,1,2,3,4,9,10,11,12,13,14,15,16,17,18,19,20,21,22,37,38,39,40,45,46,47,48,49];N.ID_OFFSET=165;N.DEFAULT="#,##0.00";N.prototype.getId=function(){return this.formatId.value};N.prototype.getFormat=function(){return this.format.value};N.prototype.setId=function(i){var I=typeof i==="number"?i:parseInt(i,10);if(isNaN(I)||I<0||N._isBuiltin(I)){return}this.formatId.value=i};N.prototype.setFormat=function(f){this.format.value=f};N._isBuiltin=function(i){return N.BUILTIN_IDS.indexOf(i)>-1};N.prototype.equals=function(n){if(!(n instanceof N)){return false}return this.getFormat()===n.getFormat()};m.exports=N;},{"../xml/XMLNode":29}],25:[function(r,m,b){var X=r("../xml/XMLNode");var A=r("./Alignment");function S(){X.call(this,S.metadata)}S.prototype=Object.create(X.prototype);S.prototype.constructor=S;S.metadata={tag:"xf",attributes:[{id:"numberFormat",name:"numFmtId",value:"0"},{id:"font",name:"fontId",value:"0"},{id:"fill",name:"fillId",value:"0"},{id:"border",name:"borderId",value:"0"}]};S.DEFAULT={font:{name:"Arial",size:11,family:"2",color:"1",bold:false},fill:{type:"none"}};S.prototype.getAlignment=function(){var a="alignment";return a in this?this[a][a].value:null};S.prototype.getFontId=function(){return this.font.value};S.prototype.getFillId=function(){return this.fill.value};S.prototype.getBorderId=function(){return this.border.value};S.prototype.getNumberFormatId=function(){return this.numberFormat.value};S.prototype.setAlignment=function(a){var c="alignment";this._apply(a,"Alignment");if(a===null){this.remove(c)}if(!A.horizontal.contains(a)){return}if(!(c in this)){this.addChild({id:c,tag:"alignment",attributes:[{id:c,name:"horizontal"}]})}this[c][c].value=a};S.prototype.setFontId=function(n){this._apply(n,"Font");this.font.value=n};S.prototype.setFillId=function(n){this._apply(n,"Fill");this.fill.value=n};S.prototype.setBorderId=function(B){this.border.value=B};S.prototype.setNumberFormatId=function(n){this._apply(n,"NumberFormat");this.numberFormat.value=n};S.prototype._apply=function(n,t){var a="apply"+t;this.remove(a);if(n){this.addAttribute({id:a,name:a,value:"1"})}};S.prototype.equals=function(s){if(!(s instanceof S)){return false}return this.getFontId()===s.getFontId()&&this.getFillId()===s.getFillId()&&this.getBorderId()===s.getBorderId()&&this.getNumberFormatId()===s.getNumberFormatId()};m.exports=S;},{"../xml/XMLNode":29,"./Alignment":20}],26:[function(r,m,b){var X=r("../xml/XMLNode"),S=r("./Style"),F=r("./Font"),a=r("./Fill"),B=r("./Border"),N=r("./NumberFormat");function c(){X.call(this,c.metadata);this.addFill({type:"none"});this.addFill({type:"gray125"});this.addStyle(S.DEFAULT)}c.prototype=Object.create(X.prototype);c.prototype.constructor=c;c.metadata={tag:"styleSheet",root:true,attributes:[{name:"xmlns",value:"http://schemas.openxmlformats.org/spreadsheetml/2006/main"}],properties:[{id:"numberFormats",tag:"numFmts",attributes:[{id:"count",name:"count",value:"0"}]},{id:"fonts",tag:"fonts",attributes:[{id:"count",name:"count",value:"0"}]},{id:"fills",tag:"fills",attributes:[{id:"count",name:"count",value:"0"}]},{id:"borders",tag:"borders",attributes:[{id:"count",name:"count",value:"0"}]},{tag:"cellStyleXfs",attributes:[{name:"count",value:"1"}],properties:[{tag:"xf",attributes:[{name:"numFmtId",value:"0"},{name:"fontId",value:"0"},{name:"fillId",value:"0"},{name:"borderId",value:"0"}]}]},{id:"cellXfs",tag:"cellXfs",attributes:[{id:"count",name:"count",value:"0"}]},{tag:"cellStyles",attributes:[{name:"count",value:"1"}],properties:[{tag:"cellStyle",attributes:[{name:"name",value:"Normal"},{name:"xfId",value:"0"},{name:"builtinId",value:"0"}]}]},{tag:"dxfs",attributes:[{name:"count",value:"0"}]},{tag:"tableStyles",attributes:[{name:"count",value:"0"},{name:"defaultTableStyle",value:"TableStyleMedium2"},{name:"defaultPivotStyle",value:"PivotStyleLight16"}]}]};c.prototype.addStyle=function(D){var s,f,g,h,n;f=this.addFont(D.font);g=this.addFill(D.fill);h=this.addBorder(D.border);if(typeof D.numberFormat==="undefined"){D.numberFormat=0}n=N._isBuiltin(D.numberFormat)?D.numberFormat:this.addNumberFormat(D.numberFormat);s=new S;s.setFontId(f);s.setFillId(g);s.getBorderId(h);s.setNumberFormatId(n);return this._addToAggregation(s,this.cellXfs)};c.prototype._addToAggregation=function(I,A){var f,i;i=-1;A.childs.forEach(function(g,h,j){if(g.equals(I)){i=h}});if(i===-1){A.addChild(I);f=A.childs.length;A.count.value=f;i=f-1}return i};c.prototype.addColor=function(h){if(!this.colors){this.addChild({id:"colors",tag:"colors",properties:[{id:"mru",tag:"mruColors"}]})}this.colors.mru.addChild({tag:"color",attributes:[{name:"rgb",value:"FF"+h}]})};c.prototype.addFont=function(D){var f=new F(D);return this._addToAggregation(f,this.fonts)};c.prototype.addFill=function(D){var i,f;f=new a(D);i=this._addToAggregation(f,this.fills);if(f.getFill()!==null){this.addColor(f.getFill())}return i};c.prototype.addBorder=function(D){var o=new B(D);return this._addToAggregation(o,this.borders)};c.prototype.addNumberFormat=function(D){var n;n=new N(D);this._addToAggregation(n,this.numberFormats);n.setId(N.ID_OFFSET+this.numberFormats.count.value);return n.getId()};m.exports=c;},{"../xml/XMLNode":29,"./Border":21,"./Fill":22,"./Font":23,"./NumberFormat":24,"./Style":25}],27:[function(r,m,b){var X=r("./XMLElement");function a(c){X.call(this,c);this.name=c.name?c.name:"";this.prefix=c.prefix?c.prefix:"";this.suffix=c.suffix?c.suffix:""}a.prototype=Object.create(X.prototype);a.prototype.constructor=a;a.prototype.serialize=function(){return" "+(this.prefix?this.prefix+":":"")+this.name+(this.suffix?":"+this.suffix:"")+'="'+this.xmlEncode(this.value)+'"'};m.exports=a;},{"./XMLElement":28}],28:[function(r,m,b){function X(c){this.value=c&&c.value?c.value:""}X.prototype.xmlEncode=function(v){return typeof v==="string"&&v.match(/[><"'&]+/)!==null?this._replace(v):v};X.prototype._replace=function(v){return v.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;")};m.exports=X;},{}],29:[function(r,m,b){var X=r("./XMLElement");var a=r("./XMLAttribute");function c(C){var i,j,f;X.call(this,C);f=typeof C==="string"?{tag:C}:C;Object.defineProperty(this,"root",{value:!!f.root,writable:false});this.tag=typeof f.tag=="string"?f.tag:"";this.attributes=[];this.childs=[];if(f.attributes){for(i=0;i<f.attributes.length;i++){this.addAttribute(f.attributes[i])}}if(f.properties){for(j=0;j<f.properties.length;j++){this.addChild(f.properties[j])}}}c.prototype=Object.create(X.prototype);c.prototype.constructor=c;c.processingInformation='<?xml version="1.0" encoding="UTF-8"?>';c.prototype.addAttribute=function(C){var f=C instanceof a?C:new a(C);this.attributes.push(f);if(C.id){Object.defineProperty(this,C.id,{value:f,writable:false,configurable:true})}return f};c.prototype.addChild=function(C){var n=C instanceof c?C:new c(C);this.childs.push(n);if(C.id){Object.defineProperty(this,C.id,{value:n,writable:false,configurable:true})}return n};c.prototype.remove=function(p){var i,f,A;if(!(p in this)){return null}f=this[p];if(f instanceof a){A=this.attributes}else if(f instanceof c&&!(p in new c(""))){A=this.childs}else{return null}i=A.indexOf(f);A.splice(i,1);delete this[p];return f};c.prototype.serialize=function(){var s,i,j;s=(this.root?c.processingInformation:"")+"<"+this.tag;for(i=0;i<this.attributes.length;i++){s+=this.attributes[i].serialize()}if(this.childs.length||this.value||typeof this.value==="number"){s+=">";for(j=0;j<this.childs.length;j++){s+=typeof this.childs[j]==="string"?this.childs[j]:this.childs[j].serialize()}s+=this.xmlEncode(this.value);s+="</"+this.tag+">"}else{s+="/>"}return s};m.exports=c;},{"./XMLAttribute":27,"./XMLElement":28}]},{},[1])(1)});
