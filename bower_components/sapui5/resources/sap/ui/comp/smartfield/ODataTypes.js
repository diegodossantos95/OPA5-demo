/*
 * SAP UI development toolkit for HTML5 (SAPUI5)

(c) Copyright 2009-2017 SAP SE. All rights reserved
 */
sap.ui.define(["jquery.sap.global","sap/ui/core/format/NumberFormat","sap/ui/model/odata/type/Boolean","sap/ui/comp/smartfield/type/DateTime","sap/ui/comp/smartfield/type/DateTimeOffset","sap/ui/comp/smartfield/type/Decimal","sap/ui/comp/smartfield/type/Int16","sap/ui/comp/smartfield/type/Int32","sap/ui/comp/smartfield/type/Int64","sap/ui/comp/smartfield/type/SByte","sap/ui/comp/smartfield/type/String","sap/ui/comp/smartfield/type/AbapBool","sap/ui/model/type/Currency","sap/ui/comp/smartfield/type/Time","sap/ui/model/odata/type/Guid","sap/ui/comp/odata/MetadataAnalyser"],function(q,N,B,D,a,b,I,c,d,S,e,A,C,T,G,M){"use strict";var O=function(p){this._oParent=p;};O.prototype.getType=function(p,f,m){var o,i;i=this._oParent.getBindingInfo("value");if(i&&i.type){return i.type;}if(p&&p.property&&p.property.type){switch(p.property.type){case"Edm.Boolean":return new B();case"Edm.Decimal":case"Edm.Double":case"Edm.Float":case"Edm.Single":o=this._getDecimalConstraints(p);return new b(f,o);case"Edm.Int16":return new I();case"Edm.Int32":return new c();case"Edm.Int64":return new d();case"Edm.Byte":case"Edm.SByte":return new S();case"Edm.DateTimeOffset":return new a(f,o);case"Edm.DateTime":o=this._getDateTimeConstraints(p,m);return new D(f,o);case"Edm.String":o=this._getStringConstraints(p);return new e(f,o);case"Edm.Time":return new T(f,m);case"Edm.Guid":return new G(f,m);default:return null;}}return null;};O.prototype._getDateTimeConstraints=function(p,m){var o={},n;if(p.property["sap:display-format"]==="Date"){o={displayFormat:"Date"};}for(n in m){o[n]=m[n];}return o;};O.prototype.getMaxLength=function(p,o){var P,v=[],l,V,f,r=0;if(o&&o.constraints){if(o.constraints.maxLength&&o.constraints.maxLength>-1){v.push(o.constraints.maxLength);}}if(o&&o.type&&o.type.oConstraints){if(o.type.oConstraints.maxLength&&o.type.oConstraints.maxLength>-1){v.push(o.type.oConstraints.maxLength);}}if(p&&p.property&&p.property.maxLength){P=parseInt(p.property.maxLength,10);if(P>-1){v.push(P);}}f=this._oParent.getMaxLength();if(f>0){v.push(f);}l=v.length;while(l--){V=v[l];if(V>0){if(r>0){if(V<r){r=V;}}else{r=V;}}}return r;};O.prototype._getDecimalConstraints=function(p){var m=null;if(p.property.precision){m={};m.precision=parseInt(p.property.precision,10);}if(p.property.scale){if(!m){m={};}m.scale=parseInt(p.property.scale,10);}return m;};O.prototype._getStringConstraints=function(p){var o=this._oParent.getBindingInfo("value"),m=this.getMaxLength(p,o),E,f={nullable:M.isNullable(p.property)};if(o&&o.type&&o.type.oConstraints){if(o.type.oConstraints.equals){E=o.type.oConstraints.equals;}}if(m>0||E){if(m>0){f.maxLength=m;}if(E){f.equals=E;}}if(M.isDigitSequence(p.property)){f.isDigitSequence=true;}return f;};O.prototype.getDisplayFormatter=function(p,f){if(f){return this.getCurrencyDisplayFormatter(true);}else{return this.getUOMDisplayFormatter(p);}};O.prototype.getCurrencyDisplayFormatter=function(f){var F=N.getCurrencyInstance({showMeasure:false});return function(o,s){var v,i,p;if(!o||!s||s==="*"){return"";}if(!f){v=o+="\u2008";return v;}i=F.oLocaleData.getCurrencyDigits(s);v=F.format(o,s);if(i===0){v+="\u2008";}p=3-i;if(p){v=q.sap.padRight(v,"\u2007",v.length+p);}return v;};};O.prototype.getUOMDisplayFormatter=function(p){var f={};if(p.scale){f.decimals=parseInt(p.scale,10);}if(p.precision){f.precision=parseInt(p.precision,10);}var F=N.getFloatInstance(f);return function(m,u){var v;if(!m||!u||u==="*"){return"";}if(isNaN(parseFloat(m))){return m.toString()+"\u2008";}v=F.format(m,u);v+="\u2008";return v;};};O.prototype.getCurrencyType=function(p){var o,f={showMeasure:false,parseAsString:true,emptyString:0};if(p){o=this._getDecimalConstraints(p);if(o){if(o.precision){f.maxIntegerDigits=o.precision;if(o.scale){f.maxIntegerDigits-=o.scale;}}if(o.precision&&o.scale){o.maximum=Math.pow(10,f.maxIntegerDigits)-(1/Math.pow(10,o.scale));o.minimum=-1*o.maximum;}}return new C(f,o);}return null;};O.prototype.getAbapBoolean=function(){return new A();};O.prototype.destroy=function(){this._oParent=null;};return O;},true);
