/*
 * ! SAP UI development toolkit for HTML5 (SAPUI5)

(c) Copyright 2009-2017 SAP SE. All rights reserved
 */
sap.ui.define(['jquery.sap.global','sap/m/MultiInput','sap/m/Bar','sap/m/Button','sap/m/ButtonType','sap/m/CheckBox','sap/m/Label','sap/m/LabelDesign','sap/m/Link','sap/m/List','sap/m/ListSeparators','sap/m/Panel','sap/m/PlacementType','sap/m/SearchField','sap/m/Text','sap/m/Toolbar','sap/m/ToolbarSpacer','sap/ui/Device','sap/ui/comp/state/UIState','./VariantConverterFrom','./VariantConverterTo','sap/ui/comp/library','sap/ui/comp/smartvariants/PersonalizableInfo','sap/ui/comp/smartvariants/SmartVariantManagementUi2','sap/ui/comp/variants/VariantManagement','sap/ui/core/Icon','sap/ui/core/TextAlign','sap/ui/core/Title','sap/ui/core/ValueState','sap/ui/layout/Grid','sap/ui/layout/GridRenderer','sap/ui/layout/GridData','sap/ui/layout/HorizontalLayout','sap/ui/layout/ResponsiveFlowLayout','sap/ui/layout/ResponsiveFlowLayoutData','sap/ui/layout/VerticalLayout','sap/ui/layout/form/Form','sap/ui/layout/form/FormContainer','sap/ui/layout/form/FormElement','sap/ui/layout/form/ResponsiveGridLayout','sap/ui/layout/form/FormRenderer','sap/ui/comp/util/IdentifierUtil'],function(q,M,B,a,b,C,L,c,d,e,f,P,g,S,T,h,k,D,U,V,l,m,o,p,r,I,s,t,u,G,v,w,H,R,x,y,F,z,A,E,J,K){"use strict";var N=G.extend("sap.ui.comp.filterbar.FilterBar",{metadata:{library:"sap.ui.comp",designTime:true,properties:{persistencyKey:{type:"string",group:"Misc",defaultValue:""},advancedMode:{type:"boolean",group:"Misc",defaultValue:false},expandAdvancedArea:{type:"boolean",group:"Misc",defaultValue:false,deprecated:true},searchEnabled:{type:"boolean",group:"Misc",defaultValue:true},filterBarExpanded:{type:"boolean",group:"Misc",defaultValue:true},considerGroupTitle:{type:"boolean",group:"Misc",defaultValue:false},showClearButton:{type:"boolean",group:"Misc",defaultValue:false},showRestoreButton:{type:"boolean",group:"Misc",defaultValue:true},showGoOnFB:{type:"boolean",group:"Misc",defaultValue:true},showRestoreOnFB:{type:"boolean",group:"Misc",defaultValue:false},showClearOnFB:{type:"boolean",group:"Misc",defaultValue:false},showGoButton:{type:"boolean",group:"Misc",defaultValue:null,deprecated:true},deltaVariantMode:{type:"boolean",group:"Misc",defaultValue:true},filterContainerWidth:{type:"string",group:"Misc",defaultValue:"12rem"},useToolbar:{type:"boolean",group:"Misc",defaultValue:true},header:{type:"string",group:"Misc",defaultValue:""},showFilterConfiguration:{type:"boolean",group:"Misc",defaultValue:true},useSnapshot:{type:"boolean",group:"Misc"}},aggregations:{filterItems:{type:"sap.ui.comp.filterbar.FilterItem",multiple:true,singularName:"filterItem"},filterGroupItems:{type:"sap.ui.comp.filterbar.FilterGroupItem",multiple:true,singularName:"filterGroupItem"},_parameters:{type:"sap.ui.comp.filterbar.FilterGroupItem",multiple:true,singularName:"_parameter",visibility:"hidden"}},associations:{basicSearch:{type:"sap.m.SearchField",multiple:false}},events:{cancel:{},reset:{parameters:{selectionSet:{type:"sap.ui.core.Control[]"}}},search:{parameters:{selectionSet:{type:"sap.ui.core.Control[]"}}},beforeVariantSave:{parameters:{context:{type:"string"}}},beforeVariantFetch:{},afterVariantLoad:{parameters:{context:{type:"string"},executeOnSelect:{type:"boolean"}}},filterChange:{added:{type:"sap.ui.core.Control"},deleted:{type:"sap.ui.core.Control"},filterItem:{type:"sap.ui.comp.filterbar.FilterGroupItem"}},clear:{parameters:{selectionSet:{type:"sap.ui.core.Control[]"}}},initialise:{},initialized:{},afterVariantSave:{},filtersDialogClosed:{parameters:{context:{type:"string"}}},filtersDialogBeforeOpen:{},filtersDialogCancel:{},filtersDialogSearch:{},filtersDialogSearchForFilters:{parameters:{newValue:{type:"string"}}},assignedFiltersChanged:{}}},renderer:v.render});N.INTERNAL_GROUP="__$INTERNAL$";N.prototype.init=function(){this._oBasicAreaLayout=null;this._oVariantManagement=null;this._oCollectiveSearch=null;this._aBasicAreaSelection=null;this._mAdvancedAreaFilter=null;this._fRegisteredFetchData=null;this._fRegisteredApplyData=null;this._fRegisterGetFiltersWithValues=null;this._oHideShowButton=null;this._oSearchButton=null;this._oFiltersButton=null;this._oClearButtonOnFB=null;this._oRestoreButtonOnFB=null;this._oDialog=null;this._oFilterDialog=null;this._bIsInitialized=false;this._aFields=null;this._oBasicSearchField=null;this._oVariant={};this._filterChangeSemaphore=true;this._triggerFilterChangeState=true;this._fRegisteredFilterChangeHandlers=null;this._fInitialiseVariants=null;this._bHostedVariantManagement=false;this._bDoItOnce=false;this._oLabelTextWidth=0;this._oRb=sap.ui.getCore().getLibraryResourceBundle("sap.ui.comp");this.setHSpacing(0);this.addStyleClass("sapUiCompFilterBar");if(this._isPhone()){this.addStyleClass("sapUiCompFilterBarPhone");}else{this.addStyleClass("sapUiCompFilterBarNonPhone");}this.addStyleClass("sapUiCompFilterBarMarginBottom");this.addStyleClass("sapUiCompFilterBarPaddingPanel");this.addStyleClass("sapContrastPlus");this._oToolbar=this._createToolbar();this._oToolbar.setLayoutData(new w({span:"L12 M12 S12"}));this.addContent(this._oToolbar);this._oBasicAreaLayout=this._createBasicAreaLayout();this._oBasicAreaLayout.setLayoutData(new w({span:"L12 M12 S12"}));this.addContent(this._oBasicAreaLayout);this._oAdvancedPanel=new P();this._oAdvancedPanel.setLayoutData(new w({span:"L12 M12 S12"}));this._oAdvancedPanel.setVisible(false);this._oAdvancedAreaForm=this._createAdvancedAreaForm();this._oAdvancedPanel.addContent(this._oAdvancedAreaForm);this.addContent(this._oAdvancedPanel);this._hResizeListener=sap.ui.core.ResizeHandler.register(this._oBasicAreaLayout,this._fHandleResize.bind(this));this.oModel=new sap.ui.model.json.JSONModel({});this.setModel(this.oModel,"FilterBar");this._oHintText=new T({text:this._oRb.getText("FILTER_BAR_NO_FILTERS_ON_FB"),textAlign:s.Center});this._oHintText.setVisible(false);this._oHintText.addStyleClass("sapUiCompFilterBarHint");this._oBasicAreaLayout.addContent(this._oHintText);if(this._isTablet()||this._isPhone()){this.setFilterBarExpanded(false);}};N.prototype._hasAnyVisibleFiltersOnFB=function(){var j=this._retrieveVisibleAdvancedItems();for(var i=0;i<j.length;i++){if(j[i].filterItem.getVisibleInFilterBar()){return true;}}return false;};N.prototype._showHintText=function(){var i=0;if(!this._oHintText){return;}if(!this.getAdvancedMode()&&!this._isPhone()){var j=!this._hasAnyVisibleFiltersOnFB();if(j&&this._mAdvancedAreaFilter){i=this._oBasicAreaLayout.indexOfContent(this._oHintText);if(i<0){this._oBasicAreaLayout.insertContent(this._oHintText,0);}}this._oHintText.setVisible(j);if(i<0){this._oBasicAreaLayout.rerender();}}};N.prototype._hasRelevantFilters=function(){var i,n=null,j;if(!this._mAdvancedAreaFilter||(Object.keys(this._mAdvancedAreaFilter)<1)){return false;}if(this.getAdvancedMode()){for(n in this._mAdvancedAreaFilter){var O=this._mAdvancedAreaFilter[n];if(O&&O.items){for(i=0;i<O.items.length;i++){j=O.items[i];if(j){if(this._determineVisibility(j.filterItem)){return true;}}}}}return false;}return true;};N.prototype._adaptButtonsEnablement=function(){var i=false||!!this._mAdvancedAreaFilter;if(this._oHideShowButton){this._oHideShowButton.setEnabled(i);if(this.getAdvancedMode()&&!this._isPhone()){this._oHideShowButton.setVisible(this._hasRelevantFilters());}}this._oClearButtonOnFB.setEnabled(i);this._oRestoreButtonOnFB.setEnabled(i);this._oFiltersButton.setEnabled(i);if(i&&this.getFilterBarExpanded()&&!this._isPhone()&&!this.getAdvancedMode()){this._oBasicAreaLayout.setVisible(true);}};N.prototype.getVariantManagement=function(){return this._oVariantManagement;};N.prototype.setShowClearOnFB=function(i){if(!this._isPhone()){this.setProperty("showClearOnFB",i);this._oClearButtonOnFB.setVisible(i);}return this;};N.prototype.setShowRestoreOnFB=function(i){if(!this._isPhone()){this.setProperty("showRestoreOnFB",i);this._oRestoreButtonOnFB.setVisible(i);}return this;};N.prototype.setShowGoOnFB=function(i){this.setProperty("showGoOnFB",i);this._calcVisibilityGoButton();return this;};N.prototype._calcVisibilityGoButton=function(){var i=this.getShowGoOnFB();if(i&&!this._isPhone()&&this.isLiveMode&&this.isLiveMode()){i=false;}this._oSearchButton.setVisible(i);};N.prototype.setShowGoButton=function(i){this.setShowGoOnFB(i);return this;};N.prototype.getShowGoButton=function(){return this.getShowGoOnFB();};N.prototype.hideGoButton=function(){this._oSearchButton.setVisible(false);};N.prototype.restoreGoButton=function(){this._oSearchButton.setVisible(this.getShowGoOnFB());};N.prototype.setShowFilterConfiguration=function(i){this.setProperty("showFilterConfiguration",i);if(this._oFiltersButton&&!this._isPhone()){this._oFiltersButton.setVisible(i);}return this;};N.prototype.isCurrentVariantStandard=function(){var i;if(this._oVariantManagement){i=this._oVariantManagement.getCurrentVariantId();if(i===""){return true;}return(i===this._oVariantManagement.getStandardVariantKey());}return undefined;};N.prototype.setCurrentVariantId=function(i,j){if(this._oVariantManagement){this._oVariantManagement.setCurrentVariantId(i,j);}};N.prototype.getCurrentVariantId=function(){var i="";if(this._oVariantManagement){i=this._oVariantManagement.getCurrentVariantId();}return i;};N.prototype.getDataSuiteFormat=function(i){return this._getDataSuiteFormat(i,null);};N.prototype._getDataSuiteFormat=function(i,j){var n=null;var O,Q,W;if(this._oVariantManagement){O=this.getCurrentVariantId();if(this.getFilterDataAsString){W=this._determineVariantFiltersInfo(i,true);Q=this.getFilterDataAsString(i);if(Q){var X=new l();n=X.convert(O,W,Q,this,j);}}}return n;};N.prototype.getBasicSearchName=function(){var i=null;if(this._oBasicSearchField&&this.getEntitySet){i="$"+this.getEntitySet()+".basicSearch";}return i;};N.prototype.getBasicSearchValue=function(){return this._getBasicSearchValue();};N.prototype.getUiState=function(i){var j,n=false;if(i){n=(i.allFilters===true);}j=this._getDataSuiteFormat(n,"13.0");return new U({selectionVariant:JSON.parse(j)});};N.prototype.setUiState=function(i,j){var n,O=null,Q=false,W=true;if(j){Q=(j.replace===true);W=(j.strictMode===true);}if(i){O=i.getSelectionVariant();if(O){n=JSON.stringify(O);}}this._setDataSuiteFormat(n,Q,W);};N.prototype.setDataSuiteFormat=function(i,j){this._setDataSuiteFormat(i,j,true);};N.prototype._setDataSuiteFormat=function(i,j,n){var O,Q;if(i){O=new V();Q=O.convert(i,this,n);if(Q){if(Q.variantId&&this._oVariantManagement){if(this._bIsInitialized){if(this._oVariantManagement.isPageVariant()){this._oVariantManagement._selectVariant(Q.variantId,"DATA_SUITE");}else{this._setFilterVisibility(Q.variantId);}}this._oVariantManagement.setInitialSelectionKey(Q.variantId);}if(Q.payload&&(j||(Object.keys(JSON.parse(Q.payload)).length>0))&&this.setFilterDataAsString){this.setFilterDataAsString(Q.payload,j);}if(Q.basicSearch&&this._oBasicSearchField&&this._oBasicSearchField.setValue){this._oBasicSearchField.setValue(""||Q.basicSearch);this._updateToolbarText();}}}};N.prototype._setFilterVisibility=function(i){if(this._oVariantManagement.getSelectionKey()!==i){this._oVariantManagement.setInitialSelectionKey(i);var j=this._getStandardVariant();if(j){var n=this._oVariantManagement.getVariantContent(this,i);if(n&&n.filterbar){if(n.version==="V2"){n=this.mergeVariant(j,n);}this._reapplyVisibility(n.filterbar);}}}};N.prototype.applySettings=function(j){if(this._possibleToChangeVariantManagement()){if(j&&j.customData){for(var i=0;i<j.customData.length;i++){var n=j.customData[i];if(n&&n.mProperties&&n.mProperties.key==="pageVariantPersistencyKey"){this._oVariantManagement.setPersistencyKey(n.mProperties.value);this._oVariantManagement.setVisible(true);this._bHostedVariantManagement=true;}}}}if(j&&j.persistencyKey){this._bHostedVariantManagement=true;}this._applyLayoutDataToToolbarButtons();G.prototype.applySettings.apply(this,arguments);};N.prototype._applyLayoutDataToToolbarButtons=function(i){q.sap.require("sap.m.ToolbarLayoutData");if(this._isPhone()||this._isTablet()||this.getAdvancedMode()||!this.getUseToolbar()){return;}this._oHideShowButton.setLayoutData(new sap.m.ToolbarLayoutData({shrinkable:true}));this._oClearButtonOnFB.setLayoutData(new sap.m.ToolbarLayoutData({shrinkable:true}));this._oRestoreButtonOnFB.setLayoutData(new sap.m.ToolbarLayoutData({shrinkable:true}));this._oFiltersButton.setLayoutData(new sap.m.ToolbarLayoutData({shrinkable:true}));this._oSearchButton.setLayoutData(new sap.m.ToolbarLayoutData({shrinkable:false}));};N.prototype.setPersistencyKey=function(i){this.setProperty("persistencyKey",i);if(this._possibleToChangeVariantManagement()){this._oVariantManagement.setVisible(true);}return this;};N.prototype._possibleToChangeVariantManagement=function(){if(this._oVariantManagement&&!this._oVariantManagement.isPageVariant()){return true;}return false;};N.prototype.clearVariantSelection=function(){if(this._oVariantManagement){this._oVariantManagement.clearVariantSelection();}};N.prototype.setSearchEnabled=function(i){this.setProperty("searchEnabled",i);if(this._oSearchButton){this._oSearchButton.setEnabled(i);}return this;};N.prototype.setSearchButtonEmphType=function(i){};N.prototype.setSimplifiedMode=function(i){};N.prototype.getSimplifiedMode=function(){if(this.getAdvancedMode()){return false;}return true;};N.prototype.setExpandAdvancedArea=function(i){this.setFilterBarExpanded(i);};N.prototype.getExpandAdvancedArea=function(){return this.getFilterBarExpanded();};N.prototype.setAdvancedMode=function(i){this.setProperty("advancedMode",i);this.toggleStyleClass("sapContrastPlus",!i);if(i){if(this._possibleToChangeVariantManagement()){this._oVariantManagement.setVisible(false);}if(this._oToolbar){this._oToolbar.addStyleClass("sapUiCompFilterBarToolbarBasicSearchNoVariant");if(this._oBasicSearchField){if(this._oToolbar.indexOfContent(this._oBasicSearchField)<0){this._oToolbar.insertContent(this._oBasicSearchField,1);}}}}else{if(this.getPersistencyKey()&&this._possibleToChangeVariantManagement()){if(this._oVariantManagement){this._oVariantManagement.setVisible(true);}if(this._oToolbar){this._oToolbar.removeStyleClass("sapUiCompFilterBarToolbarBasicSearchNoVariant");}}}this._oFiltersButton.setVisible(!i);if(this._oHideShowButton){this._oHideShowButton.setVisible((i&&this._isPhone())?false:true);}this._oBasicAreaLayout.setVisible(!i&&this.getFilterBarExpanded());this._oAdvancedPanel.setVisible(i&&this.getFilterBarExpanded());this._adaptButtonsEnablement();return this;};N.prototype.setUseToolbar=function(i){this.setProperty("useToolbar",i);if(!i){this._adaptNewFilterBarDesign();}else{this._recreateToolbar();}return this;};N.prototype._recreateToolbar=function(){if(!this._oToolbar){this._bButtonaAdded=false;if(this._oButtonsVLayout){this._oBasicAreaLayout.removeContent(this._oButtonsVLayout);this._oButtonsVLayout.destroy();this._oButtonsVLayout=null;}this._oToolbar=this._createToolbar(true);this._oToolbar.setLayoutData(new w({span:"L12 M12 S12"}));this.insertContent(this._oToolbar,0);if(this._oVariantManagement){if(this._oVariantManagement instanceof p||((this._oVariantManagement.getId()===(this.getId()+"-variant")))){this._oToolbar.insertContent(this._oVariantManagement,0);}}this._adaptButtonsEnablement();if(this._oBasicSearchFieldContainer){this._oBasicAreaLayout.removeContent(this._oBasicSearchFieldContainer);this._cleanBasicSearchContainer();this.setBasicSearch(this._oBasicSearchField);}this._oHintText=new T({text:this._oRb.getText("FILTER_BAR_NO_FILTERS_ON_FB"),textAlign:s.Center});this._oHintText.setVisible(false);this._oHintText.addStyleClass("sapUiCompFilterBarHint");this._oBasicAreaLayout.addContent(this._oHintText);this._updateToolbarText();}};N.prototype._cleanBasicSearchContainer=function(){if(this._oBasicSearchFieldContainer){var j=this._oBasicSearchFieldContainer.removeAllContent();if(j){for(var i=0;i<j.length;i++){if(j[i]!==this._oBasicSearchField){j[i].destroy();}}}this._oBasicSearchFieldContainer.destroy();this._oBasicSearchFieldContainer=null;}};N.prototype.setHeader=function(i){this.setProperty("header",i);if(this.getUseToolbar()){this._addHeaderToToolbar(i);}return this;};N.prototype._addHeaderToToolbar=function(i){if(this._oToolbar){if(this._oVariantManagement&&(this._oVariantManagement.getVisible()||this._bHostedVariantManagement)&&(this._oToolbar.indexOfContent(this._oVariantManagement)>-1)){if(!this._oSeparator){q.sap.require("sap.m.ToolbarSeparator");this._oSeparator=new sap.m.ToolbarSeparator();this._oToolbar.setHeight("3rem");}this._oToolbar.removeContent(this._oSeparator);this._oToolbar.insertContent(this._oSeparator,0);}if(!this._oText){this._oText=new T();this._oText.addStyleClass("sapMH4Style");this._oText.addStyleClass("sapUiCompSmartChartHeader");}this._oText.setText(i);this._oToolbar.removeContent(this._oText);this._oToolbar.insertContent(this._oText,0);}};N.prototype._isNewFilterBarDesign=function(){if(this.getAdvancedMode()){return false;}if(!this.getUseToolbar()){return true;}return false;};N.prototype._adaptNewFilterBarDesign=function(){if(this._isNewFilterBarDesign()){this.setFilterBarExpanded(true);this._oBasicAreaLayout.setVisible(true);if(this.getUseToolbar()){var j=this._oToolbar.getContent();for(var i=j.length-1;i>0;i--){this._oToolbar.removeContent(j[i]);}}else{if(this._oToolbar){this.removeContent(this._oToolbar);this._oToolbar.removeAllContent();this._oToolbar.destroy();this._oToolbar=null;}}if(this._oHintText){this._oBasicAreaLayout.removeContent(this._oHintText);this._oHintText.destroy();this._oHintText=null;}if(this._oHideShowButton){this._oHideShowButton.destroy();this._oHideShowButton=null;}if(!this._bButtonaAdded){this._bButtonaAdded=true;this._addButtonsToBasicArea();}if(this._oBasicSearchField){this.setBasicSearch(this._oBasicSearchField);}}};N.prototype._addButtonsToBasicArea=function(){var i=new y();if(sap.ui.getCore().getConfiguration().getRTL()){i.addStyleClass("sapUiCompFilterBarFloatLeft");}else{i.addStyleClass("sapUiCompFilterBarFloatRight");}var j=new H();j.setLayoutData(new x({margin:true}));i.addContent(new T());i.addContent(j);j.addContent(this._oClearButtonOnFB);this._oClearButtonOnFB.addStyleClass("sapUiCompFilterBarPaddingRightBtn");j.addContent(this._oRestoreButtonOnFB);this._oRestoreButtonOnFB.addStyleClass("sapUiCompFilterBarPaddingRightBtn");j.addContent(this._oFiltersButton);this._oFiltersButton.addStyleClass("sapUiCompFilterBarPaddingRightBtn");j.addContent(this._oSearchButton);this._updateToolbarText();i.addStyleClass("sapUiCompFilterBarPaddingRight");if(this._isPhone()){i.addStyleClass("sapUiCompFilterBarRemoveMinWidth");this._oBasicAreaLayout.insertContent(i,0);}else{i.addStyleClass("sapUiCompFilterBarPaddingTop");this._oBasicAreaLayout.addContent(i);}this._oButtonsVLayout=i;};N.prototype._addBasicSearchToBasicArea=function(i){var n=null;if(this._oBasicSearchFieldContainer){if(this._oBasicSearchFieldContainer.$()){n=this._oBasicSearchFieldContainer.$().width();}if(!n){n=this._oBasicSearchFieldContainer.getWidth();}this._cleanBasicSearchContainer();}if(i){var j=new L({text:"\u2008"});j.addStyleClass("sapBasicSearchFilter");var O=this._addControlToBasicAreaContainer(null,i,j);if(O){O.setVisible(true);var Q=0;if(this._isPhone()){Q=1;}this._oBasicAreaLayout.insertContent(O,Q);this._oBasicSearchFieldContainer=O;if(n){if(typeof n==='string'){this._oBasicSearchFieldContainer.setWidth(n);}else{this._oBasicSearchFieldContainer.setWidth(n+"px");}}}}};N.prototype._setCollectiveSearch=function(i){if(this.getAdvancedMode()){if(this._oToolbar){if(this._oVariantManagement){this._oToolbar.removeContent(this._oVariantManagement);this._unregisterVariantManagement(this._oVariantManagement);this._oVariantManagement=null;}if(this._oCollectiveSearch){this._oToolbar.removeContent(this._oCollectiveSearch);}this._oCollectiveSearch=i;this._oToolbar.insertContent(this._oCollectiveSearch,0);this._oToolbar.removeStyleClass("sapUiCompFilterBarToolbarBasicSearchNoVariant");}}};N.prototype.setBasicSearch=function(i){var j=this;this.setAssociation("basicSearch",i,true);if(typeof i==="string"){i=sap.ui.getCore().byId(i);}if(this._oBasicSearchField&&this._oToolbar){this._oToolbar.removeContent(this._oBasicSearchField);}if(i&&this._isNewFilterBarDesign()){this._addBasicSearchToBasicArea(i);}else{if(i&&this._oToolbar&&(!this._isPhone()||this.getAdvancedMode())){var n=this._indexOfSpacerOnToolbar();this._oToolbar.insertContent(i,n);if(this._isUi2Mode()){i.attachLiveChange(function(O){j.fireFilterChange(O);});}}}this._oBasicSearchField=i;return this;};N.prototype._getBasicSearchValue=function(){if(this._oBasicSearchField&&this._oBasicSearchField.getValue){return this._oBasicSearchField.getValue();}return null;};N.prototype._indexOfSpacerOnToolbar=function(){var j=this._oToolbar.getContent(),i;if(j){for(i=0;i<j.length;i++){if(j[i]instanceof k){return i;}}}return 0;};N.prototype.addFilterItem=function(i){var n,j,O;if(!i){throw new Error("sap.ui.comp.filterbar.FilterBar.prototype.addFilterItem()"+" Expected argument 'oFilterItem' may not be null nor empty");}n=i.getName();if(!n){throw new Error("sap.ui.comp.filterbar.FilterBar.prototype.addFilterItem()"+" Expected argument 'oFilterItem.name' may not be null nor empty");}j=i.getControl();if(!j){throw new Error("sap.ui.comp.filterbar.FilterBar.prototype.addFilterItem()"+" Expected argument 'oFilterItem.control' may not be null nor empty");}this.addAggregation("filterItems",i,true);if(!this._aBasicAreaSelection){this._aBasicAreaSelection=[];}var Q={control:i.getControl(),filterItem:i};this._aBasicAreaSelection.push(Q);O=new sap.ui.comp.filterbar.FilterGroupItem({label:i.getLabel(),labelTooltip:i.getLabelTooltip(),name:i.getName(),mandatory:i.getMandatory(),visible:i.getVisible(),visibleInFilterBar:i.getVisibleInFilterBar(),partOfCurrentVariant:true,control:i.getControl(),groupName:N.INTERNAL_GROUP,groupTitle:"",hiddenFilter:i.getHiddenFilter()});if(i.data('isCustomField')){O.data('isCustomField',true);}i.attachChange(this._filterItemChange.bind(this,null));this.addFilterGroupItem(O);return this;};N.prototype.addFilterGroupItem=function(i){var n,j,O,Q;if(!i){throw new Error("sap.ui.comp.filterbar.FilterBar.prototype.addFilterGroupItem()"+" Expected argument 'oFilterGroupItem' may not be null nor empty");}this.addAggregation("filterGroupItems",i,true);j=i.getGroupName();if(!j){throw new Error("sap.ui.comp.filterbar.FilterBar.prototype.addFilterGroupItems()"+" GroupName may not be null nor empty");}n=i.getName();if(!n){throw new Error("sap.ui.comp.filterbar.FilterBar.prototype.addFilterGroupItems()"+" Name may not be null nor empty");}if(!this._mAdvancedAreaFilter){this._mAdvancedAreaFilter={};}if(!this._mAdvancedAreaFilter[j]){this._mAdvancedAreaFilter[j]={};this._mAdvancedAreaFilter[j].filterItem=null;this._mAdvancedAreaFilter[j].items=[];}if(!this._mAdvancedAreaFilter[j].items){this._mAdvancedAreaFilter[j].items=[];}if(!this._mAdvancedAreaFilter[j].filterItem){this._mAdvancedAreaFilter[j].filterItem=i;}O={control:i.getControl(),filterItem:i};if(this.getAdvancedMode()||i.getVisibleInFilterBar()){i.setVisibleInFilterBar(true);}else{i.setVisibleInFilterBar(false);}this._mAdvancedAreaFilter[j].items.push(O);if(!i.getHiddenFilter()){Q=this._addControlToBasicAreaFormContainer(i);if(Q){O.container=Q;Q.setVisible(i.getVisible()&&i.getVisibleInFilterBar());if(i.getVisibleInFilterBar()){i.setPartOfCurrentVariant(i.getVisibleInFilterBar());}i.attachChange(this._filterGroupItemChange.bind(this));}if(this.getAdvancedMode()){this._rerenderAA();}else{this._showHintText();}}this._adaptButtonsEnablement();return this;};N.prototype._addParameter=function(j){var i,O,n,Q=false,W=N.INTERNAL_GROUP;j._setParameter(true);j.setVisibleInFilterBar(true);j.setPartOfCurrentVariant(true);this.addAggregation("_parameters",j,true);O={control:j.getControl(),filterItem:j};if(!this._mAdvancedAreaFilter){this._mAdvancedAreaFilter={};}if(!this._mAdvancedAreaFilter[W]){this._mAdvancedAreaFilter[W]={};this._mAdvancedAreaFilter[W].filterItem=null;}if(!this._mAdvancedAreaFilter[W].items){this._mAdvancedAreaFilter[W].items=[];}for(i=0;i<this._mAdvancedAreaFilter[W].items.length;i++){var X=this._mAdvancedAreaFilter[W].items[i];if(X.filterItem._isParameter()){continue;}this._mAdvancedAreaFilter[W].items.splice(i,0,O);Q=true;break;}if(!Q){this._mAdvancedAreaFilter[W].items.push(O);}n=this._addControlToBasicAreaFormContainer(j);if(n){O.container=n;n.setVisible(j.getVisible());}if(Q){this._oBasicAreaLayout.removeContent(n);this._addContainerInOrder(O.filterItem,O.container);}if(!this.getAdvancedMode()){this._showHintText();}this._adaptButtonsEnablement();return this;};N.prototype._filterItemChange=function(i,j){var n;var O;var Q;if(j&&j.oSource&&(j.oSource instanceof sap.ui.comp.filterbar.FilterItem)){Q=j.getParameter("propertyName");if(Q==="visibleInFilterBar"||Q==="visible"||Q==="label"||Q==="labelTooltip"||Q==="mandatory"){n=this._determineItemByName(j.oSource.getName(),N.INTERNAL_GROUP);if(n&&n.filterItem){if((Q==="visible")){O=j.oSource.getVisible();n.filterItem.setVisible(O);}else if(Q==="visibleInFilterBar"){O=j.oSource.getVisibleInFilterBar();var W=this._checkChangePossibleVisibleInFilterBar(n.filterItem,O);if(W){n.filterItem.setVisibleInFilterBar(O);}else{j.oSource.setVisibleInFilterBar(true);}}else if(Q==="label"){n.filterItem.setLabel(j.oSource.getLabel());}else if(Q==="labelTooltip"){n.filterItem.setLabelTooltip(j.oSource.getLabelTooltip());}else if(Q==="mandatory"){O=j.oSource.getMandatory();n.filterItem.setMandatory(O);}}}}};N.prototype._filterGroupItemChange=function(i){var j;var n;if(i&&i.oSource){n=i.getParameter("propertyName");if(n==="visibleInFilterBar"||n==="visible"){j=this._determineItemByName(i.oSource.getName(),i.oSource.getGroupName());if(j){if(n==="visibleInFilterBar"){var O=i.oSource.getVisibleInFilterBar();var Q=this._checkChangePossibleVisibleInFilterBar(i.oSource,O);if(!Q){i.oSource.setVisibleInFilterBar(true);O=true;}if(O){i.oSource.setPartOfCurrentVariant(true);}if(!this.getAdvancedMode()&&!this._oDialog){this._rerenderItem(j);this._adaptLinkText(i.oSource.getGroupName());}}else if(n==="visible"){if(this.getAdvancedMode()&&j.container){j.container.setVisible(true);}else{this._updateToolbarText();this._rerenderGroup(j,i.oSource.getGroupName());}}this._showHintText();}}else if(n==="groupTitle"){if(this._mAdvancedAreaFilter&&this._mAdvancedAreaFilter[i.oSource.getGroupName()]){if(this._mAdvancedAreaFilter[i.oSource.getGroupName()].formcontainer){this._mAdvancedAreaFilter[i.oSource.getGroupName()].formcontainer.setTitle(i.oSource.getGroupTitle());}else{this._adaptGroupTitle(i.oSource.getGroupName());}}}else if(n==="label"){if(!this._mAdvancedAreaFilter[i.oSource.getGroupName()].formcontainer){this._adaptGroupTitleForFilter(i.oSource);}}else if(n==="mandatory"){if(this._oFilterDialog){this._adaptMandatoryForFilter(i.oSource);}}else if((n==="partOfCurrentVariant")&&this.ensureLoadedValueHelpList){var W=this.determineFilterItemByName(i.oSource.getName());if(W&&W.getPartOfCurrentVariant()){this.ensureLoadedValueHelpList(i.oSource.getName());}}if(this.getAdvancedMode()){this._rerenderAA();}}};N.prototype._addContainer=function(i){if(i){if(this._oBasicAreaLayout&&!this._oFilterDialog){if(i.container&&(this._oBasicAreaLayout.indexOfContent(i.container)===-1)){this._addContainerInOrder(i.filterItem,i.container);}}}};N.prototype._addContainerInOrder=function(j,O){var n,i,Q,W=this._oBasicAreaLayout.getContent(),X=-1;if(this._isNewFilterBarDesign()){if(this._isPhone()){X++;}if(this._oBasicSearchField){X++;}}if(this._mAdvancedAreaFilter){for(n in this._mAdvancedAreaFilter){var Y=this._mAdvancedAreaFilter[n];if(Y&&Y.items){for(i=0;i<Y.items.length;i++){if(!Y.items[i].container){continue;}if(Y.items[i].container===O){this._oBasicAreaLayout.insertContent(O,X+1);return;}Q=W.indexOf(Y.items[i].container);if(Q>=0){X=Q;}}}}}};N.prototype._checkChangePossibleVisibleInFilterBar=function(i,j){if(i&&i.getMandatory()&&!j){var n=this._hasFilterValue(i);if(!n){i.setVisibleInFilterBar(true);return false;}}return true;};N.prototype._adaptLinkText=function(i){if(this._mAdvancedAreaFilter&&this._mAdvancedAreaFilter[i]&&this._mAdvancedAreaFilter[i].link){this._setLinkText(i,this._mAdvancedAreaFilter[i].link);}};N.prototype._hasFilterValue=function(i){var j=this._getFiltersWithValues();return this._checkFilterForValue(j,i);};N.prototype._adaptMandatoryForFilter=function(i){var j;var n=i.getGroupName();if(i){j=this._determineItemByName(i.getName(),n);if(j&&j.checkbox&&j.checkbox.getVisible()){var O=true;if(i.getMandatory()){var Q=this._hasFilterValue(i);if(!Q){O=false;i.setVisibleInFilterBar(true);}}j.checkbox.setEnabled(O);}}};N.prototype._adaptGroupTitleForFilter=function(i){var j;var n;if(i&&!i.getHiddenFilter()){j=i.getLabel();n=i.getLabelControl(this.getId());if(this.getConsiderGroupTitle()){if(n&&i.getGroupTitle()){n.setText(j+" ("+i.getGroupTitle()+')');}}else{n.setText(j);}}};N.prototype._adaptGroupTitle=function(j){var i;var n;if(this._mAdvancedAreaFilter&&this._mAdvancedAreaFilter[j]&&this._mAdvancedAreaFilter[j].items){for(i=0;i<this._mAdvancedAreaFilter[j].items.length;i++){n=this._mAdvancedAreaFilter[j].items[i];if(n&&n){this._adaptGroupTitleForFilter(n.filterItem);}}}};N.prototype._adaptGroupsTitle=function(){var n=null;if(this._mAdvancedAreaFilter){for(n in this._mAdvancedAreaFilter){if(n&&n!==N.INTERNAL_GROUP){this._adaptGroupTitle(n);}}}};N.prototype.registerGetFiltersWithValues=function(i){this._fRegisterGetFiltersWithValues=i;return this;};N.prototype.registerFetchData=function(i){this._fRegisteredFetchData=i;return this;};N.prototype.registerApplyData=function(i){this._fRegisteredApplyData=i;return this;};N.prototype._isTINAFScenario=function(){if(this._oVariantManagement){if(!this._isUi2Mode()){return true;}}else{if(this._oCollectiveSearch&&this.getAdvancedMode()){return true;}}return false;};N.prototype.fireInitialise=function(){if(this._isTINAFScenario()){this._createVisibleFilters();if(this.getAdvancedMode()){this._ensureFilterLoaded(null);}this._fireInitialiseEvent();}else{this._initializeVariantManagement();}};N.prototype.variantsInitialized=function(){this.fireInitialized();};N.prototype.fireInitialized=function(){this.fireEvent("initialized");};N.prototype._initializeVariantManagement=function(){this._createVisibleFilters();if(this._oVariantManagement&&this.getPersistencyKey()){if(this._isTINAFScenario()){this._oVariantManagement.initialise(this._initialiseVariants,this);}else{this._fInitialiseVariants=this._initialiseVariants.bind(this);this._oVariantManagement.attachInitialise(this._fInitialiseVariants,this);this._oVariantManagement.initialise();}}else{this._fireInitialiseEvent();}};N.prototype._fireInitialiseEvent=function(){try{this.fireEvent("initialise");}catch(i){q.sap.log.error("error during initialise event handling - "+i.message);}this._bIsInitialized=true;this._updateToolbarText();};N.prototype._initialiseVariants=function(){this._fireInitialiseEvent();if(this._oVariantManagement){this._oVariantManagement.currentVariantSetModified(false);}};N.prototype.fireAfterVariantLoad=function(i,j){this._rerenderFilters();var n={context:i,executeOnSelect:j};this.fireEvent("afterVariantLoad",n);};N.prototype.fireBeforeVariantSave=function(i){var j={context:i};var n=this._getConsiderFilterChanges();if(i){this._setConsiderFilterChanges(false);}this.fireEvent("beforeVariantSave",j);if(i){this._setConsiderFilterChanges(n);}};N.prototype.removeAllFilterItems=function(){var i;var j=[];this._aBasicAreaSelection=null;var n=this._oBasicAreaLayout.getContent();if(n){for(i=0;i<n.length;i++){this._oBasicAreaLayout.removeContent(n[i]);}}if(this._mAdvancedAreaFilter){if((this._mAdvancedAreaFilter[N.INTERNAL_GROUP])&&(this._mAdvancedAreaFilter[N.INTERNAL_GROUP].items)){for(i=0;i<this._mAdvancedAreaFilter[N.INTERNAL_GROUP].items.length;i++){if(this._mAdvancedAreaFilter[N.INTERNAL_GROUP].items[i].filterItem){j.push(this._mAdvancedAreaFilter[N.INTERNAL_GROUP].items[i].filterItem);}}delete this._mAdvancedAreaFilter[N.INTERNAL_GROUP];}if(Object.keys(this._mAdvancedAreaFilter).length===0){this._mAdvancedAreaFilter=null;}}this._destroyItems(j);this._adaptButtonsEnablement();return j;};N.prototype.removeAllFilterGroupItems=function(){var n=null,i;var j=[];for(n in this._mAdvancedAreaFilter){if(n){if(this._mAdvancedAreaFilter[n]&&this._mAdvancedAreaFilter[n].items){for(i=0;i<this._mAdvancedAreaFilter[n].items.length;i++){if(this._mAdvancedAreaFilter[n].items[i].filterItem){j.push(this._mAdvancedAreaFilter[n].items[i].filterItem);}}delete this._mAdvancedAreaFilter[n];}}if(Object.keys(this._mAdvancedAreaFilter).length===0){this._mAdvancedAreaFilter=null;}}this.__bDeleteMode=true;this._destroyItems(j);this.__bDeleteMode=false;this._adaptButtonsEnablement();return j;};N.prototype.removeAllFilters=function(){this.removeAllFilterItems();this.removeAllFilterGroupItems();this.removeBasicSearch();};N.prototype.removeBasicSearch=function(){this.setBasicSearch(null);};N.prototype.getAllFilterItems=function(j){var i,n=null;var O=[];var Q,W;if(!j){this._ensureFilterLoaded(null);}if(this._mAdvancedAreaFilter){for(n in this._mAdvancedAreaFilter){if(n){Q=this._mAdvancedAreaFilter[n];if(Q.items){for(i=0;i<Q.items.length;i++){W=Q.items[i];if(W&&W.filterItem&&W.filterItem.getVisible()){if(j){if(W.filterItem.getVisibleInFilterBar()||W.filterItem.getPartOfCurrentVariant()){O.push(W.filterItem);}}else{O.push(W.filterItem);}}}}}}}return O;};N.prototype._clearErrorState=function(){this._resetFiltersInErrorValueState();};N.prototype.getAggregation=function(n){if(n=="filterGroupItems"&&!this.__bDeleteMode){this._ensureFilterLoaded(null);}return G.prototype.getAggregation.apply(this,arguments);};N.prototype._getFilterInformation=function(){return[];};N.prototype._createVisibleFilters=function(){this._getFilters();};N.prototype._getFilters=function(){this._aFields=this._getFilterInformation();var i,j;if(this._aFields&&this._aFields.length>0){if(!this._mAdvancedAreaFilter){this._mAdvancedAreaFilter={};if(!this.getAdvancedMode()){this._mAdvancedAreaFilter[N.INTERNAL_GROUP]={};this._mAdvancedAreaFilter[N.INTERNAL_GROUP].filterItem=null;this._mAdvancedAreaFilter[N.INTERNAL_GROUP].items=null;}}for(i=0;i<this._aFields.length;i++){j=this._aFields[i];if(j.groupName!==N.INTERNAL_GROUP){if(!this._mAdvancedAreaFilter[j.groupName]){this._mAdvancedAreaFilter[j.groupName]={};this._mAdvancedAreaFilter[j.groupName].groupTitle=j.groupTitle;this._mAdvancedAreaFilter[j.groupName].filterItem=null;this._mAdvancedAreaFilter[j.groupName].items=[];}}if(j.visibleInAdvancedArea||(j.groupName===N.INTERNAL_GROUP)){this._instanciateFilterItem(j);}}}this._adaptButtonsEnablement();};N.prototype.isVisibleInFilterBarByName=function(n){var i,j=this._getFilterMetadata(n);if(j&&j.factory){if((j.hasOwnProperty("visibleInAdvancedArea")&&j.visibleInAdvancedArea)||(j.groupName===N.INTERNAL_GROUP)){return true;}}else{i=this.determineFilterItemByName(n);if(i){return i.getVisibleInFilterBar();}}return false;};N.prototype._getFilterMetadata=function(n){if(this._aFields){for(var i=0;i<this._aFields.length;i++){if(this._aFields[i].fieldName===n){return this._aFields[i];}}}return null;};N.prototype.getNonVisibleCustomFilterNames=function(){if(this._aFields.length>0){return this._getLazyNonVisibleCustomFilterNames();}else{return this._getNonVisibleCustomFilterNames();}};N.prototype._getLazyNonVisibleCustomFilterNames=function(){var i=this,j=[];this._aFields.forEach(function(n){if(n.factory){if(n.isCustomFilterField&&!n.visibleInAdvancedArea){j.push(n.fieldName);}}else if(i._isNonVisibleCustomFilterNamesByName(n.fieldName,n.groupName)){j.push(n.fieldName);}});return j;};N.prototype._isNonVisibleCustomFilterNamesByName=function(n,j){var i,O;if(this._mAdvancedAreaFilter&&this._mAdvancedAreaFilter[j]&&this._mAdvancedAreaFilter[j].items){for(i=0;i<this._mAdvancedAreaFilter[j].items.length;i++){O=this._mAdvancedAreaFilter[j].items[i];if(O.filterName&&(O.filterItem.getName()===n)){return this._isNonVisibleCustomFilterNamesByFilter(O.filterItem);}}}return false;};N.prototype._isNonVisibleCustomFilterNamesByFilter=function(i){if(i.data("isCustomField")&&!i.getVisibleInFilterBar()){return true;}return false;};N.prototype._getNonVisibleCustomFilterNames=function(){var i=this,j=[],n=this.getAllFilterItems();if(n){n.forEach(function(O){if(i._isNonVisibleCustomFilterNamesByFilter(O)){j.push(O.getName());}});}return j;};N.prototype._ensureFilterLoaded=function(n){var i,j,O;if(this._aFields&&this._aFields.length>0){for(j=0;j<this._aFields.length;j++){O=this._aFields[j];if(!O.factory){continue;}if(n){for(i=0;i<n.length;i++){if((O.fieldName===n[i].name)&&(O.groupName===n[i].group)){this._instanciateFilterItem(O);break;}}}else{this._instanciateFilterItem(O);}}if(!n){this._aFields=[];}}};N.prototype._instanciateFilterItem=function(i){var j=i.factory;if(j){delete i.factory;j.call(i);}};N.prototype._destroyItems=function(j){if(j&&j.length){for(var i=0;i<j.length;i++){j[i].destroy();}}};N.prototype._reapplyVisibility=function(j){var i,n=null;var O;if(this._mAdvancedAreaFilter){for(n in this._mAdvancedAreaFilter){if(n){var Q=this._mAdvancedAreaFilter[n];if(Q&&Q.items){for(i=0;i<Q.items.length;i++){O=Q.items[i];if(O&&O.filterItem){this._setPersVisibility(j,O.filterItem);}}if(n!==N.INTERNAL_GROUP){this._adaptLinkText(n);}}}}}};N.prototype._setPersVisibility=function(i,j){var n,O;var Q;if(j&&!j.getHiddenFilter()){O=j.getName();n=j.getGroupName();Q=this._checkForFilterInfo(i,O,n);if(this._isTINAFScenario()){if(Q){j.setVisibleInFilterBar(Q.visibleInFilterBar);j.setPartOfCurrentVariant(Q.partOfCurrentVariant);if(Q.hasOwnProperty("visible")){j.setVisible(Q.visible);}}else{j.setVisibleInFilterBar(false);if((n===N.INTERNAL_GROUP)||j._isParameter()){j.setPartOfCurrentVariant(true);}else{j.setPartOfCurrentVariant(false);}}}else{if(Q&&(Q.visibleInFilterBar!==undefined)){j.setVisibleInFilterBar((Q.visibleInFilterBar));j.setPartOfCurrentVariant((Q.partOfCurrentVariant));}else{if((n!==N.INTERNAL_GROUP)&&Q&&(Q.group===n)){j.setVisibleInFilterBar((Q!==null));}}}if(n===N.INTERNAL_GROUP){j.setPartOfCurrentVariant(true);}if(j){var W=this.determineControlByFilterItem(j,true);if(W&&W.getValueState&&(W.getValueState()!==u.None)){if(W.setValue){W.setValue("");}W.setValueState(u.None);}}}};N.prototype._checkForFilterInfo=function(j,n,O){var i;var Q=null;if(j&&j.length){for(i=0;i<j.length;i++){if(j[i].name===n){if((j[i].group===O)||this.isLiveMode){Q=j[i];break;}}}}return Q;};N.prototype._createVariantManagement=function(){var i=new p(this.getId()+"-variantUi2",{});var j=new o({type:"filterBar",keyName:"persistencyKey"});j.setControl(this);i.addPersonalizableControl(j);i.addStyleClass("sapUiCompFilterBarMarginLeft");return i;};N.prototype.fireAssignedFiltersChanged=function(){this.fireEvent("assignedFiltersChanged");};N.prototype.retrieveFiltersWithValuesAsText=function(){var j,n,O=this.retrieveFiltersWithValues(),Q,W=this.getBasicSearchValue();if(W&&O){O.splice(0,0,W);}if(!O||(O.length===0)){j=this._oRb.getText("FILTER_BAR_ASSIGNED_FILTERS_ZERO");}else{if(!this._isPhone()){Q=Math.min(5,O.length);n="";for(var i=0;i<Q;i++){n+=O[i];if(i<(Q-1)){n+=', ';}}j=this._oRb.getText("FILTER_BAR_ASSIGNED_FILTERS",[O.length,n]);if(Q<O.length){j+=", ...";}}else{j=this._oRb.getText("FILTER_BAR_ASSIGNED_FILTERS_MOBILE",[O.length]);}}return j;};N.prototype.retrieveFiltersWithValues=function(){var i,j=[];var n=this._getFiltersWithValues();if(n){for(i=0;i<n.length;i++){if(n[i].getVisible()&&n[i].getPartOfCurrentVariant()){j.push(n[i].getLabel());}}}return j;};N.prototype._getFiltersWithValues=function(){if(this._fRegisterGetFiltersWithValues){try{return this._fRegisterGetFiltersWithValues();}catch(i){q.sap.log.error("callback for obtaining the filter count throws an exception");}}return null;};N.prototype._getFiltersWithValuesCount=function(){var n=0;var i=this.retrieveFiltersWithValues();n=i.length;if(this._oBasicSearchField&&this._oBasicSearchField.getValue&&this._oBasicSearchField.getValue()){n++;}return n;};N.prototype._checkFilterForValue=function(j,n){var i;if(j){for(i=0;i<j.length;i++){if(j[i]===n){return true;}}}return false;};N.prototype._handleVisibilityOfToolbar=function(){if(this.getAdvancedMode()&&this._oToolbar){var j=false;var n=this._oToolbar.getContent();for(var i=0;i<n.length;i++){if(n[i]instanceof k){continue;}if(n[i].getVisible&&n[i].getVisible()){j=true;break;}}this._oToolbar.setVisible(j);}};N.prototype._toggleHideShow=function(){this.setFilterBarExpanded(!this.getFilterBarExpanded());};N.prototype._updateToolbarText=function(){var i=this._isNewFilterBarDesign()?"FILTER_BAR_ADAPT_FILTERS":"FILTER_BAR_ACTIVE_FILTERS";var Z=this._isNewFilterBarDesign()?"FILTER_BAR_ADAPT_FILTERS_ZERO":"FILTER_BAR_ACTIVE_FILTERS_ZERO";var n=this._getFiltersWithValuesCount();var j=n?(this._oRb.getText(i,[n])):(this._oRb.getText(Z));this._oFiltersButton.setText(j);this._oFiltersButton.setTooltip(j);this.fireAssignedFiltersChanged();};N.prototype.setFilterBarExpanded=function(i){if(this.getAdvancedMode()){this.setProperty("filterBarExpanded",i);if(this._oHideShowButton){if(i){this._oHideShowButton.setText(this._oRb.getText("FILTER_BAR_VH_HIDE"));}else{this._oHideShowButton.setText(this._oRb.getText("FILTER_BAR_VH_SHOW"));}}this._calcVisibilityGoButton();this._oAdvancedPanel.setVisible(i);}else{var j=this._isPhone()?false:i;this.setProperty("filterBarExpanded",j);if(this._isNewFilterBarDesign()){return;}if(this._isPhone()){if(this._oHideShowButton){this._oHideShowButton.setVisible(false);}this._calcVisibilityGoButton();this._oBasicAreaLayout.setVisible(false);}else{if(this._oHideShowButton){if(j){this._oHideShowButton.setText(this._oRb.getText("FILTER_BAR_HIDE"));this._oHideShowButton.setTooltip(this._oRb.getText("FILTER_BAR_HIDE"));}else{this._oHideShowButton.setText(this._oRb.getText("FILTER_BAR_SHOW"));this._oHideShowButton.setTooltip(this._oRb.getText("FILTER_BAR_SHOW"));}this._oHideShowButton.setVisible(true);}this._calcVisibilityGoButton();if(this._oHideShowButton){if(this._oHideShowButton.getEnabled()){this._oBasicAreaLayout.setVisible(j);}else{this._oBasicAreaLayout.setVisible(false);}}}}this._updateToolbarText();};N.prototype._selectionChangedInFilterDialog=function(i,j){j.setVisibleInFilterBar(i.getSelected());if(this._getConsiderFilterChanges()&&this._oVariantManagement&&this._oVariantManagement.getEnabled()){this._oVariantManagement.currentVariantSetModified(true);}this._bDirtyViaDialog=true;};N.prototype._mandatoryFilterChange=function(i){if(!i){return;}var j=i.getParameters();if(!j||!j.oSource){return;}var n=this._determineByControl(j.oSource);if(n&&n.checkbox){var O=n.filterItem;if(!O.getMandatory()){return;}var Q=this._hasFilterValue(O);if(O.getVisibleInFilterBar()){if(Q){n.checkbox.setEnabled(true);}else{n.checkbox.setEnabled(false);}}else{if(!Q){O.setVisibleInFilterBar(true);n.checkbox.setSelected(true);n.checkbox.setEnabled(false);}}}};N.prototype._createFiltersAndAdaptBasicArea=function(){var i;this._setConsiderFilterChanges(false);this._recreateBasicAreaContainer(true);i=this._createFilters();var j=this._retrieveVisibleAdvancedItems();if(this._oAddToFilterBarLabel&&(!j||(j.length<=0))){this._oAddToFilterBarLabel.setVisible(false);}this._setConsiderFilterChanges(true);return i;};N.prototype._determineNotAssignedFiltersCount=function(j){var n=0,i,O;if(this._mAdvancedAreaFilter[j]&&this._mAdvancedAreaFilter[j].items){for(i=0;i<this._mAdvancedAreaFilter[j].items.length;i++){O=this._mAdvancedAreaFilter[j].items[i].filterItem;if(!O.getVisible()||O.getHiddenFilter()){continue;}if(!O.getPartOfCurrentVariant()&&!O.getVisibleInFilterBar()){n++;}}}return n;};N.prototype._rerenderGroup=function(j,n){var i;var O;this._rerenderItem(j);this._adaptLinkText(n);if(j.formelement){if(this._mAdvancedAreaFilter[n]&&this._mAdvancedAreaFilter[n].items&&this._mAdvancedAreaFilter[n].formcontainer){for(i=0;i<this._mAdvancedAreaFilter[n].items.length;i++){O=this._mAdvancedAreaFilter[n].items[i].filterItem;if(O&&O.getVisible()){this._mAdvancedAreaFilter[n].formcontainer.setVisible(true);return;}}this._mAdvancedAreaFilter[n].formcontainer.setVisible(false);}}};N.prototype._setLinkTextAndCount=function(i,j,n){var O;if(n){O=this._oRb.getText("FILTER_BAR_SHOW_MORE_FILTERS",[n]);}else{O=this._oRb.getText("FILTER_BAR_SHOW_CHANGE_FILTERS");}j.setText(O);};N.prototype._setLinkText=function(i,j){var n=this._determineNotAssignedFiltersCount(i);this._setLinkTextAndCount(i,j,n);};N.prototype._createLink=function(i,j){var n,O=this;n=K.replace(i);var Q=new d(this.getId()+"-link-"+n);this._setLinkText(i,Q);Q.attachPress(function(){O._createAddRemoveFiltersDialog(i,Q);});if(j){Q.addAriaLabelledBy(j);}return Q;};N.prototype._isPhone=function(){return(D.system.phone)?true:false;};N.prototype._isTablet=function(){return(D.system.tablet&&!D.system.desktop)?true:false;};N.prototype._createForm=function(i){var j=this;var n=null;n=F.extend('sap.ui.comp.filterbar.Form',{metadata:{},renderer:function(O,Q){J.render.apply(this,arguments);}});(function(){n.prototype.contentOnAfterRendering=function(){F.prototype.contentOnAfterRendering.apply(this,arguments);j._adaptStyleSheet();if(j._oFilterDialog&&j._oFilterDialog.isOpen()&&(j._isNewFilterBarDesign()||!j._isPhone())){j._repositionAddToFilterBarLabel();}};}());return new n({editable:true,layout:i});};N.prototype._adaptStyleSheet=function(){var i,O;var j,Q,n=null;for(n in this._mAdvancedAreaFilter){if(n&&this._mAdvancedAreaFilter[n].items){for(i=0;i<this._mAdvancedAreaFilter[n].items.length;i++){j=this._mAdvancedAreaFilter[n].items[i];if(j&&j.control&&j.control instanceof M){Q=j.control.$();if(Q){O=Q.parent().css("overflow");if(O!=="visible"){Q.parent().css({"overflow":"visible"});}}}}}}};N.prototype._addFieldToFiltersDialog=function(i,j,n){var O,Q,W,X;if(!i&&!i.filterItem||i.filterItem.getHiddenFilter()){return;}var Y=this._determineVisibility(i.filterItem);if(i.control.getWidth){i.width=i.control.getWidth();if(i.control.setWidth){i.control.setWidth("100%");}}O=i.filterItem.getLabelControl(this.getId());if(this.getConsiderGroupTitle()){O.setText(i.filterItem.getLabel());}Q=new C({tooltip:this._oRb.getText("FILTER_BAR_SHOW_IN_FILTERBAR")});Q.setSelected(i.filterItem.getVisibleInFilterBar());if(i.filterItem.getMandatory()){X=this._checkFilterForValue(n,i.filterItem);if(!X&&i.filterItem.getVisibleInFilterBar()){Q.setEnabled(false);}}Q.attachSelect(this._selectionChangedInFilterDialog.bind(this,Q,i.filterItem));if(this._isNewFilterBarDesign()||!this._isPhone()){i.control.setLayoutData(new w({span:"L8 M8 S11"}));Q.setLayoutData(new w({span:"L1 M1 S1"}));}else{i.control.setLayoutData(new w({span:"L8 M8 S12"}));Q.setVisible(false);}W=new A({label:O,fields:[i.control,Q]});W.setVisible(Y);i.formelement=W;i.checkbox=Q;j.addFormElement(W);};N.prototype._createHeaderAddToFilterBar=function(i){var j,n;if(this._isNewFilterBarDesign()||!this._isPhone()){j=new L({});j.setLayoutData(new w({span:"L10 M10"}));j.addStyleClass("sapUiCompFilterBarAddFilterLabel");this._oAddToFilterBarLabel=j;n=new A({label:j,fields:[]});i.addFormElement(n);j.setLabelFor(null);}};N.prototype._addBasicSearchAddToFilterBar=function(i){var j;if(!this._isPhone()){this._oBasicSearchFieldClone=this._oBasicSearchField.clone();if(this._oToolbar){this._replaceOnToolbar(this._oBasicSearchField,this._oBasicSearchFieldClone);}else{this._addBasicSearchToBasicArea(this._oBasicSearchFieldClone);}}else{if(this.getAdvancedMode()){this._oBasicSearchFieldClone=this._oBasicSearchField.clone();}}if(this._isNewFilterBarDesign()||!this._isPhone()){this._oBasicSearchField.setLayoutData(new w({span:"L8 M8 S11",indent:"L3 M3 S0"}));}else{this._oBasicSearchField.setLayoutData(new w({span:"L8 M8 S12"}));}if(this._isPhone()&&this.getAdvancedMode()){j=new A({fields:[this._oBasicSearchFieldClone]});}else{j=new A({fields:[this._oBasicSearchField]});}i.addFormElement(j);};N.prototype._isGroupEmpty=function(i){var j=true;i.some(function(n){if(n.filterItem&&n.filterItem.getVisible()&&!n.filterItem.getHiddenFilter()){j=false;return true;}return false;});return j;};N.prototype._createFilters=function(){var j=this,n=null,i,O;var Q=null,W,X,Y;var Z,$,_=true,a1;this._oClonedVM=null;var b1=new E();b1.setColumnsL(1);b1.setLabelSpanL(3);b1.setColumnsM(1);b1.setLabelSpanM(3);var c1=this._createForm(b1);c1.addStyleClass("sapUiCompFilterBarDialogForm");if(this._possibleToChangeVariantManagement()&&this._oToolbar){var d1=this._oToolbar.indexOfContent(this._oVariantManagement);if(d1>=0){this._oClonedVM=this._oVariantManagement.clone();this._oClonedVM._setSelectionByKey(this._oVariantManagement.getSelectionKey());this._replaceOnToolbar(this._oVariantManagement,this._oClonedVM);Q=new z();this._oVariantManagement.setLayoutData(new w({span:"L10 M10 S12"}));W=new A({fields:this._oVariantManagement});Q.addFormElement(W);c1.addFormContainer(Q);}c1.addStyleClass("sapUiCompFilterBarGroupTitle");}if(this._oBasicSearchField&&!this._isNewFilterBarDesign()){if(!Q){Q=new z();c1.addFormContainer(Q);}this._addBasicSearchAddToFilterBar(Q);}this._ensureFilterLoaded(null);var e1=this._getFiltersWithValues();this._fRegisteredFilterChangeHandlers=function(f1){j._mandatoryFilterChange(f1);};this.attachFilterChange(this._fRegisteredFilterChangeHandlers);this._oVariant.content=this.fetchVariant();if(this._oVariantManagement){this._oVariant.key=this._oVariantManagement.getSelectionKey();this._oVariant.modified=this._oVariantManagement.currentVariantGetModified();}this._oInitialVariant={};q.extend(true,this._oInitialVariant,this._oVariant);for(n in this._mAdvancedAreaFilter){if(n&&this._mAdvancedAreaFilter[n].items){if(n===N.INTERNAL_GROUP){O=this._oRb.getText("FILTER_BAR_BASIC_GROUP");}else{O=this._mAdvancedAreaFilter[n].filterItem.getGroupTitle();}$=new t({text:O});Q=new z({title:$});if(_&&!this._isGroupEmpty(this._mAdvancedAreaFilter[n].items)){_=false;this._createHeaderAddToFilterBar(Q);if(this._oBasicSearchField&&this._isNewFilterBarDesign()){this._addBasicSearchAddToFilterBar(Q);}}a1=0;this._mAdvancedAreaFilter[n].formcontainer=Q;for(i=0;i<this._mAdvancedAreaFilter[n].items.length;i++){Y=this._mAdvancedAreaFilter[n].items[i];this._addFieldToFiltersDialog(Y,Q,e1);if(!Y.filterItem.getVisible()){a1++;}}X=Q.getFormElements();if(X&&X.length>0){if((n!==N.INTERNAL_GROUP)&&!this.getAdvancedMode()){Z=this._createLink(n,$);if(Z){if(this._isPhone()){Z.setLayoutData(new w({span:"L8 M8 S12"}));}else{Z.setLayoutData(new w({span:"L8 M8 S12",indent:"L3 M3 S0"}));}W=new A({fields:[Z]});this._mAdvancedAreaFilter[n].link=Z;Q.addFormElement(W);}if(a1===X.length){Q.setVisible(false);}}c1.addFormContainer(Q);}}}return c1;};N.prototype._replaceOnToolbar=function(i,n){var j;if(this._oToolbar){j=this._oToolbar.indexOfContent(i);if(j>-1){this._oToolbar.insertContent(n,j);this._oToolbar.removeContent(i);}}};N.prototype._recreateBasicAreaContainer=function(j){var n=null,i;var O,Q;var W,X,Y;if(this._possibleToChangeVariantManagement()&&this._oToolbar&&this._oClonedVM&&this._oVariantManagement){this._replaceOnToolbar(this._oClonedVM,this._oVariantManagement);this._oClonedVM.destroy();this._oClonedVM=null;}if(!this._isPhone()&&this._oToolbar&&this._oBasicSearchFieldClone&&this._oBasicSearchField){this._replaceOnToolbar(this._oBasicSearchFieldClone,this._oBasicSearchField);this._oBasicSearchFieldClone.destroy();this._oBasicSearchFieldClone=null;}var Z=this._oBasicAreaLayout.removeAllContent();if(!j){if(Z){var $=Z.length;var _=0;if(this._isNewFilterBarDesign()){if(this._isPhone()){_++;}else{$--;}}for(i=_;i<$;i++){if(Z[i]!==this._oHintText){Z[i].destroy();}}}}if(this._isNewFilterBarDesign()){this._addBasicSearchToBasicArea(this._oBasicSearchField);this._addButtonsToBasicArea();}for(n in this._mAdvancedAreaFilter){if(n&&this._mAdvancedAreaFilter[n].items){for(i=0;i<this._mAdvancedAreaFilter[n].items.length;i++){W=this._mAdvancedAreaFilter[n].items[i].filterItem;if(W.getHiddenFilter()){continue;}Y=null;if(j){if(!W.getVisible()||!W.getVisibleInFilterBar()){continue;}X=this._mAdvancedAreaFilter[n].items[i].container;if(X){if(X.$()&&X.$().width()){Y=X.$().width();}X.removeAllContent();X.destroy();}O=this._mAdvancedAreaFilter[n].items[i].control.clone();Q=W.getLabelControl(this.getId()).clone();Q.setLabelFor(null);if(this.getConsiderGroupTitle()){W.getLabelControl(this.getId()).setText(W.getLabel());}}else{O=this._mAdvancedAreaFilter[n].items[i].control;Q=W.getLabelControl(this.getId());if(this._mAdvancedAreaFilter[n].items[i].width){O.setWidth(this._mAdvancedAreaFilter[n].items[i].width);}}X=this._addControlToBasicAreaContainer(W,O,Q);if(X){X.setVisible(W.getVisible()&&W.getVisibleInFilterBar());this._mAdvancedAreaFilter[n].items[i].container=X;if(j&&Y){X.setWidth(Y+"px");}}}}}};N.prototype._searchRequested=function(){var i,j=false;if(this.verifySearchAllowed){i=this.verifySearchAllowed();if(i.hasOwnProperty("pending")){return;}else if(i.hasOwnProperty("error")||i.hasOwnProperty("mandatory")){j=true;}}if(j){this._bOKFiltersDialogTriggered=false;this._activateMainContent();}else{this._bOKFiltersDialogTriggered=true;if(!this.isLiveMode||!this.isLiveMode()){this.search();}else{this._oFilterDialog.close();}}};N.prototype._activateMainContent=function(){var i=this.getFilterDialogContent();if(i&&(i.length>1)){this.addFilterDialogContent(i[0]);}};N.prototype.fireSearch=function(i){if(this._oFilterDialog&&this._bOKFiltersDialogTriggered){this._oFilterDialog.close();}this.fireEvent("search",i);};N.prototype._closeDialogAndRestoreFilterBar=function(i){this._sSearchCriteriaInFiltersDialog=null;this._oVariant={};i.removeAllFormContainers();this._recreateBasicAreaContainer();this._deleteProperties();this._adaptGroupsTitle();if(this._fRegisteredFilterChangeHandlers){this.detachFilterChange(this._fRegisteredFilterChangeHandlers);this._fRegisteredFilterChangeHandlers=null;}if(this.isLiveMode&&this.isLiveMode()){this.search();}this._updateToolbarText();};N.prototype._variantSave=function(i){var j;this._oVariant={};this.fireBeforeVariantSave();if(this._oVariantManagement&&this._oFilterDialog){j=this._oVariantManagement.getSelectionKey();this._oVariant.key=j;this._oVariant.modified=false;this._oVariant.content=this._oVariantManagement.getVariantContent(this,j);}};N.prototype._afterVariantSave=function(i){this.fireAfterVariantSave();};N.prototype._variantSavePressed=function(i){this._bVariantSavePressed=true;if(this._oVariantManagement){var j=this._oVariantManagement.getSelectionKey();var n=this._oVariantManagement.getItemByKey(this._oVariantManagement.getSelectionKey());if(!this._oVariantManagement._isIndustrySolutionModeAndVendorLayer()&&((j===this._oVariantManagement.getStandardVariantKey())||(n&&n.getReadOnly&&n.getReadOnly()))){this._oVariantManagement._openSaveAsDialog();}else{this._oVariantManagement._variantSavePressed();}this._bDirtyViaDialog=false;if(this._oInitialVariant&&this._oVariantManagement._getVariantContent){this._oInitialVariant.content=this._oVariantManagement._getVariantContent(this,j);}}};N.prototype._findFirstVisibleGroup=function(){var n=null;for(n in this._mAdvancedAreaFilter){if(n&&this._mAdvancedAreaFilter[n].formcontainer&&this._mAdvancedAreaFilter[n].formcontainer.getVisible()){return this._mAdvancedAreaFilter[n].formcontainer.getTitle();}}return null;};N.prototype._checkForCollision=function(i,j){var n=this._oFilterDialog.getDomRef("scroll");this._oLabelTextWidth=Math.max(j.width(),this._oLabelTextWidth);if(!this._oLabelTextWidth){return false;}if(!(i.position()&&i.width())){return false;}if((this._oLabelTextWidth>0)&&n&&(i.position().left+i.width())>=(n.clientWidth-this._oLabelTextWidth-32)){if(this._oAddToFilterBarLabel){this._oAddToFilterBarLabel.setText("");}return true;}return false;};N.prototype._repositionAddToFilterBarLabel=function(){if(this._isNewFilterBarDesign()||!this._isPhone()){var i=this._findFirstVisibleGroup();if(i&&this._oAddToFilterBarLabel){var j=i.$();if(j){var n=this._oAddToFilterBarLabel.$();if(n){j.css({display:"inline"});if(this._checkForCollision(j,n)){return;}var O=j.offset();var Q=n.offset();if(Q&&O){Q.top=Math.ceil(O.top);n.offset(Q);if(!sap.ui.getCore().getConfiguration().getRTL()){n.css({left:"auto"});}}}}}if(this._oAddToFilterBarLabel&&!this._oAddToFilterBarLabel.getText()){this._oAddToFilterBarLabel.setText(this._oRb.getText("FILTER_BAR_SHOW_IN_FILTERBAR"));}}};N.prototype._filterSetInErrorState=function(i){if(this._oFilterDialog&&this._oFilterDialog.isOpen()){if(this._getConsiderFilterChanges()&&this._oVariantManagement&&this._oVariantManagement.getEnabled()){this._oVariantManagement.currentVariantSetModified(true);}this._bDirtyViaDialog=true;}};N.prototype._cancelFilterDialog=function(i){if(i&&this._oVariantManagement){this._bDirtyViaDialog=this._oVariantManagement._bSaveCanceled;}if(!this.getPersistencyKey()&&(this.getUseSnapshot()===false)){this.fireCancel();return;}if(this._oInitialVariant&&this._oInitialVariant.content&&this._bDirtyViaDialog){this._resetFiltersInErrorValueState();this.applyVariant(this._oInitialVariant.content,"CANCEL");if(this._oVariantManagement){if(!this._oVariantManagement.isPageVariant()){this._oVariantManagement._setSelectionByKey(this._oInitialVariant.key);}this._oVariantManagement.currentVariantSetModified(this._oInitialVariant.modified);}this.fireCancel();}};N.prototype._resetFiltersInErrorValueState=function(){var n;n=this._retrieveCurrentSelectionSet(true,true);n.forEach(function(O){if(O.control&&O.control.setValueState&&O.control.getValueState){if(O.control.getValueState()===u.Error){if(O.control.setValue){O.control.setValue("");}O.control.setValueState(u.None);}}});};N.prototype.showFilterDialog=function(){if(!this._oFilterDialog){this._showFilterDialog();}};N.prototype.addFilterDialogContent=function(i){if(this._oFilterDialog&&i){var n=this._oFilterDialog.indexOfContent(i);if(n<0){this._oFilterDialog.addContent(i);}return this._setFilterDialogActiveContent(i);}return null;};N.prototype.getFilterDialogContent=function(){if(this._oFilterDialog){return this._oFilterDialog.getContent();}return null;};N.prototype._setFilterDialogActiveContent=function(n){var i=false;if(this._oFilterDialog){this.getFilterDialogContent().forEach(function(j){if(n===j){j.setVisible(true);i=true;}else{j.setVisible(false);}});if(i){return n;}}return null;};N.prototype._getFilterDialogActiveContent=function(){var i=null;if(this._oFilterDialog){this.getFilterDialogContent().some(function(j){if(j.getVisible()){i=j;return true;}return false;});}return i;};N.prototype.setContentWidth=function(n){if(this._oFilterDialog){this._oFilterDialog.setContentWidth(n+"px");}};N.prototype.setContentHeight=function(n){if(this._oFilterDialog){this._oFilterDialog.setContentHeight(n+"px");}};N.prototype._showFilterDialog=function(){q.sap.require("sap.m.Dialog");var i=this;this._oFilterDialog=new sap.m.Dialog(this.getId()+"-adapt-filters-dialog",{stretch:D.system.phone,resizable:true,draggable:true});this._oFilterDialog.setParent(this);this._oFilterDialog.addStyleClass("sapUiPopupWithPadding");if(this.$().closest(".sapUiSizeCompact").length>0){this._oFilterDialog.addStyleClass("sapUiSizeCompact");}this._oFilterDialog.addStyleClass("sapUiCompFilterBarDialog");if(!this._isPhone()){this._oFilterDialog.addStyleClass("sapUiCompFilterBarDialogNonPhone");}var j="FILTER_BAR_ADV_FILTERS_DIALOG";if(this._isNewFilterBarDesign()){j="FILTER_BAR_ADAPT_FILTERS_DIALOG";}this._oFilterDialog.setTitle(this._oRb.getText(j));this._oFilterDialog.addStyleClass("sapMH4FontSize");this._oFilterDialog.addStyleClass("sapMH4Style");this._oFilterDialog.setVerticalScrolling(true);var n=new B();this._oFiltersSearchField=new S({placeholder:this._oRb.getText("FILTER_BAR_SEARCH")});n.addContentRight(this._oFiltersSearchField);this._oFilterDialog.setSubHeader(n);var O=this._createFiltersAndAdaptBasicArea();if(!O){q.sap.log.error("Content for Advanced Filters Dialog could not be created");return;}this._oFilterDialog.addContent(O);this._oFiltersSearchField.attachLiveChange(function(Q){if(this._oFilterDialog){this.fireFiltersDialogSearchForFilters(Q.getParameters());this._triggerSearchInFilterDialog(Q);}}.bind(this));this._bOKFiltersDialogTriggered=false;this._bVariantSaveFiltersDialogTriggered=false;this._oFilterDialog.bDoNotAddToBasicArea=true;this._oFilterDialog.attachBeforeOpen(function(){this.fireFiltersDialogBeforeOpen();}.bind(this));this._oFilterDialog.attachAfterOpen(function(){if(!this._isPhone()&&(O===this._getFilterDialogActiveContent())){var Q=i._oFilterDialog.getDomRef("scroll");if(Q){this.setContentWidth(Q.clientWidth);this.setContentHeight(Q.clientHeight);}}}.bind(this));this._oFilterDialog.attachBeforeClose(function(){if(!i._bOKFiltersDialogTriggered){i._cancelFilterDialog(i._bVariantSaveFiltersDialogTriggered);}delete i._oFilterDialog.bDoNotAddToBasicArea;i._closeDialogAndRestoreFilterBar(O);});this._oFilterDialog.attachAfterClose(function(){i._oBasicAreaLayout.rerender();i._oInitialVariant=null;i._oFilterDialog.destroy();i._oFilterDialog=null;i._showHintText();var Q={};Q.context=i._bOKFiltersDialogTriggered?"SEARCH":"CANCEL";i.fireFiltersDialogClosed(Q);if(i._isNewFilterBarDesign()){i._fHandleResize();}});this._oFilterDialog.setInitialFocus(this._oFiltersSearchField);this._addFilterDialogButtons(O);this._bDirtyViaDialog=false;this._oFilterDialog.open();};N.prototype.isDialogOpen=function(){return this._oFilterDialog?true:false;};N.prototype._addFilterDialogButtons=function(i){q.sap.require("sap.m.OverflowToolbarPriority");q.sap.require("sap.m.OverflowToolbarLayoutData");var j=this;var n;var O=null,Q,W,X,Y;X=new a(this.getId()+"-btnGoFilterDialog",{text:this._oRb.getText("FILTER_BAR_GO"),press:function(){X.focus();j._dialogSearch(i);},layoutData:new sap.m.OverflowToolbarLayoutData({priority:sap.m.OverflowToolbarPriority.NeverOverflow}),type:b.Emphasized});this._oFilterDialog.addButton(X);if(!this.getAdvancedMode()){if(this._oVariantManagement&&this._oVariantManagement.getVisible()){this._oVariantManagement._delayedControlCreation();if(this._oVariantManagement.oVariantSave){O=new a(this.getId()+"-btnSaveFilterDialog",{text:this._oRb.getText("VARIANT_MANAGEMENT_SAVE"),enabled:this._oVariantManagement.oVariantSave.getEnabled(),press:function(){j._dialogVariantSave(i);},layoutData:new sap.m.OverflowToolbarLayoutData({priority:sap.m.OverflowToolbarPriority.Low})});n=this._oVariantManagement.getModel("save_enablement");O.setModel(n);O.bindProperty("enabled","/enabled");this._oFilterDialog.addButton(O);}}Q=new a(this.getId()+"-btnClearFilterDialog",{text:this._oRb.getText("FILTER_BAR_CLEAR"),visible:this.getShowClearButton(),press:function(){j._dialogClear(i);},layoutData:new sap.m.OverflowToolbarLayoutData({priority:sap.m.OverflowToolbarPriority.Low})});this._oFilterDialog.addButton(Q);W=new a(this.getId()+"-btnRestoreFilterDialog",{text:this._oRb.getText("FILTER_BAR_RESTORE"),visible:this.getShowRestoreButton(),press:function(){j._dialogRestore(i);},layoutData:new sap.m.OverflowToolbarLayoutData({priority:sap.m.OverflowToolbarPriority.Low})});if(n){W.setEnabled(this._oVariantManagement.oVariantSave.getEnabled());W.setModel(n);W.bindProperty("enabled","/enabled");}this._oFilterDialog.addButton(W);Y=new a(this.getId()+"-btnCancelFilterDialog",{text:this._oRb.getText("FILTER_BAR_CANCEL"),press:function(){j._dialogCancel(i);},layoutData:new sap.m.OverflowToolbarLayoutData({priority:sap.m.OverflowToolbarPriority.High})});this._oFilterDialog.addButton(Y);}};N.prototype._dialogSearch=function(i){this.fireFiltersDialogSearch();this._searchRequested();};N.prototype._dialogCancel=function(i){if(this._oFilterDialog){this._bOKFiltersDialogTriggered=false;this.fireFiltersDialogCancel();this._oFilterDialog.close();}};N.prototype._dialogVariantSave=function(i){this._bVariantSaveFiltersDialogTriggered=true;this._variantSavePressed();};N.prototype._dialogRestore=function(i){this.reset();if(this._oVariantManagement&&this._oVariantManagement.getEnabled()){this._oVariantManagement.currentVariantSetModified(false);}};N.prototype._dialogClear=function(i){this.clear();};N.prototype._createButtons=function(i){var j=this;this._oHideShowButton=new a(this.getId()+"-btnShowHide",{text:this._oRb.getText("FILTER_BAR_HIDE"),tooltip:this._oRb.getText("FILTER_BAR_HIDE"),type:b.Transparent,enabled:false});this._oHideShowButton.attachPress(function(){j._toggleHideShow();});i.addContent(this._oHideShowButton);this._oClearButtonOnFB=new a(this.getId()+"-btnClear",{visible:this.getShowClearOnFB(),text:this._oRb.getText("FILTER_BAR_CLEAR"),tooltip:this._oRb.getText("FILTER_BAR_CLEAR"),type:b.Transparent,enabled:false});this._oClearButtonOnFB.attachPress(function(){j.clear();});i.addContent(this._oClearButtonOnFB);this._oRestoreButtonOnFB=new a(this.getId()+"-btnRestore",{visible:this.getShowRestoreOnFB(),text:this._oRb.getText("FILTER_BAR_RESTORE"),tooltip:this._oRb.getText("FILTER_BAR_RESTORE"),type:b.Transparent,enabled:false});this._oRestoreButtonOnFB.attachPress(function(){j.reset();if(j._oVariantManagement){j._oVariantManagement.currentVariantSetModified(false);}});i.addContent(this._oRestoreButtonOnFB);this._oFiltersButton=new a(this.getId()+"-btnFilters",{visible:this.getShowFilterConfiguration()||this._isPhone(),text:this._oRb.getText("FILTER_BAR_ACTIVE_FILTERS_ZERO"),tooltip:this._oRb.getText("FILTER_BAR_ACTIVE_FILTERS_ZERO"),type:b.Transparent,enabled:false});this._oFiltersButton.attachPress(function(){j._oFiltersButton.focus();j._showFilterDialog();});i.addContent(this._oFiltersButton);this._oSearchButton=new a(this.getId()+"-btnGo",{visible:this.getShowGoOnFB(),text:this._oRb.getText("FILTER_BAR_GO"),tooltip:this._oRb.getText("FILTER_BAR_GO"),type:b.Emphasized});this._oSearchButton.attachPress(function(){j._oSearchButton.focus();j.search();});i.addContent(this._oSearchButton);};N.prototype._createVariantLayout=function(){this._oVariantManagement=this._createVariantManagement();if(this._possibleToChangeVariantManagement()){this._oVariantManagement.setVisible(false);}this._registerVariantManagement();return this._oVariantManagement;};N.prototype._createToolbar=function(i){var j=new h(this.getId()+"-toolbar");if(!i){var n=this._createVariantLayout();j.addContent(n);}j.addContent(new k());this._createButtons(j);j.addStyleClass("sapUiCompFilterBarToolbar");j.addStyleClass("sapUiCompFilterBarToolbarMarker");return j;};N.prototype._replaceVariantManagement=function(i){if(this._oVariantManagement){this._unregisterVariantManagement();if(this._oToolbar&&this._oToolbar.getContent(this._oVariantManagement)){this._oToolbar.removeContent(this._oVariantManagement);}this._oVariantManagement.destroy();}this._oVariantManagement=i;this._registerVariantManagement();this._adaptNewFilterBarDesign();};N.prototype._createBasicAreaLayout=function(){var i=new H({visible:false});i.setAllowWrapping(true);i.addStyleClass("sapUiCompFilterBarWidth100");i.addStyleClass("sapUiCompFilterBarBasicArea");return i;};N.prototype._createAdvancedAreaForm=function(){var i=new E();i.addStyleClass("sapUiCompFilterBarPaddingForm");i.setColumnsL(3);i.setColumnsM(2);var j=new F({editable:true});j.setLayout(i);return j;};N.prototype._addControlToBasicAreaFormContainer=function(i){var j=i.getControl();if(!j){q.sap.log.error("no Control obtained");return null;}var n=i.getLabelControl(this.getId());if(!n){q.sap.log.error("no Label obtained");return null;}this._adaptGroupTitleForFilter(i);return this._addControlToBasicAreaContainer(i,j,n);};N.prototype._addControlToBasicAreaContainer=function(i,j,n){var O=new y();O.setLayoutData(new x({margin:true}));if(j.setWidth){j.setWidth("100%");}O.setWidth(this.getFilterContainerWidth());if(n){if(!n.hasStyleClass("sapUiCompFilterLabel")){n.addStyleClass("sapUiCompFilterLabel");}O.addContent(n);if(n.setLabelFor){if(i&&j){n.setLabelFor(j);}else if(j){q.sap.require("sap.ui.core.InvisibleText");var Q=new sap.ui.core.InvisibleText({text:this._oRb.getText("FILTER_BAR_BSEARCH_PLACE_HOLDER")});O.addContent(Q);j.addAriaLabelledBy(Q);}}}O.addContent(j);O.addStyleClass("sapUiCompFilterBarPaddingRight");O.addStyleClass("sapUiCompFilterBarPaddingTop");if(!this.getAdvancedMode()&&(!this._oFilterDialog||(!this._oFilterDialog.hasOwnProperty("bDoNotAddToBasicArea")))){if(i&&i.getVisible()&&i.getVisibleInFilterBar()){if(this._isNewFilterBarDesign()){var W=this._oBasicAreaLayout.getContent();if(this._isPhone()){this._oBasicAreaLayout.addContent(O);}else{this._oBasicAreaLayout.insertContent(O,W.length-1);}}else{this._oBasicAreaLayout.addContent(O);}}}return O;};N.prototype._rerenderAA=function(){this._oAdvancedAreaForm.removeAllFormContainers();var i=this._flattenMap();this._layOutAA(i);};N.prototype._layOutAA=function(i){if(this._mAdvancedAreaFilter&&Object.keys(this._mAdvancedAreaFilter).length>1){this._layOutAAMultipleGroup(i);}else{this._layOutAASingleGroup(i);}};N.prototype._layOutAAMultipleGroup=function(n){var i,j,O=0;var Q=null;for(i=0;i<n.length;i++){if(n[i].control===null){O++;}}var W=this._oAdvancedAreaForm.getLayout();if(W){if(O>=3){W.setLabelSpanL(5);W.setLabelSpanM(5);W.setColumnsL(3);W.setColumnsM(2);}else if(O===2){W.setLabelSpanL(4);W.setLabelSpanM(5);W.setColumnsL(2);W.setColumnsM(2);}else if(O===1){W.setLabelSpanL(4);W.setLabelSpanM(5);W.setColumnsL(2);W.setColumnsM(2);}}for(i=0;i<n.length;i++){if(n[i].control===null){Q=new z();if(Object.keys(this._mAdvancedAreaFilter).length>1){Q.setTitle(n[i].filterItem.getGroupTitle());}this._oAdvancedAreaForm.addFormContainer(Q);j=i+1;while(j<n.length&&(n[j].control)){this._addControlToAdvancedArea(n[j].filterItem,n[j].control,Q);j++;}i=j-1;}}if(O===1){this._oAdvancedAreaForm.addFormContainer(new z());}};N.prototype._layOutAASingleGroup=function(j){var i,n,O,Q;var W=j.length-1;var X=W>2?2:1;if(X>1){O=Math.floor(W/X);Q=((O*X)<W);for(i=1;i<X;i++){n=i*O;if(Q){++n;}if((n+i)<j.length){j.splice(n+i,0,j[0]);}}}this._layOutAAMultipleGroup(j);};N.prototype._flattenMap=function(){var n=null,i;var j=[];var O;if(this._mAdvancedAreaFilter){for(n in this._mAdvancedAreaFilter){if(n&&this._mAdvancedAreaFilter[n].items){O=false;for(i=0;i<this._mAdvancedAreaFilter[n].items.length;i++){var Q=this._mAdvancedAreaFilter[n].items[i];if(Q.filterItem&&Q.filterItem.getVisibleInFilterBar()&&Q.filterItem.getVisible()&&!Q.filterItem.getHiddenFilter()){if(!O){O=true;j.push({control:null,filterItem:this._mAdvancedAreaFilter[n].filterItem});}j.push({control:Q.control,filterItem:Q.filterItem});}}}}}return j;};N.prototype._triggerSearchByValue=function(j){var i,n,O;var Q;var W;j=j.replace(/^\s+|\s+$/g,"").toLowerCase();if(this._aListItems){var X=0;for(i=this._aListItems.length-1;i>=0;i--){Q=this._aListItems[i].getContent();if(Q&&(Q.length>0)){n=Q[0].getText();O=this._aListItems[i].data("quickinfo");if((n.toLowerCase().indexOf(j)>=0||(O&&O.toLowerCase().indexOf(j)>=0))||(this._aListItems[i].hasStyleClass("sapUiCompFilterBarGroupListItem")&&X>0)){W=true;if(this._aListItems[i].hasStyleClass("sapUiCompFilterBarGroupListItem")){if(!X){W=false;}}else{X++;}this._aListItems[i].setVisible(W);}else{this._aListItems[i].setVisible(false);}}}}};N.prototype._triggerSearch=function(i){if(!i){return;}var j=i.getParameters();if(!j){return;}var n=j.newValue?j.newValue:"";this._triggerSearchByValue(n);};N.prototype._triggerSearchByValueInFilterDialog=function(j){var n=null,i;var O,Q;var W,X;var Y;var Z;var $=true;j=j.replace(/^\s+|\s+$/g,"").toLowerCase();if(this._mAdvancedAreaFilter){for(n in this._mAdvancedAreaFilter){if(n){W=this._mAdvancedAreaFilter[n];if(W&&W.items){Y=0;Z=0;for(i=0;i<W.items.length;i++){if(W.items[i]&&W.items[i].filterItem){X=W.items[i].filterItem;if(X.getHiddenFilter()){++Y;continue;}if(X.getVisible()){if(j&&W.items[i].formelement){O=X.getLabel();Q=X.getLabelTooltip();if((O.toLowerCase().indexOf(j)>=0||(Q&&Q.toLowerCase().indexOf(j)>=0))){if(X.getPartOfCurrentVariant()){W.items[i].formelement.setVisible(true);}else{++Z;}}else{++Y;W.items[i].formelement.setVisible(false);}}else if(W.items[i].formelement){W.items[i].formelement.setVisible(X.getVisibleInFilterBar()||X.getPartOfCurrentVariant());if(W.link&&!W.link.getVisible()){W.link.setVisible(true);}}}else{++Y;}}}if(W&&W.formcontainer){if(Y===W.items.length){W.formcontainer.setVisible(false);}else{$=false;W.formcontainer.setVisible(true);if(W.link){W.link.setVisible((j&&(Z===0))?false:true);if(j&&(Z>0)){this._setLinkTextAndCount(n,W.link,Z);}else{this._setLinkText(n,W.link);}}}}}}}}if(this._oAddToFilterBarLabel){this._oAddToFilterBarLabel.setVisible(!$);}};N.prototype._triggerSearchInFilterDialog=function(i){if(!i){return;}var j=i.getParameters();if(!j){return;}var n=j.newValue?j.newValue:"";this._sSearchCriteriaInFiltersDialog=n;this._triggerSearchByValueInFilterDialog(n);};N.prototype._generateListItems=function(j,n){q.sap.require("sap.m.CustomListItem");var i;var O,Q;var W;var X=false;if(this.$().closest(".sapUiSizeCompact").length>0){X=true;}if(j&&this._mAdvancedAreaFilter){Q=this._mAdvancedAreaFilter[j];if(Q&&Q.items){for(i=0;i<Q.items.length;i++){var Y=Q.items[i];if(Y&&Y.filterItem){if(!Y.filterItem.getVisible()||Y.filterItem.getHiddenFilter()){continue;}O=new sap.m.CustomListItem();O.setVisible(true);if(!X){O.addStyleClass("sapUiCompFilterBarListItem");}else{O.addStyleClass("sapUiCompFilterBarListItemCompact");}O.data("quickinfo",Y.filterItem.getLabelTooltip());Y.initialPartOfCurrentVariant=Y.filterItem.getPartOfCurrentVariant();Y.initialVisibleInFilterBar=Y.filterItem.getVisibleInFilterBar();O.data('item',Y);W=new L({text:Y.filterItem.getLabel(),tooltip:Y.filterItem.getLabelTooltip()});O.addContent(W);n.addItem(O);if(Y.filterItem.getPartOfCurrentVariant()){n.setSelectedItem(O);}if(Y.filterItem.getMandatory()&&Y.checkbox&&!Y.checkbox.getEnabled()){O.getModeControl().setEnabled(false);}}}}}var Z=this;n.attachSelectionChange(function($){if($){var _=$.getParameters();if(_){var O=_.listItem;if(O){var a1=O.getModeControl();var Y=O.data('item');Z._selectionChangedInAddFiltersDialog(a1,Y);}}}});};N.prototype._rerenderItem=function(i){var j;if(i){j=i.filterItem.getVisible()&&i.filterItem.getVisibleInFilterBar();if(i.container){i.container.setVisible(j);if(j){this._addContainer(i);}}if(i.formelement){i.formelement.setVisible(i.filterItem.getVisible()&&(i.filterItem.getVisibleInFilterBar()||i.filterItem.getPartOfCurrentVariant()));if(i.checkbox){i.checkbox.setSelected(i.filterItem.getVisibleInFilterBar());}}}};N.prototype._rerenderFilters=function(){var i;var n=null;var j=null;if(this._mAdvancedAreaFilter){for(n in this._mAdvancedAreaFilter){if(n&&this._mAdvancedAreaFilter[n]&&this._mAdvancedAreaFilter[n].items){for(i=0;i<this._mAdvancedAreaFilter[n].items.length;i++){j=this._mAdvancedAreaFilter[n].items[i];this._rerenderItem(j);}}}}this._updateToolbarText();};N.prototype.rerenderFilters=function(){this._rerenderFilters();};N.prototype._closeAddRemoveFiltersDialog=function(i,j){if(i&&j){if(this._sSearchCriteriaInFiltersDialog&&this._oFilterDialog){this._triggerSearchByValueInFilterDialog(this._sSearchCriteriaInFiltersDialog);}else{this._setLinkText(i,j);}}};N.prototype._cancelAddRemoveFiltersDialog=function(j){var i;var n;if(j&&this._mAdvancedAreaFilter&&this._mAdvancedAreaFilter[j]&&this._mAdvancedAreaFilter[j].items){for(i=0;i<this._mAdvancedAreaFilter[j].items.length;i++){n=this._mAdvancedAreaFilter[j].items[i];if((n.initialPartOfCurrentVariant!==undefined||n.initialVisibleInFilterBar!==undefined)&&n.filterItem){if(n.filterItem.getHiddenFilter()){continue;}if((n.initialPartOfCurrentVariant!==undefined)&&(n.filterItem.getPartOfCurrentVariant()!==n.initialPartOfCurrentVariant)){n.filterItem.setPartOfCurrentVariant(n.initialPartOfCurrentVariant);this._notifyAboutChangedFilters(n.initialPartOfCurrentVariant,n.control);}if((n.initialVisibleInFilterBar!==undefined)&&(n.filterItem.getVisibleInFilterBar()!==n.initialVisibleInFilterBar)){n.filterItem.setVisibleInFilterBar(n.initialVisibleInFilterBar);}}}}if(this._oVariantManagement&&(this._oVariant.modified2!==undefined)){this._oVariantManagement.currentVariantSetModified(this._oVariant.modified2);}};N.prototype._createAddRemoveFiltersDialog=function(j,n){q.sap.require("sap.m.Dialog");q.sap.require("sap.m.ListMode");var i,O=this;if(!j){return;}this._oDialog=new sap.m.Dialog(this.getId()+"-set-filters-dialog",{stretch:D.system.phone,resizable:true,draggable:true});this._oDialog.addStyleClass("sapUiPopupWithPadding");this._oDialog.addStyleClass("sapUiCompAddRemoveFilterDialog");if(this.$().closest(".sapUiSizeCompact").length>0){this._oDialog.addStyleClass("sapUiSizeCompact");}this._oDialog.setTitle(this._oRb.getText("SELECT_FILTER_FIELDS"));this._oDialog.addStyleClass("sapMH4FontSize");this._oDialog.addStyleClass("sapMH4Style");this._oDialog.setVerticalScrolling(true);var Q=new B();var W=new S({placeholder:this._oRb.getText("FILTER_BAR_SEARCH")});this._oSearchField=W;W.attachLiveChange(function($){O._triggerSearch($);});Q.addContentRight(W);this._oDialog.setSubHeader(Q);var X=new e({mode:sap.m.ListMode.MultiSelect});X.setShowSeparators(f.None);this._oDialog.addContent(X);this._generateListItems(j,X);this._aListItems=X.getItems();for(i=0;i<this._aListItems.length;i++){X.addItem(this._aListItems[i]);}if(this._oVariant&&this._oVariantManagement){this._oVariant.modified2=this._oVariantManagement.currentVariantGetModified();}this._bOKButtonAddRemoveFilterDialogTriggered=false;var Y=new a(this.getId()+"-btnOKAddRemoveDialog",{text:this._oRb.getText("FILTER_BAR_OK")});Y.attachPress(function(){O._bOKButtonAddRemoveFilterDialogTriggered=true;O._oDialog.close();});this._oDialog.addAggregation("buttons",Y);this._oDialog.setInitialFocus(this._oSearchField);if(this._sSearchCriteriaInFiltersDialog){this._oSearchField.setValue(this._sSearchCriteriaInFiltersDialog);this._triggerSearchByValue(this._sSearchCriteriaInFiltersDialog);}var Z=new a(this.getId()+"-btnCancelAddRemoveDialog",{text:this._oRb.getText("FILTER_BAR_CANCEL"),press:function(){O._oDialog.close();}});this._oDialog.addAggregation("buttons",Z);this._oDialog.attachBeforeClose(function(){if(!O._bOKButtonAddRemoveFilterDialogTriggered){O._cancelAddRemoveFiltersDialog(j);}O.rerenderFilters();O._closeAddRemoveFiltersDialog(j,n);if(O._oFilterDialog){O._oFilterDialog.invalidate();}});this._oDialog.attachAfterClose(function(){this._aListItems=null;O._oDialog.destroy();O._oDialog=null;});this._oDialog.open();};N.prototype._selectionChangedInAddFiltersDialog=function(i,j){var n=i.getSelected();if(!n&&j.filterItem.getMandatory()&&!j.checkbox.getEnabled()){i.setSelected(true);return;}j.filterItem.setPartOfCurrentVariant(n);j.filterItem.setVisibleInFilterBar(n);this._notifyAboutChangedFilters(n,j.control);};N.prototype._setTriggerFilterChangeState=function(i){this._triggerFilterChangeState=i;};N.prototype._getTriggerFilterChangeState=function(){return this._triggerFilterChangeState;};N.prototype._setConsiderFilterChanges=function(i){this._filterChangeSemaphore=i;};N.prototype._getConsiderFilterChanges=function(){return this._filterChangeSemaphore;};N.prototype.fireFilterChange=function(i){this._updateToolbarText();if(!this._getTriggerFilterChangeState()){return;}if(this._getConsiderFilterChanges()&&this._oVariantManagement&&this._oVariantManagement.getEnabled()){this._oVariantManagement.currentVariantSetModified(true);}if(this._oFilterDialog&&!(this._oFilterDialog.isOpen())){return;}this._bDirtyViaDialog=true;this.fireEvent("filterChange",i);if(this._isNewFilterBarDesign()){}};N.prototype._notifyAboutChangedFilters=function(i,j){var O,n=this._determineByControl(j);if(i){O={"added":j,"filterItem":n};}else{O={"deleted":j,"filterItem":n};}this.fireFilterChange(O);};N.prototype._determineVariantFiltersInfo=function(j,O){var i;var n=null,Q,W;var X=[];if(this._mAdvancedAreaFilter){for(n in this._mAdvancedAreaFilter){if(n){if(this._mAdvancedAreaFilter[n].items){for(i=0;i<this._mAdvancedAreaFilter[n].items.length;i++){Q=this._mAdvancedAreaFilter[n].items[i];if(j||Q.filterItem.getVisible()){W={group:Q.filterItem.getGroupName(),name:Q.filterItem.getName(),partOfCurrentVariant:Q.filterItem.getPartOfCurrentVariant(),visibleInFilterBar:Q.filterItem.getVisibleInFilterBar(),visible:Q.filterItem.getVisible()};if(O||this._considerFilter(W)){X.push(W);}}}}}}}return X;};N.prototype.mergeVariant=function(i,j){var n={};q.extend(true,n,j);n.filterbar=[];n.filterBarVariant={};q.extend(true,n.filterbar,i.filterbar);q.extend(true,n.filterBarVariant,i.filterBarVariant);if(j&&j.version==="V2"){n.filterbar=this._mergeVariantFields(n.filterbar,j.filterbar);n.filterBarVariant=j.filterBarVariant;}return n;};N.prototype._mergeVariantFields=function(j,n){var i;n.forEach(function(O){for(i=0;i<j.length;i++){if((j[i].group===O.group)&&(j[i].name===O.name)){j.splice(i,1);break;}}});return j.concat(n);};N.prototype._isUi2Mode=function(){if(this._oVariantManagement instanceof p){return true;}return false;};N.prototype._isDeltaHandling=function(){if(this._isUi2Mode()){return false;}return this.getDeltaVariantMode();};N.prototype._getStandardVariant=function(){return this._oVariantManagement.getStandardVariant(this);};N.prototype._considerFilter=function(j){if(!this._isDeltaHandling()){return true;}var n=null;var O=this._getStandardVariant();if(O&&O.filterbar){for(var i=0;i<O.filterbar.length;i++){if((O.filterbar[i].group===j.group)&&(O.filterbar[i].name===j.name)){n=O.filterbar[i];break;}}}if(!n){if(!j.partOfCurrentVariant){return false;}return true;}if((n.partOfCurrentVariant!==j.partOfCurrentVariant)||(n.visibleInFilterBar!==j.visibleInFilterBar)||(n.visible!==j.visible)){return true;}return false;};N.prototype._addControlToAdvancedArea=function(i,j,n){var O=new A({label:i.getLabelControl(this.getId()),fields:[(j!==null)?j:new T()]});n.addFormElement(O);};N.prototype._determineVisibility=function(i){var j=false;if(i){j=i.getVisible()&&(i.getVisibleInFilterBar()||i.getPartOfCurrentVariant());j=j&&!i.getHiddenFilter();}return j;};N.prototype._retrieveVisibleAdvancedItems=function(){var i,n=null,j;var O=[];if(this._mAdvancedAreaFilter){for(n in this._mAdvancedAreaFilter){if(n){if(this._mAdvancedAreaFilter[n]&&this._mAdvancedAreaFilter[n].items){for(i=0;i<this._mAdvancedAreaFilter[n].items.length;i++){j=this._mAdvancedAreaFilter[n].items[i];if(j){if(this._determineVisibility(j.filterItem)){O.push(j);}}}}}}}return O;};N.prototype._retrieveCurrentSelectionSet=function(W,j){var i,n,O,Q=[];var X=this._retrieveVisibleAdvancedItems();for(i=0;i<X.length;i++){n=X[i];if(n.control&&n.filterItem&&(j||!n.filterItem._isParameter())){if(W){O={name:X[i].filterItem.getName(),control:X[i].control};}else{O=X[i].control;}Q.push(O);}}return Q;};N.prototype.search=function(){var i={};i.selectionSet=this._retrieveCurrentSelectionSet(false);this.fireSearch(i);return true;};N.prototype.clear=function(){var i={};i.selectionSet=this._retrieveCurrentSelectionSet(false);this._clearErrorState();this.fireClear(i);this._updateToolbarText();};N.prototype.reset=function(){var i={};i.selectionSet=this._retrieveCurrentSelectionSet(false);this.fireReset(i);this._resetVariant();};N.prototype._resetVariant=function(){var i=null,j=null;this._resetFiltersInErrorValueState();if(this._oVariantManagement){var n=this._oVariantManagement.getSelectionKey();if(n){i=this._oVariantManagement.getVariantContent(this,n);if(this._oVariant){this._oVariant.content=i;this._oVariant.modified=false;if(this.getPersistencyKey()&&this._oInitialVariant){this._oInitialVariant.content=i;this._oInitialVariant.modified=false;this._oInitialVariant.key=n;}}if(!this.getPersistencyKey()&&(this.getUseSnapshot()===undefined)&&this._oInitialVariant&&this._oInitialVariant.content){j=this._oInitialVariant.content;}if(i||j){this.applyVariant(i||j,"RESET");}}}this._resetFilterBarSearch();};N.prototype._resetFilterBarSearch=function(){this._sSearchCriteriaInFiltersDialog="";if(this._oFiltersSearchField){this._oFiltersSearchField.setValue(this._sSearchCriteriaInFiltersDialog);this._triggerSearchByValueInFilterDialog(this._sSearchCriteriaInFiltersDialog);}};N.prototype._applyVariant=function(i,j,n){var O,Q=null,W,X=false;if(i){if(n){W=this._getTriggerFilterChangeState();this._setTriggerFilterChangeState(false);}this._setConsiderFilterChanges(false);O=i.filterBarVariant;Q=i.filterbar;this._ensureFilterLoaded(Q);this._reapplyVisibility(Q);this._applyVariantFields(O);if(this._oBasicSearchField&&this._oBasicSearchField.setValue){this._oBasicSearchField.setValue(""||i.basicSearch);}if(i.executeOnSelection){X=i.executeOnSelection;}this.fireAfterVariantLoad(j,X);this._setConsiderFilterChanges(true);this._updateToolbarText();if(X||(this.getLiveMode&&this.getLiveMode())){this.search();}else{this._clearErrorState();}if(n){this._setTriggerFilterChangeState(W);}}};N.prototype._fetchVariantFiltersData=function(){if(this._fRegisteredFetchData){try{return this._fRegisteredFetchData();}catch(i){q.sap.log.error("callback for fetching data throws an exception");}}else{q.sap.log.warning("no callback for fetch data supplied");}return null;};N.prototype._applyVariantFields=function(j){if(this._fRegisteredApplyData){try{return this._fRegisteredApplyData(j);}catch(i){q.sap.log.error("callback for applying data throws an exception");}}else{q.sap.log.warning("no callback for appy data supplied");}};N.prototype._isStandardVariant=function(){var i=this.getCurrentVariantId();if(!i){return true;}if(this._oVariantManagement){if((i===this._oVariantManagement.getStandardVariantKey())){return true;}if(this._oVariantManagement._oStandardVariant===null){return true;}}return false;};N.prototype.isCurrentVariantExecuteOnSelectEnabled=function(){if(this._oVariantManagement&&this._oVariantManagement.getEnabled()){var i=this.getCurrentVariantId();if(!i){return this._oVariantManagement.getExecuteOnSelectForStandardVariant();}var j=this._oVariantManagement.getItemByKey(i);if(j){return j.getExecuteOnSelection();}}return false;};N.prototype.fetchVariant=function(){var i,j={},n;if(this._isDeltaHandling()){if(!this._isStandardVariant()){j.version="V2";}}this.fireBeforeVariantFetch();i=this._determineVariantFiltersInfo(true,!j.version);j.filterbar=(!i)?[]:i;j.filterBarVariant=this._fetchVariantFiltersData();n=this._getBasicSearchValue();if(n){j.basicSearch=n;}if(this._oVariant&&this._oVariant.content){this._oVariant.content=j;}return j;};N.prototype.applyVariant=function(i,j,n){if(i.version==="V2"){i=this.mergeVariant(this._getStandardVariant(),i,j);}this._applyVariant(i,j,n);if(n&&this._isNewFilterBarDesign()){}};N.prototype.determineMandatoryFilterItems=function(){var i;var j=[];var n=this._retrieveVisibleAdvancedItems();for(i=0;i<n.length;i++){if(n[i].filterItem.getMandatory()===true){if(n[i].control){j.push(n[i].filterItem);}}}return j;};N.prototype.determineControlByFilterItem=function(j,O){var i,n=null;var Q,W;if(!j||(!O&&j._isParameter())){return null;}if(this._aBasicAreaSelection){for(i=0;i<this._aBasicAreaSelection.length;i++){Q=this._aBasicAreaSelection[i];if(j===Q.filterItem){return Q.control;}}}if(this._mAdvancedAreaFilter){for(n in this._mAdvancedAreaFilter){if(n){W=this._mAdvancedAreaFilter[n];if(W&&W.items){for(i=0;i<W.items.length;i++){Q=W.items[i];if((O||!Q.filterItem._isParameter())&&(j===Q.filterItem)){return Q.control;}}}}}}return null;};N.prototype.determineControlByName=function(n,i){var j=this._determineEnsuredItemByName(n,i);if(j&&j.filterItem&&!j.filterItem._isParameter()){return j.control;}return null;};N.prototype.determineLabelByName=function(n,i){var j=this._determineEnsuredItemByName(n,i);if(j&&j.filterItem){return j.filterItem._oLabel;}return null;};N.prototype._determineEnsuredItemByName=function(n,i){if(!i){i=this._determineGroupNameByName(n);}this._ensureFilterLoaded([{name:n,group:i}]);return this._determineItemByName(n,i);};N.prototype._determineGroupNameByName=function(n){if(this._aFields){for(var i=0;i<this._aFields.length;i++){if(this._aFields[i].fieldName===n){return this._aFields[i].groupName;}}}var j=this._determineFilterItemByName(n);if(j){var O=j.getGroupName();if(O!==N.INTERNAL_GROUP){return O;}}return null;};N.prototype._determineItemByName=function(n,j){var i;var O,Q;var W=j;if(!n){return null;}if(!W){W=N.INTERNAL_GROUP;}if(this._mAdvancedAreaFilter){Q=this._mAdvancedAreaFilter[W];if(Q&&Q.items){for(i=0;i<Q.items.length;i++){O=Q.items[i];if(O&&O.filterItem&&(O.filterItem.getName()===n)){return O;}}}}return null;};N.prototype.determineFilterItemByName=function(n){var i=this._determineEnsuredItemByName(n);if(i&&i.filterItem){return i.filterItem;}return null;};N.prototype._determineFilterItemByName=function(i){var n,j;if(this._mAdvancedAreaFilter){for(n in this._mAdvancedAreaFilter){j=this._determineItemByName(i,n);if(j){return j.filterItem;}}}return null;};N.prototype._determineByControl=function(j){var n=null,i;if(this._mAdvancedAreaFilter){for(n in this._mAdvancedAreaFilter){if(n){var O=this._mAdvancedAreaFilter[n];if(O&&O.items){for(i=0;i<O.items.length;i++){if(O.items[i]&&O.items[i].control===j){return O.items[i];}}}}}}return null;};N.prototype._deleteProperties=function(){var n=null,i;if(this._mAdvancedAreaFilter){for(n in this._mAdvancedAreaFilter){if(n){var j=this._mAdvancedAreaFilter[n];if(j&&j.items){if(j.formcontainer){j.formcontainer.destroy();delete j.formcontainer;}if(j.link){delete j.link;}for(i=0;i<j.items.length;i++){if(j.items[i]&&j.items[i].checkbox){delete j.items[i].checkbox;}if(j.items[i]&&j.items[i].formelement){delete j.items[i].formelement;}}}}}}};N.prototype.onAfterRendering=function(i){if(!this._bDoItOnce&&!(this._isPhone()||this._isTablet())){this._bDoItOnce=true;if(this._oHintText&&this._oHintText.getVisible()){this.setFilterBarExpanded(false);}}this._checkAndAdaptFilterWidth();};N.prototype._fHandleResize=function(i){if(!this._isPhone()&&this._oFilterDialog&&this._oFilterDialog.isOpen()&&this._mAdvancedAreaFilter){this._repositionAddToFilterBarLabel();}this._checkAndAdaptFilterWidth();};N.prototype._checkAndAdaptFilterWidth=function(){if(this._isNewFilterBarDesign()&&!this._oFilterDialog){this._adaptFilterWidth();}};N.prototype._adaptFilterWidth=function(){var i;if(!this._oBasicAreaLayout){return;}if(!this._bIsInitialized){return;}var j=this._oBasicAreaLayout.getContent();if(!j){return;}for(i=j.length-1;i>=0;i--){if(!j[i].getVisible()){j.splice(i,1);}}if(j.length<1){return;}var n=this._oBasicAreaLayout.$().width()-1;var O,Q=this._calculateRequiredWidthAndResetToInitialWidth(j);if(Q>n){O=0;}else{O=j[j.length-1].$().width()+16;}var W=0,X=j.length-1;if(this._isPhone()){W++;X++;}var Y=0;for(i=W;i<X;i++){if((O+j[i].$().width()+16)>n){break;}O+=j[i].$().width()+16;Y++;}var Z=Math.floor((n-O)/Y);if((Y===1)&&(Q<n)){Z=Math.floor(Z/3);}if(Z>0){this._increaseFilterWidth(j,Z,n);}};N.prototype._calculateRequiredWidthAndResetToInitialWidth=function(j){var i,n,O=j[j.length-1].$().width()+16;var Q=this._retrieveVisibleAdvancedItems();if(this._isPhone()){O=j[0].$().width()+16;}else{O=j[j.length-1].$().width()+16;}if(this._oBasicSearchFieldContainer&&this._oBasicSearchFieldContainer.$()){this._oBasicSearchFieldContainer.$().width(this.getFilterContainerWidth());this._oBasicSearchFieldContainer.$().css({"min-width":this.getFilterContainerWidth()});this._oBasicSearchFieldContainer.$().css({"max-width":this._oBasicSearchFieldContainer.$().width()*1.5});O+=this._oBasicSearchFieldContainer.$().width();O+=16;}for(i=0;i<Q.length;i++){if(Q[i].filterItem&&Q[i].filterItem.getVisible()&&Q[i].filterItem.getVisibleInFilterBar()){var W=Q[i].container;if(W&&W.$()){if(Q[i].filterWidth){n=W.$().width();if(n!==Q[i].filterWidth){W.$().width(Q[i].filterWidth);n=Q[i].filterWidth;}}else{W.$().width(this.getFilterContainerWidth());n=W.$().width();Q[i].filterWidth=n;}W.$().css({"min-width":n});W.$().css({"max-width":n*1.5});O+=n;O+=16;}}}return O;};N.prototype._increaseFilterWidth=function(j,n,O){var Q,W=0,X=j.length-1;if(this._isPhone()){W++;X++;}for(var i=W;i<X;i++){Q=j[i].$().width()+n;j[i].$().width(Q);}};N.prototype._destroyLazyFilterControl=function(){var j,i;if(this._aFields&&(this._aFields.length>0)){if(this._aFields&&this._aFields.length>0){for(j=0;j<this._aFields.length;j++){i=this._aFields[j];if(i.factory){if(i.control){i.control.destroy();}}}}}};N.prototype._destroyNonVisibleFilterControl=function(){var i,n,j;if(this._mAdvancedAreaFilter){for(n in this._mAdvancedAreaFilter){if(n&&this._mAdvancedAreaFilter[n]&&this._mAdvancedAreaFilter[n].items){for(i=0;i<this._mAdvancedAreaFilter[n].items.length;i++){j=this._mAdvancedAreaFilter[n].items[i];if(j&&j.container){if(this._oBasicAreaLayout&&(this._oBasicAreaLayout.indexOfContent(j.container)<0)){if(j.control&&!j.bDestroyed){j.control.destroy();j.bDestroyed=true;}}}}}}}};N.prototype._destroyFilterControls=function(){if(!this.getAdvancedMode()){this._destroyLazyFilterControl();this._destroyNonVisibleFilterControl();}};N.prototype._registerVariantManagement=function(){if(this._oVariantManagement){this._oVariantManagement.attachSave(this._variantSave,this);this._oVariantManagement.attachAfterSave(this._afterVariantSave,this);}};N.prototype._unregisterVariantManagement=function(){if(this._oVariantManagement){if(this._fInitialiseVariants){this._oVariantManagement.detachInitialise(this._fInitialiseVariants);this._fInitialiseVariants=null;}this._oVariantManagement.detachSave(this._variantSave,this);this._oVariantManagement.detachAfterSave(this._afterVariantSave,this);if((!this.getUseToolbar()||this.getAdvancedMode())&&!this._oVariantManagement.getDomRef()){this._oVariantManagement.destroy();}}};N.prototype.destroy=function(){sap.ui.core.ResizeHandler.deregister(this._hResizeListener);this._hResizeListener=null;this._unregisterVariantManagement();this._destroyFilterControls();G.prototype.destroy.apply(this,arguments);if(this._oDialog){this._oDialog.destroy();this._oDialog=null;}if(this._oFilterDialog){this._oFilterDialog.destroy();this._oFilterDialog=null;}if(this.oModel){this.oModel.destroy();this.oModel=null;}this._aFields=null;this._oHintText=null;this._aBasicAreaSelection=null;this._mAdvancedAreaFilter=null;this._oBasicAreaLayout=null;this._oVariantManagement=null;this._oCollectiveSearch=null;this._oVariant=null;this._fRegisteredFetchData=null;this._fRegisteredApplyData=null;this._fRegisterGetFiltersWithValues=null;this._fRegisteredFilterChangeHandlers=null;this._oSearchButton=null;this._oFiltersButton=null;this._oHideShowButton=null;this._oClearButtonOnFB=null;this._oRestoreButtonOnFB=null;this._oAddToFilterBarLabel=null;this._oBasicSearchField=null;this._oBasicSearchFieldContainer=null;this._oButtonsVLayout=null;};return N;},true);
