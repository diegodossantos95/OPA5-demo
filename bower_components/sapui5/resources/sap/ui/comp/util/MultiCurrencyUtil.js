/*
 * ! SAP UI development toolkit for HTML5 (SAPUI5)

(c) Copyright 2009-2017 SAP SE. All rights reserved
 */
sap.ui.define(["jquery.sap.global"],function(q){"use strict";var M={isMultiCurrency:function(c){return c==="*";},openMultiCurrencyPopover:function(e,a){var s=sap.ui.getCore().byId(a.smartTableId);var A=s.getTable();var b=A.getBinding("rows");var c=a.currency;var C=a.unit;var o=a.template;var d,D;if(!b||!c||!C){return;}var l=e.getSource();var L=l.getParent();if(a.additionalParent){L=L.getParent();}var f=A.getAnalyticalInfoOfRow(A.getRowForCell(L));if(!f){return;}var i,F=[],S=[c,C],t=sap.ui.getCore().getLibraryResourceBundle("sap.ui.comp").getText("SMARTTABLE_MULTI_TOTAL_TITLE")||"Total";if(b.aApplicationFilter){F=[].concat(b.aApplicationFilter);}if(f.groupTotal||f.group){var g=f.groupedColumns;for(i=0;i<g.length;i++){D=sap.ui.getCore().byId(g[i]).getLeadingProperty();if(!D){continue;}d=b.getAnalyticalInfoForColumn(D);if(d){D=d.dimensionPropertyName;}if(D){F.push(new sap.ui.model.Filter(D,sap.ui.model.FilterOperator.EQ,f.context.getProperty(D)));}}t=sap.ui.getCore().getLibraryResourceBundle("sap.ui.comp").getText("SMARTTABLE_MULTI_GROUP_TITLE")||"Subtotal";}else if(!f.grandTotal){var p=Object.getOwnPropertyNames(b.getDimensionDetails());for(i=0;i<p.length;i++){F.push(new sap.ui.model.Filter(p[i],sap.ui.model.FilterOperator.EQ,f.context.getProperty(p[i])));}t=sap.ui.getCore().getLibraryResourceBundle("sap.ui.comp").getText("SMARTTABLE_MULTI_GROUP_TITLE")||"Subtotal";}var h=o.clone();h.unbindProperty("visible");var P=a.smartTableId+"-multiUnitPopover",j,k;j=sap.ui.getCore().byId(P);if(!j){k=new sap.m.List(P+"-detailsList",{showSeparators:"None",ariaLabelledBy:P+"-title"});k.addStyleClass("sapUiContentPadding sapUiCompMultiCurrency");j=new sap.m.ResponsivePopover(P,{content:k});q.sap.syncStyleClass("sapUiSizeCompact",A,j);A.addDependent(j);}if(!k){k=sap.ui.getCore().byId(P+"-detailsList");}j.setTitle(t);j.setPlacement(f.grandTotal?"PreferredTopOrFlip":"PreferredBottomOrFlip");k.bindItems({path:b.getPath(),filters:F,parameters:{select:S.join(",")},templateShareable:false,template:new sap.m.CustomListItem({content:[h]})});j.openBy(l);}};return M;},true);
