/*
 * ! SAP UI development toolkit for HTML5 (SAPUI5)

(c) Copyright 2009-2017 SAP SE. All rights reserved
 */
sap.ui.define(['jquery.sap.global','sap/m/VBoxRenderer','sap/m/Column','sap/m/Label','sap/m/MessageBox','sap/m/Table','sap/m/Text','sap/m/Title','sap/m/OverflowToolbar','sap/m/ToolbarDesign','sap/m/OverflowToolbarButton','sap/m/ToolbarSeparator','sap/m/VBox','sap/ui/comp/library','sap/ui/comp/providers/TableProvider','sap/ui/comp/smartfilterbar/FilterProvider','sap/ui/comp/smartvariants/SmartVariantManagement','sap/ui/model/FilterOperator','sap/ui/model/json/JSONModel','sap/ui/table/AnalyticalColumn','sap/ui/table/AnalyticalTable','sap/ui/table/Column','sap/ui/table/Table','sap/ui/table/TreeTable','sap/ui/comp/personalization/Util','sap/ui/comp/util/FormatUtil','sap/ui/comp/odata/ODataModelUtil','sap/ui/comp/odata/ODataType'],function(q,V,C,L,M,R,T,a,O,b,c,d,f,l,g,F,S,h,J,A,j,k,m,n,P,o,p,r){"use strict";var s=f.extend("sap.ui.comp.smarttable.SmartTable",{metadata:{library:"sap.ui.comp",designTime:true,properties:{entitySet:{type:"string",group:"Misc",defaultValue:null},smartFilterId:{type:"string",group:"Misc",defaultValue:null},ignoredFields:{type:"string",group:"Misc",defaultValue:null},initiallyVisibleFields:{type:"string",group:"Misc",defaultValue:null},requestAtLeastFields:{type:"string",group:"Misc",defaultValue:null},ignoreFromPersonalisation:{type:"string",group:"Misc",defaultValue:null},tableType:{type:"sap.ui.comp.smarttable.TableType",group:"Misc",defaultValue:null},useVariantManagement:{type:"boolean",group:"Misc",defaultValue:true},showVariantManagement:{type:"boolean",group:"Misc",defaultValue:true},useExportToExcel:{type:"boolean",group:"Misc",defaultValue:true},exportType:{type:"sap.ui.comp.smarttable.ExportType",group:"Misc",defaultValue:"GW"},useTablePersonalisation:{type:"boolean",group:"Misc",defaultValue:true},showTablePersonalisation:{type:"boolean",group:"Misc",defaultValue:true},showRowCount:{type:"boolean",group:"Misc",defaultValue:true},header:{type:"string",group:"Misc",defaultValue:null},toolbarStyleClass:{type:"string",group:"Misc",defaultValue:null},enableCustomFilter:{type:"boolean",group:"Misc",defaultValue:true},persistencyKey:{type:"string",group:"Misc",defaultValue:null},useOnlyOneSolidToolbar:{type:"boolean",group:"Misc",defaultValue:false},currentVariantId:{type:"string",group:"Misc",defaultValue:null},editable:{type:"boolean",group:"Misc",defaultValue:false},enableAutoBinding:{type:"boolean",group:"Misc",defaultValue:false},tableBindingPath:{type:"string",group:"Misc",defaultValue:null},editTogglable:{type:"boolean",group:"Misc",defaultValue:false},demandPopin:{type:"boolean",group:"Misc",defaultValue:false},showFullScreenButton:{type:"boolean",group:"Misc",defaultValue:false}},associations:{smartVariant:{type:"sap.ui.core.Control",multiple:false}},aggregations:{customToolbar:{type:"sap.m.Toolbar",multiple:false},semanticObjectController:{type:"sap.ui.comp.navpopover.SemanticObjectController",multiple:false},noData:{type:"sap.ui.core.Control",altTypes:["string"],multiple:false},semanticKeyAdditionalControl:{type:"sap.ui.core.Control",multiple:false}},events:{initialise:{},beforeRebindTable:{},editToggled:{},dataReceived:{},afterVariantInitialise:{},afterVariantSave:{parameters:{currentVariantId:{type:"string"}}},afterVariantApply:{parameters:{currentVariantId:{type:"string"}}},showOverlay:{},fieldChange:{},fullScreenToggled:{parameters:{fullScreen:{type:"boolean"}}},beforeExport:{parameters:{exportSettings:{type:"object"}}}}},renderer:V.render,constructor:function(){f.apply(this,arguments);this._aExistingColumns=[];this._aAlwaysSelect=[];this._oTemplate=null;this._createToolbar();this._oP13nDialogSettings=this.data("p13nDialogSettings");if(typeof this._oP13nDialogSettings==="string"){try{this._oP13nDialogSettings=JSON.parse(this._oP13nDialogSettings);}catch(e){this._oP13nDialogSettings=null;}}this._bIsFilterPanelEnabled=(this._oP13nDialogSettings&&this._oP13nDialogSettings.filter)?this._oP13nDialogSettings.filter.visible!==false:true;this._createTable();}});s.prototype.init=function(){sap.m.FlexBox.prototype.init.call(this);this.addStyleClass("sapUiCompSmartTable");this.setFitContainer(true);this._aColumnKeys=[];this._mLazyColumnMap={};};s.prototype._getVariantManagementControl=function(e){var i=null;if(e){if(typeof e==='string'){i=sap.ui.getCore().byId(e);}else{i=e;}if(i){if(!(i instanceof S)){q.sap.log.error("Control with the id="+e.getId?e.getId():e+" not of expected type");return null;}}}return i;};s.prototype._createVariantManagementControl=function(){if(this._oVariantManagement||(!this.getUseVariantManagement()&&!this.getUseTablePersonalisation())||!this.getPersistencyKey()){return;}var e=new sap.ui.comp.smartvariants.PersonalizableInfo({type:"table",keyName:"persistencyKey",dataSource:"TODO"});e.setControl(this);var i=this.getSmartVariant();if(i){this._oVariantManagement=this._getVariantManagementControl(i);}else if(this._oSmartFilter&&this._oSmartFilter.data("pageVariantPersistencyKey")){i=this._oSmartFilter.getSmartVariant();if(i){this._oVariantManagement=this._getVariantManagementControl(i);}}else{this._oVariantManagement=new S(this.getId()+"-variant",{showShare:true});}if(this._oVariantManagement){this._oVariantManagement.addPersonalizableControl(e);this._oVariantManagement.attachSave(this._variantSaved,this);this._oVariantManagement.attachAfterSave(this._variantAfterSave,this);this._oVariantManagement.initialise(this._variantInitialised,this);}};s.prototype._variantInitialised=function(){if(!this._oCurrentVariant){this._oCurrentVariant="STANDARD";}this.fireAfterVariantInitialise();if(this._oVariantManagement&&!this._oVariantManagement.getEnabled()){this._checkAndTriggerBinding();}};s.prototype._variantSaved=function(){if(this._oPersController){this._oPersController.setPersonalizationData(this._oCurrentVariant);}};s.prototype._variantAfterSave=function(){this.fireAfterVariantSave({currentVariantId:this.getCurrentVariantId()});};s.prototype.setUseExportToExcel=function(u){if(u===this.getUseExportToExcel()){return;}this.setProperty("useExportToExcel",u,true);if(this.bIsInitialised&&this._oToolbar){this._createToolbarContent();}};s.prototype.setExportType=function(e){if(e===this.getExportType()){return;}this.setProperty("exportType",e,true);if(this.bIsInitialised&&this._oToolbar){this._createToolbarContent();}};s.prototype.setUseTablePersonalisation=function(u){this.setProperty("useTablePersonalisation",u,true);};s.prototype.setShowTablePersonalisation=function(e){this.setProperty("showTablePersonalisation",e,true);if(this._oTablePersonalisationButton){this._oTablePersonalisationButton.setVisible(e);}};s.prototype.setUseVariantManagement=function(u){this.setProperty("useVariantManagement",u,true);if(this._oPersController){this._oPersController.setResetToInitialTableState(!u);}};s.prototype.setShowVariantManagement=function(e){this.setProperty("showVariantManagement",e,true);if(this._oVariantManagement&&!this._oVariantManagement.isPageVariant()){this._oVariantManagement.setVisible(e);if(this._oSeparator){this._oSeparator.setVisible(e);}}};s.prototype.setToolbarStyleClass=function(e){this.setProperty("toolbarStyleClass",e,true);};s.prototype.setCustomToolbar=function(e){if(this._oCustomToolbar){this.removeItem(this._oCustomToolbar);}this._oCustomToolbar=e;};s.prototype.getCustomToolbar=function(){return this._oCustomToolbar;};s.prototype.setHeader=function(t){var e=this.getProperty("header"),i;this.setProperty("header",t,true);if(this.bIsInitialised&&this._oToolbar){i=(!e===!t);if(!i){this._createToolbarContent();}else{this._refreshHeaderText();}}};s.prototype.setShowRowCount=function(e){this.setProperty("showRowCount",e,true);this._refreshHeaderText();};s.prototype.setShowFullScreenButton=function(e){this.setProperty("showFullScreenButton",e,true);if(this._oFullScreenButton){this._oFullScreenButton.setVisible(e);}};s.prototype.setEditTogglable=function(e){this.setProperty("editTogglable",e,true);if(this._oEditButton){this._oEditButton.setVisible(e);}};s.prototype.setEditable=function(e){this.setProperty("editable",e,true);if(this._oEditModel){this._oEditModel.setProperty("/editable",e);}if(this._oEditButton){this._oEditButton.setIcon(e?"sap-icon://display":"sap-icon://edit");}if(this._isMobileTable&&this._oTable.setKeyboardMode){this._oTable.setKeyboardMode(e?"Edit":"Navigation");}};s.prototype.setDemandPopin=function(D){var e=this.getDemandPopin();if(e===D){return;}this.setProperty("demandPopin",D,true);if(this.bIsInitialised){if(D){this._updateColumnsPopinFeature();}else{this._deactivateColumnsPopinFeature();}}};s.prototype._refreshHeaderText=function(){if(!this._headerText){return;}var t=this.getHeader();this._headerText.setVisible(!!t);if(this.getShowRowCount()){var i=parseInt(this._getRowCount(true),10);q.sap.require("sap.ui.core.format.NumberFormat");var v=sap.ui.core.format.NumberFormat.getFloatInstance().format(i);t+=" ("+v+")";}this._headerText.setText(t);};s.prototype._addFullScreenButton=function(){if(this._oFullScreenButton){this._oToolbar.removeContent(this._oFullScreenButton);}if(this.getShowFullScreenButton()){if(!this._oFullScreenButton){this._oFullScreenButton=new c(this.getId()+"-btnFullScreen",{press:function(){this._toggleFullScreen(!this.bFullScreen);}.bind(this)});}this._renderFullScreenButton();this._oToolbar.addContent(this._oFullScreenButton);}};s.prototype._createToolbar=function(){var e=null;if(!this._oToolbar){e=this.getCustomToolbar();if(e){this._oToolbar=e;}else{this._oToolbar=new O({design:sap.m.ToolbarDesign.Transparent});this._oToolbar.addStyleClass("sapUiCompSmartTableToolbar");if(this.getToolbarStyleClass()){this._oToolbar.addStyleClass(this.getToolbarStyleClass());}}this._oToolbar.setLayoutData(new sap.m.FlexItemData({shrinkFactor:0}));}};s.prototype._toggleFullScreen=function(v,e){if(!this._oFullScreenButton||(v===this.bFullScreen&&!e)){return;}this.bFullScreen=v;if(!this._oFullScreenUtil){this._oFullScreenUtil=sap.ui.requireSync("sap/ui/comp/util/FullScreenUtil");}this._oFullScreenUtil.toggleFullScreen(this,this.bFullScreen,this._oFullScreenButton,this._toggleFullScreen.bind(this,false));this._renderFullScreenButton();this.fireFullScreenToggled({fullScreen:v});};s.prototype._renderFullScreenButton=function(){var e=sap.ui.getCore().getLibraryResourceBundle("sap.ui.comp"),t;t=this.bFullScreen?e.getText("CHART_MINIMIZEBTN_TOOLTIP"):e.getText("CHART_MAXIMIZEBTN_TOOLTIP");this._oFullScreenButton.setTooltip(t);this._oFullScreenButton.setText(t);this._oFullScreenButton.setIcon(this.bFullScreen?"sap-icon://exit-full-screen":"sap-icon://full-screen");};s.prototype._createToolbarContent=function(){if(!this._oToolbar){this._createToolbar();}this._addVariantManagementToToolbar();this._addSeparatorToToolbar();this._addHeaderToToolbar();this._addSpacerToToolbar();this._addEditTogglableToToolbar();this._addTablePersonalisationToToolbar();this._addExportToExcelToToolbar();this._addFullScreenButton();this._bToolbarInsertedIntoItems=true;this.insertItem(this._oToolbar,0);};s.prototype._addEditTogglableToToolbar=function(){var B;if(this._oEditButton){this._oToolbar.removeContent(this._oEditButton);}if(this.getEditTogglable()){if(!this._oEditButton){B=sap.ui.getCore().getLibraryResourceBundle("sap.ui.comp").getText("TABLE_EDITTOGGLE_TOOLTIP");this._oEditButton=new sap.m.OverflowToolbarButton(this.getId()+"-btnEditToggle",{icon:this.getEditable()?"sap-icon://display":"sap-icon://edit",text:B,tooltip:B,press:function(){var e=this.getEditable();e=!e;this.setEditable(e,true);this.fireEditToggled({editable:e});}.bind(this)});}this._oToolbar.addContent(this._oEditButton);}};s.prototype._addHeaderToToolbar=function(){if(this._headerText){this._oToolbar.removeContent(this._headerText);}if(!this._headerText){this._headerText=new a(this.getId()+"-header");this._headerText.addStyleClass("sapMH4Style");this._headerText.addStyleClass("sapUiCompSmartTableHeader");}this._refreshHeaderText();this._oToolbar.insertContent(this._headerText,0);};s.prototype._addSeparatorToToolbar=function(){if(this._oSeparator){this._oToolbar.removeContent(this._oSeparator);}if(this.getHeader()&&this.getUseVariantManagement()&&this._oVariantManagement&&!this._oVariantManagement.isPageVariant()){if(!this._oSeparator){this._oSeparator=new d(this.getId()+"-toolbarSeperator");if(!this.getShowVariantManagement()){this._oSeparator.setVisible(false);}}this._oToolbar.insertContent(this._oSeparator,0);if(!this._oToolbar.getHeight()){this._oToolbar.addStyleClass("sapUiCompSmartTableToolbarHeight");}}};s.prototype._addVariantManagementToToolbar=function(){if(this._oVariantManagement&&!this._oVariantManagement.isPageVariant()){this._oToolbar.removeContent(this._oVariantManagement);if(this.getUseVariantManagement()){this._oToolbar.insertContent(this._oVariantManagement,0);if(!this._oVariantManagement.isPageVariant()){this._oVariantManagement.setVisible(this.getShowVariantManagement());}}}};s.prototype._addSpacerToToolbar=function(){var e=false,I=this._oToolbar.getContent(),i,t;if(I){t=I.length;i=0;for(i;i<t;i++){if(I[i]instanceof sap.m.ToolbarSpacer){e=true;break;}}}if(!e){this._oToolbar.addContent(new sap.m.ToolbarSpacer(this.getId()+"-toolbarSpacer"));}};s.prototype._addTablePersonalisationToToolbar=function(){var B;if(this._oTablePersonalisationButton){this._oToolbar.removeContent(this._oTablePersonalisationButton);}if(this.getUseTablePersonalisation()){if(!this._oTablePersonalisationButton){B=sap.ui.getCore().getLibraryResourceBundle("sap.ui.comp").getText("TABLE_PERSOBTN_TOOLTIP");this._oTablePersonalisationButton=new sap.m.OverflowToolbarButton(this.getId()+"-btnPersonalisation",{icon:"sap-icon://action-settings",text:B,tooltip:B,press:function(e){this._oPersController.openDialog();}.bind(this)});this._oTablePersonalisationButton.setVisible(this.getShowTablePersonalisation());}this._oToolbar.addContent(this._oTablePersonalisationButton);}};s.prototype._addExportToExcelToToolbar=function(){if(this._oUseExportToExcel){this._oToolbar.removeContent(this._oUseExportToExcel);}if(this.getUseExportToExcel()&&(this._bTableSupportsExcelExport||this.getExportType()==="UI5Client")){var B;if(!this._oUseExportToExcel){B=sap.ui.getCore().getLibraryResourceBundle("sap.ui.comp").getText("TABLE_EXPORT_TEXT");this._oUseExportToExcel=new sap.m.OverflowToolbarButton(this.getId()+"-btnExcelExport",{icon:"sap-icon://excel-attachment",text:B,tooltip:B,press:function(e){if(this.getExportType()==="UI5Client"){this._triggerUI5ClientExport();return;}var D=function(){var t=this._getRowBinding();var u=t.getDownloadUrl("xlsx");u=this._removeExpandParameter(u);if(u&&u.length>2048&&sap.ui.Device.browser.msie){M.error(sap.ui.getCore().getLibraryResourceBundle("sap.ui.comp").getText("DOWNLOAD_TOO_COMPLEX_TEXT"));return;}var E={url:u};this.fireBeforeExport({exportSettings:E});window.open(E.url);}.bind(this);var i=this._getRowCount();if(i>10000){M.confirm(sap.ui.getCore().getLibraryResourceBundle("sap.ui.comp").getText("DOWNLOAD_CONFIRMATION_TEXT",i),{actions:[M.Action.YES,M.Action.NO],onClose:function(t){if(t===M.Action.YES){D();}}});}else{D();}}.bind(this)});this._setExcelExportEnableState();}this._oToolbar.addContent(this._oUseExportToExcel);}};s.prototype._triggerUI5ClientExport=function(){var e=sap.ui.getCore().loadLibrary("sap.ui.export",true);e.then(function(){var t=this._oTable.getColumns(),i,u=t.length,v,w,x,y,z,B,D=[];if(this._isMobileTable&&t.length){t=t.sort(function(N,Q){return N.getOrder()-Q.getOrder();});}for(i=0;i<u;i++){y=null;v=t[i];if(v.getVisible()){if(v.getLeadingProperty){y=v.getLeadingProperty();}w=v.data("p13nData");if(w){if(!y){y=w["leadingProperty"];}}if(y){if(v.getLabel){x=v.getLabel();}else if(v.getHeader){x=v.getHeader();}z=v.getWidth().toLowerCase()||w.width||"";if(z.indexOf("em")>0){z=Math.round(parseFloat(z));}else if(z.indexOf("px")>0){z=Math.round(parseInt(z,10)/16);}B=w.type==="numeric"?"number":w.type;if(w.isCurrency){B="currency";}else if(B!="date"&&r.isDateOrTime(w.edmType)){B=r.getDefaultValueTypeName(w.edmType);if(B==="DateTimeOffset"){B="DateTime";}}D.push({columnId:v.getId(),property:y,width:z,label:(x&&x.getText)?x.getText():y,textAlign:v.getHAlign(),type:B,unitProperty:B==="currency"?w.unit:null,displayUnit:B==="currency",precision:w.precision,scale:w.scale});}}}var E=this._getRowBinding();var G=this.getModel();var H=this.getHeader();var I=this._getRowCount();var K={workbook:{columns:D},dataSource:{type:"odata",dataUrl:E.getDownloadUrl&&E.getDownloadUrl("json"),serviceUrl:G.sServiceUrl,headers:G.getHeaders(),count:I,useBatch:G.bUseBatch},fileName:H};this.fireBeforeExport({exportSettings:K});sap.ui.require(["sap/ui/export/Spreadsheet"],function(N){new N(K).build();});}.bind(this));};s.prototype._removeExpandParameter=function(u){var e=u.replace(new RegExp("([\\?&]\\$expand=[^&]+)(&?)"),function(i,t,v){return v?t.substring(0,1):"";});return e;};s.prototype._getRowCount=function(e){var i=this._getRowBinding();if(!i){return 0;}var t=0;if(e&&i.getTotalSize){t=i.getTotalSize();}else{t=i.getLength();}if(t<0||t==="0"){t=0;}return t;};s.prototype._setExcelExportEnableState=function(){if(this._oUseExportToExcel){var i=this._getRowCount();this._oUseExportToExcel.setEnabled(i>0);}};s.prototype._createPersonalizationController=function(){if(this._oPersController||!this.getUseTablePersonalisation()){return;}var e=this._oP13nDialogSettings;e=this._setIgnoreFromPersonalisationToSettings(e);q.sap.require("sap.ui.comp.personalization.Controller");this._oPersController=new sap.ui.comp.personalization.Controller({table:this._oTable,columnKeys:this._aColumnKeys,setting:e,resetToInitialTableState:!this.getUseVariantManagement(),beforePotentialTableChange:this._beforePersonalisationModelDataChange.bind(this),afterPotentialTableChange:this._afterPersonalisationModelDataChange.bind(this),afterP13nModelDataChange:this._personalisationModelDataChange.bind(this),requestColumns:this._personalisationRequestColumns.bind(this)});};s.prototype._setIgnoreFromPersonalisationToSettings=function(e){var i=P.createArrayFromString(this.getIgnoreFromPersonalisation());if(i.length){if(!e){e={};}var t=function(u){if(!e[u]){e[u]={};}e[u].ignoreColumnKeys=i;};t("filter");t("sort");t("group");t("columns");}return e;};s.prototype._getRowBinding=function(){if(this._oTable){return this._oTable.getBinding(this._sAggregation);}};s.prototype.setEntitySet=function(e){this.setProperty("entitySet",e);this._initialiseMetadata();};s.prototype.propagateProperties=function(){f.prototype.propagateProperties.apply(this,arguments);this._initialiseMetadata();};s.prototype._initialiseMetadata=function(){if(!this.bIsInitialised){p.handleModelInit(this,this._onMetadataInitialised);}};s.prototype._onMetadataInitialised=function(){this._bMetaModelLoadAttached=false;if(!this.bIsInitialised){this._createTableProvider();if(this._oTableProvider){this._aTableViewMetadata=this._oTableProvider.getTableViewMetadata();if(this._aTableViewMetadata){if(!this._isMobileTable&&this.getDemandPopin()){this.setDemandPopin(false);q.sap.log.error("use SmartTable property 'demandPopin' only  with responsive table, property has been set to false");}this.bIsInitialised=true;this._bTableSupportsExcelExport=this._oTableProvider.getSupportsExcelExport();this._listenToSmartFilter();this._createVariantManagementControl();this._createToolbarContent();this._aAlwaysSelect=this._oTableProvider.getRequestAtLeastFields();this._createContent();this._createPersonalizationController();this._oEditModel=new J({editable:this.getEditable()});this.setModel(this._oEditModel,"sm4rtM0d3l");this.fireInitialise();if(!this._oVariantManagement||(this._oVariantManagement&&this._bVariantInitialised)){this._checkAndTriggerBinding();}}}}};s.prototype._checkAndTriggerBinding=function(){if(!this._bAutoBindingTriggered){this._bAutoBindingTriggered=true;if(this.getEnableAutoBinding()){if(this._oSmartFilter){this._oSmartFilter.search();}else{this._reBindTable();}}}};s.prototype._createTableProvider=function(){var e,E,i;E=this.getEntitySet();i=this.getIgnoredFields();e=this.getModel();if(e&&E){if(this._aExistingColumns.length){if(i){i+=","+this._aExistingColumns.toString();}else{i=this._aExistingColumns.toString();}}this._oTableProvider=new g({entitySet:E,ignoredFields:i,initiallyVisibleFields:this.getInitiallyVisibleFields(),isEditableTable:this.getEditable(),smartTableId:this.getId(),isAnalyticalTable:!!this._isAnalyticalTable,isMobileTable:!!this._isMobileTable,dateFormatSettings:this.data("dateFormatSettings"),currencyFormatSettings:this.data("currencyFormatSettings"),defaultDropDownDisplayBehaviour:this.data("defaultDropDownDisplayBehaviour"),useSmartField:this.data("useSmartField"),useSmartToggle:this.data("useSmartToggle"),skipAnnotationParse:this.data("skipAnnotationParse"),lineItemQualifier:this.data("lineItemQualifier"),presentationVariantQualifier:this.data("presentationVariantQualifier"),enableInResultForLineItem:this.data("enableInResultForLineItem"),_semanticKeyAdditionalControl:this.getAggregation("semanticKeyAdditionalControl"),model:e,semanticObjectController:this.getSemanticObjectController()});}};s.prototype._listenToSmartFilter=function(){var e=null;e=this.getSmartFilterId();this._oSmartFilter=this._findControl(e);if(this._oSmartFilter){this._oSmartFilter.attachSearch(this._reBindTable,this);this._oSmartFilter.attachFilterChange(this._filterChangeEvent,this);this._setNoDataText(sap.ui.getCore().getLibraryResourceBundle("sap.ui.comp").getText("SMARTTABLE_NO_DATA"));}};s.prototype._filterChangeEvent=function(){if(this._isTableBound()&&this._oSmartFilter&&!this._oSmartFilter.getLiveMode()&&!this._oSmartFilter.isDialogOpen()){this._showOverlay(true);}};s.prototype._showOverlay=function(e){if(e){var i={show:true};this.fireShowOverlay({overlay:i});e=i.show;}this._oTable.setShowOverlay(e);};s.prototype._findControl=function(i){var e,v;if(i){e=sap.ui.getCore().byId(i);if(!e){v=this._getView();if(v){e=v.byId(i);}}}return e;};s.prototype._getView=function(){if(!this._oView){var e=this.getParent();while(e){if(e instanceof sap.ui.core.mvc.View){this._oView=e;break;}e=e.getParent();}}return this._oView;};s.prototype.rebindTable=function(e){this._reBindTable(null,e);};s.prototype._reBindTable=function(e,t){var u,v,w,i,x,y,z=[],B,E,D,G,H,I,K,N,Q={},U={preventTableBind:false};w=this._getTablePersonalisationData()||{};B=w.filters;E=w.excludeFilters;N=w.sorters;if(this._oSmartFilter){y=this._oSmartFilter.getFilters();Q=this._oSmartFilter.getParameters()||{};}if(y&&y.length){if(E){z=[new sap.ui.model.Filter([y[0],E],true)];}else{z=y;}}else if(E){z=[E];}if(B){B=z.concat(B);}else{B=z;}D=this.getRequestAtLeastFields();if(D){G=D.split(",");}else{G=[];}G=G.concat(this._aAlwaysSelect);I=this._getVisibleColumnPaths();H=I["select"];if(!H||!H.length){H=G;}else{x=G.length;for(i=0;i<x;i++){if(H.indexOf(G[i])<0){H.push(G[i]);}}}if(this._sSelectForGroup&&H.indexOf(this._sSelectForGroup)<0){H.push(this._sSelectForGroup);}if(H.length){Q["select"]=H.toString();K=I["expand"];if(K.length){Q["expand"]=K.join(",");}}Q["useBatchRequests"]=true;if(!N){N=[];}U.filters=B;U.sorter=N;U.parameters=Q;U.length=undefined;U.startIndex=undefined;this.fireBeforeRebindTable({bindingParams:U});if(!U.preventTableBind){N=U.sorter;B=U.filters;Q=U.parameters;H=U.parameters["select"];if(!H||!H.length){M.error(sap.ui.getCore().getLibraryResourceBundle("sap.ui.comp").getText("SMARTTABLE_NO_COLS"),{styleClass:(this.$()&&this.$().closest(".sapUiSizeCompact").length)?"sapUiSizeCompact":""});return;}v=this.getTableBindingPath()||("/"+this.getEntitySet());if(this._oTable.resumeUpdateAnalyticalInfo){this._oTable.resumeUpdateAnalyticalInfo(true,false);}this._bDataLoadPending=true;this._bIgnoreChange=false;if(this._bForceTableUpdate){t=true;this._bForceTableUpdate=false;}if(!t){u=this._oTable.getBinding(this._sAggregation);if(u&&u.mParameters){t=!(q.sap.equal(Q,u.mParameters,true)&&q.sap.equal(Q.custom,u.mParameters.custom)&&!U.length&&!U.startIndex&&v===u.getPath());}}if(!this._bNoDataUpdated){this._bNoDataUpdated=true;this._setNoDataText();}if(!u||!this._bIsTableBound||t){this._oTable.bindRows({path:v,filters:B,sorter:N,parameters:Q,length:U.length,startIndex:U.startIndex,template:this._oTemplate,events:{dataRequested:function(){this._bIgnoreChange=true;}.bind(this),dataReceived:function(e){if(e&&e.getParameter&&e.getParameter("__simulateAsyncAnalyticalBinding")){return;}this._bIgnoreChange=false;this._onDataLoadComplete(e,true);this.fireDataReceived(e);}.bind(this),change:function(e){if(this._bIgnoreChange){return;}var W,X=false;W=(e&&e.getParameter)?e.getParameter("reason"):undefined;if(!W||W==="filter"||W==="context"){X=true;}if(W==="change"||X){this._onDataLoadComplete(e,X);}}.bind(this)}});this._bIsTableBound=true;}else{u.sort(N);u.filter(B,"Application");}this._showOverlay(false);}};s.prototype._onDataLoadComplete=function(e,i){if(this._bDataLoadPending||i){this._bDataLoadPending=false;this.updateTableHeaderState();}};s.prototype._isTableBound=function(){if(this._bIsTableBound){return true;}if(this._oTable){return this._oTable.isBound(this._sAggregation);}return false;};s.prototype.setNoData=function(N){this._oNoData=N;};s.prototype.getNoData=function(){return this._oNoData;};s.prototype._setNoDataText=function(e){var i=this._oTable.setNoData;if(!i){i=this._oTable.setNoDataText;}if(!i){return;}var N=e;if(!N){N=this.getNoData();}if(!N){N=sap.ui.getCore().getLibraryResourceBundle("sap.ui.comp").getText("SMARTTABLE_NO_RESULTS");}i.call(this._oTable,N,true);};s.prototype.updateTableHeaderState=function(){this._refreshHeaderText();this._setExcelExportEnableState();};s.prototype._createContent=function(){var i,e=0,t,I,u,v=[];if(this._aExistingColumns&&this._aExistingColumns.length){this._aColumnKeys=[].concat(this._aExistingColumns.reverse());}I=this._parseIndexedColumns();e=this._aTableViewMetadata.length;for(i=0;i<e;i++){t=this._aTableViewMetadata[i];if(t.isInitiallyVisible){this._aColumnKeys.push(t.name);}else{v.push(t.name);}if(!(t.isInitiallyVisible||t.inResult)){this._mLazyColumnMap[t.name]=t;}else{u=this._createColumnForField(t);this._oTable.addColumn(u);}}this._insertIndexedColumns(I);this._aColumnKeys=this._aColumnKeys.concat(v);this._updateColumnsPopinFeature();this._storeInitialColumnSettings();};s.prototype._createColumnForField=function(e){var i,I;I=this.getId()+"-"+e.name.replace(/[^A-Za-z0-9_.:-]+/g,"_");i=this._createColumn(e,I);e.isColumnCreated=true;i.data("p13nData",{columnKey:e.name,leadingProperty:e.name,additionalProperty:e.additionalProperty,navigationProperty:e.navigationProperty,sortProperty:e.sortable?e.name:undefined,filterProperty:e.filterable?e.name:undefined,fullName:e.hasValueListAnnotation?e.fullName:null,type:e.filterType,maxLength:e.maxLength,precision:e.precision,scale:e.scale,align:e.align,edmType:e.type,isCurrency:e.isCurrencyField,unit:e.unit,width:e.width,aggregationRole:e.aggregationRole});if(e.filterable&&i.setFilterProperty){i.setFilterProperty(e.name);}if(e.sortable&&i.setSortProperty){i.setSortProperty(e.name);}this._registerContentTemplateEvents(e.template);return i;};s.prototype._parseIndexedColumns=function(){var i,e,t,I,u,v,w,x,y;var z=this._oTable.getColumns();var B=null;if(this._oTemplate&&this._oTemplate.getCells){B=this._oTemplate.getCells();}if(!z){return null;}I=[];e=z.length;for(i=0;i<e;i++){t=z[i];u=t.data("p13nData");v=null;w=null;if(u){v=u.columnIndex;w=u.columnKey;}x=-1;if(v!==null&&v!==undefined){x=parseInt(v,10);}if(!isNaN(x)&&x>-1){if(B){y=B[i];this._oTemplate.removeCell(y);}else{y=null;}this._aColumnKeys.splice(i-I.length,1);I.push({index:x,columnKey:w,column:t,template:y});this._oTable.removeColumn(t);}}I.sort(function(D,E){return D.index-E.index;});return I;};s.prototype._insertIndexedColumns=function(I){var i,e,t;if(!I){return;}e=I.length;for(i=0;i<e;i++){t=I[i];this._aColumnKeys.splice(t.index,0,t.columnKey);this._oTable.insertColumn(t.column,t.index);if(t.template){this._oTemplate.insertCell(t.template,t.index);}}};s.prototype._updateColumnsPopinFeature=function(){if(!this._isMobileTable||!this.getDemandPopin()){return;}var e=this._oTable.getColumns();if(!e){return;}e=e.filter(function(v){return v.getVisible();});e.sort(function(v,w){return v.getOrder()-w.getOrder();});var t,u=e.length;for(var i=0;i<u;i++){t=e[i];if(i<2){t.setDemandPopin(false);t.setMinScreenWidth("1px");}else{t.setDemandPopin(true);if(t.getPopinDisplay()!="WithoutHeader"){t.setPopinDisplay(sap.m.PopinDisplay.Inline);}t.setMinScreenWidth((i+1)*10+"rem");}}};s.prototype._storeInitialColumnSettings=function(){this._aInitialSorters=[];P.createSort2Json(this._oTable,this._aInitialSorters,P.createArrayFromString(this.getIgnoreFromPersonalisation()));};s.prototype._deactivateColumnsPopinFeature=function(){if(!this._isMobileTable){return;}var e=this._oTable.getColumns();if(!e){return;}var t,u=e.length;for(var i=0;i<u;i++){t=e[i];t.setDemandPopin(false);t.setMinScreenWidth("1px");}};s.prototype._registerContentTemplateEvents=function(t){if(t&&t.attachChange){t.attachChange(function(e){this.fireFieldChange({changeEvent:e});}.bind(this));}};s.prototype._updateInitialColumns=function(){var i=this._oTable.getColumns(),t=i?i.length:0,u,v,w;while(t--){w=null;u=i[t];if(u){v=u.data("p13nData");if(typeof v==="string"){try{v=JSON.parse(v);}catch(e){}if(v){u.data("p13nData",v);}}if(v){w=v["columnKey"];}if(w){this._aExistingColumns.push(w);}}}};s.prototype._getVisibleColumnPaths=function(){var e={},t=[],E=[],u=this._oTable.getColumns(),i,v=u?u.length:0,w,x,y,z,B;var D=function(y,G){var H,I;if(y){I=y.split(",");H=I.length;while(H--){y=I[H];if(y&&G.indexOf(y)<0){G.push(y);}}}};for(i=0;i<v;i++){w=u[i];y=null;if(w.getVisible()){if(w.getLeadingProperty){y=w.getLeadingProperty();}x=w.data("p13nData");if(x){if(!y){y=x["leadingProperty"];}z=x["additionalProperty"];B=x["navigationProperty"];}if(y&&t.indexOf(y)<0){t.push(y);}D(z,t);D(B,E);}}e["select"]=t;e["expand"]=E;return e;};s.prototype._createTable=function(){var e=this.getItems(),i=e?e.length:0,t,I;this._sAggregation="rows";while(i--){t=e[i];if(t instanceof m||t instanceof R){break;}t=null;}if(t){this._oTable=t;if(t instanceof j){this._isAnalyticalTable=true;}else if(t instanceof R){this._isMobileTable=true;this._oTemplate=(t.getItems()&&t.getItems().length>0)?t.getItems()[0]:new sap.m.ColumnListItem();t.removeAllItems();}else if(t instanceof n){this._isTreeTable=true;}this._updateInitialColumns();}else{I=this.getId()+"-ui5table";if(this.getTableType()==="AnalyticalTable"){this._isAnalyticalTable=true;this._oTable=new j(I,{enableCustomFilter:true});}else if(this.getTableType()==="ResponsiveTable"){this._isMobileTable=true;this._oTable=new R(I,{growing:true});this._oTemplate=new sap.m.ColumnListItem();}else if(this.getTableType()==="TreeTable"){this._isTreeTable=true;this._oTable=new n(I,{selectionMode:sap.ui.table.SelectionMode.MultiToggle});}else{this._oTable=new m(I,{selectionMode:sap.ui.table.SelectionMode.MultiToggle});}if(this._oTable.setVisibleRowCountMode){this._oTable.setVisibleRowCountMode(sap.ui.table.VisibleRowCountMode.Auto);}this.insertItem(this._oTable,2);}if(!this._oTable.getLayoutData()){if(this._oTable instanceof sap.m.Table||(this._oTable.getVisibleRowCountMode&&this._oTable.getVisibleRowCountMode()!==sap.ui.table.VisibleRowCountMode.Auto)){this._oTable.setLayoutData(new sap.m.FlexItemData({growFactor:1,baseSize:"auto"}));}else{this._oTable.setLayoutData(new sap.m.FlexItemData({growFactor:1,baseSize:"0%"}));}}if(this._oTable.addAriaLabelledBy){this._oTable.addAriaLabelledBy(this.getId()+"-header");}this._oTable.addStyleClass("sapUiCompSmartTableInnerTable");this._oTable.setEnableBusyIndicator(true);this._oTable.setBusyIndicatorDelay(100);if(this._oTable.setEnableCustomFilter){this._oTable.setEnableCustomFilter(this.getEnableCustomFilter());}if(this._oTable.setShowColumnVisibilityMenu){this._oTable.setShowColumnVisibilityMenu(false);}if(this._oTable.getEnableCustomFilter&&this._oTable.getEnableCustomFilter()&&this._bIsFilterPanelEnabled){if(this._oTable.setEnableCellFilter){this._oTable.setEnableCellFilter(false);}if(this._oTable.attachCustomFilter){this._oTable.attachCustomFilter(this._showTableFilterDialog.bind(this));}}if(this._isAnalyticalTable){this._createColumn=this._createAnalyticalColumn;}else if(this._isMobileTable){this._sAggregation="items";this._createColumn=this._createMobileColumn;this._oTable.bindRows=this._oTable.bindItems;}if(!this._isMobileTable){this._oTable.attachEvent("_rowsUpdated",function(){this._setExcelExportEnableState();},this);}if(this._oTable._setLargeDataScrolling){this._oTable._setLargeDataScrolling(true);}};s.prototype.getTable=function(){return this._oTable;};s.prototype._showTableFilterDialog=function(e){if(this._oPersController){this._oPersController.openDialog({filter:{visible:true,payload:{column:e.getParameter("column")}}});}};s.prototype._createColumn=function(e,i){var t;t=new k(i,{autoResizable:true,hAlign:e.align,width:e.width,visible:e.isInitiallyVisible,label:new L(i+"-header",{textAlign:e.align,text:e.label}),sorted:e.sorted,sortOrder:e.sortOrder,tooltip:e.quickInfo,showSortMenuEntry:e.sortable,showFilterMenuEntry:e.filterable&&this._bIsFilterPanelEnabled,name:e.fieldName,template:e.template});return t;};s.prototype._createAnalyticalColumn=function(e,i){var t;if(e.isCurrencyField&&e.template.addStyleClass){e.template.addStyleClass("sapUiCompCurrencyBold");}t=new A(i,{autoResizable:true,hAlign:e.align,width:e.width,visible:e.isInitiallyVisible,inResult:e.inResult,label:new L(i+"-header",{textAlign:e.align,text:e.label}),tooltip:e.quickInfo,sorted:e.sorted,sortOrder:e.sortOrder,grouped:e.grouped,showIfGrouped:e.grouped,showSortMenuEntry:e.sortable,showFilterMenuEntry:e.filterable&&this._bIsFilterPanelEnabled,summed:e.summed,leadingProperty:e.name,template:e.template});return t;};s.prototype._createMobileColumn=function(e,i){var t;t=new C(i,{hAlign:e.align,visible:e.isInitiallyVisible,header:new T(i+"-header",{textAlign:e.align,text:e.label,tooltip:e.quickInfo}),tooltip:e.quickInfo,width:e.isImageURL?"3em":undefined});if(this._oTemplate){this._oTemplate.addCell(e.template);}return t;};s.prototype.fetchVariant=function(){if(this._oCurrentVariant==="STANDARD"||this._oCurrentVariant===null){return{};}return this._oCurrentVariant;};s.prototype.applyVariant=function(v,e){this._oCurrentVariant=v;if(this._oCurrentVariant==="STANDARD"){this._oCurrentVariant=null;}P.recoverPersonalisationDateData(this._oCurrentVariant,this._oTable);if(e==="STANDARD"){this._oApplicationDefaultVariant=this._oCurrentVariant;}if(this._oApplicationDefaultVariant&&!e){this._oCurrentVariant=q.extend(true,{},this._oApplicationDefaultVariant,v);}this._bApplyingVariant=true;if(this._oTable._setSuppressRefresh){this._oTable._setSuppressRefresh(true);}if(this._oPersController){if(this._oCurrentVariant===null||q.isEmptyObject(this._oCurrentVariant)){this._oPersController.resetPersonalization(sap.ui.comp.personalization.ResetType.ResetFull);}else{this._oPersController.setPersonalizationData(this._oCurrentVariant);}}this._bApplyingVariant=false;this.fireAfterVariantApply({currentVariantId:this.getCurrentVariantId()});};s.prototype.variantsInitialized=function(){this._bVariantInitialised=true;this._checkAndTriggerBinding();};s.prototype._personalisationRequestColumns=function(e){var t=e.getParameter("columnKeys"),u,i,v,w,x,y={};v=t.length;for(i=0;i<v;i++){u=t[i];w=this._mLazyColumnMap[u];if(w){x=this._createColumnForField(w);if(this._isMobileTable){this._oTable.addColumn(x);}y[w.name]=x;}}this._oPersController.addColumns(y);};s.prototype._beforePersonalisationModelDataChange=function(e){if(this._oTable.suspendUpdateAnalyticalInfo){this._oTable.suspendUpdateAnalyticalInfo();}};s.prototype._afterPersonalisationModelDataChange=function(e){this._updateColumnsPopinFeature();};s.prototype._personalisationModelDataChange=function(e){this._oCurrentVariant=e.getParameter("persistentData");var i=e.getParameter("changeType");var t=this._getChangeStatus(i);if(t===sap.ui.comp.personalization.ChangeType.Unchanged){return;}if(!this._bApplyingVariant){if(!this.getUseVariantManagement()){this._persistPersonalisation();}else if(this._oVariantManagement){this._oVariantManagement.currentVariantSetModified(true);}}if(t===sap.ui.comp.personalization.ChangeType.ModelChanged&&this._isTableBound()){if(i&&i.columns===sap.ui.comp.personalization.ChangeType.ModelChanged){this._bForceTableUpdate=true;}if(this._oSmartFilter){this._oSmartFilter.search();}else{this._reBindTable(null);}}};s.prototype._getChangeStatus=function(e){if(!e){return sap.ui.comp.personalization.ChangeType.ModelChanged;}if(e.sort===sap.ui.comp.personalization.ChangeType.ModelChanged||e.filter===sap.ui.comp.personalization.ChangeType.ModelChanged||e.columns===sap.ui.comp.personalization.ChangeType.ModelChanged||e.group===sap.ui.comp.personalization.ChangeType.ModelChanged){return sap.ui.comp.personalization.ChangeType.ModelChanged;}if(e.sort===sap.ui.comp.personalization.ChangeType.TableChanged||e.filter===sap.ui.comp.personalization.ChangeType.TableChanged||e.columns===sap.ui.comp.personalization.ChangeType.TableChanged||e.group===sap.ui.comp.personalization.ChangeType.TableChanged){return sap.ui.comp.personalization.ChangeType.TableChanged;}return sap.ui.comp.personalization.ChangeType.Unchanged;};s.prototype._getTablePersonalisationData=function(){if(!this._oCurrentVariant){return null;}var e=[],i=[],E=[],t,G,u,v,w,x,y,z,B="",I;this._sSelectForGroup=null;if(this._isMobileTable&&this._oCurrentVariant.group&&this._oCurrentVariant.group.groupItems){G=this._oCurrentVariant.group.groupItems[0];w=this._getColumnByKey(G.columnKey);if(w){B=w.getHeader().getText();}z=this._getPathFromColumnKeyAndProperty(G.columnKey,"sortProperty");if(z){y=z;u=new sap.ui.model.Sorter(y,G.operation==="GroupDescending",function(D){var K=D.getProperty(y);return{key:K,text:B?B+" : "+K:K};});this._sSelectForGroup=y;e.push(u);}}if(this._oCurrentVariant.sort){v=this._oCurrentVariant.sort.sortItems;}else{v=this._aInitialSorters;}if(v){v.forEach(function(D){var H=D.operation==="Descending";z=this._getPathFromColumnKeyAndProperty(D.columnKey,"sortProperty");if(z){if(u&&u.sPath===z){u.bDescending=H;}else{e.push(new sap.ui.model.Sorter(z,H));}}},this);}if(this._oCurrentVariant.filter){this._oCurrentVariant.filter.filterItems.forEach(function(D){var H=D.value1,K=D.value2;z=null;I=false;w=this._getColumnByKey(D.columnKey);if(w){if(w.getFilterProperty){z=w.getFilterProperty();}x=w.data("p13nData");if(x){I=x.type==="time";if(!z){z=x["filterProperty"];}}}if(z){if(I){if(H instanceof Date){H=o.getEdmTimeFromDate(H);}if(K instanceof Date){K=o.getEdmTimeFromDate(K);}}else if(H instanceof Date&&this._oTableProvider&&this._oTableProvider.getIsUTCDateHandlingEnabled()){H=F.getDateInUTCOffset(H);K=K?F.getDateInUTCOffset(K):K;}if(D.exclude){E.push(new sap.ui.model.Filter(z,h.NE,H));}else{i.push(new sap.ui.model.Filter(z,D.operation,H,K));}}},this);if(E.length){t=new sap.ui.model.Filter(E,true);}}return{filters:i,excludeFilters:t,sorters:e};};s.prototype._getColumnByKey=function(e){var t,u,v,i,w;if(this._oTable){t=this._oTable.getColumns();v=t.length;for(i=0;i<v;i++){u=t[i];w=u.data("p13nData");if(w&&w.columnKey===e){return u;}}}return null;};s.prototype._getPathFromColumnKeyAndProperty=function(e,i){var t=null,u,v;u=this._getColumnByKey(e);if(u){if(i=="sortProperty"&&u.getSortProperty){t=u.getSortProperty();}else if(i=="filterProperty"&&u.getFilterProperty){t=u.getFilterProperty();}else if(i=="leadingProperty"&&u.getLeadingProperty){t=u.getLeadingProperty();}if(!t){v=u.data("p13nData");if(v){t=v[i];}}}return t;};s.prototype._persistPersonalisation=function(){if(this._oVariantManagement&&!this._oVariantManagement.isPageVariant()){this._oVariantManagement.getVariantsInfo(function(v){var e,i=null;if(v&&v.length>0){i=v[0].key;}e=i!==null;this._oVariantManagement.fireSave({name:"Personalisation",global:false,overwrite:e,key:i,def:true});}.bind(this));}};s.prototype.getCurrentVariantId=function(){return this._oVariantManagement?this._oVariantManagement.getCurrentVariantId():"";};s.prototype.setCurrentVariantId=function(v){if(this._oVariantManagement&&!this._oVariantManagement.isPageVariant()){this._oVariantManagement.setCurrentVariantId(v);}else{q.sap.log.error("sap.ui.comp.smarttable.SmartTable.prototype.setCurrentVariantId: VariantManagement does not exist, or is a page variant");}};s.prototype.isInitialised=function(){return!!this.bIsInitialised;};s.prototype._aAvailablePanels=["Columns","Sort","Filter","Group"];s.prototype.openPersonalisationDialog=function(e){if(!e||this._aAvailablePanels.indexOf(e)<0){q.sap.log.warning("sap.ui.comp.smarttable.SmartTable.prototype.openPersonalisationDialog: "+e+" is not a valid panel!");return;}if(this._oPersController){var i={};i[e.toLowerCase()]={visible:true};this._oPersController.openDialog(i);}};s.prototype.exit=function(){var i,e;if(this._oSmartFilter){this._oSmartFilter.detachSearch(this._reBindTable,this);this._oSmartFilter.detachFilterChange(this._filterChangeEvent,this);this._oSmartFilter=null;}if(this._oTableProvider&&this._oTableProvider.destroy){this._oTableProvider.destroy();}this._oTableProvider=null;if(this._oPersController&&this._oPersController.destroy){this._oPersController.destroy();}this._oPersController=null;if(this._oVariantManagement){this._oVariantManagement.detachSave(this._variantSaved,this);this._oVariantManagement.detachAfterSave(this._variantAfterSave,this);if(!this._oVariantManagement.isPageVariant()&&this._oVariantManagement.destroy){this._oVariantManagement.destroy();}}if(this._oFullScreenUtil){this._oFullScreenUtil.cleanUpFullScreen(this);this._oFullScreenUtil=null;}if(this._oEditModel){this._oEditModel.destroy();}if(this._oNoData&&this._oNoData.destroy){this._oNoData.destroy();}this.oNoData=null;if(this._aTableViewMetadata){i=this._aTableViewMetadata.length;while(i--){e=this._aTableViewMetadata[i];if(e&&!e.isColumnCreated&&e.template){e.template.destroy();}}}this._aTableViewMetadata=null;this._oEditModel=null;this._oVariantManagement=null;this._oCurrentVariant=null;this._oApplicationDefaultVariant=null;this._aExistingColumns=null;this._mLazyColumnMap=null;this._aColumnKeys=null;this._aAlwaysSelect=null;this._oCustomToolbar=null;if(this._oToolbar&&!this._bToolbarInsertedIntoItems){this._oToolbar.destroy();}this._oToolbar=null;if(this._oUseExportToExcel&&!this.getUseExportToExcel()){this._oUseExportToExcel.destroy();}this._oUseExportToExcel=null;this._oTablePersonalisationButton=null;this._oP13nDialogSettings=null;if(this._oTemplate){this._oTemplate.destroy();}this._oTemplate=null;this._oView=null;this._oTable=null;};return s;},true);
