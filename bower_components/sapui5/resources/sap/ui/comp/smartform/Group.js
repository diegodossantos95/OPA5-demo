/*
 * ! SAP UI development toolkit for HTML5 (SAPUI5)

(c) Copyright 2009-2017 SAP SE. All rights reserved
 */
sap.ui.define(['jquery.sap.global','sap/ui/comp/library','sap/ui/core/Element','sap/ui/layout/ResponsiveFlowLayoutData','sap/ui/layout/form/FormContainer','./GroupElement'],function(q,l,E,R,F,G){"use strict";var a=F.extend("sap.ui.comp.smartform.Group",{metadata:{library:"sap.ui.comp",designTime:true,properties:{useHorizontalLayout:{type:"boolean",group:"Misc",defaultValue:null},horizontalLayoutGroupElementMinWidth:{type:"int",group:"Misc",defaultValue:null},label:{type:"string",group:"Misc",defaultValue:null}},defaultAggregation:"groupElements",aggregations:{groupElements:{type:"sap.ui.comp.smartform.GroupElement",multiple:true,singularName:"groupElement"},layout:{type:"sap.ui.layout.GridData",multiple:false}},_visibilityDerived:false}});a.prototype.setUseHorizontalLayout=function(v){var o=this.getUseHorizontalLayout();if(o==v){return this;}this.setProperty("useHorizontalLayout",v);var g=this.getGroupElements();for(var i=0;i<g.length;i++){g[i].setUseHorizontalLayout(v);}this._updateLayoutData();return this;};a.prototype._updateLayoutData=function(){if(this.getUseHorizontalLayout()){var s=this.getParent();while(s&&!s.addGroup&&s.getParent){s=s.getParent();}if(!s||!s.getLayout()||!s.getLayout().getGridDataSpan()){if(!this.getLayoutData()){if(!this._oResponsiveLayout){this._oResponsiveLayout=new R({"linebreak":true,"linebreakable":true});this._oResponsiveLayout._bCreatedByGroup=true;}this.setLayoutData(this._oResponsiveLayout);}}else{this._updateLineBreaks();}}else if(this._oResponsiveLayout&&this.getLayoutData()==this._oResponsiveLayout){this.setLayoutData();this._oResponsiveLayout.setParent(this);}};a.prototype.setHorizontalLayoutGroupElementMinWidth=function(n){var d=this.getHorizontalLayoutGroupElementMinWidth();if(d==n){return this;}q.sap.log.error("HorizontalLayoutGroupElementMinWidth is deprecated",this);this.setProperty("horizontalLayoutGroupElementMinWidth",n);var g=this.getGroupElements();for(var i=0;i<g.length;i++){g[i].setHorizontalLayoutGroupElementMinWidth(n);}return this;};a.prototype.setEditMode=function(e){var g=this.getGroupElements();for(var i=0;i<g.length;i++){g[i].setEditMode(e);}return this;};a.prototype._delegateEditModeFromParent=function(g){var p=null;var e=false;if(g){p=this.getParent();if(p&&p.getEditable){e=p.getEditable();g.setEditMode(e);}}};a.prototype._updateLineBreaks=function(){if(!this.getUseHorizontalLayout()){return;}var s=this.getParent();if(!s){return;}while(s&&!s._getGridDataSpanNumbers&&s.getParent){s=s.getParent();}if(!s._getGridDataSpanNumbers){return;}var S=s._getGridDataSpanNumbers();if(!S){return;}var e=this.getGroupElements();e=e.filter(function(o){return o.getVisible();});var C=0;var d=0;var f=0;var g=0;var L=false;var h=false;var j=false;var k=false;for(var i=0;i<e.length;i++){var o=e[i];C++;d++;f++;g++;if(S.XL*C>12){L=true;C=1;}else{L=false;}if(S.L*d>12){h=true;d=1;}else{h=false;}if(S.M*f>12){j=true;f=1;}else{j=false;}if(S.S*g>12){k=true;g=1;}else{k=false;}o._setLinebreak(L,h,j,k);}};a.prototype._updateGridDataSpan=function(){if(!this.getUseHorizontalLayout()){return;}var g=this.getGroupElements();for(var i=0;i<g.length;i++){g[i]._updateGridDataSpan();}};a.prototype._updateFormContainerVisibility=function(){var A=this.getVisible();if(A===false&&this._visibilityDerived===false){return;}var g=this.getGroupElements();var v=false;v=g.some(function(o){return o.getVisible();});if(A!==v){this._visibilityDerived=true;F.prototype.setVisible.apply(this,[v]);this.fireEvent("_visibleChanged");}};a.prototype.setLabel=function(L){this.setProperty("label",L);var t=this.getTitle();if(t&&(typeof t!=="string")){q.sap.log.error("Title already set, Label can not be set",this);}else{this.setTitle(L);}return this;};a.prototype.setVisible=function(v){F.prototype.setVisible.apply(this,arguments);this._visibilityDerived=false;this.fireEvent("_visibleChanged");return this;};a.prototype.addGroupElement=function(g){return this.addFormElement(g);};a.prototype.insertGroupElement=function(g,i){return this.insertFormElement(g,i);};a.prototype.getGroupElements=function(){return this.getFormElements();};a.prototype.indexOfGroupElement=function(g){return this.indexOfFormElement(g);};a.prototype.removeGroupElement=function(g){return this.removeFormElement(g);};a.prototype.removeAllGroupElements=function(){return this.removeAllFormElements();};a.prototype.destroyGroupElements=function(){return this.destroyFormElements();};a.prototype.addFormElement=function(g){if(!g){return this;}g=this.validateAggregation("groupElements",g,true);g.setUseHorizontalLayout(this.getUseHorizontalLayout());g.setHorizontalLayoutGroupElementMinWidth(this.getHorizontalLayoutGroupElementMinWidth());g.attachVisibleChanged(this._updateFormContainerVisibility,this);_.call(this,g);F.prototype.addFormElement.apply(this,arguments);this._delegateEditModeFromParent(g);this._updateFormContainerVisibility();if(this.getUseHorizontalLayout()){g._updateGridDataSpan();this._updateLineBreaks();}return this;};a.prototype.insertFormElement=function(g,i){if(!g){return this;}g=this.validateAggregation("groupElements",g,true);g.setUseHorizontalLayout(this.getUseHorizontalLayout());g.setHorizontalLayoutGroupElementMinWidth(this.getHorizontalLayoutGroupElementMinWidth());g.attachVisibleChanged(this._updateFormContainerVisibility,this);_.call(this,g);F.prototype.insertFormElement.apply(this,arguments);this._delegateEditModeFromParent(g);this._updateFormContainerVisibility();if(this.getUseHorizontalLayout()){g._updateGridDataSpan();this._updateLineBreaks();}return this;};a.prototype.removeFormElement=function(g){var o=F.prototype.removeFormElement.apply(this,arguments);if(o){o.detachVisibleChanged(this._updateFormContainerVisibility,this);c.call(this,o);if(this.getGroupElements().length>0){this._updateFormContainerVisibility();this._updateLineBreaks();}}return o;};a.prototype.removeAllFormElements=function(){var g=F.prototype.removeAllFormElements.apply(this,arguments);for(var i=0;i<g.length;i++){var o=g[i];o.detachVisibleChanged(this._updateFormContainerVisibility,this);c.call(this,o);}return g;};a.prototype.setLayout=function(L){L=this.validateAggregation("layout",L,false);return this.setLayoutData(L);};a.prototype.getLayout=function(){return this.getLayoutData();};a.prototype.destroyLayout=function(L){return this.destroyLayoutData();};a.prototype.addCustomData=function(C){if(!C){return this;}F.prototype.addCustomData.apply(this,arguments);var g=this.getGroupElements();for(var i=0;i<g.length;i++){b.call(this,g[i],C);}return this;};a.prototype.insertCustomData=function(C,I){if(!C){return this;}F.prototype.insertCustomData.apply(this,arguments);var g=this.getGroupElements();for(var i=0;i<g.length;i++){b.call(this,g[i],C);}return this;};a.prototype.removeCustomData=function(C){var o=F.prototype.removeCustomData.apply(this,arguments);if(o){var g=this.getGroupElements();for(var i=0;i<g.length;i++){c.call(this,g[i],o.getId());}}return o;};a.prototype.removeAllCustomData=function(){var C=F.prototype.removeAllCustomData.apply(this,arguments);if(C.length>0){var g=this.getGroupElements();for(var i=0;i<g.length;i++){c.call(this,g[i]);}}return C;};a.prototype.destroyCustomData=function(){F.prototype.destroyCustomData.apply(this,arguments);var g=this.getGroupElements();for(var i=0;i<g.length;i++){c.call(this,g[i]);}return this;};function _(g){var C=this.getCustomData();for(var i=0;i<C.length;i++){b.call(this,g,C[i]);}}function b(g,C){if(sap.ui.comp.smartform.inheritCostomDataToFields(C)){var n=C.clone();n._bFromGroup=true;n._sOriginalId=C.getId();g.addCustomData(n);}}function c(g,o){var C=g.getCustomData();for(var i=0;i<C.length;i++){var d=C[i];if(d._bFromGroup&&(!o||o==d._sOriginalId)){g.removeCustomData(d);}}}a.prototype.clone=function(I,L){var g=this.removeAllGroupElements();var C=F.prototype.clone.apply(this,arguments);for(var i=0;i<g.length;i++){var o=g[i];var d=o.clone(I,L);this.addGroupElement(o);C.addGroupElement(d);}return C;};return a;},true);
