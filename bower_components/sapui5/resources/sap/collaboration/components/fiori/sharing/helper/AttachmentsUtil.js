/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 * 
 * (c) Copyright 2009-2017 SAP SE. All rights reserved
 */
jQuery.sap.declare("sap.collaboration.components.fiori.sharing.helper.AttachmentsUtil");jQuery.sap.require("sap.collaboration.components.utils.CommonUtil");sap.ui.base.Object.extend("sap.collaboration.components.fiori.sharing.helper.AttachmentsUtil",{constructor:function(l,o,j){this.oCommonUtil=new sap.collaboration.components.utils.CommonUtil();this.oLangBundle=l;this.oODataUtil=o;this.oJamODataModel=j;},createFileSelectionDialog:function(p,a,o,w,h){var b=function(e){var v=e.getParameter("value");var f=new sap.ui.model.Filter("name",sap.ui.model.FilterOperator.Contains,v);var B=e.getSource().getBinding("items");B.filter([f]);};this.oFileSelectionDialog=new sap.m.SelectDialog(p+"_FileSelectionDialog",{multiSelect:true,rememberSelections:true,title:this.oLangBundle.getText("ATTACHMENTS_FIELD_TEXT",[""]),confirm:o,search:b,liveChange:b});if(w){this.oFileSelectionDialog.setContentWidth(w.toString()+"px");}if(h){this.oFileSelectionDialog.setContentHeight(h.toString()+"px");}var i=new sap.m.StandardListItem({title:"{name}",icon:"{icon}",iconDensityAware:false,iconInset:true,type:sap.m.ListType.Active});this.oFileSelectionDialog.setModel(a);this.oFileSelectionDialog.bindAggregation("items","/attachments",i);return this.oFileSelectionDialog;},createAttachmentsModel:function(f){var a=[];for(var i=0;i<f.length;i++){a.push({name:f[i].getName(),mimeType:f[i].getMimeType(),url:f[i].getUrl(),icon:this.oCommonUtil.getIconFromMimeType(f[i].getMimeType())});}var A=new sap.ui.model.json.JSONModel({attachments:a});return A;},createFolderSelectionDialog:function(p,g,o,O,w,h){var s=this;var b=function(e){s.oFolderSelectionDialog.getContent()[0].getController().navigateBack();};var H=new sap.m.Bar(p+"_FolderSelectionDialogHeaderBar",{contentLeft:[new sap.m.Button(p+"_FolderSelectionDialogHeaderBarBackButton",{type:sap.m.ButtonType.Back,visible:false,press:b})],contentMiddle:[new sap.m.Label(p+"_FolderSelectionDialogHeaderBarTitle",{text:this.oLangBundle.getText("TARGET_FOLDER_FIELD_TEXT")})]});var a=new sap.m.Button(p+"_FolderSelectionDialogOKButton",{text:this.oLangBundle.getText("OK_BUTTON_TEXT"),press:function(e){o(e);s.oFolderSelectionDialog.close();}});var c=new sap.m.Button(p+"_FolderSelectionDialogCancelButton",{text:this.oLangBundle.getText("CANCEL_BUTTON_TEXT"),press:function(e){O(e);s.oFolderSelectionDialog.close();}});this.oFolderSelectionDialog=new sap.m.Dialog(p+"_FolderSelectionDialog",{beginButton:a,endButton:c,customHeader:H}).addStyleClass("sapUiPopupWithPadding");var f=this.createFolderSelectionView(p,g,w,h);this.oFolderSelectionDialog.addContent(f);if(sap.ui.Device.system.phone){this.oFolderSelectionDialog.setStretch(true);}return this.oFolderSelectionDialog;},createFolderSelectionView:function(p,g,w,h){var f=sap.ui.view({id:p+"_FolderSelectionView",viewData:{controlId:p,groupId:g,languageBundle:this.oLangBundle,oDataUtil:this.oODataUtil,oDataModel:this.oJamODataModel,folderSelectionDialog:this.oFolderSelectionDialog},type:sap.ui.core.mvc.ViewType.JS,viewName:"sap.collaboration.components.fiori.sharing.FolderSelection"});if(w){f.setWidth(w.toString()+"px");}if(h){f.setHeight(h.toString()+"px");}return f;},getCurrentFolder:function(){if(this.oFolderSelectionDialog){return this.oFolderSelectionDialog.getContent()[0].getController().getCurrentFolder();}return{name:this.oLangBundle.getText("TARGET_FOLDER_FIELD_TEXT"),id:""};},getCurrentGroupId:function(){return this.oFolderSelectionDialog.getContent()[0].getController().sGroupId;},resetFolderSelection:function(g){if(this.oFolderSelectionDialog){this.oFolderSelectionDialog.getContent()[0].getController().sGroupId=g;this.oFolderSelectionDialog.getContent()[0].getController().sCurrentFolderId='';this.oFolderSelectionDialog.getContent()[0].getController().aFolderBuffer=[];}},setCurrentFolderId:function(f){this.oFolderSelectionDialog.getContent()[0].getController().sCurrentFolderId=f;}});
