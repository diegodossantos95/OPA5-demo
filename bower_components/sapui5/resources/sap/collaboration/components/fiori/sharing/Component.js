/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 * 
 * (c) Copyright 2009-2017 SAP SE. All rights reserved
 */
jQuery.sap.require("sap.collaboration.library");jQuery.sap.require("sap.collaboration.components.utils.OdataUtil");jQuery.sap.require("sap.collaboration.components.utils.CommonUtil");jQuery.sap.require("sap.ui.core.UIComponent");jQuery.sap.declare("sap.collaboration.components.fiori.sharing.Component");jQuery.sap.require("sap.m.MessageBox");sap.ui.core.UIComponent.extend("sap.collaboration.components.fiori.sharing.Component",{metadata:{includes:["../../resources/css/Sharing.css"],properties:{width:{type:"sap.ui.core.CSSSize",defaultValue:"100%"},height:{type:"sap.ui.core.CSSSize",defaultValue:"100%"},oDataServiceUrl:{type:"sap.ui.core.URI",defaultValue:"/sap/opu/odata/sap/SM_INTEGRATION_V2_SRV"},collaborationHostODataServiceUrl:{type:"sap.ui.core.URI",defaultValue:"/sap/bc/ui2/smi/rest_tunnel/Jam/api/v1/OData"},tunnelServiceUrl:{type:"sap.ui.core.URI",defaultValue:"/sap/bc/z_sail_httproxy/Jam/api/v1/OData"},object:{type:"object"},attachments:{type:"object"},externalObject:{type:"object"}}},init:function(){this.oCommonUtil=new sap.collaboration.components.utils.CommonUtil();this.oLangBundle=this.oCommonUtil.getLanguageBundle();this.sODataServiceUrl=undefined;this.sTunnelServiceUrl=undefined;this.sJamUrl=undefined;this.oODataUtil=undefined;this.oSharingView=undefined;this.oView=undefined;this.aJamGroups=[];this.bOdataOn=true;},onBeforeRendering:function(){},onAfterRendering:function(){this.logComponentProperties();if(this.bStopRendering===undefined||this.bStopRendering===false){this.oSharingView=this.getSharingView();this.oSharingView.placeAt(this.getId());}},exit:function(){this.oSharingView.destroy();},setSettings:function(s){this.setODataServiceUrl(s.oDataServiceUrl);this.setTunnelServiceUrl(s.tunnelServiceUrl);this.setObject(s.object);this.setAttachments(s.attachments);this.setExternalObject(s.externalObject);},render:function(r){r.write("<div id='"+this.getId()+"' style='width:"+this.getWidth()+";height:"+this.getHeight()+"'");r.write(">");r.write("</div>");},getSharingView:function(){var o;var O;var s;var a=this.getObject();if(a){s=a.id;o=a.display;O=a.share;}var c=this.getComponentData();if(c){this.oDialogComponent=c.dialogComponent;}var b=this;var n=function(){if(!b.oNoGroupsView){b.oNoGroupsView=sap.ui.view({id:b.getId()+"_NoGroupsView",viewData:{controlId:b.getId(),langBundle:b.oLangBundle,jamUrl:b.oSharingView.getController().sJamUrl,},type:sap.ui.core.mvc.ViewType.JS,viewName:"sap.collaboration.components.fiori.sharing.NoGroups"});}b.oSharingView.destroy();b.oSharingView=undefined;b.oNoGroupsView.placeAt(b.getId());};if(!this.oSharingView){this.oSharingView=sap.ui.view({id:this.getId()+"_SharingView",viewData:{controlId:this.getId(),odataServiceUrl:this.systemSettings.oDataServiceUrl,collaborationHostODataServiceUrl:this.systemSettings.collaborationHostODataServiceUrl,collaborationHostRestService:this.systemSettings.collaborationHostRestService,langBundle:this.oLangBundle,jamGroups:this.aJamGroups,sharingDialog:undefined,noGroupsCallBack:n,objectDisplay:o,objectShare:O,objectId:s,attachments:this.getAttachments(),externalObject:this.getExternalObject()},type:sap.ui.core.mvc.ViewType.JS,viewName:"sap.collaboration.components.fiori.sharing.Sharing"});}else{this.oSharingView.getViewData().objectId=s;this.oSharingView.getViewData().objectShare=O;this.oSharingView.getViewData().objectDisplay=o;this.oSharingView.getViewData().externalObject=this.getExternalObject();}if(this.oNoGroupsView){this.oNoGroupsView.destroy();this.oNoGroupsView=undefined;}return this.oSharingView;},shareToJam:function(){this.oSharingView.getController().shareToJam();},logComponentProperties:function(){jQuery.sap.log.debug("Share Component properties:","","sap.collaboration.components.fiori.sharing.Component.logComponentProperties()");jQuery.sap.log.debug("width: "+this.getWidth());jQuery.sap.log.debug("height: "+this.getHeight());jQuery.sap.log.debug("oDataServiceUrl: "+this.getODataServiceUrl());jQuery.sap.log.debug("tunnelServiceUrl: "+this.getTunnelServiceUrl());if(this.getObject()){jQuery.sap.log.debug("object->id: "+this.getObject().id);jQuery.sap.log.debug("object->display: "+this.getObject().display);jQuery.sap.log.debug("object->share: "+this.getObject().share);}else{jQuery.sap.log.debug("object: undefined");}if(this.getAttachments()&&this.getAttachments().attachmentsArray){jQuery.sap.log.debug("Attachments:");var a=this.getAttachments().attachmentsArray;for(var i=0;i<a.length;i++){jQuery.sap.log.debug("Attachments"+(i+1)+":");jQuery.sap.log.debug(a[i].mimeType);jQuery.sap.log.debug(a[i].name);jQuery.sap.log.debug(a[i].url);}}else{jQuery.sap.log.debug("attachments: undefined");}if(this.getExternalObject()){jQuery.sap.log.debug("externalObject->appContext: "+this.getObject().appContext);jQuery.sap.log.debug("externalObject->odataServicePath: "+this.getObject().odataServicePath);jQuery.sap.log.debug("externalObject->collection: "+this.getObject().collection);jQuery.sap.log.debug("externalObject->key: "+this.getObject().key);jQuery.sap.log.debug("object->name: "+this.getObject().name);jQuery.sap.log.debug("object->summary: "+this.getObject().summary);}else{jQuery.sap.log.debug("externalObject: undefined");}}});
