/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)

(c) Copyright 2009-2017 SAP SE. All rights reserved
 */
sap.ui.define(['jquery.sap.global','./library','sap/m/library','sap/ui/core/theming/Parameters'],function(q,l,M,P){"use strict";var L={};L.render=function(r,c){r.write("<div");r.writeControlData(c);r.addClass("sapSuiteLMC");if(!l._isInGenericTile(c)){r.addClass("sapSuiteLMCFocus");}if(c._bSemanticMode){r.addClass("sapSuiteLMCSemanticMode");}if(c._bFocusMode){r.addClass("sapSuiteLMCFocusMode");}if(c.getSize()){r.addClass("sapSuiteLMCSize"+c.getSize());}if(c.hasListeners("press")){r.addClass("sapSuiteUiMicroChartPointer");r.writeAttribute("tabindex","0");}if(c._bNoBottomLabels){r.addClass("sapSuiteLMCNoBottomLabels");}if(c._bNoTopLabels){r.addClass("sapSuiteLMCNoTopLabels");}if(q.inArray(c.getSize(),["S","XS","M"])>=0){r.addClass("sapSuiteLMCSmallFont");}r.writeClasses();var a=c._createTooltipText();r.writeAttribute("role","presentation");r.writeAttributeEscaped("aria-label",a);r.write(">");r.write("<div");r.addClass("sapSuiteLMCSvgWrapper");r.writeClasses();r.write(">");this._renderLabelsTop(r,c);this._renderCanvas(r,c);this._renderLabelsBottom(r,c);r.write("</div>");r.write("</div>");};L._renderCanvas=function(r,c){var p=c.getPoints();var a=p.length;r.write("<div");r.addClass("sapSuiteLMCSvgCanvas");r.writeClasses();r.write(">");r.write("<svg");r.writeAttributeEscaped("id",c.getId()+"-sapSuiteLMCSvgElement");r.writeAttribute("focusable","false");r.addClass("sapSuiteLMCSvgElement");r.writeClasses();r.write(">");if(c._bScalingValid){this._renderThresholdLine(r,c);for(var i=1;i<a;i++){this._renderLine(r,c,c._aNormalizedPoints[i-1].x,c._aNormalizedPoints[i-1].y,c._aNormalizedPoints[i].x,c._aNormalizedPoints[i].y);}}r.write('</svg>');r.write("<div");r.writeAttributeEscaped("id",c.getId()+"-sapSuiteLMCPointsContainer");r.writeClasses();r.write(">");var s=c.getShowPoints(),o,b;if(c._bScalingValid&&(c._bFocusMode||s)){for(var j=0;j<a;j++){o=p[j];b=this._isPointEmphasized(o);if(!c._bFocusMode&&s||c._bFocusMode&&b&&o.getShow()){this._renderPoint(r,c,o,j,b);}}}r.write("</div>");r.write("</div>");};L._renderPoint=function(r,c,p,a,e){var n=c._aNormalizedPoints[a],C=c.getColor();if(n.x<0||n.x>100||n.y<0||n.y>100){return;}r.write("<div");r.addStyle("left",q.sap.encodeHTML(n.x+"%"));r.addStyle("top",q.sap.encodeHTML(100-n.y+"%"));if(c._bFocusMode&&c._bSemanticMode){r.addClass("sapSuiteLMCPoint"+q.sap.encodeHTML(p.getColor()));}else if(!c._bFocusMode&&c._bSemanticMode){if(p.getY()>=c.getThreshold()){if(M.ValueColor[C.above]){r.addClass("sapSuiteLMCPoint"+q.sap.encodeHTML(C.above));}else{r.addStyle("background-color",q.sap.encodeHTML(this._getHexColor(C.above)));}}else if(M.ValueColor[C.below]){r.addClass("sapSuiteLMCPoint"+q.sap.encodeHTML(C.below));}else{r.addStyle("background-color",q.sap.encodeHTML(this._getHexColor(C.below)));}}else if(!c._bSemanticMode&&typeof C==="string"){if(M.ValueColor[C]){r.addClass("sapSuiteLMCPoint"+q.sap.encodeHTML(C));}else{r.addStyle("background-color",q.sap.encodeHTML(this._getHexColor(C)));}}else{r.addClass("sapSuiteLMCPointNeutral");}r.addClass("sapSuiteLMCPoint");if(e&&p.getShow()){r.addClass("sapSuiteLMCPointEmphasized");}r.writeClasses();r.writeStyles();r.write("/>");};L._renderThresholdLine=function(r,c){if(c._fNormalizedThreshold>=0&&c._fNormalizedThreshold<=100&&!c._bThresholdNull){r.write("<line");r.writeAttribute("x1","0%");r.writeAttributeEscaped("y1",(100-c._fNormalizedThreshold)+"%");r.writeAttribute("x2","100%");r.writeAttributeEscaped("y2",(100-c._fNormalizedThreshold)+"%");r.addClass("sapSuiteLMCLineThreshold");r.writeClasses();r.write("/>");}};L._renderLine=function(r,c,s,a,e,b){if(this._isDimensionLineOutsideCanvas(c,s,e,"X")||this._isDimensionLineOutsideCanvas(c,a,b,"Y")){return;}var i,I,d=e-s,f=b-a;if((a-c._fNormalizedThreshold)*(b-c._fNormalizedThreshold)<0){i=s+(c._fNormalizedThreshold-a)*d/f;this._renderLine(r,c,s,a,i,c._fNormalizedThreshold);this._renderLine(r,c,i,c._fNormalizedThreshold,e,b);}else if(a*b<0){i=s-a*d/f;this._renderLine(r,c,s,a,i,0);this._renderLine(r,c,i,0,e,b);}else if((a-100)*(b-100)<0){i=s+(100-a)*d/f;this._renderLine(r,c,s,a,i,100);this._renderLine(r,c,i,100,e,b);}else if(s*e<0){I=a-s*f/d;this._renderLine(r,c,s,a,0,I);this._renderLine(r,c,0,I,e,b);}else if((s-100)*(e-100)<0){I=a+(100-s)*f/d;this._renderLine(r,c,s,a,100,I);this._renderLine(r,c,100,I,e,b);}else{this._displayLine(r,c,s,a,e,b);}};L._displayLine=function(r,c,s,a,e,b){r.write("<line");r.writeAttributeEscaped("x1",s+"%");r.writeAttributeEscaped("y1",(100-a)+"%");r.writeAttributeEscaped("x2",e+"%");r.writeAttributeEscaped("y2",(100-b)+"%");r.addClass("sapSuiteLMCLine");if(c._bSemanticMode&&!c._bFocusMode){if(a>=c._fNormalizedThreshold&&b>=c._fNormalizedThreshold){if(M.ValueColor[c.getColor().above]){r.addClass("sapSuiteLMCLine"+q.sap.encodeHTML(c.getColor().above));}else{r.addStyle("stroke",q.sap.encodeHTML(this._getHexColor(c.getColor().above)));}}else if(M.ValueColor[c.getColor().below]){r.addClass("sapSuiteLMCLine"+q.sap.encodeHTML(c.getColor().below));}else{r.addStyle("stroke",q.sap.encodeHTML(this._getHexColor(c.getColor().below)));}}else if(!c._bSemanticMode&&typeof c.getColor()==="string"){if(M.ValueColor[c.getColor()]){r.addClass("sapSuiteLMCLine"+q.sap.encodeHTML(c.getColor()));}else{r.addStyle("stroke",q.sap.encodeHTML(this._getHexColor(c.getColor())));}}else{r.addClass("sapSuiteLMCLineNeutral");}r.writeStyles();r.writeClasses();r.write("/>");};L._renderLabelsBottom=function(r,c){var s=c.getLeftBottomLabel();if(s&&s.length>0){r.write("<div");r.addClass("sapSuiteLMCLeftBottomLabel");r.addClass("sapSuiteLMCLabel");r.writeClasses();r.write(">");r.writeEscaped(s);r.write("</div>");}var R=c.getRightBottomLabel();if(R&&R.length>0){r.write("<div");r.addClass("sapSuiteLMCRightBottomLabel");r.addClass("sapSuiteLMCLabel");r.writeClasses();r.write(">");r.writeEscaped(R);r.write("</div>");}};L._renderLabelsTop=function(r,c){var t="",T="",p=c.getPoints(),i=p.length,f,o;if(i>=1){f=p[0];o=p[i-1];if(c._bFocusMode&&c._bSemanticMode&&c._bScalingValid){if(this._isPointEmphasized(f)&&f.getShow()){t="sapSuiteLMCLabel"+f.getColor();}else{t="sapSuiteLMCLabelNeutral";}if(this._isPointEmphasized(o)&&o.getShow()){T="sapSuiteLMCLabel"+o.getColor();}else{T="sapSuiteLMCLabelNeutral";}}else if(!c._bFocusMode&&c._bSemanticMode&&c._bScalingValid&&c.getShowPoints()&&M.ValueColor[c.getColor().above]&&M.ValueColor[c.getColor().below]){if(f.getY()>=c.getThreshold()){t="sapSuiteLMCLabel"+c.getColor().above;}else{t="sapSuiteLMCLabel"+c.getColor().below;}if(o.getY()>=c.getThreshold()){T="sapSuiteLMCLabel"+c.getColor().above;}else{T="sapSuiteLMCLabel"+c.getColor().below;}}else{t="sapSuiteLMCLabelNeutral";T="sapSuiteLMCLabelNeutral";}}var s=c.getLeftTopLabel();if(s&&s.length>0){r.write("<div");r.addClass("sapSuiteLMCLeftTopLabel");r.addClass("sapSuiteLMCLabel");r.addClass(q.sap.encodeHTML(t));r.writeClasses();r.write(">");r.writeEscaped(s);r.write("</div>");}var R=c.getRightTopLabel();if(R&&R.length>0){r.write("<div");r.addClass("sapSuiteLMCRightTopLabel");r.addClass("sapSuiteLMCLabel");r.addClass(q.sap.encodeHTML(T));r.writeClasses();r.write(">");r.writeEscaped(c.getRightTopLabel());r.write("</div>");}};L._isPointEmphasized=function(p){return p&&p.getMetadata().getName()==="sap.suite.ui.microchart.LineMicroChartEmphasizedPoint";};L._getHexColor=function(c){return P.get(c)||c;};L._isDimensionLineOutsideCanvas=function(c,s,e,a){var m=100,i=0;if(a==="X"&&c._minXScale===c._maxXScale){m=50;i=50;}else if(a==="Y"&&c._minYScale===c._maxYScale){m=50;i=50;}return((s>=m&&e>=m)&&!(s===m&&e===m))||((s<=i&&e<=i)&&!(s===i&&e===i));};return L;},true);
