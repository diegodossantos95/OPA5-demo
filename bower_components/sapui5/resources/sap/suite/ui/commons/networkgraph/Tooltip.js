sap.ui.define(["jquery.sap.global","./SvgBase","./Line","./Node","./Group","sap/m/Popover","sap/m/List","sap/m/OverflowToolbar","sap/m/PlacementType","sap/m/Button","sap/m/CustomListItem","sap/m/FlexBox","sap/m/HBox","sap/m/IconTabBar","sap/m/IconTabFilter","sap/m/Panel","sap/m/StandardListItem","sap/m/Text","sap/m/ToolbarSpacer","sap/ui/core/Icon","sap/m/FlexItemData","sap/ui/core/library"],function(q,S,L,N,G,P,a,O,b,B,C,F,H,I,c,d,e,T,f,g,h,i){var r=sap.ui.getCore().getLibraryResourceBundle("sap.suite.ui.commons");var j=S.extend("sap.suite.ui.commons.networkgraph.Tooltip",{metadata:{library:"sap.suite.ui.commons",events:{afterOpen:{},afterClose:{}}}});j.prototype.init=function(){this._oPopover=null;this._oElement=null;};j.prototype.create=function(p){this._oPopover=new P(this.getId()+"-tooltip",{showHeader:false,placement:this.getParent()._bIsRtl?b.PreferredLeftOrFlip:b.PreferredRightOrFlip,afterOpen:function(){this.fireAfterOpen();}.bind(this),afterClose:function(){this.fireAfterClose();}.bind(this),beforeOpen:function(){this._fnCreate();}.bind(this),contentMinWidth:"350px"}).addStyleClass("sapSuiteUiCommonsNetworkTooltip");this.addDependent(this._oPopover);this._oPopover._afterAdjustPositionAndArrowHook=function(){var $=this.$("arrow"),t=this.$().position().top,A=$.position().top,k=15,w=q(window).height(),n=t+A-k;if(w>n+this.$().height()){$.css("top",k);this.$().css("top",n);}};};j.prototype.instantClose=function(){this._oPopover.oPopup.close(0);};j.prototype.close=function(){this._oPopover.close();};j.prototype.openDetail=function(A){this._fnCreate=this._createDetail;this._oElement=A.item;this._oPopover.openBy(A.opener||this._getOpener(A.item,A.point));};j.prototype._createDetail=function(){var k=this._getTooltipCreateFunction(this._oElement);this._oPopover.removeAllContent();this._appendFooter();k(this._oElement);};j.prototype.openLink=function(A){this._oElement=A.item;this._fnCreate=this._createLink;this._oPopover.openBy(A.opener);};j.prototype._createLink=function(A){var l=new a(),D=this._oElement;this._oPopover.removeAllContent();this._appendHeader(r.getText("NETWORK_GRAPH_TOOLTIP_EXTERNAL_LINKS"));D.getActionLinks().forEach(function(o){l.addItem(new C({content:[new H({renderType:"Bare",items:[o.clone().addStyleClass("sapUiTinyMargin")]})]}));});this._oPopover.addContent(l);this._appendFooter();};j.prototype._getOpener=function(o,p){if(o instanceof L&&p){this._cleanUpLineTooltip();this._tooltipRect=this._createElement("rect",{x:p.x,y:p.y,width:0,height:0});this.getParent().$svg.append(this._tooltipRect);return this._tooltipRect;}return o;};j.prototype._getTooltipCreateFunction=function(o){if(o instanceof N){return this._createNodeTooltip.bind(this);}if(o instanceof L){return this._createLineTooltip.bind(this);}if(o instanceof G){return this._createGroupTooltip.bind(this);}return null;};j.prototype._cleanUpLineTooltip=function(){if(this._tooltipRect){q(this._tooltipRect).remove();}};j.prototype._appendDescription=function(o,w){if(o.getDescription()){w=w||this._oPopover;w.addContent(new d({content:new T({textAlign:"Initial",text:o.getDescription()}).addStyleClass("sapSuiteUiCommonsNetworkTooltipDescription")}).addStyleClass("sapSuiteUiCommonsNetworkTooltipArea"));}};j.prototype._appendAttributes=function(A,w){var l=new a(),o=w||this._oPopover;if(A.length>0){A.forEach(function(k){l.addItem(new C({content:[new H({items:[new T({layoutData:[new h({baseSize:"50%"})],text:k.getLabel()}),new T({layoutData:[new h({baseSize:"50%"})],text:k.getValue(),width:"100%",textAlign:i.TextAlign.End})]}).addStyleClass("sapSuiteUiCommonsNetworkTooltipLine")]}));o.addContent(l);});}};j.prototype._appendNodesList=function(o,w){var l=new a();o.aNodes.forEach(function(n){if(n.getTitle()){l.addItem(new e({title:n.getTitle(),icon:n.getIcon()}));}});w.addContent(l);};j.prototype._appendFooter=function(){var t=this;this.oCloseButton=new B({text:"Close",press:function(){t._oPopover.close();}});this._oPopover.setFooter(new O({content:[new f(),this.oCloseButton]}));this._oPopover.setInitialFocus(this.oCloseButton);};j.prototype._appendHeader=function(t){if(t){this._oPopover.insertContent(new d({width:"100%",content:[new T({width:"100%",textAlign:i.TextAlign.Center,text:t})]}).addStyleClass("sapSuiteUiCommonsNetworkTooltipArea"),0);}};j.prototype._createGroupTooltip=function(o){var k=function(){return o.getAttributes().length>0||o.getDescription();};var D,n;this._appendHeader(o.getTitle());if(k()){n=new c({text:r.getText("NETWORK_GRAPH_TOOLTIP_LIST_OF_NODES")});D=new c({text:r.getText("NETWORK_GRAPH_TOOLTIP_INFORMATION")});this._oPopover.addContent(new I({items:[D,n]})).addStyleClass("sapSuiteUiCommonsNetworkGroupTooltipTabBar");this._appendDescription(o,D);this._appendAttributes(o.getAttributes(),D);this._appendNodesList(o,n);}else{this._appendNodesList(o,this._oPopover);}};j.prototype._createNodeTooltip=function(n){this._appendDescription(n);this._appendAttributes(n.getAttributes());this._appendHeader(n.getTitle());};j.prototype._createLineTooltip=function(l,p){var k=function(){var s=new T({width:"50%",text:l.getFromNode().getTitle()}).addStyleClass("sapSuiteUiCommonsNetworkGraphNoPointerEvents sapSuiteUiCommonsNetworkLineTooltipLabel"),o=new g({src:"sap-icon://arrow-right"}).addStyleClass("sapUiTinyMarginBegin sapUiTinyMarginEnd sapSuiteUiCommonsNetworkGraphNoPointerEvents sapSuiteUiCommonsNetworkLineTooltipFromToIcon"),n=new T({textAlign:i.TextAlign.End,width:"50%",text:l.getToNode().getTitle()}).addStyleClass("sapSuiteUiCommonsNetworkGraphNoPointerEvents sapSuiteUiCommonsNetworkLineTooltipLabel"),t=new F({renderType:"Bare",width:"100%",justifyContent:"Center",items:[s,o,n]}).addStyleClass("sapSuiteUiCommonsNetworkLineTooltipFromTo");return t;},m=function(){var t=l.getTitle();this._oPopover.addContent(k());if(t){this._appendHeader(t);}this._appendDescription(l);this._appendAttributes(l.getAttributes());}.bind(this);m(l);};return j;});
