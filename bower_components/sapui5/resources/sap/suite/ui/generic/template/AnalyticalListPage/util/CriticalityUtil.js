sap.ui.define(["sap/ui/base/Object","sap/ui/model/Context","sap/suite/ui/generic/template/AnalyticalListPage/util/OperationCode","sap/suite/ui/generic/template/AnalyticalListPage/util/FilterUtil","jquery.sap.global"],function(B,C,O,F,q){"use strict";var P="Positive",N="Negative",a="Critical",b="Neutral",G="Good",E="Error",T="Target",M="Maximize",c="Minimize";var d=B.extend("sap.suite.ui.generic.template.AnalyticalListPage.util.CriticalityUtil");d.setVals=function(t,v,D,e,V){this.toleranceLow=t;this.toleranceHigh=v;this.deviationLow=D;this.deviationHigh=e;this._value=V;this.state=undefined;};d.Maximize=function(){if(this.toleranceLow||this.deviationLow){if(this._value>=this.toleranceLow){this.state=sap.m.ValueColor.Good;}else if(this._value<this.deviationLow){this.state=sap.m.ValueColor.Error;}else{this.state=sap.m.ValueColor.Critical;}}return this.state;};d.Maximizing=function(){this.Maximize();};d.Minimize=function(){if(this.toleranceHigh||this.deviationHigh){if(this._value<=this.toleranceHigh){this.state=sap.m.ValueColor.Good;}else if(this._value>this.deviationHigh){this.state=sap.m.ValueColor.Error;}else{this.state=sap.m.ValueColor.Critical;}}return this.state;};d.Minimizing=function(){this.Minimize();};d.Target=function(){if(this.toleranceLow&&this.toleranceHigh){if(this._value>=this.toleranceLow&&this._value<=this.toleranceHigh){this.state=sap.m.ValueColor.Good;}else if(this._value<this.deviationLow||this._value>this.deviationHigh){this.state=sap.m.ValueColor.Error;}else{this.state=sap.m.ValueColor.Critical;}}return this.state;};d.getDataPoint=function(m,e){var f=m.getMetaModel(),o=f.getODataEntityType(f.getODataEntitySet(e.getEntitySet()).entityType),g=e.getChartQualifier()in o?o[e.getChartQualifier()]:undefined,D,h=0,j=g?g.MeasureAttributes:undefined;if(j){for(var i=0;i<j.length;i++){if(j[i].Measure&&j[i].Measure.PropertyPath===e.getMeasureField()){D=j[i].DataPoint?o[j[i].DataPoint.AnnotationPath.substring(1)]:undefined;if(D){h++;break;}}}}if(h===0){q.sap.log.error("There is no datapoint for the measure "+e.getMeasureField());}return D;};d.getCriticalityRefProperties=function(D){var r=[];var e=D.Criticality;if(e){var s=F.readProperty(e,"Path");if(s){r.push(s);}}else{var f=D.CriticalityCalculation,i=F.readProperty(D,"CriticalityCalculation.ImprovementDirection.EnumMember")?F.getPrimitiveValue(D.CriticalityCalculation.ImprovementDirection):undefined,g=F.readProperty(f,"DeviationRangeLowValue.Path"),h=F.readProperty(f,"DeviationRangeHighValue.Path"),t=F.readProperty(f,"ToleranceRangeLowValue.Path"),j=F.readProperty(f,"ToleranceRangeHighValue.Path");if(i===M){if(g){r.push(g);}if(t){r.push(t);}}else if(i===c){if(j){r.push(j);}if(h){r.push(h);}}else if(i===T){if(g){r.push(g);}if(t){r.push(t);}if(h){r.push(h);}if(j){r.push(j);}}}return r.length>0?r:undefined;};d.CalculateCriticality=function(D,e,m){for(var i=0;i<e.results.length;i++){if(D&&D.Criticality){var f=(D.Criticality.EnumMember||D.Criticality.Path)?F.getPathOrPrimitiveValue(D.Criticality):undefined;if(f){if(f.indexOf("path")!==-1){f=D.Criticality.Path?e.results[i][D.Criticality.Path]:undefined;}if(f===N){e.results[i].color=E;}else if(f===P){e.results[i].color=G;}else if(f===a){e.results[i].color=a;}else if(f===b){e.results[i].color=b;}}}else{var I=F.readProperty(D,"CriticalityCalculation.ImprovementDirection.EnumMember")?F.getPrimitiveValue(D.CriticalityCalculation.ImprovementDirection):undefined;if(I){if(F.readProperty(D,"CriticalityCalculation.ToleranceRangeLowValue")){var t=F.readProperty(D,"CriticalityCalculation.ToleranceRangeLowValue.Int")?Number(D.CriticalityCalculation.ToleranceRangeLowValue.Int):Number(e.results[i][D.CriticalityCalculation.ToleranceRangeLowValue.Path]);}if(F.readProperty(D,"CriticalityCalculation.ToleranceRangeHighValue")){var g=F.readProperty(D,"CriticalityCalculation.ToleranceRangeHighValue.Int")?Number(D.CriticalityCalculation.ToleranceRangeHighValue.Int):Number(e.results[i][D.CriticalityCalculation.ToleranceRangeHighValue.Path]);}if(F.readProperty(D,"CriticalityCalculation.DeviationRangeLowValue")){var h=F.readProperty(D,"CriticalityCalculation.DeviationRangeLowValue.Int")?Number(D.CriticalityCalculation.DeviationRangeLowValue.Int):Number(e.results[i][D.CriticalityCalculation.DeviationRangeLowValue.Path]);}if(F.readProperty(D,"CriticalityCalculation.DeviationRangeHighValue")){var j=F.readProperty(D,"CriticalityCalculation.DeviationRangeHighValue.Int")?Number(D.CriticalityCalculation.DeviationRangeHighValue.Int):Number(e.results[i][D.CriticalityCalculation.DeviationRangeHighValue.Path]);}if(isNaN(h)){h=undefined;}if(isNaN(j)){j=undefined;}if(isNaN(t)){t=undefined;}if(isNaN(g)){g=undefined;}var v=Number(e.results[i][m]);this.setVals(t,g,h,j,v);e.results[i].color=(this[I]());}}}return e;};return d;},true);
