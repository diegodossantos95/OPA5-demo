sap.ui.define(["jquery.sap.global","sap/ui/base/Object","sap/ui/Device","sap/ui/model/json/JSONModel","sap/ui/core/routing/History","sap/ui/core/routing/HistoryDirection","sap/m/MessageToast","sap/m/ActionSheet","sap/m/Dialog","sap/m/Popover","sap/suite/ui/generic/template/lib/routingHelper","sap/suite/ui/generic/template/lib/ContextBookkeeping","sap/suite/ui/generic/template/lib/testableHelper"],function(q,B,D,J,H,a,M,A,b,P,r,C,t){"use strict";var c=(t.testableStatic(function(T,o){var s="sapUiSizeCozy",e="sapUiSizeCompact";if(o.hasClass(s)||o.hasClass(e)){return"";}else{return T?s:e;}},"Application_determineContentDensityClass")(D.support.touch,q(document.body)));function g(){return c;}function f(o,p){q.sap.syncStyleClass(c,p,o);p.addDependent(o);}var f=t.testableStatic(f,"Application_attachControlToParent");function d(T){var o=new C(T.oAppComponent);var l;function e(){return l;}function s(i){l=i;}function h(i){var j=T.oNavigationControllerProxy.getActiveComponents();return j.indexOf(i.getId())>=0;}var I=false;function p(j){if(I){return;}var i=0;for(;i<T.aRunningSideEffectExecutions.length&&!T.aRunningSideEffectExecutions[i];i++){i++;}if(T.aRunningSideEffectExecutions[i]){I=true;var e1=T.aRunningSideEffectExecutions[i];e1.then(function(){if(T.aRunningSideEffectExecutions[i]===e1){T.aRunningSideEffectExecutions[i]=null;}I=false;p(j);});}else{j();}}function m(i){var j;if(i instanceof b){j="open";}else if(i instanceof P||i instanceof A){j="openBy";}if(j){var e1=i[j];i[j]=function(){var f1=arguments;p(function(){if(!T.oBusyHelper.isBusy()){T.oBusyHelper.getUnbusy().then(function(){e1.apply(i,f1);});}});};}}var F={};function k(i,j,e1,f1,g1){i=i||T.oNavigationHost;var h1=i.getId();var i1=F[h1]||(F[h1]={});var j1=i1[j];if(!j1){j1=sap.ui.xmlfragment(h1,j,e1);f(j1,i);var k1;if(f1){k1=new J();j1.setModel(k1,f1);}(g1||q.noop)(j1,k1);i1[j]=j1;m(j1);}return j1;}function n(){return new Promise(function(i){T.oNavigationObserver.getProcessFinished(true).then(function(){T.oBusyHelper.getUnbusy().then(i);});});}function u(i){T.oShellServicePromise.then(function(j){j.setBackNavigation(i);});}function v(i){if(!T.oFlexibleColumnLayoutHandler){return{isNextObjectLoadedAfterDelete:function(){return false;},getOrderToShowObjectPageAfterDelete:function(){return false;},isListAndFirstEntryLoadedOnStartup:function(){return false;},supressNavigationUpAfterDeletion:function(){return false;},handleDataReceived:function(){return false;}};}return T.oFlexibleColumnLayoutHandler.getFclProxyForView(i);}var w=false;function x(i){w=i;}function y(i,j){if(!T.oFlexibleColumnLayoutHandler){return true;}var e1=r.determineNavigationPath(i,j);return T.oFlexibleColumnLayoutHandler.isNewHistoryEntryRequired(e1);}function R(i){T.aStateChangers.push(i);}function z(i){return T.oFlexibleColumnLayoutHandler?T.oFlexibleColumnLayoutHandler.getTargetAfterCancelPromise(i):Promise.resolve(i);}function E(i,j){o.adaptAfterDeletion(i);if(i.length===0||!T.oFlexibleColumnLayoutHandler){return;}T.oFlexibleColumnLayoutHandler.adaptAfterDeletion(i,j);}function G(i,j,e1){var f1=T.mEntityTree[i];var g1;if(f1.navigationProperty&&f1.parent){g1=j?f1.entitySet:f1.navigationProperty;}else{g1=i;}if(e1.indexOf(g1)<0){e1.unshift(g1);if(f1.navigationProperty&&f1.parent){G(f1.parent,j,e1);}}}function K(i,j){var e1=[];G(i,j,e1);return e1;}function L(j){var e1=K(j);e1.pop();var f1="";var g1="";var h1=[];for(var i=0;i<e1.length;i++){f1=f1+g1+e1[i];h1.push(f1);g1="/";}return h1;}function N(){var i=T.oNavigationControllerProxy.oHashChanger.getHash();var j=i.split("?")[0];var e1=j.split("/");if(e1[0]===""||e1[0]==="#"){e1.splice(0,1);}return e1;}function O(i,j,e1){if(T.oFlexibleColumnLayoutHandler){return T.oFlexibleColumnLayoutHandler.adaptBreadCrumbUrl(i,j,e1);}return i;}function Q(){var j=T.oNavigationControllerProxy.getActiveComponents();var e1=0;var f1;for(var i=0;i<j.length;i++){var g1=T.componentRegistry[j[i]];if(g1.viewLevel>0&&(e1===0||g1.viewLevel<e1)){e1=g1.viewLevel;f1=g1.oComponent;}}var h1=f1?Promise.resolve(f1):T.oNavigationControllerProxy.getRootComponentPromise();return h1.then(function(i1){return i1.getModel("i18n").getResourceBundle();});}function S(){return T.oNavigationControllerProxy.getAppTitle();}function U(i,j){T.oNavigationControllerProxy.subTitleForViewLevelChanged(i,j);}function V(i){return T.oNavigationControllerProxy.getCurrentKeys(i);}function W(){for(var i in T.componentRegistry){var j=T.componentRegistry[i];if(j.viewLevel===1){if(h(j.oComponent)){var e1=j.oComponent.getComponentContainer().getElementBinding();return e1&&e1.getPath();}else{return null;}}}return null;}function X(e1,f1,g1,h1,i1){var j1=g1.oComponent.getEntitySet();var k1=T.mEntityTree[j1];var l1=false;var m1;var n1=true;for(var i=0;i<k1.children.length&&!m1;i++){var o1=k1.children[i];var p1=T.mEntityTree[o1];if(p1.navigationProperty===e1){m1=p1.sRouteName;n1=!p1.noKey;}}if(h1&&!m1){var q1=k1.embeddedComponents[h1];if(q1){for(var j=0;j<q1.pages.length&&!l1;j++){var r1=q1.pages[j];if(r1.navigationProperty===e1){l1=true;m1=j1+"/"+h1+"/"+e1;n1=!(r1.routingSpec&&r1.routingSpec.noKey);}}}}if(m1){var s1=l1?h1+r.getPatternDelimiter():"";var t1=n1?"("+f1+")":"";var u1=s1+e1+t1;T.oNavigationControllerProxy.navigateToSuffix(u1,g1.viewLevel+1,m1,i1);}}var Y;function Z(i){var j=i.getEntitySet();var e1=T.mEntityTree[j];if(e1&&e1.communicationModel){return e1.communicationModel;}Y=Y||new J();return Y;}var $;function _(j,e1){var i=e1||0;if(i>0){return null;}var f1=j.getEntitySet();var g1=T.mEntityTree[f1];var h1=g1&&g1.communicationObject;for(;i<0&&h1;){g1=T.mEntityTree[g1.parent];if(g1.communicationObject!==h1){i++;h1=g1.communicationObject;}}if(i<0||h1){return h1;}$=$||{};return $;}function a1(i){for(var j in T.mEntityTree){if(T.mEntityTree[j].navigationProperty&&(T.mEntityTree[j].level===i+1)){return T.mEntityTree[j].navigationProperty;}}}function b1(){return T.oFlexibleColumnLayoutHandler?T.oFlexibleColumnLayoutHandler.getMaxColumnCountInFCL():false;}function c1(){return T.oFlexibleColumnLayoutHandler&&T.oFlexibleColumnLayoutHandler.isListAndFirstEntryLoadedOnStartup();}function d1(){return T.oFlexibleColumnLayoutHandler&&T.oFlexibleColumnLayoutHandler.isNextObjectLoadedAfterDelete();}T.oApplicationProxy={getDraftSiblingPromise:o.getDraftSiblingPromise,getAlternativeContextPromise:o.getAlternativeContextPromise,getResourceBundleForEditPromise:Q,getHierarchySectionsFromCurrentHash:N,getContentDensityClass:g,setEditableNDC:x,getDialogFragment:k.bind(null,null),destroyView:function(i){delete F[i];},setListReportTable:s};return{setEditableNDC:x,getEditableNDC:function(){return w;},getContentDensityClass:g,attachControlToParent:f,getDialogFragmentForView:k,getBusyHelper:function(){return T.oBusyHelper;},performAfterSideEffectExecution:p,isComponentActive:h,showMessageToast:function(){var i=arguments;var j=function(){q.sap.log.info("Show message toast");M.show.apply(M,i);};Promise.all([n(true),T.oBusyHelper.getUnbusy()]).then(j);},setBackNavigation:u,getFclProxyForView:v,isNewHistoryEntryRequired:y,registerStateChanger:R,getDraftSiblingPromise:o.getDraftSiblingPromise,registerContext:o.registerContext,activationStarted:o.activationStarted,cancellationStarted:o.cancellationStarted,editingStarted:o.editingStarted,getTargetAfterCancelPromise:z,adaptAfterDeletion:E,getBreadCrumbInfo:L,adaptBreadCrumbUrl:O,getSections:K,getHierarchySectionsFromCurrentHash:N,getAppTitle:S,subTitleForViewLevelChanged:U,getCurrentKeys:V,getPathForViewLevelOneIfVisible:W,getCommunicationModel:Z,getCommunicationObject:_,navigateRoute:X,getForwardNavigationProperty:a1,getMaxColumnCountInFCL:b1,isListAndFirstEntryLoadedOnStartup:c1,isNextObjectLoadedAfterDelete:d1,getListReportTable:e};}return B.extend("sap.suite.ui.generic.template.lib.Application",{constructor:function(T){q.extend(this,d(T));}});});
