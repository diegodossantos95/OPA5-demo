sap.ui.define(["sap/m/SegmentedButtonItem","sap/m/Button","sap/m/ButtonType","sap/m/Text","sap/m/Dialog","sap/m/SegmentedButton","sap/suite/ui/generic/template/AnalyticalListPage/controller/VisualFilterDialogController","sap/ui/core/mvc/Controller","sap/suite/ui/generic/template/AnalyticalListPage/util/FilterUtil"],function(S,B,a,T,D,b,V,C,F){"use strict";var c="visual";var f=C.extend("sap.suite.ui.generic.template.AnalyticalListPage.controller.FilterBarController",{init:function(s){this.compactFilterData={};var m=this;m.oState=s;var d=m.oState.oController.getOwnerComponent().getShowGoButtonOnFilterBar()?true:false;s.oSmartFilterbar.setShowGoOnFB(d);s.oSmartFilterbar.setLiveMode(!d);s.oSmartFilterbar.setShowMessages(d);if(s.oSmartTable){s.oSmartTable.setEnableAutoBinding(!d);}if(!d){m.oState.oSmartFilterbar._oFiltersButton.setVisible(false);}s.oHeader=s.oPage.getHeader();s.oTitle=s.oPage.getTitle();if(s.oKpiTagContainer){s.alr_filterContainer.removeContent(s.oKpiTagContainer);s.oKpiTagContainer.addStyleClass("sapSmartTemplatesAnalyticalListPageKpiTagContainer");}if(s.alr_visualFilterBar){s.alr_visualFilterBar.setSmartFilterContext(this.oState.oSmartFilterbar);s.alr_visualFilterBar.attachFilterChange(this._onVisualFilterChange.bind(this));}s.oSmartFilterbar.attachAfterVariantLoad(this._afterVariantLoad.bind(this));},_updateFilterLink:function(){var o=this.oState.oSmartFilterbar.getFilterData(),t=this.oState.oController.getOwnerComponent().getModel("_templPriv");t.setProperty('/alp/filtersLink',o);},_afterVariantLoad:function(e){if(this.oState.alr_visualFilterBar){this.oState.alr_visualFilterBar.updateVisualFilterBindings(true);}if(this.oState.oSmartFilterbar.isLiveMode()&&e.mParameters.context!="INIT"){this.oState.oSmartFilterbar.search();}},_onVisualFilterChange:function(e){var o=this.oState.oController.getOwnerComponent().getModel("_filter"),d=o.getData();if(e.getParameter('propertyName')&&e.getParameter('bVisible')!==undefined){var g=this.oState.oSmartFilterbar.determineFilterItemByName(e.getParameter('propertyName'));if(e.getParameter('bVisible')){if(!g.getPartOfCurrentVariant()){g.setPartOfCurrentVariant(true);g.setVisibleInFilterBar(true);}}else{g.setPartOfCurrentVariant(false);g.setVisibleInFilterBar(false);}}this.oState.oSmartFilterbar.setFilterData(d,true);if(this.oState.oSmartFilterbar.isLiveMode()){this.oState.oSmartFilterbar.search();}},onGoFilter:function(){this.oState.oSmartFilterbar.search();},setDefaultFilter:function(m){var t=this.oState.oController.getOwnerComponent().getModel("_templPriv");t.setProperty('/alp/filterMode',m);this.handleFilterSwitch(m);},handleFilterSwitch:function(m,A){var t=this.oState.oController.getOwnerComponent().getModel("_templPriv");if(t.getProperty('/alp/filterMode')===c){this.fnCheckMandatory();}},fnCheckMandatory:function(){this.oState.oSmartFilterbar.checkSearchAllowed(this.oState);var t=this.oState.oController.getOwnerComponent().getModel("_templPriv");if(!t.getProperty('/alp/searchable')){this.oState.oSmartFilterbar.showFilterDialog();}},showDialog:function(){this.oState.oSmartFilterbar.showFilterDialog();},clearFilters:function(){var o=this.oState.oSmartFilterbar.getFilterData();for(var p in o){if(o.hasOwnProperty(p)){delete o[p];}}this.oState.oSmartFilterbar.setFilterData(o,true);if(this.oState.chartController){this.oState.chartController.updateTable();}},changeVisibility:function(e){var o=e.getParameters().filterItem.filterItem,v=e.getParameters().added?true:false,d=this.oState.alr_visualFilterBar.getModel('_visualFilterConfigModel').getData().filterCompList,g=this.oState.visualFilterDialogContainer;for(var i=0;i<d.length;i++){if(o&&o.getName()===d[i].component.properties.parentProperty){g.oConfig.filterCompList[i].shownInFilterDialog=v;g.oConfig.filterCompList[i].shownInFilterBar=v;g._updateVisualFilterConfigModel(i,'/shownInFilterDialog',v);g.selectCheckBox(i,v);break;}}g._reloadForm();}});return f;});
