jQuery.sap.declare("sap.zen.crosstab.rendering.CrossRequestManager");jQuery.sap.require("sap.zen.crosstab.rendering.ScrollManager");jQuery.sap.require("sap.zen.crosstab.rendering.PixelScrollManager");jQuery.sap.require("sap.zen.crosstab.rendering.HeaderScrollManager");jQuery.sap.require("sap.zen.crosstab.rendering.RenderingConstants");jQuery.sap.require("sap.zen.crosstab.utils.Utils");
sap.zen.crosstab.rendering.CrossRequestManager=function(c,r){"use strict";var s=null;var h=null;var H=0;var a="";var v=0;var V="";var b=false;var C=null;var d=null;var D=null;var R=null;var e=false;var f="";var g="";var t=0;var T=0;var i=0;var j=0;var A=false;var k=false;var l=false;var m=undefined;var n=undefined;var o=null;var p=c.getDataArea();var q=c.getRowHeaderArea();var u=c.getColumnHeaderArea();var w=c.getDimensionHeaderArea();var x=false;var y=false;this.reset=function(){if(s){s.destroy();}s=null;if(h){h.destroy();}h=null;};this.clearSavedColWidths=function(){C=null;d=null;D=null;R=null;};this.clearSavedData=function(){s=null;h=null;H=0;a="";v=0;V="";b=false;this.clearSavedColWidths();e=false;f="";g="";t=0;T=0;o=null;x=false;y=false;};this.saveTableDimensions=function(){if(c.getPropertyBag().isPixelScrolling()){var F=$(document.getElementById(c.getId()+"_dataArea"));i=F.outerHeight();j=F.outerWidth();}t=c.getTotalRows();T=c.getTotalCols();};function z(F){if(g==="expanded"){return(F<0);}else if(g==="collapsed"){return(F>0);}else{return false;}}this.handleRootCause=function(){var O=v;var F=H;var G=m;var I=n;if(f==="plan"){if(a!=="plan"&&V!=="plan"){this.clearSavedData();}}else if(f==="sorting"){if(a!=="sort"){this.clearSavedData();}else{v=0;n=false;}}else if(f==="hierarchy"){if(a==="hier"&&V==="hier"){var J=t-c.getTotalRows();var K=T-c.getTotalCols();if(J!==0){if(z(J)){if(!e){if(c.getPropertyBag().isPixelScrolling()){k=true;}else{v=Math.max(0,v-J);}}}else{this.clearSavedData();}}else if(K!==0){if(z(K)){if(!e){if(c.getPropertyBag().isPixelScrolling()){A=true;}else{H=Math.max(0,H-K);}}}else{this.clearSavedData();}}}else{this.clearSavedData();}}e=false;f="";g="";t=0;T=0;if(F!==H||O!==v||G!==m||I!==n){c.getUtils().sendScrollPosUpdate(H,m,v,n);}l=true;};this.getHPixelScrollPosAfterRendering=function(){var P=-1;if(c.getPropertyBag().isPixelScrolling()){var F=$(document.getElementById(c.getId()+"_dataArea"));if(A){var G=F.outerWidth()-j;P=H+G;A=false;}}return P;};this.getVPixelScrollPosAfterRendering=function(){var P=-1;if(c.getPropertyBag().isPixelScrolling()){var F=$(document.getElementById(c.getId()+"_dataArea"));if(k){var G=F.outerHeight()-i;P=v+G;k=false;}}return P;};this.setRootCause=function(F){f=F;};this.setHierarchyAction=function(F){g=F;};this.setIsHierarchyDirectionDown=function(I){e=I;};this.getScrollManager=function(){if(!s){if(c.getPropertyBag().isPixelScrolling()){s=new sap.zen.crosstab.rendering.PixelScrollManager(c,r);}else{s=new sap.zen.crosstab.rendering.ScrollManager(c,r);}if(b){s.setHScrollPos(H);s.setVScrollPos(v);}}return s;};this.getHeaderScrollManager=function(){if(!h){h=new sap.zen.crosstab.rendering.HeaderScrollManager(c,r);if(b){h.setHScrollData(o);}}return h;};this.saveHScrollInfo=function(F,G){if(c.getPropertyBag().isPixelScrolling()){var s=c.getRenderEngine().getScrollManager();H=0;if(s){H=s.getCurrentHScrollPos();}}else{H=c.getColumnHeaderArea().getRenderStartCol();if(s&&s.isHScrolledToEnd()){H++;m=true;}}if(G){v=0;}a=F;b=true;x=true;};this.saveVScrollInfo=function(F,G){if(c.getPropertyBag().isPixelScrolling()){var I=$(document.getElementById(c.getId()+"_lowerRight_scrollDiv"));v=0;if(I&&I.length>0){v=I.scrollTop();}}else{v=c.getRowHeaderArea().getRenderStartRow();if(s&&s.isVScrolledToEnd()){v++;n=true;}}if(G){H=0;}V=F;b=true;y=true;};this.savedInfoHandled=function(){if(l===true){H=0;a="";v=0;V="";b=false;C=null;d=null;D=null;R=null;l=false;m=undefined;n=undefined;o=null;x=false;y=false;}};this.hasSavedInfo=function(){return b;};this.getSavedHScrollInfo=function(){var F={};F.iPos=H;F.sAction=a;F.bScrolledToEnd=m;return F;};this.getSavedVScrollInfo=function(){var F={};F.iPos=v;F.sAction=V;F.bScrolledToEnd=n;return F;};this.saveColWidths=function(){var u=c.getColumnHeaderArea();var w=c.getDimensionHeaderArea();var q=c.getRowHeaderArea();var p=c.getDataArea();if(!u.hasLoadingPages()){C=u.getColWidths();b=true;}if(!p.hasLoadingPages()){D=p.getColWidths();b=true;}if(!w.hasLoadingPages()){d=w.getColWidths();b=true;}if(!q.hasLoadingPages()){R=q.getColWidths();b=true;}};this.restoreColWidths=function(){var u=c.getColumnHeaderArea();var w=c.getDimensionHeaderArea();var q=c.getRowHeaderArea();var p=c.getDataArea();if(C){u.setColWidths(C);C=null;}if(D){p.setColWidths(D);D=null;}if(d){w.setColWidths(d);d=null;}if(R){q.setColWidths(R);R=null;}};function B(F,G,I,J){var K={iHScrollPos:F,bHScrolledToEnd:G,iVScrollPos:I,bVScrolledToEnd:J};if(K.iHScrollPos<0){K.iHScrollPos=0;K.bHScrolledToEnd=false;}if(K.iVScrollPos<0){K.iVScrollPos=0;K.bVScrolledToEnd=false;}if(!c.getPropertyBag().isPixelScrolling()){var L=p?p:u;var M=L.getColCnt()-1;if(K.iHScrollPos>M){K.iHScrollPos=0;K.bHScrolledToEnd=false;}L=p?p:q;var N=L.getRowCnt()-1;if(K.iVScrollPos>N){K.iVScrollPos=0;K.bVScrolledToEnd=false;}}if((K.iHScrollPos!==F)||(K.iVScrollPos!==I)){c.getUtils().sendScrollPosUpdate(0,false,0,false);}return K;}this.setHScrollInfo=function(F,G){H=F;m=G;b=true;x=true;};this.setVScrollInfo=function(F,G){v=F;n=G;b=true;y=true;};this.setScrollData=function(F,G,I,J){var K=B(F,G,I,J);H=K.iHScrollPos;v=K.iVScrollPos;m=K.bHScrolledToEnd;n=K.bVScrolledToEnd;b=true;x=true;y=true;};function E(F){var G=F;if(G.iHPos<0){G.iHPos=0;}if(G.iHPos!==F.iHPos){c.getUtils().sendScrollPosUpdate(G.iHPos,undefined,undefined,undefined,true);}return G;}this.setHeaderScrollData=function(F){var G=E(F);b=true;o=G;};this.getHeaderScrollData=function(){return o;};this.hasSavedHScrollInfo=function(){return x;};this.hasSavedVScrollInfo=function(){return y;};};
