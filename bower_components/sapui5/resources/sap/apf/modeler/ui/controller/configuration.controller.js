/*!
 * SAP APF Analysis Path Framework
 *
 * (c) Copyright 2012-2014 SAP SE. All rights reserved
 */
jQuery.sap.require("sap.apf.modeler.ui.utils.nullObjectChecker");jQuery.sap.require("sap.apf.modeler.ui.utils.viewValidator");jQuery.sap.require('sap.apf.modeler.ui.utils.textPoolHelper');(function(){"use strict";var v,t,a,c,C,p,o;var n=new sap.apf.modeler.ui.utils.NullObjectChecker();function _(q){q.byId("idConfigurationBasicData").setText(t("configurationData"));q.byId("idConfigTitleLabel").setText(t("configTitle"));q.byId("idConfigTitle").setPlaceholder(t("newConfiguration"));q.byId("idConfigurationIdLabel").setText(t("configurationId"));q.byId("idSemanticObjectLabel").setText(t("semanticObject"));q.byId("idNoOfCategoriesLabel").setText(t("noOfCategories"));q.byId("idNoOfStepsLabel").setText(t("noOfSteps"));q.byId("idFilterTypeData").setText(t("filterType"));q.byId("idFilterTypeLabel").setText(t("type"));q.byId("smartFilterBar").setText(t("smartFilterBar"));q.byId("facetFilter").setText(t("configuredFilters"));q.byId("none").setText(t("noFilters"));q.byId("idAriaPropertyForFilterRadioGp").setText(t("type"));}function b(q){if(!o){return;}q.byId("idNoOfCategories").setValue(C.getCategories().length);}function d(q){if(!o){return;}q.byId("idNoOfSteps").setValue(C.getSteps().length);}function e(q){if(!o){return;}q.byId("idConfigTitle").setValue(o.AnalyticalConfigurationName);}function f(q){if(!o){return;}if(o.AnalyticalConfiguration.indexOf(sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.ISNEWCONFIG)===-1){q.byId("idConfigurationId").setValue(o.AnalyticalConfiguration);}}function g(q){var r=a.getApplication(p.arguments.appId);if(r){q.byId("idSemanticObject").setValue(r.SemanticObject);}}function h(q){var F;if(o){F=Object.keys(C.getFilterOption())[0];q.byId("idFilterTypeRadioGroup").setEnabled(true);q.byId("idFilterTypeRadioGroup").setSelectedButton(q.byId(F));}}function i(q){if(p&&p.arguments&&p.arguments.configId){o=c.getConfiguration(p.arguments.configId);}if(o){C=q.getView().getViewData().oConfigurationEditor;}}function j(q,s){var T=t("configuration")+": "+s;q.getView().getViewData().updateTitleAndBreadCrumb(T);}function k(q,s){var T=c.getTextPool();var r=sap.apf.modeler.ui.utils.TranslationFormatMap.APPLICATION_TITLE;T.setTextAsPromise(s,r).done(function(A){C.setApplicationTitle(A);});}function l(q,s,r){var u={appId:p.arguments.appId};var w={name:s};if(r){w.id=r;u.configId=r;q.getView().getViewData().updateSelectedNode(w,u);}else{q.getView().getViewData().updateSelectedNode(w);}}function m(q){var F={};var s=q.byId("idFilterTypeRadioGroup").getSelectedButton().getCustomData()[0].getValue();F[s]=true;C.setFilterOption(F);C.setIsUnsaved();}sap.ui.controller("sap.apf.modeler.ui.controller.configuration",{onInit:function(){var q=this;var V=q.getView().getViewData();a=V.oApplicationHandler;c=V.oConfigurationHandler;t=V.getText;p=V.oParams;v=new sap.apf.modeler.ui.utils.ViewValidator(q.getView());_(q);i(q);q.setDetailData();v.addField("idConfigTitle");},onAfterRendering:function(){var q=this;if(q.getView().byId("idConfigTitle").getValue().length===0){q.getView().byId("idConfigTitle").focus();}},setDetailData:function(){var q=this;g(q);f(q);e(q);b(q);d(q);h(q);},updateSubViewInstancesOnReset:function(q){C=q;},handleChangeDetailValue:function(){var q=this;var s=q.byId("idConfigTitle").getValue().trim();var r;if(n.checkIsNotNullOrUndefinedOrBlank(s)){r={AnalyticalConfigurationName:s};if(p&&p.arguments&&p.arguments.configId&&(p.arguments.configId.indexOf("newConfig")===-1)){c.setConfiguration(r,p.arguments.configId);l(q,s);}else{var T=c.setConfiguration(r);o=c.getConfiguration(T);if(!C){c.loadConfiguration(T,function(u){C=u;});}l(q,s,T);}k(q,s);j(q,s);o=r;}C.setIsUnsaved();},handleChangeForFilterType:function(){var q=this,F;if(!C.isDataLostByFilterOptionChange()){m(q);q.getView().getViewData().updateTree();}else{F=new sap.ui.xmlfragment("idFilterOptionChangeFragment","sap.apf.modeler.ui.fragment.dialogWithTwoButtons",q);F.setState(sap.ui.core.ValueState.Warning);F.setTitle(t("warning"));sap.ui.core.Fragment.byId("idFilterOptionChangeFragment","idLabelForDialog").setText(t("filterOptionChangeMessage"));sap.ui.core.Fragment.byId("idFilterOptionChangeFragment","idBeginButtonForDialog").setText(t("continue"));sap.ui.core.Fragment.byId("idFilterOptionChangeFragment","idEndButtonForDialog").setText(t("cancel"));F.open();}},handleBeginButtonDialogWithTwoButtons:function(){var q=this;m(q);q.getView().getViewData().updateTree();sap.ui.core.Fragment.byId("idFilterOptionChangeFragment","idDialogWithTwoButtons").destroy();},handleEndButtonDialogWithTwoButtons:function(){var q=this;h(q);sap.ui.core.Fragment.byId("idFilterOptionChangeFragment","idDialogWithTwoButtons").destroy();},getValidationState:function(){return v.getValidationState();}});})();
