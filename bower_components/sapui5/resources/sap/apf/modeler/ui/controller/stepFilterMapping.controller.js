/*!
 * SAP APF Analysis Path Framework
 *
 * (c) Copyright 2012-2014 SAP AG. All rights reserved
 */
jQuery.sap.require("sap.apf.modeler.ui.controller.requestOptions");(function(){"use strict";var n=new sap.apf.modeler.ui.utils.NullObjectChecker();var t=new sap.apf.modeler.ui.utils.TextManipulator();sap.apf.modeler.ui.controller.requestOptions.extend("sap.apf.modeler.ui.controller.stepFilterMapping",{onBeforeRendering:function(){var c=this;c.byId("idSelectPropertiesLabel").setVisible(false);c.byId("idSelectProperties").setVisible(false);c.byId("idOptionalRequestFieldLabel").setVisible(true);c.byId("idOptionalRequestField").setVisible(true);c.byId("idOptionalRequestField").setForceSelection(false);},getIdOfPropertiesControl:function(){return"idOptionalRequestField";},getIdOfPropertyLabel:function(){return"idOptionalRequestFieldLabel";},setSelectedKeysForProperties:function(p){var c=this;if(p.length!==0){c.byId("idOptionalRequestField").setSelectedKey(p[0]);}else{c.byId("idOptionalRequestField").clearSelection();}},getSelectedKeysForProperties:function(){var c=this,s,S;var T=c.getView().getViewData().oTextReader;s=t.removePrefixText(c.byId("idOptionalRequestField").getSelectedKey(),T(sap.apf.modeler.ui.utils.CONSTANTS.texts.NOTAVAILABLE));S=n.checkIsNotNullOrUndefinedOrBlank(s)?[s]:[];return S;},setDisplayText:function(){var c=this;var T=c.getView().getViewData().oTextReader;c.byId("idSourceLabel").setText(T("source"));c.byId("idEntityLabel").setText(T("entity"));c.byId("idOptionalRequestFieldLabel").setText(T("targetProperty"));},resetEntityAndProperties:function(){var c=this;c.clearEntity();c.byId("idEntity").setModel(null);c.byId("idEntity").setSelectedKey(undefined);c.clearSelectProperties();c.byId("idOptionalRequestField").setModel(null);c.byId("idOptionalRequestField").setSelectedKey(undefined);},resetFilterMappingFields:function(){var c=this;c.clearSource();c.byId("idSource").setValue("");c.resetEntityAndProperties();c.addOrRemoveMandatoryFieldsAndRequiredFlag(false);},updateFilterMappingFields:function(){var c=this,s,e,E,S,a;var T=c.getView().getViewData().oTextReader;s=c.byId("idSource").getValue().trim();if(n.checkIsNotNullOrUndefinedOrBlank(s)){if(!n.checkIsNotNullOrUndefinedOrBlank(c.getAllEntities(s))){c.resetEntityAndProperties();return;}c.setDetailData();e=t.removePrefixText(c.byId("idEntity").getSelectedKey(),T(sap.apf.modeler.ui.utils.CONSTANTS.texts.NOTAVAILABLE));E=n.checkIsNotNullOrUndefinedOrBlank(e)?e:undefined;c.updateEntity(E);S=t.removePrefixText(c.byId("idOptionalRequestField").getSelectedKey(),T(sap.apf.modeler.ui.utils.CONSTANTS.texts.NOTAVAILABLE));a=n.checkIsNotNullOrUndefinedOrBlank(S)?[S]:[];c.updateSelectProperties(a);}c.oConfigurationEditor.setIsUnsaved();},getSource:function(){var c=this;return c.oParentObject.getFilterMappingService();},getAllEntitiesAsPromise:function(s){var c=this;return c.oConfigurationEditor.getAllEntitySetsOfServiceWithGivenPropertiesAsPromise(s,c.oParentObject.getFilterProperties());},getEntity:function(){var c=this;return c.oParentObject.getFilterMappingEntitySet();},getAllEntitySetPropertiesAsPromise:function(s,e){var c=this;return c.oConfigurationEditor.getAllPropertiesOfEntitySetAsPromise(s,e);},clearSource:function(){var c=this;c.oParentObject.setFilterMappingService(undefined);c.clearEntity();},clearEntity:function(){var c=this;c.oParentObject.setFilterMappingEntitySet(undefined);c.clearSelectProperties();},clearSelectProperties:function(){var c=this;var o=c.oParentObject.getFilterMappingTargetProperties();o.forEach(function(p){c.oParentObject.removeFilterMappingTargetProperty(p);});},removeSelectProperties:function(p){var c=this;p.forEach(function(a){c.oParentObject.removeFilterMappingTargetProperty(a);});},updateSource:function(s){var c=this;c.oParentObject.setFilterMappingService(s);},updateEntity:function(e){var c=this;c.oParentObject.setFilterMappingEntitySet(e);},updateSelectProperties:function(s){var c=this;c.clearSelectProperties();s.forEach(function(p){c.oParentObject.addFilterMappingTargetProperty(p);});},updateOptionalRequestFieldProperty:function(f){var c=this;c.updateSelectProperties(f);},getSelectProperties:function(){var c=this;return c.oParentObject.getFilterMappingTargetProperties();},getValidationState:function(){var c=this;return c.viewValidator.getValidationState();}});}());
