/*!
 * SAP APF Analysis Path Framework
 * 
 * (c) Copyright 2012-2014 SAP AG. All rights reserved
 */
jQuery.sap.declare("sap.apf.core.textResourceHandler");jQuery.sap.require("sap.apf.utils.hashtable");jQuery.sap.require("jquery.sap.resources");(function(){'use strict';sap.apf.core.TextResourceHandler=function(I){var m=I.instances.messageHandler;var r;var h=new sap.apf.utils.Hashtable(m);var H=new sap.apf.utils.Hashtable(m);var o=new sap.apf.utils.Hashtable(m);var a={};var R=(I.constructors&&I.constructors.ResourceModel)||sap.ui.model.resource.ResourceModel;this.getTextNotHtmlEncoded=function(l,p){var t;var c;var k;if(typeof l==="string"){c=l;}else{m.check((l!==undefined&&l.kind!==undefined&&l.kind==="text"&&l.key!==undefined),"Error - oLabel is not compatible");c=l.key;}k=JSON.stringify({textKey:c,parameters:p});if(h.hasItem(k)){return h.getItem(k);}t=b(c,p);h.setItem(k,t);return t;};this.getTextHtmlEncoded=function(l,p){return jQuery.sap.encodeHTML(this.getTextNotHtmlEncoded(l,p));};this.getMessageText=function(s,p){return r.getText(s,p,false);};this.loadTextElements=function(t){var i,l;l=t.length;for(i=0;i<l;i++){H.setItem(t[i].TextElement,t[i].TextElementDescription);}};this.registerTextWithKey=function(k,t){a[k]=t;};this.loadResourceModelAsPromise=function(A,s,c){var d=jQuery.Deferred();var e=new R({bundleUrl:A,async:true});if(s!==undefined&&s!==""){e.enhance({bundleUrl:s,async:true}).then(function(){if(c!==undefined&&c!==""){e.enhance({bundleUrl:c,async:true}).then(function(){e.getResourceBundle().then(function(f){r=f;d.resolve();});});}else{e.getResourceBundle().then(function(f){r=f;d.resolve();});}});}else if(c!==undefined&&c!==""){e.enhance({bundleUrl:c,async:true}).then(function(){e.getResourceBundle().then(function(f){r=f;d.resolve();});});}else{e.getResourceBundle().then(function(f){r=f;d.resolve();});}return d.promise();};function b(k,p){var t;if(k===sap.apf.core.constants.textKeyForInitialText){return"";}else if(a[k]){return jQuery.sap.formatMessage(a[k],p);}else if(H.hasItem(k)){t=r.getText(k,p,true);if(typeof t!=="string"||t===k){return H.getItem(k);}return t;}else if(o.hasItem(k)){return o.getItem(k);}t=r.getText(k,p,true);if(typeof t==="string"){return t;}m.putMessage(m.createMessageObject({code:"3001",aParameters:[k],oCallingObject:this}));var e="# text not available: "+k;o.setItem(k,e);return e;}};}());
