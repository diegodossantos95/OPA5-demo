// Copyright (c) 2009-2017 SAP SE, All Rights Reserved
sap.ui.define(function(){"use strict";sap.ui.controller("sap.ushell.components.flp.launchpad.group_list.GroupList",{onInit:function(){this.sViewId="#"+this.getView().getId();this.sGroupListId="#"+this.getView().oGroupList.getId();this.handleScroll=this._fHandleScroll.bind(this);},onAfterRendering:function(){this.jqView=jQuery(this.sViewId);this.jgGroupList=jQuery(this.sGroupListId);var e=sap.ui.getCore().getEventBus();e.unsubscribe("grouplist","ScrollAnimationEnd",this._handleScrollAnimationEnd,this);e.subscribe("grouplist","ScrollAnimationEnd",this._handleScrollAnimationEnd,this);e.unsubscribe("grouplist","DashboardRerender",this._addScroll,this);e.subscribe("grouplist","DashboardRerender",this._addScroll,this);e.unsubscribe("launchpad","dashboardScroll",this.handleScroll,this);e.subscribe("launchpad","dashboardScroll",this.handleScroll,this);this._addScroll();},_addScroll:function(){var t=this;setTimeout(function(){this.dashboardElement=document.querySelector(".sapUshellDashboardView section");if(this.dashboardElement){this.dashboardElement.removeEventListener('scroll',t.handleScroll);this.dashboardElement.addEventListener('scroll',t.handleScroll);}}.bind(this),0);},_fHandleScroll:function(){var m=this.getView().getModel(),t=m.getProperty("/topGroupInViewPortIndex");if(!m.getProperty("/scrollingToGroup")){if(!m.getProperty("/groupList-skipScrollToGroup")){var g=jQuery('#groupList li.sapUshellGroupLI');var s=g.removeClass('sapUshellSelected').eq(t);s.addClass('sapUshellSelected');var a=document.getElementById('groupListPage-cont');var b=a.scrollTop;var c=b+a.offsetHeight;var d=s[0]?s[0].offsetTop:undefined;if(d<b){jQuery('#groupListPage section').animate({scrollTop:g[t].offsetTop},0);}else if(d+s[0].offsetHeight>c){jQuery('#groupListPage section').animate({scrollTop:b+g[t].offsetHeight},0);}}sap.ushell.utils.handleTilesVisibility();}},_handleGroupListItemPress:function(e){var s=e.getSource(),f;f=e.getParameter("action")==="sapenter";this._handleScrollToGroup(s,false,f);},_handleScrollToGroup:function(g,a,f){if(!g){return;}var t=this;document.querySelector(".sapUshellDashboardView").removeEventListener('scroll',t.handleScroll);this._publishAsync("launchpad","scrollToGroup",{group:g,groupChanged:a,focus:f});},_handleScrollAnimationEnd:function(){var t=this;document.querySelector(".sapUshellDashboardView").addEventListener('scroll',t.handleScroll);this.getView().getModel().setProperty("/scrollingToGroup",false);},_publishAsync:function(c,e,d){var b=sap.ui.getCore().getEventBus();window.setTimeout($.proxy(b.publish,b,c,e,d),1);}});},true);
