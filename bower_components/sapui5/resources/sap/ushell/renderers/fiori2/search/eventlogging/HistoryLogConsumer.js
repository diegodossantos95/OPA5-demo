sap.ui.define(['sap/ushell/renderers/fiori2/search/eventlogging/EventConsumer'],function(E){"use strict";jQuery.sap.declare('sap.ushell.renderers.fiori2.search.eventlogging.HistoryLogConsumer');var m=sap.ushell.renderers.fiori2.search.eventlogging.HistoryLogConsumer=function(){this.init.apply(this,arguments);};m.prototype=jQuery.extend(new E(),{collectEvents:false,init:function(s){this.sina=s;},logEvent:function(e){switch(e.type){case this.eventLogger.ITEM_NAVIGATE:this._addUserHistoryEntry(e.targetUrl);break;}},_addUserHistoryEntry:function(t){if(!t){return;}if(t.indexOf("#")===-1){return;}var s=this.sina.getSystem().getServices();if(s.PersonalizedSearch&&s.PersonalizedSearch.capabilities&&s.PersonalizedSearch.capabilities.SetUserStatus){var u=this._createUserHistoryEntry(t);this.sina.addUserHistoryEntry(u).done(function(d){}).fail(function(e){});}},_createUserHistoryEntry:function(t){function g(p){var l=p;for(var i=0,n=l.length;i<n;i++){var o=l[i];if(o.indexOf("sap-system")!==-1){var q=o.split("=");return{"System":q[1].slice(4,7),"Client":q[1].slice(8,-1)};}}}function a(H){return H.split("-")[0];}function b(H){return H.split("-")[1].split("&")[0];}function c(p){var l=p;var n=[];for(var i=0,o=l.length;i<o;i++){var q=l[i];if(q.indexOf("sap-system")!==-1){continue;}var r=q.split("=")[0];var v=q.split("=")[1];n.push({"Name":r,Value:v});}return n;}var u={"NavigationEventList":[{"SourceApplication":{"SemanticObjectType":"","Intent":"","ParameterList":[]}},{"TargetApplication":{"SemanticObjectType":"","Intent":"","ParameterList":[]}}]};var h=window.hasher.getHashAsArray();var s=a(h[0]);u.NavigationEventList[0].SourceApplication.SemanticObjectType=s;var d=b(h[0]);u.NavigationEventList[0].SourceApplication.Intent=d;var e=c(h[1].split("&"));u.NavigationEventList[0].SourceApplication.ParameterList=e;h=t.split("?");var f=a(h[0]).split("#")[1];u.NavigationEventList[1].TargetApplication.SemanticObjectType=f;var j=b(h[0]);u.NavigationEventList[1].TargetApplication.Intent=j;var k=c(h[1].split("&"));u.NavigationEventList[1].TargetApplication.ParameterList=k;var S=g(h[1].split("&"));u.NavigationEventList[1].TargetApplication=jQuery.extend(u.NavigationEventList[1].TargetApplication,S);return u;}});return m;});
