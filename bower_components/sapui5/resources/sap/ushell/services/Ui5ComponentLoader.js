// Copyright (c) 2009-2017 SAP SE, All Rights Reserved
sap.ui.define(["sap/ushell/services/Ui5ComponentHandle"],function(U){"use strict";function a(c,p,C){this._oConfig=(C&&C.config)||{};function g(u){var P=jQuery.sap.getUriParameters(u).mParams,x=P["sap-xapp-state"],r;delete P["sap-xapp-state"];r={startupParameters:P};if(x){r["sap-xapp-state"]=x;}return r;}function b(s,t,P){Object.keys(P).forEach(function(S){var T,v;T=P[S];v=s[S];if(v){t[T]=jQuery.isPlainObject(v)?jQuery.extend(true,{},v):v;}});}this.createComponent=function(A,P,w){var d=new jQuery.Deferred(),s=window["sap-ui-debug"]===true?"sap/fiori/core-ext-light-dbg.js":"sap/fiori/core-ext-light.js",e=A&&A.url,o,l=true,f=jQuery.sap.isDeclared('sap.fiori.core',true)||jQuery.sap.isDeclared('sap.fiori.core-ext-light',true),L=true,h=A&&A.applicationDependencies||{},i,u,j,k=(this._oConfig&&this._oConfig.hasOwnProperty("amendedLoading"))?this._oConfig.amendedLoading:true,m=false;if(jQuery.isArray(h.messages)){h.messages.forEach(function(M){var S=String.prototype.toLowerCase.call(M.severity||"");S=["trace","debug","info","warning","error","fatal"].indexOf(S)!==-1?S:"error";jQuery.sap.log[S](M.text,M.details,h.name);});}if(A&&A.ui5ComponentName){o=jQuery.extend(true,{},A.applicationDependencies);j=jQuery.extend(true,{startupParameters:{}},A.componentData);if(e){i=e.indexOf("?");if(i>=0){u=g(e);j.startupParameters=u.startupParameters;if(u["sap-xapp-state"]){j["sap-xapp-state"]=u["sap-xapp-state"];}e=e.slice(0,i);}}b(A,j,{"applicationConfiguration":"config","reservedParameters":"technicalParameters"});o.componentData=j;if(A.hasOwnProperty("loadDefaultDependencies")){L=A.loadDefaultDependencies;delete A.loadDefaultDependencies;}if(this._oConfig&&this._oConfig.hasOwnProperty("loadDefaultDependencies")){L=L&&this._oConfig.loadDefaultDependencies;}L=L&&k;if(!o.asyncHints){o.asyncHints=L?{"libs":["sap.ca.scfld.md","sap.ca.ui","sap.me","sap.ui.unified"]}:{};}if(A.hasOwnProperty("loadCoreExt")){l=A.loadCoreExt;delete A.loadCoreExt;}if(l&&k&&!f){o.asyncHints.preloadBundles=o.asyncHints.preloadBundles||[];o.asyncHints.preloadBundles.push(s);}m=l&&(l||f||(k===false));if(w){o.asyncHints.waitFor=w;}if(!o.name){o.name=A.ui5ComponentName;}if(e){o.url=e;}o.async=true;if(P){o.id="application-"+P.semanticObject+"-"+P.action+"-component";U.onBeforeApplicationInstanceCreated(o);}sap.ui.component(o).then(function(n){A.componentHandle=new U(n);if(m){A.coreResourcesFullyLoaded=true;}d.resolve(A);},function(E){var n="The issue is most likely caused by application "+o.name,q="Failed to load UI5 component with properties: '"+JSON.stringify(o,null,4)+"'.";if(E.stack){q+=" Error likely caused by:\n"+E.stack;}if(E.status==="parsererror"){n+=", as one or more of its resources could not be parsed"}n+=". Please create a support incident and assign it to the support component of the respective application.";jQuery.sap.log.error(n,q,o.name);d.reject(E);});}else{d.resolve(A);}return d.promise();};};a.hasNoAdapter=true;return a;},true);
