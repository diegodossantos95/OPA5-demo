// Copyright (c) 2009-2017 SAP SE, All Rights Reserved
(function(s,q){"use strict";s.ui.define(["sap/ushell/services/Container","sap/ushell/services/AppConfiguration","sap/ushell/services/Personalization","sap/ushell/services/URLParsing","sap/ushell/services/CrossApplicationNavigation","sap/ushell/services/_SmartNavigation/complements"],function(c,a,p,u,C,P){c=s.ushell.Container;u=c.getService("URLParsing");C=c.getService("CrossApplicationNavigation");p=c.getService("Personalization");function b(){return new S(P,a,p,u,C);}b.hasNoAdapter=true;return b;});s.ushell.services.SmartNavigation=S;function S(p,a,P,u,c){if(!S.instance){Object.defineProperty(S,"instance",{value:Object.create(null,{getLinks:{value:function(A){var b=c.getLinks(A);var C=a.getCurrentApplication();var f=C.sShellHash;var o=C.componentHandle;if(C.componentHandle){o=C.componentHandle.getInstance();}if(!f){q.sap.log.warning("Call to SmartNavigation#getLinks() simply "+"delegated to CrossApplicationNavigation#getLinks()"+" because oAppConfiguration#getCurrentApplication()#sShellHash"+" evaluates to undefined.");return b;}return q.when(b,p.getNavigationOccurrences(f,P,o,u)).then(function(l,n){if(n.length===0){return l;}return p.prepareLinksForSorting(l,n,u).sort(function(L,O){return O.clickCount-L.clickCount;});});}},toExternal:{value:function(A,C){var _=arguments;var d=p.getHashFromOArgs(A.target,u);var t=function(){return c.toExternal.apply(c,_);};var o=a.getCurrentApplication();var f=o.sShellHash;var b=o.componentHandle;if(o.componentHandle){b=o.componentHandle.getInstance();}if(!f){q.sap.log.warning("Current shell hash could not be identified. Navigation will not be tracked.",null,"sap.ushell.services.SmartNavigation");return q.when(t());}if(!d){q.sap.log.warning("Destination hash does not conform with the ushell guidelines. Navigation will not be tracked.",null,"sap.ushell.services.SmartNavigation");return q.when(t());}return p.recordNavigationOccurrences(f,d,P,b,u).then(t);}},hrefForExternal:{value:function(){var h=c.hrefForExternal.apply(c,arguments);return h;}},getPrimaryIntent:{value:function(){var o=c.getPrimaryIntent.apply(c,arguments);return o;}},trackNavigation:{value:function(A){var t=A.target;var C=a.getCurrentApplication();var f=C.sShellHash;var d;if(!f){q.sap.log.warning("Call to SmartNavigation#trackNavigation() simply ignored"+" because oAppConfiguration#getCurrentApplication()#sShellHash"+" evaluates to undefined.");return q.when(null);}d=p.getHashFromOArgs(t,u);if(!d){q.sap.log.warning("Navigation not tracked - no valid destination provided",null,"sap.ushell.services.SmartNavigation");return q.when(null);}q.sap.log.debug("Navigation to "+d+" was tracked out of "+f,null,"sap.ushell.services.SmartNavigation");return p.recordNavigationOccurrences(f,d,P,C.componentHandle.getInstance(),u);}},constructor:{value:S}})});}return S.instance;}})(sap,jQuery);
