sap.ui.define(['sap/ui/core/Control'],function(C){"use strict";var a=C.extend("sap.ushell.ui.launchpad.CatalogsContainer",{metadata:{properties:{categoryFilter:{type:"string",defaultValue:"ALL"},categoryAllocateTiles:{type:"int",defaultValue:"0"}},aggregations:{catalogs:{type:"sap.ushell.ui.launchpad.CatalogEntryContainer",multiple:true}}},renderer:{render:function(r,c){var b=c.getCatalogs();if(b.length){c.setBusy(false);}r.write("<div");r.addClass("sapUshellCatalogsContainer");r.writeClasses();r.writeControlData(c);r.write(">");jQuery.each(b,function(i,d){r.renderControl(this);});r.write("</div>");}}});a.prototype.setPagingManager=function(p){jQuery.sap.measure.start("FLP:DashboardManager.CatalogsRendering","CatalogsRendering","FLP");jQuery.sap.measure.pause("FLP:DashboardManager.CatalogsRendering");this.oPagingManager=p;};a.prototype.setCategoryAllocateTiles=function(n){var i=this.getCatalogs();this.nAllocatedUnits=n;if(!this.indexingMaps){return;}if(!this.filters){this.filters={};}this.filters.pagination=function(e){var p=e.getPath(),c,b,d=this.getCatalogs();b=this.indexingMaps.onScreenPathIndexMap[p];c=d[b.aItemsRefrenceIndex];if(b.isVisible&&(c.nAllocatedUnits||this.nAllocatedUnits)){c.handleElements("appBoxesContainer");c.handleElements("customTilesContainer");}else{b.isVisible=false;}}.bind(this);this.indexingMaps=sap.ushell.ui.launchpad.TileContainerUtils.indexOnScreenElements(i);sap.ushell.ui.launchpad.TileContainerUtils.applyFilterOnAllItems(this.mBindingInfos["catalogs"],this.filters);if(this.indexingMaps){sap.ushell.ui.launchpad.TileContainerUtils.showHideTilesAndHeaders(this.indexingMaps,this.getCatalogs());}};a.prototype.setCategoryFilter=function(c){var s,i,o,I=this.getCatalogs();this.sCatalogTerm=c;if(!this.indexingMaps){return;}if(!this.filters){this.filters={};}this.filters.catalogEntry=function(e){var p=e.getPath(),b=e.getProperty("title")===this.sCatalogTerm,d;if(!this.sCatalogTerm){return;}d=this.indexingMaps.onScreenPathIndexMap[p];if(d){d.isVisible=b;}}.bind(this);for(s in this.indexingMaps.onScreenPathIndexMap){if(this.indexingMaps.onScreenPathIndexMap.hasOwnProperty(s)){i=this.indexingMaps.onScreenPathIndexMap[s];o=I[i.aItemsRefrenceIndex];if(c===o.getBindingContext().getProperty("title")){if(o.catalogState.appBoxesContainer!=="full"||o.catalogState.customTilesContainer!=="full"){if(this.oPagingManager){this.oPagingManager.moveToNextPage();this.nAllocatedUnits=this.oPagingManager._calcElementsPerPage();}if(o.catalogState.appBoxesContainer!=="full"){o.handleElements("appBoxesContainer");}if(o.catalogState.customTilesContainer!=="full"){o.handleElements("customTilesContainer");}}}}}if(this.oPagingManager){this.oPagingManager.moveToNextPage();this.nAllocatedUnits=this.oPagingManager._calcElementsPerPage();}this.indexingMaps=sap.ushell.ui.launchpad.TileContainerUtils.indexOnScreenElements(I);sap.ushell.ui.launchpad.TileContainerUtils.applyFilterOnAllItems(this.mBindingInfos["catalogs"],this.filters);if(this.indexingMaps){sap.ushell.ui.launchpad.TileContainerUtils.showHideTilesAndHeaders(this.indexingMaps,this.getCatalogs());}};a.prototype.updateAggregation=function(r){jQuery.sap.log.debug("Updating TileContainer. Reason: ",r);try{jQuery.sap.measure.resume("FLP:DashboardManager.CatalogsRendering");this.filterElements();jQuery.sap.measure.pause("FLP:DashboardManager.CatalogsRendering");}catch(e){sap.ui.base.ManagedObject.prototype.updateAggregation.apply(this,arguments);}};a.prototype.addNewItem=function(e,n){var N,b,i,p=e.getPath(),c=!!this.nAllocatedUnits;N=sap.ushell.ui.launchpad.TileContainerUtils.createNewItem.bind(this)(e,n);N.nAllocatedUnits=this.nAllocatedUnits;N.getAllocatedUnits=function(){return this.nAllocatedUnits;}.bind(this);N.elementFiltered=function(d,E,o){b=this.oPagingManager.getSizeofSupportedElementInUnits("tile");this.nAllocatedUnits+=d*b;this.setCategoryAllocateTiles(this.nAllocatedUnits);}.bind(this);N.newElementCreated=function(E,o){this.nAllocatedUnits-=this.oPagingManager.getSizeofSupportedElementInUnits("tile");if(this.nAllocatedUnits<=0){this.nAllocatedUnits=0;}}.bind(this);sap.ushell.ui.launchpad.TileContainerUtils.addNewItem.bind(this)(N,n);i=this.getCatalogs();this.indexingMaps.onScreenPathIndexMap[p]={aItemsRefrenceIndex:i.length-1,isVisible:true};this.catalogPagination[p]=c;return true;};a.prototype.handleFilters=function(){if(!this.catalogPagination){this.catalogPagination={};}if(!this.catalogsElementsMap){this.catalogsElementsMap={};}if(!this.filters){this.filters={};}};a.prototype.filterElements=function(){var n="catalogs",b=this.mBindingInfos[n].binding,B=b.getContexts(),i=this.getCatalogs(),c;if(!this.indexingMaps){this.indexingMaps=sap.ushell.ui.launchpad.TileContainerUtils.indexOnScreenElements(i);}this.handleFilters();c=sap.ushell.ui.launchpad.TileContainerUtils.markVisibleOnScreenElements(B,this.indexingMaps,false);if(!sap.ushell.ui.launchpad.TileContainerUtils.validateOrder(B,i,c)){throw true;}sap.ushell.ui.launchpad.TileContainerUtils.createMissingElementsInOnScreenElements(this.indexingMaps,B,c,this.addNewItem.bind(this),i,this.filters,n);i=this.getCatalogs();sap.ushell.ui.launchpad.TileContainerUtils.showHideTilesAndHeaders(this.indexingMaps,i);};return a;});
