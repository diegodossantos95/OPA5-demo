// Copyright (c) 2009-2017 SAP SE, All Rights Reserved
sap.ui.define(function(){"use strict";sap.ui.jsview("sap.ushell.ui.footerbar.SaveAsTile",{getControllerName:function(){return"sap.ushell.ui.footerbar.SaveAsTile";},createContent:function(c){this.oResourceBundle=sap.ushell.resources.i18n;this.viewData=this.getViewData()||{};this.appData=this.viewData.appData||{};this.oTitleInput=new sap.m.Input('bookmarkTitleInput',{tooltip:this.oResourceBundle.getText("bookmarkDialogoTitle_tooltip"),value:{path:"/title",mode:sap.ui.model.BindingMode.TwoWay}}).addStyleClass("sapUshellInputField");this.oTitleInput.addAriaLabelledBy("titleLbl");this.oSubTitleInput=new sap.m.Input('bookmarkSubTitleInput',{tooltip:this.oResourceBundle.getText("bookmarkDialogoSubTitle_tooltip"),value:{path:"/subtitle",mode:sap.ui.model.BindingMode.TwoWay}}).addStyleClass("sapUshellInputField");this.oSubTitleInput.addAriaLabelledBy("subtitleLbl");this.oInfoInput=new sap.m.Input('bookmarkInfoInput',{tooltip:this.oResourceBundle.getText("tileSettingsDialog_informationField"),value:{path:"/info",mode:sap.ui.model.BindingMode.TwoWay},visible:"{/showInfo}"}).addStyleClass("sapUshellInputField");this.oInfoInput.addAriaLabelledBy("infoLbl");var t={numberValue:"{/numberValue}",title:"{/title}",subtitle:"{/subtitle}",info:"{/info}",icon:"{/icon}",infoState:"{/infoState}",numberFactor:"{/numberFactor}",numberUnit:"{/numberUnit}",numberDigits:"{/numberDigits}",numberState:"{/numberState}",stateArrow:"{/stateArrow}",targetURL:"{/targetURL}",keywords:"{/keywords}"},p=function(d){var r=d;switch(d){case"Positive":r="Good";break;case"Negative":r="Critical";break;}return r;};var T,s;if(this.viewData.serviceUrl){T=new sap.m.GenericTile({header:t.title,subheader:t.subtitle,size:"Auto",tileContent:[new sap.m.TileContent({size:"Auto",footer:t.info,unit:t.numberUnit,content:[new sap.m.NumericContent({scale:t.numberFactor,value:t.numberValue,truncateValueTo:5,valueColor:p(t.numberState),indicator:t.stateArrow,icon:t.icon,width:"100%"})]})]});s=(typeof(this.viewData.serviceUrl)==="function")?this.viewData.serviceUrl():this.viewData.serviceUrl;c.calcTileDataFromServiceUrl(s);}else{T=new sap.m.GenericTile({header:t.title,subheader:t.subtitle,size:"Auto",tileContent:[new sap.m.TileContent({size:"Auto",footer:t.info,content:new sap.m.NumericContent({icon:t.icon,value:' ',width:"100%"})})]});}this.setTileView(T);var a=new sap.ushell.ui.launchpad.Tile({"long":false,tileViews:[T],afterRendering:function(e){var j=jQuery(this.getDomRef()),d=j.find(".sapMGT");d.removeAttr("tabindex");}}).addStyleClass("sapUshellBookmarkFormPreviewTileMargin");var P=new sap.m.Label("previewLbl",{text:" "+this.oResourceBundle.getText('previewFld'),visible:"{/showPreview}"}),o=new sap.m.Label("titleLbl",{required:true,text:" "+this.oResourceBundle.getText('titleFld'),labelFor:this.oTitleInput}),S=new sap.m.Label("subtitleLbl",{text:this.oResourceBundle.getText('subtitleFld'),labelFor:this.oSubTitleInput}),i=new sap.m.Label("infoLbl",{text:this.oResourceBundle.getText('tileSettingsDialog_informationField'),labelFor:this.oInfoInput,visible:"{/showInfo}"}),b=new sap.ui.core.HTML("previewBackgroundElement",{content:"<div class='sapUshellShellBG sapContrastPlus sapUiStrongBackgroundColor'></div>"}),h=new sap.m.FlexBox("saveAsTileHBox",{items:[b,a],alignItems:sap.m.FlexAlignItems.Center,justifyContent:sap.m.FlexJustifyContent.Center,renderType:sap.m.FlexRendertype.Bare,visible:"{/showPreview}"}).addStyleClass("sapUshellShellBG").addStyleClass("sapUshellBookmarkFormPreviewBoxBottomMargin");o.setLabelFor('bookmarkTitleInput');S.setLabelFor('bookmarkSubTitleInput');i.setLabelFor('bookmarkInfoInput');var g=new sap.m.Label("groupLbl",{text:this.oResourceBundle.getText('GroupListItem_label'),visible:"{/showGroupSelection}"});this.oGroupsSelect=new sap.m.Select("groupsSelect",{tooltip:this.oResourceBundle.getText('bookmarkDialogoGroup_tooltip'),items:{path:"/groups",template:new sap.ui.core.ListItem({text:"{title}"})},width:"100%",visible:{parts:["/showGroupSelection","/groups"],formatter:function(d,G){if(d&&!(G&&G.length)){this.oController.loadPersonalizedGroups();}return d;}.bind(this)}});this.oGroupsSelect.addAriaLabelledBy("groupLbl");return[P,h,o,this.oTitleInput,S,this.oSubTitleInput,i,this.oInfoInput,g,this.oGroupsSelect];},getTitleInput:function(){return this.oTitleInput;},getTileView:function(){return this.tileView;},setTileView:function(t){this.tileView=t;},getBookmarkTileData:function(){var s;if(this.oGroupsSelect&&this.oGroupsSelect.getSelectedItem()){s=this.oGroupsSelect.getSelectedItem().getBindingContext().getObject();}var u;if(this.viewData.customUrl){if(typeof(this.viewData.customUrl)==="function"){u=this.viewData.customUrl();}else{u=this.viewData.customUrl;}}else{u=hasher.getHash()?('#'+hasher.getHash()):window.location.href;}return{title:this.oTitleInput.getValue()?this.oTitleInput.getValue().substring(0,256).trim():'',subtitle:this.oSubTitleInput.getValue()?this.oSubTitleInput.getValue().substring(0,256).trim():'',url:u,icon:this.getModel().getProperty('/icon'),info:this.oInfoInput.getValue()?this.oInfoInput.getValue().substring(0,256).trim():'',numberUnit:this.viewData.numberUnit,serviceUrl:typeof(this.viewData.serviceUrl)==="function"?this.viewData.serviceUrl():this.viewData.serviceUrl,serviceRefreshInterval:this.viewData.serviceRefreshInterval,group:s,keywords:this.viewData.keywords};}});},false);
