// Copyright (c) 2009-2017 SAP SE, All Rights Reserved
sap.ui.define(['sap/ushell/utils','sap/ushell/User','sap/ushell/System'],function(u,U,S){"use strict";var C=function(i,p,P){var a="/sap/public/bc/icf/logoff",l=g(P.config,a),o=c(P.config),s=b(i,P.config);function g(f,D){if(f.systemProperties&&f.systemProperties.logoutUrl){return f.systemProperties.logoutUrl;}return D;}function c(f){var h,j=f.userProfile;if(j){h=d(j.defaults,f.userProfilePersonalization,j.metadata);}return new U(h||e());}function b(O,f){var h=f.systemProperties,A=O.getAlias(),j=O.getPlatform(),B=O.getBaseUrl(),k,m;if(h){A=h.alias||A;j=h.platform||j;k=h.SID;m=h.client;}return new S({alias:A,platform:j,baseUrl:B,system:k,client:m});}function d(D,f,h){var j=jQuery.extend(e(),D,f);j.bootTheme={theme:j.theme,root:""};delete j.theme;if(h&&h.editablePropterties){j.setThemePermitted=h.editablePropterties.indexOf("theme")>-1;j.setAccessibilityPermitted=h.editablePropterties.indexOf("accessibility")>-1;j.setContentDensityPermitted=h.editablePropterties.indexOf("contentDensity")>-1;}return j;}function e(){return{setThemePermitted:false,setAccessibilityPermitted:false,setContentDensityPermitted:false};}this._getLogoutUrl=function(){return l;};this._setDocumentLocation=function(L){document.location=L;};this.getSystem=function(){return s;};this.getUser=function(){return o;};this.load=function(){return jQuery.when();};this.getCurrentUrl=function(){return window.location.href;};this.logout=function(L){var f;if(!L){throw new Error("Not implemented");}if(u.hasNativeLogoutCapability()){f=(new URI(this._getLogoutUrl())).absoluteTo(this.getCurrentUrl()).search("").toString();u.getPrivateEpcm().doLogOff(f);}else{this.logoutRedirect();}return jQuery.when();};this.logoutRedirect=function(){var f=s.adjustUrl(this._getLogoutUrl());this._setDocumentLocation(f);};};return C;},true);
