(function(){var P=CodeMirror.Pos;function S(d,q,p,c){this.atOccurrence=false;this.doc=d;if(c==null&&typeof q=="string")c=false;p=p?d.clipPos(p):P(0,0);this.pos={from:p,to:p};if(typeof q!="string"){if(!q.global)q=new RegExp(q.source,q.ignoreCase?"ig":"g");this.matches=function(r,p){if(r){q.lastIndex=0;var l=d.getLine(p.line).slice(0,p.ch),e=0,m,s;for(;;){q.lastIndex=e;var n=q.exec(l);if(!n)break;m=n;s=m.index;e=m.index+(m[0].length||1);if(e==l.length)break;}var g=(m&&m[0].length)||0;if(!g){if(s==0&&l.length==0){m=undefined;}else if(s!=d.getLine(p.line).length){g++;}}}else{q.lastIndex=p.ch;var l=d.getLine(p.line),m=q.exec(l);var g=(m&&m[0].length)||0;var s=m&&m.index;if(s+g!=l.length&&!g)g=1;}if(m&&g)return{from:P(p.line,s),to:P(p.line,s+g),match:m};};}else{var o=q;if(c)q=q.toLowerCase();var f=c?function(s){return s.toLowerCase();}:function(s){return s;};var t=q.split("\n");if(t.length==1){if(!q.length){this.matches=function(){};}else{this.matches=function(r,p){if(r){var e=d.getLine(p.line).slice(0,p.ch),l=f(e);var m=l.lastIndexOf(q);if(m>-1){m=a(e,l,m);return{from:P(p.line,m),to:P(p.line,m+o.length)};}}else{var e=d.getLine(p.line).slice(p.ch),l=f(e);var m=l.indexOf(q);if(m>-1){m=a(e,l,m)+p.ch;return{from:P(p.line,m),to:P(p.line,m+o.length)};}}};}}else{var b=o.split("\n");this.matches=function(r,p){var l=t.length-1;if(r){if(p.line-(t.length-1)<d.firstLine())return;if(f(d.getLine(p.line).slice(0,b[l].length))!=t[t.length-1])return;var e=P(p.line,b[l].length);for(var g=p.line-1,i=l-1;i>=1;--i,--g)if(t[i]!=f(d.getLine(g)))return;var h=d.getLine(g),j=h.length-b[0].length;if(f(h.slice(j))!=t[0])return;return{from:P(g,j),to:e};}else{if(p.line+(t.length-1)>d.lastLine())return;var h=d.getLine(p.line),j=h.length-b[0].length;if(f(h.slice(j))!=t[0])return;var k=P(p.line,j);for(var g=p.line+1,i=1;i<l;++i,++g)if(t[i]!=f(d.getLine(g)))return;if(d.getLine(g).slice(0,b[l].length)!=t[l])return;return{from:k,to:P(g,b[l].length)};}};}}}S.prototype={findNext:function(){return this.find(false);},findPrevious:function(){return this.find(true);},find:function(r){var s=this,p=this.doc.clipPos(r?this.pos.from:this.pos.to);function b(l){var p=P(l,0);s.pos={from:p,to:p};s.atOccurrence=false;return false;}for(;;){if(this.pos=this.matches(r,p)){this.atOccurrence=true;return this.pos.match||true;}if(r){if(!p.line)return b(0);p=P(p.line-1,this.doc.getLine(p.line-1).length);}else{var m=this.doc.lineCount();if(p.line==m-1)return b(m);p=P(p.line+1,0);}}},from:function(){if(this.atOccurrence)return this.pos.from;},to:function(){if(this.atOccurrence)return this.pos.to;},replace:function(n){if(!this.atOccurrence)return;var l=CodeMirror.splitLines(n);this.doc.replaceRange(l,this.pos.from,this.pos.to);this.pos.to=P(this.pos.from.line+l.length-1,l[l.length-1].length+(l.length==1?this.pos.from.ch:0));}};function a(o,f,p){if(o.length==f.length)return p;for(var b=Math.min(p,o.length);;){var l=o.slice(0,b).toLowerCase().length;if(l<p)++b;else if(l>p)--b;else return b;}}CodeMirror.defineExtension("getSearchCursor",function(q,p,c){return new S(this.doc,q,p,c);});CodeMirror.defineDocExtension("getSearchCursor",function(q,p,c){return new S(this,q,p,c);});})();
