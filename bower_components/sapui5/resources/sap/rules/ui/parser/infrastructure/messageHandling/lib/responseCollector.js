jQuery.sap.declare("sap.rules.ui.parser.infrastructure.messageHandling.lib.responseCollector");jQuery.sap.require("sap.rules.ui.parser.infrastructure.messageHandling.lib.message");jQuery.sap.require("sap.rules.ui.parser.infrastructure.messageHandling.lib.opMessages");jQuery.sap.require("sap.rules.ui.parser.infrastructure.locale.lib.constants");jQuery.sap.require("sap.rules.ui.parser.infrastructure.errorHandling.hrfException");jQuery.sap.require("sap.rules.ui.parser.infrastructure.locale.lib.resourceBundle");sap.rules.ui.parser.infrastructure.messageHandling.lib.responseCollector=sap.rules.ui.parser.infrastructure.messageHandling.lib.responseCollector||{};sap.rules.ui.parser.infrastructure.messageHandling.lib.responseCollector.lib=(function(){var m=sap.rules.ui.parser.infrastructure.messageHandling.lib.message.lib.messages;var o=sap.rules.ui.parser.infrastructure.messageHandling.lib.opMessages.lib.opMessages;var l=sap.rules.ui.parser.infrastructure.locale.lib.constants.lib.propertiesEnum;var h=sap.rules.ui.parser.infrastructure.errorHandling.hrfException.lib;var r=sap.rules.ui.parser.infrastructure.locale.lib.resourceBundle.lib;var R=(function(){var S={error:1,warn:2,info:3,debug:4};var i=null;function R(){var t=-1;var a={code:{},message:{},output:{},details:[]};var b=[];var D=function(){};var c={};var d=false;var e=r.getInstance();function f(){b=[];d=false;}function g(s,p){if(!p||p===true){f();}c=new D();c.subject=s;a.details.push(c);}function j(){if(!c||!c.subject){jQuery.sap.log.error("ResponseCollector addMessage: no subject was defined");g("GENERAL",false);}if(!c.messages){c.messages=[];}}function k(p,q){var s="";s=e.getString(p.code,q,l.MESSAGES);return s;}function n(p,q,s){if(s){p.additionalInfo=s;}if(q){p.path=q;}if(d===false){if(t===-1||S[p.severity]<S[t]){t=p.severity;}}var u=JSON.parse(JSON.stringify(p));if(d===true){b.push(u);}else{c.messages.push(u);}return u;}return{build:function(){return a;},setOutput:function(p){a.output=p;},addMessage:function(p,q,s,u,v){j();var w=JSON.parse(JSON.stringify(m[p]));if(v!==null&&v!==undefined){w.description=v;}else{w.description=k(w,q);}return n(w,s,u);},getLastMessage:function(){if(!c.messages||c.messages.length===0){return null;}return c.messages[c.messages.length-1].description;},getMessage:function(p,q){var s="";var u=JSON.parse(JSON.stringify(m[p]));s=k(u,q);return s;},getTopSeverity:function(){if(t===-1){return null;}return t;},hold:function(){b=[];d=true;},unHold:function(){f();},getStandByMessagesList:function(){return b;},addSubject:function(s,p){g(s,p);},setOpMessage:function(p,s){if(!p||!s){throw new h.HrfException("setOpMessage: missing patrameters");}a.code=o[p][s].code;a.message=e.getString(a.code,null,l.OP_MESSAGES);},clear:function(){t=-1;a={code:{},message:{},output:{},details:[]};b=[];D=function(){};c={};d=false;},trace:function(s,p,q){if(q){h.trace(q);return;}var u="HRF Trace Message: "+p;switch(s){case S.error:jQuery.sap.log.error(u+"\n\nCall stack:\n----------\n"+(new Error()).stack+'\n\n-------------------------------------');break;case S.info:jQuery.sap.log.info(u);break;case S.debug:jQuery.sap.log.debug(u);break;case S.warn:jQuery.sap.log.error(u);break;}}};}return{severity:function(){return S;},getInstance:function(){if(!i){i=new R();i.constructor=null;}return i;}};}());return{ResponseCollector:R};}());
