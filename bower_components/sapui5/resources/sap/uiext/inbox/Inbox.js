/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 * 
 * (c) Copyright 2009-2017 SAP SE. All rights reserved
 */
jQuery.sap.declare("sap.uiext.inbox.Inbox");jQuery.sap.require("sap.uiext.inbox.library");jQuery.sap.require("sap.ui.core.Control");sap.ui.core.Control.extend("sap.uiext.inbox.Inbox",{metadata:{deprecated:true,publicMethods:["clearDrillDownFilter","clearRowSettings","bindTaskTable","getTaskTableBinding","bindTaskExecutionURL","bindTaskTypeDynamicFilter","bindSearch","setSubstitutionEnabled","getSubstitutionEnabled","bindTasks","setConfiguration","setOpenTaskUIInNewTab","addAction","refresh"],library:"sap.uiext.inbox",properties:{"taskExecutionURLThemeValue":{type:"string",group:"Misc",defaultValue:null},"handleBindings":{type:"boolean",group:"Misc",defaultValue:true},"openCompletedTasks":{type:"boolean",group:"Misc",defaultValue:false}},events:{"oDataRequestCompleted":{},"refresh":{},"taskAction":{},"taskSelectionChange":{}}}});sap.uiext.inbox.Inbox.M_EVENTS={'oDataRequestCompleted':'oDataRequestCompleted','refresh':'refresh','taskAction':'taskAction','taskSelectionChange':'taskSelectionChange'};
/*!
 * @copyright@
 */
jQuery.sap.require("sap.uiext.inbox.InboxConstants");jQuery.sap.require("sap.uiext.inbox.TCMMetadata");jQuery.sap.require("sap.uiext.inbox.tcm.TCMModel");jQuery.sap.require("sap.uiext.inbox.InboxLink");jQuery.sap.require("sap.uiext.inbox.InboxTaskCategoryFilterList");jQuery.sap.require("sap.uiext.inbox.TaskInitialFilters");jQuery.sap.require("sap.uiext.inbox.InboxUtils");jQuery.sap.require("sap.uiext.inbox.SubstitutionRulesManager");jQuery.sap.require("sap.uiext.inbox.InboxFilters");jQuery.sap.require("sap.uiext.inbox.controller.InboxControllerFactory");jQuery.sap.require("sap.uiext.inbox.InboxDataManager");jQuery.sap.require("sap.ui.core.format.DateFormat");jQuery.sap.require("sap.ui.core.ListItem");jQuery.sap.require("sap.ui.core.HTML");jQuery.sap.require("sap.ui.core.Locale");jQuery.sap.require("sap.ui.core.Icon");jQuery.sap.require("sap.ui.core.IconPool");jQuery.sap.require("sap.ui.commons.layout.MatrixLayout");jQuery.sap.require("sap.ui.commons.Image");jQuery.sap.require("sap.ui.commons.ToggleButton");jQuery.sap.require("sap.ui.commons.DropdownBox");jQuery.sap.require("sap.ui.commons.SearchField");jQuery.sap.require("sap.ui.commons.Toolbar");jQuery.sap.require("sap.ui.commons.TextView");jQuery.sap.require("sap.ui.commons.Label");jQuery.sap.require("sap.ui.commons.Button");jQuery.sap.require("sap.ui.commons.ToolbarSeparator");jQuery.sap.require("sap.ui.commons.Link");jQuery.sap.require("sap.ui.commons.TextField");jQuery.sap.require("sap.ui.commons.layout.BorderLayout");jQuery.sap.require("sap.ui.commons.layout.HorizontalLayout");jQuery.sap.require("sap.ui.commons.layout.VerticalLayout");jQuery.sap.require("sap.ui.commons.RadioButtonGroup");jQuery.sap.require("sap.ui.commons.Dialog");jQuery.sap.require("sap.uiext.inbox.InboxFormattedTextView");jQuery.sap.require("sap.uiext.inbox.InboxToggleTextView");jQuery.sap.require("sap.ui.ux3.FacetFilter");jQuery.sap.require("sap.ui.ux3.FacetFilterList");jQuery.sap.require("sap.ui.ux3.OverlayContainer");jQuery.sap.require("sap.ui.table.Table");jQuery.sap.require("sap.ui.model.Sorter");jQuery.sap.require("sap.ui.model.Filter");
sap.uiext.inbox.Inbox.prototype.init=function(){this.oTcmMetadata=new sap.uiext.inbox.TCMMetadata();this.oTCMModel=new sap.uiext.inbox.tcm.TCMModel();this.inboxUtils=sap.uiext.inbox.InboxUtils;this.constants=sap.uiext.inbox.InboxConstants;this.oDataManager=sap.uiext.inbox.InboxDataManager;this.oCore=sap.ui.getCore();this._oBundle=this.oCore.getLibraryResourceBundle("sap.uiext.inbox");var c=sap.ui.getCore().getConfiguration().getTheme();this._imgResourcePath=sap.ui.resource('sap.uiext.inbox','themes/'+c+'/img/');var u=jQuery.sap.getUriParameters();var d=this.constants.defaultView_URLParameter;var U=u.get(d);if(U===null){var a=this.inboxUtils.getCookieValue(d);this.defaultView=a!==undefined?a:this.constants.tableView;}else{this.defaultView=jQuery.inArray(U,this.constants.inboxViews)===-1?this.constants.tableView:U;this.inboxUtils.setCookieValue(d,this.defaultView,1);}var C={};C.bAsyncValue=(u.get(this.constants.async_URLParameter)==="true")?true:false;this.oController=new sap.uiext.inbox.controller.InboxControllerFactory(C).getController();this.oController.setView(this);var s=u.get("sap-ui-inbox-clientUpdate");if(s){s=s.toLowerCase();}if(s&&s==='true'){this.clientUpdate=true;}this.sProviderHost="";this.bRefreshTaskTypes=true;this.selectedContexts=[];this.sTypeOfModel="";this.bpmSvcUrl="";var t=this.constants.tableViewRowCount_URLParameter;this.tableViewRowCountValue=u.get(t);var r=this.constants.rrViewRowCount_URLParameter;this.rrViewRowCountValue=u.get(r);this.applyTaskCategoryFilter=false;this.isSubstitutionEnabled=false;this.isSubstitutionRuleCreationSupported=false;this.isCustomAttributesEnabled=false;this.isCustomActionsEnabled=false;this.showTaskDescription=false;this.showTaskCategory=true;this.isBatchOperationSupported=true;this.isForwardActionEnabled=false;this.isCommentsEnabled=false;this.bOpenTaskUIInNewTab=true;this.bUseBatch=false;this.bAllowCustomAttributeSort=true;this.bShowNoDueDateFilter=false;this.loggedInUserName;this.loggedInUserDisplayName;this._substitutionPath="";this.sCollectionPath="TaskCollection";this.filtersToApply={};this.filterState={};this.resetMessages=true;this.httpMethodForAction='POST';this.currentView=this.defaultView;this.bRefreshStartFlag=false;this.oPendingSearchRequest=undefined;this.getDefaultTaskExecutionURLCallBack=function(i,b){var I=this.sCollectionPath+"(InstanceID='"+i+"',SAP__Origin='"+b+"')/UIExecutionLink?$format=json";var e=this.bpmSvcUrl+I;var f="";var m=this.getCoreModel();var g=this;var h={async:false,requestUri:e,method:"GET",headers:{Accept:"application/json","x-csrf-token":m.oHeaders["x-csrf-token"]}};OData.request(h,function(j,k){f=j.GUI_Link;},function(j){if(j.response.statusCode==205){var k={statusCode:j.response.statusCode,statusText:j.response.statusText};m.fireRequestFailed(k);}else{var M=g.inboxUtils.getErrorMessageFromODataErrorObject(j);g.showMessage("error",g._oBundle.getText("INBOX_MSG_ERR_EXUI")+" "+i+"; "+M);}});if(f.search("HRMSS_LR_APPR_G")!=-1){var l=sap.ui.getCore().getConfiguration().getLanguage();f=f+"&sap-language="+l;}return f;};this.getTaskExecURLStatusCallBack=function(i,b){var e="";var f=this.bpmSvcUrl+this.sCollectionPath+"(InstanceID='"+i+"',SAP__Origin='"+b+"')?$format=json";var m=this.getCoreModel();var g=this;var h={async:false,requestUri:f,method:"GET",headers:{Accept:"application/json","x-csrf-token":m.oHeaders["x-csrf-token"]}};OData.request(h,function(j,k){e=j.Status;},function(j){if(j.response.statusCode==205){var k={statusCode:j.response.statusCode,statusText:j.response.statusText};m.fireRequestFailed(k);}else{g.showMessage("error",g._oBundle.getText("INBOX_MSG_ERR_EXUI")+" "+i);}});return e;};this.searchCallBack="";this.dynamicTaskTypeFilterCallBack="";this.getTaskExecutionURLCallBack=this.getDefaultTaskExecutionURLCallBack;this.lastRefreshedOnDateTime=new Date();this.vLayout=this.createInboxUI();this.vLayout.setParent(this);this.addAndRemoveSubstDropDowns();this.constants=sap.uiext.inbox.InboxConstants;this.lastRefreshedOnDateTime=new Date();this.bCustomAttributesVisible=false;};
sap.uiext.inbox.Inbox.prototype.exit=function(){this.vLayout.destroy();this.vLayout=null;function r(i){var I=sap.ui.getCore().byId(i);I&&I.destroy();}r(this.getId()+'--'+"dropdownCell1");r(this.getId()+'--'+"dropdownCell2");r(this.getId()+'--'+"dropdownCell3");r(this.getId()+'--'+"manageSubstitutionMI");r(this.getId()+'--'+"rrMainMatrixLayout");r(this.getId()+'--'+"separatorRRViewCell");if(this.oCustomActionToolPopup){r(this.oCustomActionToolPopup.getId());}if(this.oCustomActionToolPopupCommentsMand){r(this.oCustomActionToolPopupCommentsMand.getId());}this._oBundle=undefined;delete this.oCustomActionToolPopup;delete this.oCustomActionToolPopupCommentsMand;};
sap.uiext.inbox.Inbox.prototype.createAttributes=function(a,p){var t=this;if(a.name==="INBOX_FILTER_CATEGORY"){var A=new sap.uiext.inbox.InboxTaskCategoryFilterList(this.getId()+'--'+a.name);A.setSelectedKeys(["INBOX_FILTER_CATEGORY_TASKS"]);}else{var A=new sap.ui.ux3.FacetFilterList(this.getId()+'--'+a.name);}A.setTitle(this._oBundle.getText(a.name));for(var i=0;i<a.attributes.length;i++){if(typeof a.attributes[i]=="string"||a.attributes[i].key!=undefined){var b;var o;if(a.attributes[i].key!=undefined){var c=a.attributes[i];b=t.inboxUtils.scrub(c.key);o=new sap.ui.core.ListItem(this.getId()+'--'+b,{text:a.attributes[i].value,key:a.attributes[i].key});if(c.sap__Origin){o.data("SAP__Origin",c.sap__Origin);}if(c.instanceID){o.data("InstanceID",c.instanceID);}}else{b=t.inboxUtils.scrub(a.attributes[i]);o=new sap.ui.core.ListItem(this.getId()+'--'+b,{text:this._oBundle.getText(a.attributes[i]),key:b});}A.addItem(o);}else{t.createAttributes(a.attributes[i],A);}}p.addList(A);};
sap.uiext.inbox.Inbox.prototype.toggleFilterView=function(e,I){var t=I;var f=sap.ui.getCore().byId(t.getId()+'--'+"filterFacet");t.showBusyLoader();if(f===undefined){f=new sap.ui.ux3.FacetFilter(t.getId()+'--'+"filterFacet");var F=t.applyTaskCategoryFilter?t.constants.aDrillDownFilterMetadata:t.bShowNoDueDateFilter?t.constants.aFilterMetaDataWithNoDueDate:t.constants.aFilterMetaData;for(var a=0;a<F.length;a++){t.createAttributes(F[a],f);}var v=sap.ui.getCore().byId(t.getId()+'--'+"verticalLayoutContainer");v.insertContent(f,1);var l=f.getLists();for(var i=0;i<l.length;i++){if(l[i].getId()===t.getId()+'--'+"INBOX_FILTER_PRIORITY"){l[i].attachSelect(t,t.applyDrillDownFilterForPriority);}else if(l[i].getId()===t.getId()+'--'+"INBOX_FILTER_STATUS"){l[i].attachSelect(t,t.applyDrillDownFilterForStatus);}else if(l[i].getId()===t.getId()+'--'+"INBOX_FILTER_CREATION_DATE"){l[i].setMultiSelect(false);l[i].attachSelect(t,t.applyDrillDownFilterForDateTime);}else if(l[i].getId()===t.getId()+'--'+"INBOX_FILTER_TASK_TYPE"){l[i].attachSelect(t,t.applyDrillDownFilterForTaskType);}else if(l[i].getId()===t.getId()+'--'+"INBOX_FILTER_DUE_DATETIME"){l[i].setMultiSelect(false);l[i].attachSelect(t,t.applyDrillDownFilterForDueDate);}else if(l[i].getId()===t.getId()+'--'+"INBOX_FILTER_CATEGORY"){l[i].setMultiSelect(false);l[i].attachSelect(t,t.applyDrillDownFilterForTaskCategory);}}}var s=sap.ui.getCore().byId(t.getId()+'--'+"INBOX_FILTER_STATUS");if(sap.ui.getCore().byId(t.getId()+'--'+"filterComboBox2").getSelectedItemId()===t.getId()+'--'+"li_completedTasks"){if(s!=undefined){f.removeList(s);}if(o!==undefined){f.removeList(o);}}var o=sap.ui.getCore().byId(t.getId()+'--'+"INBOX_FILTER_CREATION_DATE");var b=sap.ui.getCore().byId(t.getId()+'--'+"INBOX_FILTER_DUE_DATETIME");var S=sap.ui.getCore().byId(t.getId()+'--'+"filterComboBox2").getSelectedItemId();if(S===t.getId()+'--'+"li_overdueTasks"||S===t.getId()+'--'+"li_escalatedTasks"){if(o!==undefined&&f.indexOfList(o)!==-1){f.removeList(o);}if(b!==undefined&&f.indexOfList(b)!==-1){f.removeList(b);}}var c=t._getComponent("filterViewButton");f.setVisible(c.getPressed());t.hideBusyLoader();};
sap.uiext.inbox.Inbox.prototype.populateFilterButtonContainer=function(f){var a=new sap.ui.commons.layout.MatrixLayoutCell({id:this.getId()+'--'+"filterButtonCell"});var s=false;var b=new sap.ui.commons.ToggleButton(this.getId()+'--'+"filterViewButton",{icon:sap.uiext.inbox.InboxConstants.filterViewImage,pressed:false,tooltip:this._oBundle.getText("INBOX_BUTTON_FILTER_VIEW_TOOLTIP")});b.attachPress(this,this.toggleFilterView);b.addStyleClass("sapUiExtInboxToolBarContainerHeight");a.addContent(b);a.setPadding(sap.ui.commons.layout.Padding.None);f.createRow(a);};
sap.uiext.inbox.Inbox.prototype.addAndRemoveSubstDropDowns=function(){var d=sap.ui.getCore().byId(this.getId()+'--'+"dropdownRow");var a=sap.ui.getCore().byId(this.getId()+'--'+"dropdownCell1");var b=sap.ui.getCore().byId(this.getId()+'--'+"dropdownCell2");var c=sap.ui.getCore().byId(this.getId()+'--'+"dropdownCell3");var m=sap.ui.getCore().byId(this.getId()+'--'+"manageSubstitutionMI");var M=sap.ui.getCore().byId(this.getId()+'--'+"rrManageSubstitutionMI");if(this.getSubstitutionEnabled()){d.addCell(a);d.addCell(b);d.addCell(c);}else{if(d!=undefined){d.removeCell(a);d.removeCell(c);}}var r=sap.ui.getCore().byId(this.getId()+'--'+"rrSettingsButton");var t=sap.ui.getCore().byId(this.getId()+'--'+"settingsButton");this._manageVisibilityOfSettingsButton(r);this._manageVisibilityOfSettingsButton(t);};
sap.uiext.inbox.Inbox.prototype.populateDropDownContainer=function(d){var a=new sap.ui.commons.layout.MatrixLayoutRow(this.getId()+'--'+"dropdownRow");var b=new sap.ui.commons.layout.MatrixLayoutCell(this.getId()+'--'+"dropdownCell1");b.setPadding(sap.ui.commons.layout.Padding.None);var c=new sap.ui.commons.DropdownBox(this.getId()+'--'+"filterComboBox1",{tooltip:this._oBundle.getText("INBOX_TASKS_FILTER_DROPDOWN_TOOLTIP"),items:[new sap.ui.core.ListItem(this.getId()+'--'+"li_allTasks",{text:this._oBundle.getText("INBOX_DROP_DOWN_VALUE_ALL_TASKS")}),new sap.ui.core.ListItem(this.getId()+'--'+"li_myTasks",{text:this._oBundle.getText("INBOX_MY_TASKS_TEXT")}),new sap.ui.core.ListItem(this.getId()+'--'+"li_substitutedTasks",{text:this._oBundle.getText("SUBSTITUTION_INBOX_DROP_DOWN_VALUE_TASKS_ASSIGNED_TO_ME")})]});c.attachChange(this,this.applyDropDownFilter1);c.setValue(this._oBundle.getText("INBOX_DROP_DOWN_VALUE_ALL_TASKS"));c.addStyleClass("sapUiExtInboxToolBarContainerHeight");c.addStyleClass("sapUiExtInboxComboBox");b.addContent(c);a.addCell(b);var e=new sap.ui.commons.layout.MatrixLayoutCell(this.getId()+'--'+"dropdownCell2");e.setPadding(sap.ui.commons.layout.Padding.None);var f=new sap.ui.commons.DropdownBox(this.getId()+'--'+"filterComboBox2",{tooltip:this._oBundle.getText("INBOX_TASKS_FILTER_DROPDOWN_TOOLTIP"),items:[new sap.ui.core.ListItem(this.getId()+'--'+"li_openTasks",{text:this._oBundle.getText("INBOX_DROP_DOWN_VALUE_OPEN_TASKS")}),new sap.ui.core.ListItem(this.getId()+'--'+"li_completedTasks",{text:this._oBundle.getText("INBOX_DROP_DOWN_VALUE_COMPLETED_TASKS")}),new sap.ui.core.ListItem(this.getId()+'--'+"li_overdueTasks",{text:this._oBundle.getText("INBOX_DROP_DOWN_VALUE_OVERDUE_TASKS")}),new sap.ui.core.ListItem(this.getId()+'--'+"li_escalatedTasks",{text:this._oBundle.getText("INBOX_DROP_DOWN_VALUE_ESCALATED_TASKS")})]});f.attachChange(this,this.applyDropDownFilter);f.setValue(this._oBundle.getText("INBOX_DROP_DOWN_VALUE_OPEN_TASKS"));f.addStyleClass("sapUiExtInboxToolBarContainerHeight");f.addStyleClass("sapUiExtInboxComboBox");e.addContent(f);a.addCell(e);var g=new sap.ui.commons.layout.MatrixLayoutCell(this.getId()+'--'+"dropdownCell3");g.setPadding(sap.ui.commons.layout.Padding.None);var h=new sap.ui.commons.DropdownBox(this.getId()+'--'+"filterComboBox3",{maxPopupItems:10});var o='';if(sap.ui.getCore().byId(this.getId()+'--'+'onBehalfOfListItem')===undefined){var o=new sap.ui.core.ListItem(this.getId()+'--'+'onBehalfOfListItem');}o.setText(this._oBundle.getText("SUBSTITUTION_INBOX_FILTER_ON_BEHALF_OF"));o.setKey("onBehalfOf");h.addItem(o);var i='';if(sap.ui.getCore().byId(this.getId()+'--'+'li_allUsers')===undefined){i=new sap.ui.core.ListItem(this.getId()+'--'+'li_allUsers');}i.setText(this._oBundle.getText("INBOX_DROP_DOWN_VALUE_ALL_USERS"));i.setKey("allUsers");h.addItem(i);h.attachChange(this,this.applyDropDownFilter3);h.setValue(this._oBundle.getText("SUBSTITUTION_INBOX_FILTER_ON_BEHALF_OF"));h.addStyleClass("sapUiExtInboxToolBarContainerHeight");h.addStyleClass("sapUiExtInboxComboBox");h.setEnabled(false);g.addContent(h);a.addCell(g);d.addRow(a);this.addAndRemoveSubstDropDowns();};
sap.uiext.inbox.Inbox.prototype.populateSearchFieldContainer=function(s){var a=new sap.ui.commons.layout.MatrixLayoutCell(this.getId()+'--'+"searchBoxCell");a.setPadding(sap.ui.commons.layout.Padding.None);var b=new sap.ui.commons.SearchField(this.getId()+'--'+"searchField",{enableListSuggest:false,enableClear:true,startSuggestion:0,tooltip:this._oBundle.getText("INBOX_SEARCH_TEXT")});b.addStyleClass("sapUiExtInboxSearchField");b.attachSuggest(this,function(e,t){if(e.getParameter("value")===""){t.resetSearchCriteria();t.applyFilterOnResponse(null);}});b.attachSearch(this,this.localSearch);a.addContent(b);s.createRow(a);};
sap.uiext.inbox.Inbox.prototype.populateNotificationBar=function(){var n=new sap.ui.ux3.NotificationBar({id:this.getId()+'--'+"notificationBar",visibleStatus:"None"});var m=new sap.ui.ux3.Notifier({id:this.getId()+'--'+"messageNotifier",title:this._oBundle.getText("INBOX_NOTIFICATIONS"),messageSelected:function onMessageSelected(e){}});n.setMessageNotifier(m);n.addStyleClass("sapUiExtInboxNotificationBar");return n;};
sap.uiext.inbox.Inbox.prototype.populateToolBar=function(){var t=new sap.ui.commons.layout.MatrixLayout(this.getId()+'--'+"toolbarContainer",{layoutFixed:false,width:"100%",columns:6,widths:["1px","1px","1px","1px","100%","1px"]});var v=new sap.ui.commons.layout.MatrixLayout(this.getId()+'--'+"viewButtonsContainer",{layoutFixed:false});var f=new sap.ui.commons.layout.MatrixLayout(this.getId()+'--'+"filterButtonContainer",{layoutFixed:false});var r=new sap.ui.commons.layout.MatrixLayout(this.getId()+'--'+"refreshButtonContainer",{layoutFixed:false});var d=new sap.ui.commons.layout.MatrixLayout(this.getId()+'--'+"dropDownContainer",{layoutFixed:false});var e=new sap.ui.commons.Label(this.getId()+'--'+"emptyLabel",{text:""});var s=new sap.ui.commons.layout.MatrixLayout(this.getId()+'--'+"searchFieldContainer",{layoutFixed:false});t.createRow(v,d,f,r,e,s);this.populateViewButtonsContainer(v);this.populateDropDownContainer(d);this.populateFilterButtonContainer(f);this.populateRefreshButtonContainer(r);this.populateSearchFieldContainer(s);return t;};
sap.uiext.inbox.Inbox.prototype.populateViews=function(){var t=this;var v=sap.ui.getCore().byId(this.getId()+'--'+'verticalLayoutContainer');var a=new sap.ui.commons.Toolbar(this.getId()+'--'+"actionButtonsToolbarContainer");a.setDesign(sap.ui.commons.ToolbarDesign.Standard);a.addStyleClass("sapUiExtInboxActionButtonsToolbarContainer");if(sap.ui.getCore().byId(this.getId()+'--'+'openActionButton')===undefined){var c=new sap.ui.commons.Button(this.getId()+'--'+"openActionButton",{icon:this.constants.iconPool.getIconURI("open-folder"),text:this._oBundle.getText("INBOX_ACTION_BUTTON_OPEN"),enabled:false,tooltip:this._oBundle.getText("INBOX_ACTION_BUTTON_OPEN")});c.attachPress(this,function(E,h){t.showBusyLoader();t.populateTaskExecutionContent();t.hideBusyLoader();});a.addItem(c);}if(sap.ui.getCore().byId(this.getId()+'--'+'claimActionButton')===undefined){var b=new sap.ui.commons.Button(this.getId()+'--'+"claimActionButton",{icon:this.constants.iconPool.getIconURI("locked"),text:this._oBundle.getText("INBOX_ACTION_BUTTON_CLAIM"),enabled:false,tooltip:this._oBundle.getText("INBOX_ACTION_BUTTON_CLAIM"),visible:false});b.attachPress({inbox:t,view:t.constants.tableView,action:"Claim"},t.executeActionOnTask);b.setVisible(false);a.addItem(b);}if(sap.ui.getCore().byId(this.getId()+'--'+'releaseActionButton')===undefined){var r=new sap.ui.commons.Button(this.getId()+'--'+"releaseActionButton",{icon:this.constants.iconPool.getIconURI("unlocked"),text:this._oBundle.getText("INBOX_ACTION_BUTTON_RELEASE"),enabled:false,tooltip:this._oBundle.getText("INBOX_ACTION_BUTTON_RELEASE"),visible:false});r.attachPress({inbox:t,view:t.constants.tableView,action:"Release"},t.executeActionOnTask);r.setVisible(false);a.addItem(r);}if(sap.ui.getCore().byId(this.getId()+'--'+'forwardActionButton')===undefined){var f=new sap.ui.commons.Button(this.getId()+'--'+"forwardActionButton",{icon:this.constants.iconPool.getIconURI("open-command-field"),text:this._oBundle.getText("INBOX_ACTION_BUTTON_FORWARD"),enabled:false,tooltip:this._oBundle.getText("INBOX_ACTION_BUTTON_FORWARD"),visible:false});f.attachPress({inbox:t,view:t.constants.tableView,action:"Forward"},t._executeForwardAction);a.addItem(f);}if(sap.ui.getCore().byId(this.getId()+'--'+'settingsButton')===undefined){var s=new sap.ui.commons.Button(this.getId()+'--'+"settingsButton",{tooltip:this._oBundle.getText("INBOX_MANAGE_SUBSTITUTION_RULES_TOOLTIP"),icon:this.constants.iconPool.getIconURI("workflow-tasks"),iconHovered:this._imgResourcePath+sap.uiext.inbox.InboxConstants.settingsImageHover,iconSelected:this._imgResourcePath+sap.uiext.inbox.InboxConstants.settingsImageHover,lite:true});s.addStyleClass("sapUiExtInboxToolbarRight");s.addStyleClass("sapUiExtInboxSettingsButton");s.attachPress(t,t.onSubstitutionButtonPress);a.addItem(s);}v.addContent(a);if(t._getComponent('listViewTable')===undefined){var T=new sap.ui.table.Table(t.getId()+'--'+"listViewTable",{});T.attachFilter(function(E){E.preventDefault();var C=E.getParameter("column");var V=E.getParameter("value");t._applyFilterOnTableColumns(C,V);t._preserveTableSort();});T.setThreshold(10000);T.addStyleClass("sapUiExtInboxCustomTable");T.setEditable(false);T.bDynamic=true;T.setBusyIndicatorDelay(0);var d=t._getCategoryMetadata();var e=d.properties.length;for(var g=0;g<e;g++){t._createTableColumnContent(g,d);}t.bSorted=false;T.attachSort(function(E){var C=E.getParameter("column");if(t._isCustomAttribute(C)){E.preventDefault();var h=C.data("customAttrName");var j=null;var k=null;var l=t.constants;var o=l.oTaskDefinitionCustomAttributesMap;var m=t._getComponent("INBOX_FILTER_TASK_TYPE");var S=m.getSelectedKeys();if(S){var n=S[0];var p=o[n];if(p){for(var i=0;i<p.length;i++){var q=p[i];if(q.Name==h){var j=q.Type;break;}}}}if(j){k=E.getParameter("sortOrder");}t._applySortOnTableColumn(C,h,j,k);}else{var u=t._currentViewElement();if(u._originalKeys){var L=u.getBinding('rows');L.iLength=u._originalKeys.length;}t.bSorted=true;t.resetSearchCriteria();}});T.attachRowSelectionChange(function(E){t._handleTableRowSelect(E);});T.clearSelection();}v.addContent(T);v.addContent(t.createTableRowSettingsContent());t.createRowRepeaterView();};
sap.uiext.inbox.Inbox.prototype.addAction=function(a,d,t,A,m){var T=4;if(m===undefined){m=true;}if(a&&d&&A&&t){var o=this._getActionButtonToolBarForTableView();var b=new sap.ui.commons.Button(this.getId()+'--'+a,{text:d,enabled:true,tooltip:t}).attachPress(A);o.insertItem(b,100);}else{if(arguments.length<T){console.error("Add Action failed: missing parameters");}}return this;};
sap.uiext.inbox.Inbox.prototype._handleTableRowSelect=function(e){var d=this.getCoreModel();var t=this;var s=[],S=[];var a=[];var b=[];var l=this._getComponent('listViewTable');var c=l.getSelectedIndices();var p=e.getParameters();var o={aSupportsClaim:[],aSupportsRelease:[],aSupportsForward:[]};jQuery.each(c,function(i,g){var r=l.getContextByIndex(g);s.push(d.getProperty("Status",r));var h=d.getProperty(t.constants.TaskDefinitionCollection.properties.taskDefnID,r);var j=d.getProperty(t.constants.sapOrigin,r);if(jQuery.inArray(h,a)===-1){a.push(d.getProperty(t.constants.TaskDefinitionCollection.properties.taskDefnID,r));}if(jQuery.inArray(j,S)===-1){S.push(j);}b.push(d.getProperty(t.constants.InstanceID,r));o.aSupportsClaim.push(d.getProperty("SupportsClaim",r));o.aSupportsRelease.push(d.getProperty("SupportsRelease",r));if(t.isForwardActionEnabled){o.aSupportsForward.push(d.getProperty("SupportsForward",r));}});this.disableActionButtonsOnMultiStatus(s,o,S);if(this.isCustomActionsEnabled){this._deleteCustomActionsForTableView();var f=this._isCompletedTasksSelected();if(a&&a.length===1&&!f){this._createCustomActionsOnTableRowSelect(b,S);}}this._handleForwardButtonVisibilityOnRowSelection(S,o);var T=[];jQuery.each(c,function(i,g){var r=l.getContextByIndex(g);var h=d.getProperty(t.constants.InstanceID,r);var j=d.getProperty(t.constants.sapOrigin,r);var k={};k["InstanceID"]=h;k["SAP__Origin"]=j;T.push(k);});this.fireTaskSelectionChange({"taskUniqueIdentifiers":T});};
sap.uiext.inbox.Inbox.prototype._createCustomActionsOnTableRowSelect=function(s,S){this._getCustomActionsDefinitionOnMultiSelect(s,S[0]);};
sap.uiext.inbox.Inbox.prototype._getCustomActionsDefinitionOnMultiSelect=function(s,S){var c=sap.uiext.inbox.InboxConstants.taskInstanceDecisionOptionsMap;var a=s.length;var A=[],C,f=[];for(var i=0;i<a;i++){C=c[s[i]];if(C){A.push(C);}else{f.push(s[i]);}}var F=f.length;if(F<=1){this._getCustomActionsDefinition(f[0],S,A);}else{this._fetchCustomActionsOnMultiSelect(A,f,S);}};
sap.uiext.inbox.Inbox.prototype._fetchCustomActionsOnMultiSelect=function(a,f,s){if(this.bUseBatch){this._fetchCustomActionsUsingBatch(a,f,s);}else{this._fetchCustomActionsUsingAsyncCall(f,s,a);}};
sap.uiext.inbox.Inbox.prototype._fetchCustomActionsUsingBatch=function(a,f,s){var u=[];jQuery.each(f,function(i,I){var U={};U.InstanceID="'"+I+"'";U.SAP__Origin="'"+s+"'";u.push(U);});this.oDataManager.fireBatchRequest({sPath:this.constants.decisionOptionsFunctionImport,sMethod:"GET",sBatchGroupId:"fetchDecisionOptions",aUrlParameters:u,numberOfRequests:f.length,fnSuccess:jQuery.proxy(this._processCustomActionsBatchResponse,{oInbox:this,aAvailableCustomActionArrayList:a,aFetchCustomActionsFor:f}),fnError:jQuery.proxy(this._handleErrorOnBatchRequests,this)});};
sap.uiext.inbox.Inbox.prototype._processCustomActionsBatchResponse=function(d,r){var b=d.__batchResponses;var a=0;jQuery.each(b,jQuery.proxy(function(i,c){if(c&&c.statusCode&&c.statusCode==200){this.oInbox.constants.taskInstanceDecisionOptionsMap[this.aFetchCustomActionsFor[a++]]=c.data.results;this.aAvailableCustomActionArrayList.push(c.data.results);}},this));this.oInbox._displayCustomActions([],this.aAvailableCustomActionArrayList);};
sap.uiext.inbox.Inbox.prototype._createTableColumnContent=function(i,a){var t=this;var T=this._getComponent('listViewTable');if(a.properties[i]=="TaskTitle"){var f=t._getFirstColumnContentTemplate();var o=t._createTableColumn(i,a,"INBOX_TASK_TITLE_TOOLTIP",f);o.setWidth("330px");o.setFlexible(false);T.insertColumn(o,i);}else if(a.properties[i]=="CreatedOn"){var c=new sap.ui.commons.TextView({text:{formatter:t.inboxUtils.dateTimeFormat,path:a.properties[i]}});c.bindProperty("tooltip",a.properties[i],t.tooltipFormatForDateTime);var C=t._createTableColumn(i,a,"INBOX_START_DATE_TOOLTIP",c);C.setFlexible(true);T.insertColumn(C,i);}else if(a.properties[i]=="CreatedByName"){var b=new sap.ui.commons.TextView({text:{path:a.properties[i]}});b.bindProperty("tooltip",a.properties[i]);var d=t._createTableColumn(i,a,"INBOX_CREATED_BY_NAME_TOOLTIP",b);d.setFlexible(true);T.insertColumn(d,i);}else if(a.properties[i]=="CompletionDeadLine"){var e=new sap.ui.commons.TextView({text:{formatter:t.inboxUtils.dateTimeFormat,path:a.properties[i]}});e.bindProperty("tooltip",a.properties[i],t.tooltipFormatForDateTime);var g=t._createTableColumn(i,a,"INBOX_DUE_DATE_TOOLTIP",e);g.setFlexible(true);T.insertColumn(g,i);}else if(a.properties[i]=="Status"){var s=new sap.ui.commons.TextView();s.bindText({parts:[{path:"Status",type:new sap.ui.model.type.String()},{path:"StatusText",type:new sap.ui.model.type.String()}],formatter:function(h,j){return t._getTaskStatus(h,j);},useRawValues:true});var S=t._createTableColumn(i,a,"INBOX_STATUS_TOOLTIP",s);S.setFlexible(true);T.insertColumn(S,i);}else if(a.properties[i]=="Priority"){var p=new sap.ui.commons.TextView();p.bindProperty("text","Priority",function(v){if(v!=null&&v!=""&&v!=undefined){return t._oBundle.getText(t.constants.prioTooltip[v]);}return"";});var P=t._createTableColumn(i,a,"INBOX_PRIORITY_TOOLTIP",p);P.setFlexible(true);T.insertColumn(P,i);}};
sap.uiext.inbox.Inbox.prototype._createTableColumn=function(c,i,a,b){var p=i.properties[c];var t=new sap.ui.table.Column({id:this.getId()+'--'+p}).setLabel(new sap.ui.commons.Label({text:this._oBundle.getText(i.propertiesLabel[c]),tooltip:this._oBundle.getText(a),design:sap.ui.commons.LabelDesign.Bold})).setTemplate(b).setSortProperty(p).data("ColumnType","StandardAttribute");var C=this.constants.TABLE_VIEW_TECH_NAMES;if(p!==C.INBOX_TABLE_VIEW_STATUS&&p!==C.INBOX_TABLE_VIEW_PRIORITY)t.setFilterProperty(p);return t;};
sap.uiext.inbox.Inbox.prototype.createTableRowSettingsContent=function(){var t=this;var a=new sap.ui.commons.layout.MatrixLayout(t.getId()+'--'+'tableRowSettingLayoutContainer');var s=new sap.ui.commons.SegmentedButton({id:t.getId()+'--'+'tableRowSettingsSegBtn',buttons:[new sap.ui.commons.Button({id:t.getId()+'--'+'table10RowsSegBtn',lite:true,text:'10',tooltip:this._oBundle.getText("INBOX_SET_NUMBER_OF_ROWS_TO")+" "+this._oBundle.getText("INBOX_NUMBER_TEN")}).addStyleClass("sapUiExtInboxSegmentedButtonTransparent"),new sap.ui.commons.Button({id:t.getId()+'--'+'table25RowsSegBtn',lite:true,text:'25',tooltip:this._oBundle.getText("INBOX_SET_NUMBER_OF_ROWS_TO")+" "+this._oBundle.getText("INBOX_NUMBER_TWENTYFIVE")}).addStyleClass("sapUiExtInboxSegmentedButtonTransparent"),new sap.ui.commons.Button({id:t.getId()+'--'+'table50RowsSegBtn',lite:true,text:'50',tooltip:this._oBundle.getText("INBOX_SET_NUMBER_OF_ROWS_TO")+" "+this._oBundle.getText("INBOX_NUMBER_FIFTY")}).addStyleClass("sapUiExtInboxSegmentedButtonTransparent")]});s.attachSelect(function(e){var r=parseInt(sap.ui.getCore().byId(e.getParameters().selectedButtonId).getText());var B=this.getButtons();var S=e.getParameters().selectedButtonId;for(var i=0;i<B.length;i++){var o=B[i];if(S!==o.getId()){o.addStyleClass("sapUiExtInboxSegmentedButtonTransparent");o.removeStyleClass("sapUiExtInboxSegmentedButtonTransparentSelected");}else{o.removeStyleClass("sapUiExtInboxSegmentedButtonTransparent");o.addStyleClass("sapUiExtInboxSegmentedButtonTransparentSelected");}}t.setNoOfRowsOnTable(r);});if(t.tableViewRowCountValue!=null&&t.tableViewRowCountValue!=undefined){if(parseInt(t.tableViewRowCountValue)===10||parseInt(t.tableViewRowCountValue)===25||parseInt(t.tableViewRowCountValue)===50){s.fireSelect({selectedButtonId:t.getId()+'--'+'table'+parseInt(t.tableViewRowCountValue)+'RowsSegBtn'});s.setSelectedButton(t.getId()+'--'+'table'+parseInt(t.tableViewRowCountValue)+'RowsSegBtn');sap.ui.getCore().byId(s.getSelectedButton()).addStyleClass("sapUiExtInboxSegmentedButtonTransparentSelected");}else{t.setNoOfRowsOnTable(parseInt(t.tableViewRowCountValue));}}else{s.setSelectedButton(t.getId()+'--'+'table10RowsSegBtn');sap.ui.getCore().byId(s.getSelectedButton()).addStyleClass("sapUiExtInboxSegmentedButtonTransparentSelected");}var b=new sap.ui.commons.layout.BorderLayout(t.getId()+'--'+'tableBorderLayout',{width:"100%",height:"40px"});b.createArea(sap.ui.commons.layout.BorderLayoutAreaTypes.end,s);b.setAreaData(sap.ui.commons.layout.BorderLayoutAreaTypes.end,{size:"45%",contentAlign:"right",visible:true});a.createRow(new sap.ui.commons.TextView({text:' '}));a.createRow(b);return a;};
sap.uiext.inbox.Inbox.prototype.createRowRepeaterView=function(){var t=this;var v=sap.ui.getCore().byId(t.getId()+'--'+'verticalLayoutContainer');var T=sap.ui.getCore().byId(t.getId()+'--'+'tasksRowRepeater');if(!T){var r=new sap.ui.commons.layout.MatrixLayout({id:t.getId()+'--'+"rrMainMatrixLayout",layoutFixed:true,columns:3,width:'100%',widths:['9%','73%','18%']});var f=new sap.ui.commons.layout.MatrixLayoutRow({id:t.getId()+'--'+'rrFirstRow'});r.addRow(f);var o=new sap.ui.commons.layout.MatrixLayoutCell({id:t.getId()+'--'+'taskInitiatorImageCell',rowSpan:2,colSpan:1,hAlign:sap.ui.commons.layout.HAlign.Center,vAlign:sap.ui.commons.layout.VAlign.Middle});o.addStyleClass("sapUiExtInboxRRFirstRowStyle");var a=new sap.ui.commons.Image(t.getId()+'--'+"taskInitiatorImg");a.setWidth("52px");a.setHeight("52px");a.addStyleClass("sapUiExtInboxRowRepTaskInitiatorColor");a.bindProperty("tooltip","CreatedByName");a.bindProperty("src","CreatedBy",function(L){var M=this.getBindingContext();if(L){return t.inboxUtils.getUserMediaResourceURL(t.bpmSvcUrl,M.getProperty("SAP__Origin"),M.getProperty("CreatedBy"));}else{this.setVisible(false);}});o.addContent(a);var b=t._getComponent("taskInitiatorIcn");if(!b){b=new sap.ui.core.Icon({id:(t.getId()+'--'+"taskInitiatorIcn"),decorative:false,src:{parts:this.oController.getTaskInitiatorIconParts(t),formatter:this.oController.getTaskInitiatorIconFormatter(t)}});}b.setSize("52px").addStyleClass("sapUiExtInboxRowRepTaskInitiatorColor").bindProperty("tooltip","CreatedByName");o.addContent(b);f.addCell(o);var c=new sap.ui.commons.layout.MatrixLayoutCell({id:t.getId()+'--'+'taskTitleCell',padding:sap.ui.commons.layout.Padding.Bottom});c.addStyleClass("sapUiExtInboxRRFirstRowStyle");var d=new sap.uiext.inbox.InboxLink(t.getId()+'--'+"rrViewTaskTitle");d.addStyleClass('sapUiExtInboxfontBold');d.addDelegate({onAfterRendering:function(){if(this.data("overDue")===true){this.addStyleClass('sapUiExtInboxRedColor');}}});d.bindProperty("text","TaskTitle",function(L){if(this.getBindingContext()===undefined)return undefined;else return L;});d.bindProperty("overdue","CompletionDeadLine",function(L){return t._isOverDue(L);});d.bindProperty("tooltip","TaskTitle");d.bindProperty("enabled","Status",function(L){if(L==="COMMITTED"){this.addStyleClass("sapUiExtInboxLnkDsbl");return false;}else if(t.getOpenCompletedTasks()===false&&L=="COMPLETED"){this.addStyleClass("sapUiExtInboxLnkDsbl");return false;}this.removeStyleClass("sapUiExtInboxLnkDsbl");return true;});d.attachPress(this,function(L,M){t.showBusyLoader();var R=L.getSource().getParent();var N=L.getSource().getBindingContext();var O=t.getCoreModel();var S=L.getSource().getParent().getParent().getParent();var P=[];var Q=[];var U=[];var V=[];Q.push(O.getProperty("InstanceID",N));U.push(O.getProperty("TaskTitle",N));V.push(O.getProperty("SAP__Origin",N));if(t.getTaskExecutionURLCallBack!=""&&t.getTaskExecutionURLCallBack!=undefined&&t.getTaskExecutionURLCallBack!==null){var W=t.getTaskExecutionURLCallBack(Q[0],V[0]);if(W!==null&&W.replace(/\s/g,"").length>0){P.push(W);}}else{P.push("");}var X=L.getParameter("windowEvent");if(!X.ctrlKey&&!(X.button==1)&&!X.shiftKey&&!t.bOpenTaskUIInNewTab){M.populateTaskExecutionContent({aSelectedContexts:[N],arrayURLs:P,arrayIDs:Q,arrayTitles:U,aTaskSAPOrigins:V,oRow:S});t.hideBusyLoader();}else{t.hideBusyLoader();var W=P[0];if(W!==null&&W.replace(/\s/g,"").length>0){var Y=window.open(W);Y.focus();L.preventDefault();}}});c.addContent(d);f.addCell(c);var e=new sap.ui.commons.layout.MatrixLayoutCell({id:t.getId()+'--'+'createdOnCell',padding:sap.ui.commons.layout.Padding.Both,hAlign:sap.ui.commons.layout.HAlign.End});e.addStyleClass("sapUiExtInboxRRFirstRowStyle");e.addStyleClass("sapUiExtInboxRRPaddingRight");var g=new sap.ui.commons.TextView(t.getId()+'--'+"rrViewCreatedOnDate");g.addStyleClass("sapUIExtInboxRRTextColourStyle");g.bindProperty("tooltip","CreatedOn",t.tooltipFormatForDateTime);g.bindProperty("text","CreatedOn",function(L){if(L!==null&&L!==""){return t.inboxUtils.dateTimeFormat(L);}});e.addContent(g);f.addCell(e);var s=new sap.ui.commons.layout.MatrixLayoutRow({id:t.getId()+'--'+'secondRow'});r.addRow(s);var h=new sap.ui.commons.layout.MatrixLayout({id:t.getId()+'--'+"taskDescriptnMatxLyt",layoutFixed:false});var i=new sap.uiext.inbox.InboxFormattedTextView({htmlText:{parts:this.oController.getTaskDetailsParts(),formatter:this.oController.getTaskDetailsFormatter(t)},maxLines:1});var j=new sap.uiext.inbox.InboxToggleTextView({showMore:{parts:this.oController.getExpandTaskDescriptionLinkParts(),formatter:this.oController.getExpandTaskDescriptionLinkFormatter(t)}}).setFTV(i).attachShowMoreClick(function(L){var M=this.getAggregation('fTV');if(L.getParameter('text')===t._oBundle.getText("INBOX_SHOW_MORE_TEXT")){M.setHtmlText(M.data("showMore"));M.removeClamp();M.data('clamped','false');}else{M.setMaxLines(1);M.setHtmlText(M.data("showLess"));}});var k=new sap.ui.commons.layout.MatrixLayoutCell({id:t.getId()+'--'+'taskDesCell',hAlign:sap.ui.commons.layout.HAlign.Left,colSpan:1});k.addContent(j);h.createRow(k);var l=new sap.ui.commons.layout.MatrixLayoutCell({id:t.getId()+'--'+'taskDescriptionCell',padding:sap.ui.commons.layout.Padding.None,colSpan:1});l.addContent(h);s.addCell(l);var m=new sap.ui.commons.layout.MatrixLayoutCell({id:t.getId()+'--'+'statusCell',padding:sap.ui.commons.layout.Padding.End,hAlign:sap.ui.commons.layout.HAlign.End,vAlign:sap.ui.commons.layout.VAlign.Top});m.addStyleClass("sapUiExtInboxRRPaddingRight");var n=new sap.ui.commons.TextView(t.getId()+'--'+"rrViewStatus");n.addStyleClass("sapUIExtInboxRRTextColourStyle");n.bindProperty("text","Status",function(L){var M=t.getModel();var N=M.getProperty(sap.uiext.inbox.InboxConstants.PROPERTY_NAME_CUSTOM_STATUS,this.getBindingContext(),false);return t._getTaskStatus(L,N);});m.addContent(n);s.addCell(m);var p=new sap.ui.commons.layout.MatrixLayoutRow({id:t.getId()+'--'+'thirdRow'});r.addRow(p);var q=new sap.ui.commons.layout.MatrixLayoutCell({id:t.getId()+'--'+'taskInitiatorNameCell',hAlign:sap.ui.commons.layout.HAlign.Center,vAlign:sap.ui.commons.layout.VAlign.Top,colSpan:1,rowSpan:2});var u=new sap.ui.commons.TextView(t.getId()+'--'+"taskInitiatorName",{design:sap.ui.commons.TextViewDesign.Small,wrapping:false,width:'90%'});u.setTextAlign(sap.ui.core.TextAlign.Center);u.setDesign(sap.ui.commons.TextViewDesign.Bold);u.bindProperty("text","CreatedByName");q.addContent(u);p.addCell(q);var w=new sap.ui.commons.layout.MatrixLayoutCell({id:t.getId()+'--'+'actionLinksCell',padding:sap.ui.commons.layout.Padding.None,colSpan:1});var x=new sap.ui.commons.layout.MatrixLayout({id:t.getId()+'--'+"taskActionMatrixLayout",layoutFixed:false});var y=new sap.ui.commons.layout.MatrixLayoutCell({id:t.getId()+'--'+'claimActionCell',hAlign:sap.ui.commons.layout.HAlign.Left,vAlign:sap.ui.commons.layout.VAlign.Bottom,colSpan:1});var z=new sap.ui.commons.Link(t.getId()+'--'+"rrViewClaimAction",{tooltip:t._oBundle.getText("INBOX_ACTION_BUTTON_CLAIM"),visible:false,enabled:false});z.addStyleClass("sapUiExtInboxLnkNoUnderline");var A=new sap.ui.commons.Label({id:t.getId()+'--'+"dotSeparator",text:sap.uiext.inbox.InboxConstants.DOT,visible:false});A.addStyleClass("sapUIExtInboxDotSeperatorStyle");z.setText(t._oBundle.getText("INBOX_ACTION_BUTTON_CLAIM"));z.attachPress({inbox:t,view:t.constants.rowRepeaterView,action:"Claim"},t.executeActionOnTask);y.addContent(z);var B=new sap.ui.commons.layout.MatrixLayoutCell({id:t.getId()+'--'+'releaseActionCell',hAlign:sap.ui.commons.layout.HAlign.Left,vAlign:sap.ui.commons.layout.VAlign.Bottom,colSpan:1});var C=new sap.ui.commons.Link(t.getId()+'--'+"rrViewReleaseAction",{tooltip:t._oBundle.getText("INBOX_ACTION_BUTTON_RELEASE"),visible:false,enabled:false});C.addStyleClass("sapUiExtInboxLnkNoUnderline");C.setText(t._oBundle.getText("INBOX_ACTION_BUTTON_RELEASE"));C.attachPress({inbox:t,view:t.constants.rowRepeaterView,action:"Release"},t.executeActionOnTask);B.addContent(C);var D=new sap.ui.commons.Label({id:t.getId()+'--'+"dotSeparator2",visible:false,text:sap.uiext.inbox.InboxConstants.DOT});D.addStyleClass("sapUIExtInboxDotSeperatorStyle");var E=t._createForwardActionLinkCell();var F=new sap.ui.commons.layout.MatrixLayoutCell({id:t.getId()+'--'+'customActionCell',hAlign:sap.ui.commons.layout.HAlign.Left,vAlign:sap.ui.commons.layout.VAlign.Top,padding:sap.ui.commons.layout.Padding.None,colSpan:1});var H=new sap.ui.layout.HorizontalLayout(t.getId()+'--'+"hrLayoutForCustomActions");H.setVisible(false);F.addContent(H);H.bindProperty("visible","InstanceID",function(V){if(!t._isCompletedTasksSelected()){if(V){if(this.getContent()[0]){this.getContent()[0].setVisible(true);}var M=t.getCoreModel();var L=this.getBindingContext();var _=M.getProperty("SAP__Origin",L);var N;var O=this;function P(N){if(N&&N.length>0){if(O.getContent()[0])O.getContent()[0].setVisible(false);for(var R in N){(function(S){var U=new sap.ui.commons.Link();var W=N[S];U.data('key',W.DecisionKey);U.data('text',W.DecisionText);U.data('commentsMandatory',W.CommentMandatory);var X=!W.DecisionText?W.DecisionKey:W.DecisionText;U.setText(X);U.attachPress({inbox:t,view:t.constants.rowRepeaterView},jQuery.proxy(t._handleCustomActionClick,t));U.addStyleClass("sapUiExtInboxLnkNoUnderline");U.addStyleClass("sapUiExtInboxCustomActionLinkPadding");var A=new sap.ui.commons.Label({text:sap.uiext.inbox.InboxConstants.DOT,visible:true});A.addStyleClass("sapUiExtInboxCustomActionLinkPadding");A.addStyleClass("sapUIExtInboxDotSeperatorStyle");O.addContent(A);O.addContent(U);}(R));}}else{if(O.getContent()[0])O.getContent()[0].setVisible(false);O.setVisible(false);}};N=t._getCustomActionsDefinition(V,_,null,P);}else{this.destroyContent();var Q=new sap.ui.core.Icon();Q.setSrc(t.constants.iconPool.getIconURI("refresh"));this.addContent(Q);return true;}}});x.createRow(y,A,B,D,E,F);w.addContent(x);p.addCell(w);var G=new sap.ui.commons.layout.MatrixLayoutCell({id:t.getId()+'--'+'segmentedButtonsCell',padding:sap.ui.commons.layout.Padding.None,hAlign:sap.ui.commons.layout.HAlign.End,colSpan:1});var I=t.createOtherActions(t);G.addContent(I);p.addCell(G);r.addStyleClass("sapUiExtInboxRowRepeaterLayoutBorder");var T=new sap.ui.commons.RowRepeater(t.getId()+'--'+'tasksRowRepeater',{numberOfRows:5});T.setBusyIndicatorDelay(0);T.setThreshold(10000);T.setDesign(sap.ui.commons.RowRepeaterDesign.BareShell);T.addStyleClass("sapUiExtInboxBackgroundColour");T.addStyleClass("sapUiExtInboxRowRepeaterBorder");}var J=t.createRowRepeaterToolBar(t);J.setVisible(false);v.addContent(J);T.setVisible(false);v.addContent(T);var K=t.createRowRepeaterToolsContent(t);K.setVisible(false);v.addContent(K);};
sap.uiext.inbox.Inbox.prototype.onSubstitutionButtonPress=function(e,i){var t=i;var s=sap.ui.getCore().byId(t.getId()+'--'+'substitutionRulesManager');var m=t.getCoreModel();if(s===undefined){s=new sap.uiext.inbox.SubstitutionRulesManager(t.getId()+'--'+'substitutionRulesManager');s.setParent(t);s.sUrl=m.sServiceUrl;s.bUseBatch=t.bUseBatch;s.oTCMModel=t.oTCMModel;s.oTcmMetadata=t.oTcmMetadata;s.oConfiguration=t.oConfiguration;s.isSubstitutionRuleCreationSupported=t.isSubstitutionRuleCreationSupported;s.oDataManager=t.oDataManager;var p=t.constants.SubstitutionProfileCollection;s.bSubstitutionProfileAvailable=t.oTcmMetadata._isEntitySet(p.name,p.entityType);}s.getSubstitutionRulesData(m);s.open();};
sap.uiext.inbox.Inbox.prototype.populateTaskExecutionContent=function(t){var a=this;var s=false,T=0;this.showBusyLoader();var b="";if(this.getTaskExecutionURLThemeValue()!==undefined&&this.getTaskExecutionURLThemeValue()!==null&&this.getTaskExecutionURLCallBack===this.getDefaultTaskExecutionURLCallBack){b=this.getTaskExecutionURLThemeValue();}var e=sap.ui.getCore().byId(this.getId()+'--'+'taskExecUI');if(e!=undefined){e.destroy();}var i=0;var u,c,d,f,g,S,h=[],C=[],w,r;if(t===undefined||t===null)t=this.getnavigateTaskExecMetadata();if(t!=undefined){u=t.arrayURLs;c=t.arrayIDs;T=c.length;d=t.arrayTitles;g=t.aTaskSAPOrigins;S=t.aSelectedContexts;w=S;if(this.clientUpdate){r=t.oRow}}e=new sap.ui.ux3.OverlayContainer(this.getId()+'--'+"taskExecUI");e.setOpenButtonVisible(false);if(this.currentView===this.constants.tableView&&S){this.selectedContexts=S;}e.attachClose({inBox:this,completedTaskContexts:h,changeContextValues:C,rrSelectedRow:r},function(E,I){var v=I.inBox,x=I.completedTaskContexts,y=I.changeContextValues;jQuery.sap.byId(a.getId()+'--'+"execURLFrame").attr('src',"");v.resetSearchCriteria();if(v.clientUpdate){var z=I.rrSelectedRow;if(v.getTaskExecURLStatusCallBack!==""&&v.getTaskExecURLStatusCallBack!==undefined&&v.getTaskExecURLStatusCallBack!==null){var A=v.getTaskExecURLStatusCallBack(c[i],g[i]);if(A==='COMPLETED'){if(r){x.push({orow:r,context:w[i]});}else{x.push(w[i]);}}else{if(r){y.push({row:r,context:w[i],keys:[{key:'Status',value:A}]});}else{y.push({context:w[i],keys:[{key:'Status',value:A}]});}}}v._refreshLocal(x,y);}else{v.applyFilterOnResponse(v.selectedContexts);}});if(T==1){s=true;}var n=sap.ui.getCore().byId(this.getId()+'--'+'nxtBtnContainer');if(n===undefined&&!s){n=new sap.ui.commons.layout.MatrixLayout(this.getId()+'--'+"nxtBtnContainer",{layoutFixed:false,height:"95%",width:"100%"});}var p=sap.ui.getCore().byId(this.getId()+'--'+'prevIcon');if(p===undefined&&!s){p=new sap.ui.core.Icon({id:this.getId()+'--'+"prevIcon",src:sap.ui.core.IconPool.getIconURI("navigation-left-arrow"),size:"32px",color:"rgb(51,51,51)",activeBackgroundColor:"white",hoverColor:"rgb(238,238,238)",hoverBackgroundColor:"rgb(102,102,102)",width:"90%"}).addStyleClass("sapUiExtInboxNextPrevBtnDisabled");p.setSrc(sap.ui.core.IconPool.getIconURI("navigation-left-arrow"));p.setColor("#eeeeee").setHoverBackgroundColor("white");p.attachPress(function(E){if(p.getColor()!=="#eeeeee"){p.setColor("#eeeeee").setHoverBackgroundColor("white");j.setColor("#eeeeee").setHoverBackgroundColor("white");var v="";if(a.getTaskExecURLStatusCallBack!==""&&a.getTaskExecURLStatusCallBack!==undefined&&a.getTaskExecURLStatusCallBack!==null){v=a.getTaskExecURLStatusCallBack(c[i],g[i]);}if(v==="COMPLETED"){if(a.clientUpdate){h.push(S[i]);}u.splice(i,1);c.splice(i,1);w.splice(i,1);}else{if(a.clientUpdate){C.push({context:S[i],keys:[{key:'Status',value:v}]});}}i=i-1;if(u[i]===undefined){u[i]="";if(a.getTaskExecutionURLCallBack!==""&&a.getTaskExecutionURLCallBack!==undefined&&a.getTaskExecutionURLCallBack!==null){u[i]=a.getTaskExecutionURLCallBack(c[i],g[i]);}}if(u[i]!==null&&u[i].replace(/\s/g,"").length>0){jQuery.sap.byId(a.getId()+'--'+"execURLFrame").attr('src',a.inboxUtils.appendThemingParameters(u[i],b)+"&sap-inbox-overlay=true");}}else{E.preventDefault();}});}var j=sap.ui.getCore().byId(this.getId()+'--'+'nextIcon');if(j===undefined&&!s){var j=new sap.ui.core.Icon({id:this.getId()+'--'+"nextIcon",src:sap.ui.core.IconPool.getIconURI("navigation-right-arrow"),size:"32px",color:"rgb(51,51,51)",activeBackgroundColor:"white",hoverColor:"rgb(238,238,238)",hoverBackgroundColor:"rgb(102,102,102)",width:"90%"}).addStyleClass("sapUiExtInboxNextPrevBtnDisabled");j.setSrc(sap.ui.core.IconPool.getIconURI("navigation-right-arrow"));if(c.length>1){j.setColor("#333333").setHoverBackgroundColor("rgb(102,102,102)");}else{j.setColor("#eeeeee").setHoverBackgroundColor("white");}j.attachPress(function(E){if(j.getColor()!=="#eeeeee"){p.setColor("#eeeeee").setHoverBackgroundColor("white");j.setColor("#eeeeee").setHoverBackgroundColor("white");var v="";if(a.getTaskExecURLStatusCallBack!==""&&a.getTaskExecURLStatusCallBack!==undefined&&a.getTaskExecURLStatusCallBack!==null){v=a.getTaskExecURLStatusCallBack(c[i],g[i]);}if(v==="COMPLETED"){if(a.clientUpdate){h.push(S[i]);}u.splice(i,1);c.splice(i,1);w.splice(i,1);}else{if(a.clientUpdate){C.push({context:S[i],keys:[{key:'Status',value:v}]});}i=i+1;}if(u[i]===undefined){u[i]="";if(a.getTaskExecutionURLCallBack!==""&&a.getTaskExecutionURLCallBack!==undefined&&a.getTaskExecutionURLCallBack!==null){u[i]=a.getTaskExecutionURLCallBack(c[i],g[i]);}}if(u[i]!==null&&u[i].replace(/\s/g,"").length>0){jQuery.sap.byId(a.getId()+'--'+"execURLFrame").attr('src',a.inboxUtils.appendThemingParameters(u[i],b)+"&sap-inbox-overlay=true");}}else{E.preventDefault();}});}var k=sap.ui.getCore().byId(this.getId()+'--'+'prevBtnContainer');if(k===undefined&&!s){k=new sap.ui.commons.layout.MatrixLayout(this.getId()+'--'+"prevBtnContainer",{layoutFixed:false,height:"95%",width:"100%"});}var l=new sap.ui.core.HTML(this.getId()+'--'+"execURLFrame",{content:"<iframe name='myframe' src='"+u[i]+b+"&sap-inbox-overlay=true"+"' scrolling='auto' id = '"+this.getId()+'--'+"execURLFrame"+"' style='position: absolute;height: 100%;width: 100%; border: none;'></iframe>"});var B=new sap.ui.commons.layout.BorderLayout(this.getId()+'--'+"taskExecBorderLayout",{width:"100%",height:"100%",top:new sap.ui.commons.layout.BorderLayoutArea({size:"20%",contentAlign:"center",visible:false,content:[new sap.ui.commons.TextView({text:'Task:'+d[i],design:sap.ui.commons.TextViewDesign.Bold})]}),center:new sap.ui.commons.layout.BorderLayoutArea({contentAlign:"left",visible:true,content:[l]})});if(!s){var m=sap.ui.getCore().byId(this.getId()+'--'+"traverseLabel");if(!m){m=new sap.ui.commons.Label(this.getId()+'--'+"traverseLabel");}var o=sap.ui.getCore().byId(this.getId()+'--'+"dummyLabel");if(!o){o=new sap.ui.commons.Label({id:this.getId()+'--'+"dummyLabel",visible:false});}n.createRow(j);k.createRow(p);var B=sap.ui.getCore().byId(this.getId()+'--'+"taskExecBorderLayout");B.setAreaData(sap.ui.commons.layout.BorderLayoutAreaTypes.begin,{size:"2%",contentAlign:"right",visible:true,content:[k,m]});B.setAreaData(sap.ui.commons.layout.BorderLayoutAreaTypes.end,{size:"2%",contentAlign:"right",visible:true,content:[n,o]});}e.addContent(B);l.attachAfterRendering(function(){jQuery.sap.byId(a.getId()+'--'+"execURLFrame").bind('load',function(v){var x=c.length;if(j){if(i!==x-1)j.setColor("#333333").setHoverBackgroundColor("rgb(102,102,102)");else j.setColor("#eeeeee").setHoverBackgroundColor("white");}if(p){if(i===0)p.setColor("#eeeeee").setHoverBackgroundColor("white");else p.setColor("#333333").setHoverBackgroundColor("rgb(102,102,102)");}if(m){m.setDesign(sap.ui.commons.LabelDesign.Bold);m.setWidth("85%");m.setText((i+1)+"/"+c.length);}if(o){o.setDesign(sap.ui.commons.LabelDesign.Bold);o.setWidth("60%");}});});if(s&&u!==null&&!u[0]){this.hideBusyLoader();}else{e.open();}function q(E){var v;var x=jQuery.sap.byId(a.getId()+'--'+"taskExecUI");if(jQuery.browser.msie==true&&parseInt(jQuery.browser.version)<10){var y=jQuery.parseJSON(E.data);}else{y=E.data;}if(jQuery.isArray(y)){jQuery.each(y,function(z,A){v=y[z];if(v.command==="resize"){x.css({"margin":"auto"});if(!v.data.height){x.animate({"width":v.data.width},"slow");}else if(!v.data.width){x.animate({"height":v.data.height},"slow");}else x.animate({"height":v.data.height,"width":v.data.width},"slow");}})}}if(window.addEventListener){window.addEventListener('message',q,false);}else if(window.attachEvent){window.attachEvent('onmessage',q);}};
sap.uiext.inbox.Inbox.prototype.createInboxUI=function(){var v=new sap.ui.commons.layout.VerticalLayout(this.getId()+'--'+"verticalLayoutContainer");if(sap.ui.getCore().byId(this.getId()+'--'+'toolbarContainer')===undefined){v.insertContent(this.populateToolBar(),0);}this.populateViews();if(sap.ui.getCore().byId(this.getId()+'--'+'notificationBar')===undefined){v.addContent(this.populateNotificationBar());}return v;};
sap.uiext.inbox.Inbox.prototype.openToolPopUp=function(i){var t=i;var r;var n=sap.ui.getCore().byId(t.getId()+'--'+"rowSettingsRBG");;var s=sap.ui.getCore().byId(t.getId()+'--'+"sPopup");if(s===undefined){n=new sap.ui.commons.RadioButtonGroup(t.getId()+'--'+"rowSettingsRBG",{tooltip:"Select number of rows to be displayed on the Table",columns:3});var I=new sap.ui.core.Item({text:"10",key:"rows10"});n.addItem(I);I=new sap.ui.core.Item({text:"25",key:"rows25"});n.addItem(I);I=new sap.ui.core.Item({text:"50",key:"rows50"});n.addItem(I);s=new sap.ui.commons.Dialog(t.getId()+'--'+"sPopup",{title:i._oBundle.getText("INBOX_TABLE_SETTINGS_POPUP_TITLE"),content:[n],buttons:[new sap.ui.commons.Button({text:i._oBundle.getText("INBOX_BUTTON_OK_TEXT"),press:function(){t.setNoOfRowsOnTable(sap.ui.getCore().byId(t.getId()+'--'+'rowSettingsRBG').getSelectedItem().getText());s.close();}})]});s.setWidth("231px");s.setHeight("137px");}if(r===undefined){r=sap.ui.getCore().byId(t.getId()+'--'+'listViewTable').getVisibleRowCount()+"";}if(r!=undefined&&n!=undefined){switch(r){case"10":n.setSelectedIndex(0);break;case"25":n.setSelectedIndex(1);break;case"50":n.setSelectedIndex(2);break;}}s.open();};
sap.uiext.inbox.Inbox.prototype.setSubstitutionEnabled=function(i,p){if(this.isSubstitutionEnabled!=i){this.isSubstitutionEnabled=i;this._substitutionPath=p;this.addAndRemoveSubstDropDowns();}};
sap.uiext.inbox.Inbox.prototype._setColumnVisibility=function(c){if(c!==undefined&&c!==null){var t=this;var i=false;var a=sap.uiext.inbox.InboxConstants;var T=sap.ui.getCore().byId(this.getId()+'--'+'listViewTable');var b=this.getInvisibleCols(c);var d=T.getColumns();jQuery.each(d,function(e,f){jQuery.each(b,function(e,g){if(t.absId(f.getId())===sap.uiext.inbox.InboxConstants.TABLE_VIEW_TECH_NAMES[g])f.setVisible(false);});});this.resizeColumns();}};
sap.uiext.inbox.Inbox.prototype.absId=function(s){return s.split("--")[1].replace(/^\s+|\s+$/g,'');};
sap.uiext.inbox.Inbox.prototype.getInvisibleCols=function(c){var i=[];jQuery.each(c.columns,function(a,b){if(b.visibility===false)i.push(b.field);});return i;};
sap.uiext.inbox.Inbox.prototype.getColumnVisibility=function(){return this.colList;};
sap.uiext.inbox.Inbox.prototype.getSubstitutionEnabled=function(){return this.isSubstitutionEnabled};
sap.uiext.inbox.Inbox.prototype.clearDrillDownFilter=function(){this.resetFilterView(true);};
sap.uiext.inbox.Inbox.prototype.getTaskTableBinding=function(){var l=sap.ui.getCore().byId(this.getId()+'--'+'listViewTable');return l.getBinding('rows');};
sap.uiext.inbox.Inbox.prototype.bindTaskExecutionURL=function(t,a){this.getTaskExecutionURLCallBack=t;this.getTaskExecURLStatusCallBack=a;return this;};
sap.uiext.inbox.Inbox.prototype.bindTaskTypeDynamicFilter=function(t){this.dynamicTaskTypeFilterCallBack=t;return this;};
sap.uiext.inbox.Inbox.prototype.bindSearch=function(s){this.searchCallBack=s;return this;};
sap.uiext.inbox.Inbox.prototype.bindSubstitutedUsers=function(p){var d=sap.ui.getCore().byId(this.getId()+'--'+'filterComboBox3');var s=d.getSelectedKey();var S=d.getValue();var o=sap.ui.getCore().byId(this.getId()+'--'+'onBehalfOfListItem');if(o===undefined){o=new sap.ui.core.ListItem(this.getId()+'--'+'onBehalfOfListItem');}o.setText(this._oBundle.getText("SUBSTITUTION_INBOX_FILTER_ON_BEHALF_OF"));o.setKey("onBehalfOf");o.setEnabled(false);var a=sap.ui.getCore().byId(this.getId()+'--'+'li_allUsers');if(a===undefined){a=new sap.ui.core.ListItem(this.getId()+'--'+'li_allUsers');}a.setText(this._oBundle.getText("INBOX_DROP_DOWN_VALUE_ALL_USERS"));a.setKey("allUsers");var I=p+"?$format=json&$skip=0&$top=100&$inlinecount=allpages";var r=this.bpmSvcUrl+I;var b="";var m=this.getCoreModel();var t=this;var c={async:false,requestUri:r,method:"GET",headers:{Accept:"application/json","x-csrf-token":m.oHeaders["x-csrf-token"]}};OData.request(c,function(e,f){if(e.results.length>0){if(d.getEnabled()===false){d.setEnabled(true);}d.removeAllItems();d.addItem(o);d.addItem(a);for(var i=0;i<e.results.length;i++){b+=e.results[i].DisplayName;var l=new sap.ui.core.ListItem();l.setKey(e.results[i].UniqueName);l.setText(e.results[i].DisplayName);d.addItem(l);}if(t.bRefreshStartFlag&&t.filtersToApply.dropDownFilter3){var u=false;for(var i=0;i<e.results.length;i++){if(e.results[i].UniqueName==s){u=true;d.setSelectedKey(s);}}if(!u){delete t.filtersToApply.dropDownFilter3;t.showMessage("error",t._oBundle.getText("INBOX_MSG_ERR_SUBSTITUTION_DELETED",[S]));}u=false;}}else{d.setEnabled(false);}},function(e){if(e.response.statusCode==205){var f={statusCode:e.response.statusCode,statusText:e.response.statusText};m.fireRequestFailed(f);}else{t.showMessage("error",t._oBundle.getText("INBOX_MSG_ERR_EXUI")+this.id);}});};
sap.uiext.inbox.Inbox.prototype.bindTaskTable=function(p,t){var i=new sap.uiext.inbox.InboxFilters();var I=new sap.uiext.inbox.InboxSecondaryFilters();i.setSecondaryFilter(t);this.bindTasks(p,i);};
sap.uiext.inbox.Inbox.prototype.bindTasks=function(p,f,s){var P,S,t;if(f){P=f.getPrimaryFilter();S=f.getSecondaryFilter();};this.modelRefreshed=true;this.oModel=this.getModel();this.oController.setModel(this.oModel);this._handleTaskCategoryVisibility();this._setCommentsVisibility();this._initFlagsByModel();this.oDataManager.setModel(this.oModel);if(this.typeOfModel==="OData"){this._initODataModel();}else{this._bindTaskActions();}this.sCollectionPath=p;if(!(/^\//).test(this.sCollectionPath))this.sCollectionPath="/"+this.sCollectionPath;this.oModel.attachRequestSent(this,function(E,k){var C=k._currentViewElement();C.setBusy(true);k._handleRequestSent(E);});this.oModel.attachRequestCompleted(this,function(E,k){var C=k._currentViewElement();C.setBusy(false);var u=E.getParameter("url");if(u&&u.indexOf("TaskCollection")>0){k._handleRequestCompleted(E);}});this.oModel.attachRequestFailed(this,function(E,k){var C=k._currentViewElement();C.setBusy(false);k._handleRequestFailed(E);});var a=this._initTableView();var T=this._initRowRepeaterView();var r=this._getComponent('rrMainMatrixLayout');var i=s?s:new sap.ui.model.Sorter("CreatedOn",true);this._applySortOnView(i);this.resetFilterView(false);this._selectInitialValueinDropDown(P);if(this.defaultView===this.constants.rowRepeaterView){var v=sap.ui.getCore().byId(this.getId()+'--'+'viewSelectionSegBtn');if(v!==undefined){var b=this.getId()+'--'+'rrViewSelectionButton';v.setSelectedButton(b);var c=sap.ui.getCore().byId(this.getId()+'--'+'rrViewSelectionButton');v.fireSelect({selectedButtonId:b,triggeredFrom:'initialView'});}}var d=sap.ui.getCore().byId(this.getId()+'--'+"filterViewButton");var $=d.$();var F=[],m;var D=new sap.ui.model.Filter("Status",sap.ui.model.FilterOperator.NE,"COMPLETED");var I=this.filtersToApply.dropDownFilter;if(I===undefined){I=D;}if(this.applyTaskCategoryFilter){if(this.filterOperatorCategoryTask===undefined){var e=this.inboxUtils._getCategoryFilter("TASK");}this.filtersToApply.taskCategory=e;F=this._addFilterToFilterMetadata(e,F);}var n=this.filtersToApply.neCompleted;if(S!=null){var o=S.getFilterObjects();m=o.filterOperatorMap;var g=m?!d.getPressed():d.getPressed();if(g){d.setPressed(!d.getPressed());d.firePress();}if(m){this.filtersToApply=o.filtersAppliedMap;F=this._selectFilterValuesinFacetFilterView(S,m,I);}else{F=this._addFilterToFilterMetadata(I,F);this.filtersToApply.dropDownFilter=I;}if(n){var h=S.getFilterUIKeys();if(!(h.Status&&h.Status.length>0)){F=this._addFilterToFilterMetadata(n,F);}}}else{if(d.getPressed()){d.setPressed(!d.getPressed());d.firePress();}this.filtersToApply.dropDownFilter=I;F=this._addFilterToFilterMetadata(I,F);if(n){F=this._addFilterToFilterMetadata(n,F);}}var j=this._getBindingParameters();if(this.defaultView===this.constants.rowRepeaterView){T.bindRows({path:this.sCollectionPath,template:r,parameters:j,sorter:i,filters:F});}a.bindRows({path:this.sCollectionPath,parameters:j,sorter:i,filters:F});this.setToggleCustomAttributeBtnVisibilityStreamView(this.isCustomAttributesEnabled);return this;};
sap.uiext.inbox.Inbox.prototype.setToggleCustomAttributeBtnVisibilityStreamView=function(c){var t=this._getComponent("toggleCustomAttributes");if(c){t.setVisible(true);}};
sap.uiext.inbox.Inbox.prototype.localSearch=function(e,a){if(a.searchCallBack!==""&&a.searchCallBack!==undefined){a.searchCallBack();return;}var m=a.getCoreModel();var s=jQuery.trim(e.getParameter("query").toLowerCase());var c=a._currentViewElement();var f=[];a._resetStateBeforeSearch();f.push(a._getBindingKeysOnLocalSearch(s,m._original_data,c._originalKeys));if(a.currentView===a.constants.tableView&&a._isTableFiltered()){f.push(a._getCurrentBindingKeysForTableColumnFilters(m._original_data,c._originalKeys));}var r=a.inboxUtils._getUniqueArray(f);var b={};var v;for(var i in r){v=m._original_data[r[i]];b[r[i]]=v;if(v.Description){var d,g;var D=v.Description;if(D&&D.__list instanceof Array){d=D.__list[0];g=m.oData[d];if(g)b[d]=g;}else{var o=D.__ref;if(D&&o){g=m.oData[o];if(g)b[o]=g;}}}if(v.TaskDefinitionData){var h,j;var t=v.TaskDefinitionData;if(t&&t.__list instanceof Array){h=v.TaskDefinitionData.__list[0];j=m.oData[h];if(j)b[h]=j;}else{var k=t.__ref;if(t&&k){j=m.oData[k];if(j)b[k]=j;}}}}m.oData=b;var B=c.mBindingInfos["rows"];if(B&&B.binding){B.binding.iLength=r.length;B.binding.aKeys=r;a.currentView===a.constants.tableView?c.rerender():c.updateRows(false);c._updateBindingContexts(undefined,undefined,"change");}var R=c.getBinding('rows').iLength;a._updatePaginator(R);if(R<=0)a.showMessage("info",a._oBundle.getText("INBOX_MSG_FOR_NO_DATA"));else a.deleteMessage();a.fireODataRequestCompleted({bindingLength:R,appliedFilter:a._oBundle.getText("INBOX_SEARCH_RESULTS_TEXT")});};
sap.uiext.inbox.Inbox.prototype._getBindingKeysOnLocalSearch=function(s,S,o){var K=[];for(var j in S){var v=S[j];var a=false;var f;var t;for(var l in o){if(j==o[l]){for(var k=0;k<this._getCategoryMetadata().properties.length;k++){t=this._getCategoryMetadata().properties[k];f=v[t];if(!f&&t==="TaskTitle"){f=this._oBundle.getText("INBOX_TASK_TITLE_NOTAVAILABLE_MSG");}if(f!=null){if(jQuery.type(f)==="date"){f=(this.inboxUtils.dateTimeFormat(f));}if(t==="Priority"||t==="Status"){if(f=="VERY_HIGH")f=this._oBundle.getText("INBOX_FILTER_PRIORITY_VERY_HIGH");if(f=="HIGH")f=this._oBundle.getText("INBOX_FILTER_PRIORITY_HIGH");if(f=="MEDIUM")f=this._oBundle.getText("INBOX_FILTER_PRIORITY_MEDIUM");if(f=="LOW")f=this._oBundle.getText("INBOX_FILTER_PRIORITY_LOW");if(f=="READY")f=this._oBundle.getText("INBOX_FILTER_STATUS_READY");if(f=="RESERVED")f=this._oBundle.getText("INBOX_FILTER_STATUS_RESERVED");if(f=="IN_PROGRESS")f=this._oBundle.getText("INBOX_FILTER_STATUS_IN_PROGRESS");}f=f.toLowerCase();if(f.indexOf(s)>=0){a=true;break;}}}if(!a){if(v.Description){var d=v.Description;a=this._getValuePresent(S,d,sap.uiext.inbox.InboxConstants.NAVIGATION_DESCRIPTION,s);}}if(!a){if(v.TaskDefinitionData){var T=v.TaskDefinitionData;a=this._getValuePresent(S,T,sap.uiext.inbox.InboxConstants.NAVIGATION_TASKDEFINITION,s);}}if(!a){if(v.CustomAttributeData){var c=v.CustomAttributeData.__list;if(c!==undefined){for(var i=0;i<c.length;i++){var b=c[i];var f=S[b].Value;if(f!=null||f!=undefined){f=f.toLowerCase();if(f.indexOf(s)>=0){a=true;break;}}}}}}if(a){var e=j;K.push(e);}}}}return K;};
sap.uiext.inbox.Inbox.prototype.refresh=function(t){this.applyFilterOnResponse(null);};
sap.uiext.inbox.Inbox.prototype.applyFilterOnResponse=function(s,r){var m=this.getCoreModel();var t=this;this.showBusyLoader();var l;var c;var n=sap.ui.getCore().byId(this.getId()+'--'+'notificationBar');var M=sap.ui.getCore().byId(this.getId()+'--'+'messageNotifier');if(n!=undefined){M.destroyMessages();n.setVisibleStatus(sap.ui.ux3.NotificationBarStatus.Min);}if(t.currentView===t.constants.tableView){c=sap.ui.getCore().byId(this.getId()+'--'+'listViewTable');if(c!==undefined){if(s!=undefined&&s!=null){t.selectedContexts=s;}else{t.selectedContexts=[];}l=c.getBinding('rows');}}else if(this.currentView===t.constants.rowRepeaterView){c=sap.ui.getCore().byId(this.getId()+'--'+'tasksRowRepeater');if(c!==undefined){c.gotoPage(1);var a=this._getComponent('rowRepeaterPaginator');if(a){a.destroy();}l=c.getBinding('rows');}}var f=[];if(l!=null&&l!=undefined){l.aApplicationFilters=[];for(var i in t.filtersToApply){var b=t.filtersToApply[i];if(jQuery.isArray(b)){f=f.concat(b)}else f.push(b);}if(this.currentView===t.constants.rowRepeaterView&&r){var S=l.oSorter;var R=t._getComponent('sortByFilterComboBox');var d=R.getSelectedItemId();if(d){var e=t.constants.mRRSortMap[t._removeParentID(d)];S=e?t._getComponent(e).getSorter():S;}var T=t._getComponent("rrMainMatrixLayout");var p=t._getBindingParameters();if(this.clientUpdate===undefined){c.unbindRows();c.bindRows({path:t.sCollectionPath,template:T,parameters:p,sorter:S,filters:f});c.bRowsRebinded=true;}else{l.filter(f);c.updateRows(false);}}else{l.filter(f);}}t.modelRefreshed=true;if(l){c._originalKeys=l.aKeys;}this.hideBusyLoader();};
sap.uiext.inbox.Inbox.prototype.refreshTaskList=function(e,a){a.bRefreshStartFlag=true;if(!a.getHandleBindings()){a.fireRefresh(e);}else{}var m=a.getCoreModel();var t=sap.ui.getCore().byId(a.getId()+'--'+'listViewTable');var r=sap.ui.getCore().byId(a.getId()+'--'+'tasksRowRepeater');var l;var b;var s=a.getlistTableSelectedIndices();var c=[];jQuery.each(s,function(i,n){b=t.getContextByIndex(n);c.push(b);});var d;if(a.currentView===sap.uiext.inbox.InboxConstants.tableView){d=t;}else if(a.currentView===sap.uiext.inbox.InboxConstants.rowRepeaterView){d=r;}if(d!=undefined){if(c!=undefined&&c!=null){a.selectedContexts=c;}else{a.selectedContexts=[];}if(a.clientUpdate){d.getModel().refresh();a.modelRefreshed=true;}else{var f=sap.ui.getCore().byId(a.getId()+'--'+'filterComboBox3');if(f!=undefined&&f.getEnabled()===true){a.bindSubstitutedUsers("/SubstitutedUsersCollection");}l=d.getBinding('rows');var F=[];if(l!=null){l.aApplicationFilters=[];for(var g in a.filtersToApply){var h=a.filtersToApply[g];if(jQuery.isArray(h)){F=F.concat(h)}else F.push(h);}l.filter(F);}}}a.modelRefreshed=true;d._originalKeys=d.getBinding('rows').aKeys;a.resetSearchCriteria();var j=sap.ui.getCore().byId(a.getId()+'--'+"refreshOnText");if(j){a.lastRefreshedOnDateTime=new Date();var k=a._getFormattedRefreshOnDateTime();j.setText(a._oBundle.getText("INBOX_TEXT_ON")+sap.uiext.inbox.InboxConstants.SPACE+k);j.setTooltip(a._getFormattedTooltipForLastRefreshedTime());}};
sap.uiext.inbox.Inbox.prototype.applyDropDownFilter1=function(e,i){var l=e.getSource().getSelectedItemId();if(l===i.getId()+'--'+"li_substitutedTasks"){sap.ui.getCore().byId(i.getId()+'--'+'filterComboBox3').setEnabled(false);i.filtersToApply.dropDownFilter1=new sap.ui.model.Filter("IsSubstituted",sap.ui.model.FilterOperator.EQ,true);i.bindSubstitutedUsers("/SubstitutedUsersCollection");sap.ui.getCore().byId(i.getId()+'--'+'onBehalfOfListItem').setEnabled(false);}else{sap.ui.getCore().byId(i.getId()+'--'+'onBehalfOfListItem').setEnabled(true);sap.ui.getCore().byId(i.getId()+'--'+'filterComboBox3').setSelectedItemId(i.getId()+'--'+'onBehalfOfListItem');sap.ui.getCore().byId(i.getId()+'--'+'filterComboBox3').setEnabled(false);delete i.filtersToApply.dropDownFilter3;if(l===i.getId()+'--'+"li_allTasks"){delete i.filtersToApply.dropDownFilter1;}else if(l===i.getId()+'--'+"li_myTasks"){i.filtersToApply.dropDownFilter1=new sap.ui.model.Filter("IsSubstituted",sap.ui.model.FilterOperator.EQ,false);}}i.applyFilterOnResponse(null);};
sap.uiext.inbox.Inbox.prototype.applyDropDownFilter3=function(e,i){var l=e.getSource().getSelectedItemId();if(l===i.getId()+'--'+"li_allUsers"){delete i.filtersToApply.dropDownFilter3;}else{i.filtersToApply.dropDownFilter3=new sap.ui.model.Filter("SubstitutedUser",sap.ui.model.FilterOperator.EQ,sap.ui.getCore().byId(i.getId()+'--'+'filterComboBox3').getSelectedKey());}i.applyFilterOnResponse(null);};
sap.uiext.inbox.Inbox.prototype.applyDropDownFilter=function(e,i){var a=false;var l=e.getSource().getSelectedItemId();var s=sap.ui.getCore().byId(i.getId()+'--'+"INBOX_FILTER_STATUS");var f=sap.ui.getCore().byId(i.getId()+'--'+"INBOX_FILTER_CREATION_DATE");var F=sap.ui.getCore().byId(i.getId()+'--'+"INBOX_FILTER_DUE_DATETIME");var o=sap.ui.getCore().byId(i.getId()+'--'+"filterFacet");i.resetSearchCriteria();if(l===i.getId()+'--'+"li_completedTasks"){a=true;i._deleteCustomActions();if(s!==undefined){i.storeFilterState("INBOX_FILTER_STATUS");o.removeList(s);}if(f!==undefined){i.storeFilterState("INBOX_FILTER_CREATION_DATE");o.removeList(f);}if(F!==undefined){i.storeFilterState("INBOX_FILTER_DUE_DATETIME");o.removeList(F);}delete i.filtersToApply.resStat;delete i.filtersToApply.readyStat;delete i.filtersToApply.InProStat;delete i.filtersToApply.neCompleted;delete i.filtersToApply.today;delete i.filtersToApply.last30;delete i.filtersToApply.last15;delete i.filtersToApply.last7;i.clearFiltersForDueDate();i.filtersToApply.dropDownFilter=[new sap.ui.model.Filter("Status",sap.ui.model.FilterOperator.EQ,"COMPLETED")];}if(l===i.getId()+'--'+"li_openTasks"){if(s!=undefined){o.addList(s);i.retrieveFilterState("INBOX_FILTER_STATUS");}if(f!=undefined&&o.indexOfList(f)===-1){o.addList(f);i.retrieveFilterState("INBOX_FILTER_CREATION_DATE");}if(F!==undefined&&o.indexOfList(F)===-1){o.addList(F);i.retrieveFilterState("INBOX_FILTER_DUE_DATETIME");}delete i.filtersToApply.neCompleted;if((i.filtersToApply.resStat===undefined)&&(i.filtersToApply.readyStat===undefined)&&(i.filtersToApply.InProStat===undefined)){i.filtersToApply.dropDownFilter=new sap.ui.model.Filter("Status",sap.ui.model.FilterOperator.NE,"COMPLETED");}else{delete i.filtersToApply.dropDownFilter;}}if(l===i.getId()+'--'+"li_overdueTasks"){if(s!=undefined){o.addList(s);i.retrieveFilterState("INBOX_FILTER_STATUS");}if(f!=undefined&&o.indexOfList(f)!==-1){i.storeFilterState("INBOX_FILTER_CREATION_DATE");o.removeList(f);}if(F!==undefined&&o.indexOfList(F)!==-1){i.storeFilterState("INBOX_FILTER_DUE_DATETIME");o.removeList(F);}i.clearFiltersForDueDate();delete i.filtersToApply.today;delete i.filtersToApply.last30;delete i.filtersToApply.last15;delete i.filtersToApply.last7;var b=i.getFormattedDateTimeOff(0,true);i.filtersToApply.dropDownFilter=new sap.ui.model.Filter("CompletionDeadLine",sap.ui.model.FilterOperator.LT,b);if((i.filtersToApply.resStat===undefined)&&(i.filtersToApply.readyStat===undefined)&&(i.filtersToApply.InProStat===undefined)&&(i.filtersToApply.neCompleted===undefined)){i.filtersToApply.neCompleted=new sap.ui.model.Filter("Status",sap.ui.model.FilterOperator.NE,"COMPLETED");}}if(l===i.getId()+'--'+"li_escalatedTasks"){if(s!=undefined){o.addList(s);i.retrieveFilterState("INBOX_FILTER_STATUS");}if(f!=undefined&&o.indexOfList(f)!=-1){i.storeFilterState("INBOX_FILTER_CREATION_DATE");o.removeList(f);}if(F!==undefined&&o.indexOfList(F)!==-1){i.storeFilterState("INBOX_FILTER_DUE_DATETIME");o.removeList(F);}i.clearFiltersForDueDate();delete i.filtersToApply.today;delete i.filtersToApply.last30;delete i.filtersToApply.last15;delete i.filtersToApply.last7;i.filtersToApply.dropDownFilter=new sap.ui.model.Filter("IsEscalated",sap.ui.model.FilterOperator.EQ,true);if((i.filtersToApply.resStat===undefined)&&(i.filtersToApply.readyStat===undefined)&&(i.filtersToApply.InProStat===undefined)&&(i.filtersToApply.neCompleted===undefined)){i.filtersToApply.neCompleted=new sap.ui.model.Filter("Status",sap.ui.model.FilterOperator.NE,"COMPLETED");}}if(a==true){i.hideAllActionButtonsandLinks();}else{i.showAllActionButtonsandLinks();}var t=i._isDrillDownFilterSelected('TaskDefinitionID');i._deleteCustomActions(null);if(!a&&t){i.applyFilterOnResponse(null,true);}else{i.applyFilterOnResponse(null);}};
sap.uiext.inbox.Inbox.prototype.clearFiltersForCategory=function(){delete this.filtersToApply.taskCategory;delete this.filtersToApply.todoCategory;delete this.filtersToApply.alertCategory;delete this.filtersToApply.notificationCategory;};
sap.uiext.inbox.Inbox.prototype.clearFiltersForPriority=function(){delete this.filtersToApply.lowPrio;delete this.filtersToApply.medPrio;delete this.filtersToApply.hiPrio;delete this.filtersToApply.veryhiPrio;};
sap.uiext.inbox.Inbox.prototype.clearFiltersForStatus=function(){delete this.filtersToApply.resStat;delete this.filtersToApply.readyStat;delete this.filtersToApply.InProStat;delete this.filtersToApply.neCompleted;if(this.filtersToApply.dropDownFilter!=undefined){if((this.filtersToApply["dropDownFilter"].sPath==="Status")&&(this.filtersToApply["dropDownFilter"].sOperator==="NE")){delete this.filtersToApply.dropDownFilter;}}};
sap.uiext.inbox.Inbox.prototype.clearFiltersForDueDate=function(){delete this.filtersToApply.dueDateToday;delete this.filtersToApply.dueDatenext30;delete this.filtersToApply.dueDatenext15;delete this.filtersToApply.dueDatenext7;delete this.filtersToApply.noDueDate;};
sap.uiext.inbox.Inbox.prototype.clearFiltersForDateTime=function(){delete this.filtersToApply.today;delete this.filtersToApply.last30;delete this.filtersToApply.last15;delete this.filtersToApply.last7;};
sap.uiext.inbox.Inbox.prototype.clearFiltersForTaskType=function(){for(var i in this.filtersToApply){if(this.filtersToApply[i].sPath==='TaskDefinitionID'){delete this.filtersToApply[i];}}};
sap.uiext.inbox.Inbox.prototype.applyDrillDownFilterForTaskCategory=function(e,a){var f,b,c,d;var F=sap.ui.getCore().byId(a.getId()+'--'+'filterFacet');var g=e.getParameter("selectedItems");a.resetSearchCriteria();a.clearFiltersForCategory();a._modifyTableColumnsOnFilterCategory();a._modifyFacetFilterOnFilterCategory();a.changeToolbarOnFilterCategory();for(var i=0;i<g.length;i++){switch(g[i].getId()){case a.getId()+'--'+"INBOX_FILTER_CATEGORY_TASKS":f=a.inboxUtils._getCategoryFilter("TASK",a.sProviderHost);a.filtersToApply['taskCategory']=f;break;case a.getId()+'--'+"INBOX_FILTER_CATEGORY_TODO":b=a.inboxUtils._getCategoryFilter("Todo",a.sProviderHost);a.filtersToApply['todoCategory']=b;break;case a.getId()+'--'+"INBOX_FILTER_CATEGORY_ALERT":c=a.inboxUtils._getCategoryFilter("Alert",a.sProviderHost);a.filtersToApply['alertCategory']=c;break;case a.getId()+'--'+"INBOX_FILTER_CATEGORY_NOTIFICATION":d=a.inboxUtils._getCategoryFilter("Notification",a.sProviderHost);a.filtersToApply['notificationCategory']=d;break;};}a.applyFilterOnResponse(null);};
sap.uiext.inbox.Inbox.prototype._modifyFacetFilterOnFilterCategory=function(r){if(r){var c=this.constants.aDependentDrillDownFiltersBasedOnCategory.aFilterMetadataDefault;}else{var c=this._getCategoryFilterMetadata();}var f=sap.ui.getCore().byId(this.getId()+'--'+"filterFacet");if(f!=undefined){var F=f.getLists();var a=[];for(var i=0;i<F.length;i++){var o=F[i];var s=this._removeParentID(o.getId());a.push(s);if(jQuery.inArray(s,c)===-1){this.storeFilterState(s);f.removeList(o);this._deleteRemovedFilter(s);}}for(var i=0;i<c.length;i++){if(jQuery.inArray(c[i],a)===-1){var b=sap.ui.getCore().byId(this.getId()+'--'+c[i]);if(b!=undefined&&f.indexOfList(b)===-1){f.insertList(b,i);this.retrieveFilterState(c[i]);}}}}};
sap.uiext.inbox.Inbox.prototype._deleteRemovedFilter=function(f){switch(f){case"INBOX_FILTER_CATEGORY":this.clearFiltersForCategory();break;case"INBOX_FILTER_TASK_TYPE":this.clearFiltersForTaskType();break;case"INBOX_FILTER_PRIORITY":this.clearFiltersForPriority();break;case"INBOX_FILTER_STATUS":this.clearFiltersForStatus();break;case"INBOX_FILTER_CREATION_DATE":this.clearFiltersForDateTime();break;case"INBOX_FILTER_DUE_DATETIME":this.clearFiltersForDueDate();break;};};
sap.uiext.inbox.Inbox.prototype._modifyTableColumnsOnFilterCategory=function(){var t=this._getComponent('listViewTable');var T=t.getColumns();var a=this._getCategoryMetadata();var b=[];for(var i=0;i<T.length;i++){var c=T[i];var C=this._removeParentID(c.getId());b.push(C);if(jQuery.inArray(C,a.properties)===-1){c.destroy();}}for(var i=0;i<a.properties.length;i++){if(jQuery.inArray(a.properties[i],b)===-1){this._createTableColumnContent(i,a);}}};
sap.uiext.inbox.Inbox.prototype._getSelectedCategory=function(){var f=this._getComponent("INBOX_FILTER_CATEGORY");if(f!=null&&f.getSelectedKeys()!=null){return f.getSelectedKeys()[0];}};
sap.uiext.inbox.Inbox.prototype._getCategoryMetadata=function(){if(this.applyTaskCategoryFilter){var s=this._getSelectedCategory();switch(s){case"INBOX_FILTER_CATEGORY_TASKS":return this.constants.mEntities.taskMetadata;break;case"INBOX_FILTER_CATEGORY_TODO":return this.constants.mEntities.todoMetadata;break;case"INBOX_FILTER_CATEGORY_ALERT":return this.constants.mEntities.alertMetadata;break;case"INBOX_FILTER_CATEGORY_NOTIFICATION":return this.constants.mEntities.notificationMetadata;break;default:return this.constants.mEntities.taskMetadata;};}else{return this.constants.mEntities.taskMetadata;}};
sap.uiext.inbox.Inbox.prototype._getCategoryFilterMetadata=function(){var s=this._getSelectedCategory();var d=this.constants.aDependentDrillDownFiltersBasedOnCategory;switch(s){case"INBOX_FILTER_CATEGORY_TASKS":return d.aFilterMetadataForCategoryTask;break;case"INBOX_FILTER_CATEGORY_TODO":return d.aFilterMetadataForCategoryTodo;break;case"INBOX_FILTER_CATEGORY_ALERT":return d.aFilterMetadataForCategoryAlert;break;case"INBOX_FILTER_CATEGORY_NOTIFICATION":return d.aFilterMetadataForCategoryNotification;break;default:return d.aFilterMetadataForCategoryTask;};};
sap.uiext.inbox.Inbox.prototype.applyDrillDownFilterForPriority=function(e,a){var f,b,c,d;var g=e.getParameter("selectedItems");a.resetSearchCriteria();a.clearFiltersForPriority();for(var i=0;i<g.length;i++){switch(g[i].getId()){case a.getId()+'--'+"INBOX_FILTER_PRIORITY_LOW":if(this.filterOperatorPrioLow===undefined)f=a.inboxUtils._getPriorityFilters("LOW",a.sProviderHost);a.filtersToApply['lowPrio']=f;break;case a.getId()+'--'+"INBOX_FILTER_PRIORITY_MEDIUM":if(b===undefined)b=a.inboxUtils._getPriorityFilters("MEDIUM",a.sProviderHost);a.filtersToApply['medPrio']=b;break;case a.getId()+'--'+"INBOX_FILTER_PRIORITY_HIGH":if(c===undefined)c=a.inboxUtils._getPriorityFilters("HIGH",a.sProviderHost);a.filtersToApply['hiPrio']=c;break;case a.getId()+'--'+"INBOX_FILTER_PRIORITY_VERY_HIGH":if(d===undefined)d=a.inboxUtils._getPriorityFilters("VERY_HIGH",a.sProviderHost);a.filtersToApply['veryhiPrio']=d;break;};}a.applyFilterOnResponse(null);};
sap.uiext.inbox.Inbox.prototype.applyDrillDownFilterForStatus=function(e,a){var f,b,c,d;a.resetSearchCriteria();a.clearFiltersForStatus();if(e.getParameter("all")){d=new sap.ui.model.Filter("Status",sap.ui.model.FilterOperator.NE,"COMPLETED");a.filtersToApply['neCompleted']=d;}else{var g=e.getParameter("selectedItems");for(var i=0;i<g.length;i++){switch(g[i].getId()){case a.getId()+'--'+"INBOX_FILTER_STATUS_RESERVED":if(f===undefined)f=a.inboxUtils._getStatusFilters("RESERVED",a.sProviderHost);a.filtersToApply['resStat']=f;break;case a.getId()+'--'+"INBOX_FILTER_STATUS_READY":if(b===undefined)b=a.inboxUtils._getStatusFilters("READY",a.sProviderHost);a.filtersToApply['readyStat']=b;break;case a.getId()+'--'+"INBOX_FILTER_STATUS_IN_PROGRESS":if(c===undefined)c=a.inboxUtils._getStatusFilters("IN_PROGRESS",a.sProviderHost);a.filtersToApply['InProStat']=c;break;};}}a.applyFilterOnResponse(null);};
sap.uiext.inbox.Inbox.prototype.applyDrillDownFilterForDateTime=function(e,a){var f,b,c,d;var t=sap.ui.getCore().byId(a.getId()+'--'+"INBOX_FILTER_DATETIME_TODAY");var l=sap.ui.getCore().byId(a.getId()+'--'+"INBOX_FILTER_DATETIME_MONTH");var g=sap.ui.getCore().byId(a.getId()+'--'+"INBOX_FILTER_DATETIME_15DAYS");var h=sap.ui.getCore().byId(a.getId()+'--'+"INBOX_FILTER_DATETIME_WEEK");var j=e.getParameter("selectedItems");a.resetSearchCriteria();a.clearFiltersForDateTime();var k=sap.ui.getCore().byId(a.getId()+'--'+'filterComboBox2');var m=false;if(k.getSelectedItemId()===a.getId()+'--'+'li_completedTasks'){m=true;}for(var i=0;i<j.length;i++){switch(j[i].getId()){case a.getId()+'--'+"INBOX_FILTER_DATETIME_TODAY":var n=a.getFormattedDateTimeOff(0,false);if(f===undefined){f=new sap.ui.model.Filter("CreatedOn",sap.ui.model.FilterOperator.GE,n);}a.filtersToApply['today']=f;delete a.filtersToApply.last30;delete a.filtersToApply.last15;delete a.filtersToApply.last7;break;case a.getId()+'--'+"INBOX_FILTER_DATETIME_MONTH":var n=a.getFormattedDateTimeOff(30,false);if(b===undefined){b=new sap.ui.model.Filter("CreatedOn",sap.ui.model.FilterOperator.GE,n);}a.filtersToApply['last30']=b;delete a.filtersToApply.today;delete a.filtersToApply.last15;delete a.filtersToApply.last7;break;case a.getId()+'--'+"INBOX_FILTER_DATETIME_15DAYS":var n=a.getFormattedDateTimeOff(15,false);if(c===undefined){c=new sap.ui.model.Filter("CreatedOn",sap.ui.model.FilterOperator.GE,n);}a.filtersToApply['last15']=c;delete a.filtersToApply.today;delete a.filtersToApply.last30;delete a.filtersToApply.last7;break;case a.getId()+'--'+"INBOX_FILTER_DATETIME_WEEK":var n=a.getFormattedDateTimeOff(7,false);if(d===undefined){d=new sap.ui.model.Filter("CreatedOn",sap.ui.model.FilterOperator.GE,n);}a.filtersToApply['last7']=d;delete a.filtersToApply.today;delete a.filtersToApply.last30;delete a.filtersToApply.last15;break;};}a.applyFilterOnResponse(null);};
sap.uiext.inbox.Inbox.prototype.applyDrillDownFilterForTaskType=function(e,a){var c=a.constants;a.resetSearchCriteria();a.clearFiltersForTaskType();var b=(a.typeOfModel==="OData");if(b&&a.currentView===a.constants.tableView){a._clearCustomAttributeSort();}if(!e.getParameter("all")){var d=e.getParameter("selectedItems");a.bRefreshTaskTypes=false;if(b){a._createCustomAttributes(d);}for(var i=0;i<d.length;i++){a.filtersToApply[d[i].getKey()]=new sap.ui.model.Filter("TaskDefinitionID",sap.ui.model.FilterOperator.EQ,decodeURIComponent(d[i].getKey()));};}else{if(a.isCustomActionsEnabled===true&&b){a._deleteCustomActions(null);}if(a.isCustomAttributesEnabled===true&&b){a._deleteCustomAttributeColumns(null);a._modifyListBindingForExpand(false,c.customAttributeNavigationParam);}}var r=(a.currentView===a.constants.rowRepeaterView)?true:false;a.applyFilterOnResponse(null,r);};
sap.uiext.inbox.Inbox.prototype._getCustomAttributeMetaData=function(t,s,r,S){var a=this;var c=this.constants;var T=c.TaskDefinitionCollection;var C=c.oTaskDefinitionCustomAttributesMap;var o=C[t];if(!o){var R=this.bpmSvcUrl+c.forwardSlash+T.entityName+"("+T.properties.taskDefnID+"='"+t+"',"+c.sapOrigin+"='"+s+"')"+c.forwardSlash+T.navParam.customAttrDefn;var m=this.getCoreModel();var b={async:true,requestUri:R,method:"GET",headers:{Accept:c.acceptHeaderforJSON,"Accept-Language":sap.ui.getCore().getConfiguration().getLanguage(),"x-csrf-token":m.oHeaders["x-csrf-token"]}};OData.request(b,function(d,e){var f=d.results;var g=[];for(var i=0;i<f.length;i++){var h={};h.Name=f[i].Name;h.Type=f[i].Type;h.Label=f[i].Label;g.push(h);}C[t]=g;a._displayCustomAttributes(t,S,r);},function(e){a.showMessage("error",a._oBundle.getText("INBOX_MSG_FETCH_CUSTOM_ATTRIBUTES_FAILS"));});}else{a._displayCustomAttributes(t,S,r);}};
sap.uiext.inbox.Inbox.prototype._displayCustomAttributes=function(s,S,r){var c=this.constants;var C=c.oTaskDefinitionCustomAttributesMap[s];if(this.currentView===this.constants.tableView){this._deleteCustomAttributeColumns(C);if(C){this._createCustomAttributeColumns(C);}}else{if(C&&C.length==0){this._addActionContentinRowRepeater(r,"customAttributes",this._createNoDataLabel(this._oBundle.getText("INBOX_MSG_NO_TASK_DETAILS")));return;}var o=c.oTaskInstanceCustomAttributeValuesMap[S];if(o&&!jQuery.isEmptyObject(o)){this._addActionContentinRowRepeater(r,"customAttributes",this._createCustomAttributesLayoutForRRView(C,o,r));}}};
sap.uiext.inbox.Inbox.prototype._getCustomAttributeData=function(t,s,r,S){var a=this;var c=this.constants;var T=c.TaskCollection;var C=c.oTaskInstanceCustomAttributeValuesMap;var o=C[t];if(!o){var u=c.forwardSlash+T.entityName+"("+T.properties.instanceID+"='"+t+"',"+c.sapOrigin+"='"+s+"')"+c.forwardSlash+T.navParam.customAttrValues;var R=this.bpmSvcUrl+u;var o={};var m=this.getCoreModel();var b={async:true,requestUri:R,method:"GET",headers:{Accept:c.acceptHeaderforJSON,"x-csrf-token":m.oHeaders["x-csrf-token"]}};OData.request(b,function(d,e){var f=d.results;if(f.length>0){o["numberOfAttributes"]=f.length;for(var i=0;i<f.length;i++){o[f[i].Name]=f[i].Value;C[t]=o;}}else{C[t]=o;}a._displayCustomAttributes(S,t,r);},function(e){a.showMessage("error",a._oBundle.getText("INBOX_MSG_FETCH_CUSTOM_ATTRIBUTES_FAILS"));});}};
sap.uiext.inbox.Inbox.prototype._createCustomAttributeColumns=function(c){var t=this;var T=this._getComponent('listViewTable');var m=this.getCoreModel();var N="name",C=0;jQuery.each(c,function(i,a){var o=t._getComponent(t.inboxUtils.scrub(a.Name));var b=a.Type;var d=b&&(jQuery.inArray(b.replace("class ",""),t.constants.rightAlignedTypes)!=-1)?sap.ui.core.TextAlign.Right:sap.ui.core.TextAlign.Left;if(!o){o=new sap.ui.table.Column({id:t.getId()+'--'+t.inboxUtils.scrub(a.Name)}).data("customAttrName",a.Name).data("ColumnType","CustomAttribute").setFlexible(true).setLabel(new sap.ui.commons.Label({text:a.Label,tooltip:a.Label,design:sap.ui.commons.LabelDesign.Bold})).setTemplate(new sap.ui.commons.TextView({id:t.getId()+'--'+t.inboxUtils.scrub(a.Name)+'textView',text:{parts:t.oController.getCustomAttributeColumnParts(a.Name),formatter:t.oController.getCustomAttributeColumnFormatter(t)},}).data(N,a.Name).setTextAlign(d));if(t.oController.isFilterOnCustomAttributesSupported()){o.setFilterProperty(a.Name);}if(t.bAllowCustomAttributeSort){o.bindProperty("sortProperty","CustomAttributeData",function(v){return"CustomAttributeData/"+this.data("customAttrName");});}}else{if(T.indexOfColumn(o)===-1){var l=o.getLabel();if(l.getText()!==a.Label){l.setText(a.Label);}}}T.insertColumn(o,C+1);C++;});this.resizeColumns();};
sap.uiext.inbox.Inbox.prototype._deleteCustomAttributeColumns=function(c){var t=this._getComponent('listViewTable');var T=t.getColumns();for(var i=0;i<T.length;i++){var C=T[i];if(jQuery.inArray(this._removeParentID(C.getId()),this._getCategoryMetadata().properties)===-1){t.removeColumn(C);C.destroy();}}};
sap.uiext.inbox.Inbox.prototype.applyDrillDownFilterForDueDate=function(e,a){var f,b,c,d,g,h;var t=sap.ui.getCore().byId(a.getId()+'--'+"INBOX_FILTER_DUE_DATETIME_TODAY");var n=sap.ui.getCore().byId(a.getId()+'--'+"INBOX_FILTER_DUE_DATETIME_MONTH");var j=sap.ui.getCore().byId(a.getId()+'--'+"INBOX_FILTER_DUE_DATETIME_15DAYS");var k=sap.ui.getCore().byId(a.getId()+'--'+"INBOX_FILTER_DUE_DATETIME_WEEK");var l=sap.ui.getCore().byId(a.getId()+'--'+"INBOX_FILTER_NO_DUE_DATETIME");a.resetSearchCriteria();a.clearFiltersForDueDate();if(!e.getParameter("all")){var m=e.getParameter("selectedItems");var o=new Date(0);for(var i=0;i<m.length;i++){switch(m[i].getId()){case a.getId()+'--'+"INBOX_FILTER_DUE_DATETIME_TODAY":var p=a.getFormattedDueDateTimeOff(1);if(f===undefined){f=new sap.ui.model.odata.Filter("CompletionDeadLine",[{operator:sap.ui.model.FilterOperator.LE,value1:p},{operator:sap.ui.model.FilterOperator.GE,value1:o}],true);}a.filtersToApply['dueDateToday']=f;delete a.filtersToApply.next30;delete a.filtersToApply.next15;delete a.filtersToApply.next7;delete a.filtersToApply.noDueDate;break;case a.getId()+'--'+"INBOX_FILTER_DUE_DATETIME_MONTH":var p=a.getFormattedDueDateTimeOff(30);if(b===undefined){b=new sap.ui.model.odata.Filter("CompletionDeadLine",[{operator:sap.ui.model.FilterOperator.LE,value1:p},{operator:sap.ui.model.FilterOperator.GE,value1:o}],true);}a.filtersToApply['dueDatenext30']=b;delete a.filtersToApply.dueDateToday;delete a.filtersToApply.next15;delete a.filtersToApply.next7;delete a.filtersToApply.noDueDate;break;case a.getId()+'--'+"INBOX_FILTER_DUE_DATETIME_15DAYS":var p=a.getFormattedDueDateTimeOff(15);if(c===undefined){c=new sap.ui.model.odata.Filter("CompletionDeadLine",[{operator:sap.ui.model.FilterOperator.LE,value1:p},{operator:sap.ui.model.FilterOperator.GE,value1:o}],true);}a.filtersToApply['dueDatenext15']=c;delete a.filtersToApply.dueDateToday;delete a.filtersToApply.next30;delete a.filtersToApply.next7;delete a.filtersToApply.noDueDate;break;case a.getId()+'--'+"INBOX_FILTER_DUE_DATETIME_WEEK":var p=a.getFormattedDueDateTimeOff(7);if(d===undefined){d=new sap.ui.model.odata.Filter("CompletionDeadLine",[{operator:sap.ui.model.FilterOperator.LE,value1:p},{operator:sap.ui.model.FilterOperator.GE,value1:o}],true);}a.filtersToApply['dueDatenext7']=d;delete a.filtersToApply.dueDateToday;delete a.filtersToApply.next30;delete a.filtersToApply.next15;delete a.filtersToApply.noDueDate;break;case a.getId()+'--'+"INBOX_FILTER_NO_DUE_DATETIME":if(h===undefined){h=new sap.ui.model.Filter("CompletionDeadLine",sap.ui.model.FilterOperator.EQ,null);}a.filtersToApply['noDueDate']=h;delete a.filtersToApply.dueDateToday;delete a.filtersToApply.next30;delete a.filtersToApply.next15;delete a.filtersToApply.next7;break;};}}a.applyFilterOnResponse(null);};
sap.uiext.inbox.Inbox.prototype._getSelectedContextsBeforeRequest=function(){return this.selectedContexts;};
sap.uiext.inbox.Inbox.prototype._setVisibility=function(c,v){var C=this._getComponent(c);if(C){C.setVisible(v);}};
sap.uiext.inbox.Inbox.prototype.changeToolbarOnFilterCategory=function(){var s=this._getComponent('settingsButton');var S=this._getSelectedCategory();switch(S){case"INBOX_FILTER_CATEGORY_TASKS":s.setEnabled(true);break;case"INBOX_FILTER_CATEGORY_TODO":s.setEnabled(false);break;case"INBOX_FILTER_CATEGORY_ALERT":s.setEnabled(false);break;case"INBOX_FILTER_CATEGORY_NOTIFICATION":s.setEnabled(false);break;default:s.setEnabled(true);};};
sap.uiext.inbox.Inbox.prototype.showAllActions=function(){this._setVisibility('claimActionButton',true);this._setVisibility('releaseActionButton',true);this._setVisibility('openActionButton',true);this._setVisibility('forwardActionButton',true);this._setVisibility('rrViewClaimAction',true);this._setVisibility('rrViewReleaseAction',true);this._setVisibility('rrViewForwardAction',true);this._setVisibility('dotSeparator',true);this._setVisibility('dotSeparator2',true);};
sap.uiext.inbox.Inbox.prototype.hideAllActionButtonsandLinks=function(){if(this.getOpenCompletedTasks()==false){this._setVisibility('openActionButton',false);}this._setVisibility('claimActionButton',false);this._setVisibility('releaseActionButton',false);this._setVisibility('forwardActionButton',false);this._setVisibility('rrViewClaimAction',false);this._setVisibility('rrViewReleaseAction',false);this._setVisibility('rrViewForwardAction',false);this._setVisibility('dotSeparator',false);this._setVisibility('dotSeparator2',false);};
sap.uiext.inbox.Inbox.prototype.showAllActionButtonsandLinks=function(){if(this.typeOfModel==="OData"){var t=this.constants.ENTITY_NAME_TASK_COLLECTION;this._setVisibility('openActionButton',false);if(this.oTcmMetadata._isPropertyAvailable(t,"SupportsClaim")){this._setVisibility('claimActionButton',true);this._setVisibility('rrViewClaimAction',true);}if(this.oTcmMetadata._isPropertyAvailable(t,"SupportsRelease")){this._setVisibility('releaseActionButton',true);this._setVisibility('rrViewReleaseAction',true);this._setVisibility('dotSeparator',true);}if(this.oTcmMetadata._isPropertyAvailable(t,"SupportsForward")&&this.isForwardActionEnabled){this._setVisibility('forwardActionButton',true);this._setVisibility('dotSeparator2',true);this._setVisibility('rrViewForwardAction',true);}}else{this.showAllActions();}};
sap.uiext.inbox.Inbox.prototype._handleActionButtonsEnable=function(s){if((s.length>0)&&!(jQuery.inArray(false,s)>-1)){return true;}else{return false;}};
sap.uiext.inbox.Inbox.prototype.disableActionButtonsOnMultiStatus=function(s,a){var c=this._getComponent('claimActionButton');var r=this._getComponent('releaseActionButton');var f=this._getComponent('forwardActionButton');var b=this._getComponent('openActionButton');var C=this._isCompletedTasksSelected();var g=this.getOpenCompletedTasks();var S=a.aSupportsClaim;var d=a.aSupportsForward;var e=a.aSupportsRelease;if(!g&&C){b.setVisible(false);}else{b.setVisible(true);}if(s.length>0&&!jQuery.inArray("COMPLETED",s)>-1){b.setEnabled(true);}else{if(this.getOpenCompletedTasks()==true){b.setEnabled(true);}else{b.setEnabled(false);}}c.setEnabled(this._handleActionButtonsEnable(S));r.setEnabled(this._handleActionButtonsEnable(e));f.setEnabled(this._handleActionButtonsEnable(d));};
sap.uiext.inbox.Inbox.prototype.dateFormat=function(d,D){if(d!=undefined&&typeof(d)=='string'&&d!=""){var a;if(d.indexOf('Date')!=-1){a=new Date();a.setTime(d.substring((d.indexOf("(")+1),d.indexOf(")")));}else{a=new Date(d.substring((d.indexOf("'")+1),d.length-1));}d=a;}if(d!=undefined&&d!=""){var i=sap.ui.core.format.DateFormat.getDateInstance({style:"medium"});if(D!==undefined&&D===false){i=sap.ui.core.format.DateFormat.getDateInstance({pattern:"MMM dd",style:"medium"});}return i.format(d);}return"";};
sap.uiext.inbox.Inbox.prototype.tooltipFormatForDateTime=function(d){if(d!=undefined&&typeof(d)=='string'&&d!=""){var a;if(d.indexOf('Date')!=-1){a=new Date();a.setTime(d.substring((d.indexOf("(")+1),d.indexOf(")")));}else{a=new Date(d.substring((d.indexOf("'")+1),d.length-1));}d=a;}if(d!=undefined&&d!=""){var i=sap.ui.core.format.DateFormat.getDateTimeInstance({style:"full"});return i.format(d);}return"";};
sap.uiext.inbox.Inbox.prototype.executeActionOnTask=function(e,a){var b=a.inbox;var v=a.view;var c=a.action;var d=(c===b.constants.FORWARD)?true:false;var f=d?a.forwardTo:"";b.showBusyLoader();var l,r,m;var s=[],g=[],h=[],j=[];var k=[];var n,o;var p,q;b.resetSearchCriteria();m=b.getCoreModel();if(v===b.constants.tableView){l=sap.ui.getCore().byId(b.getId()+'--'+'listViewTable');if(e.getSource())var t=b.getlistTableSelectedIndices();jQuery.each(t,function(i,z){r=l.getContextByIndex(z);g.push(r);p=m.getProperty("InstanceID",r);q=m.getProperty("SAP__Origin",r);s.push(p);h.push(q);if(i==0){n=p;o=q;}else{n=n+";"+p;o=o+";"+q;}});}else if(v===b.constants.rowRepeaterView){var C=e.getSource().getBindingContext();var R=e.getSource().getParent().getParent().getParent().getParent().getParent().getParent();p=m.getProperty("InstanceID",C);q=m.getProperty("SAP__Origin",C);s.push(p);h.push(q);n=p;o=q;g.push(C);}if(s!=null||s.length>0){var I,u,w,x;if(c==="Claim"){c="Claim";}if(c==="Release"){c="Release";}if(d){c="Forward";}var y=e.getParameters();y.action=c;y.selectedIDs=n;y.selectedSAPOrigins=o;y.selectedIDList=s;y.selectedSAPOriginList=h;y.selectedContextList=g;if(R){y.oRow=R;}if(d){y.selectedForwardToUsers=f;}b.fireTaskAction(y);if(b.clientUpdate===undefined&&b.typeOfModel!=="OData"){b.applyFilterOnResponse(g);}}b.resetMessages=false;if(b.clientUpdate){b.resetMessages=true;}};
sap.uiext.inbox.Inbox.prototype.defaultActionHandler=function(e,a){var c=a.constants;var A=e.getParameter('action');var b=e.getParameter('selectedIDs');var d=e.getParameter('selectedSAPOrigins');var s=e.getParameter('selectedIDList');var f=e.getParameter('selectedSAPOriginList');var g=e.getParameter('commentsList');var h=(A===a.constants.FORWARD)?true:false;var S=e.getParameter('selectedContextList');var o=e.getParameter('oRow');var F=e.getParameter('selectedForwardToUsers');var j=s.length;var t=j;if((j>1)&&a.isBatchOperationSupported){var u=[];for(var i=0;i<j;i++){var U={};U.InstanceID="'"+s[i]+"'";U.SAP__Origin="'"+f[i]+"'";if(g&&g.length>0){U.Comments="'"+g[i]+"'";}if(h){U.ForwardTo="'"+e.getParameter('selectedForwardToUsers')+"'";}u.push(U);}var k=function(D,r){a.processTaskActionBatchResponse(S,D,A,F);};var E=function(m){a._handleErrorOnBatchRequests(m,A,t);};this.oDataManager.fireBatchRequest({sPath:A,sMethod:"POST",sBatchGroupId:"standardActionBatch",aUrlParameters:u,numberOfRequests:j,fnSuccess:k,fnError:E});}else{var l={};l.InstanceID=decodeURIComponent(b);l.SAP__Origin=d;if(h)l.ForwardTo=e.getParameter('selectedForwardToUsers');var k=function(m,r){if(a.clientUpdate){var C=[],n=[];a.hideBusyLoader();a.selectedContexts=S;var p=a._getAppliedStatusFilterValues();if(A==='Forward'||p.length>0&&(jQuery.inArray(m.Status,p))===-1){if(o)C.push({orow:o,context:S[0]});else C.push(S[0]);}n.push({context:S[0],keys:[{key:'Status',value:m.Status},{key:'IsEscalated',value:m.IsEscalated}]});a._refreshLocal(C,n,true);}if(a.clientUpdate===undefined)a.applyFilterOnResponse(S);if(A==="Forward")a.showMessage("success",a._oBundle.getText("INBOX_MSG_FORWARD_ACTION_SUCCESS",[m.TaskTitle,F]));else a.showMessage("success",a._oBundle.getText("INBOX_MSG_ACTION_SUCCESS",[A,m.TaskTitle]));};var E=function(m){a._handleErrorOnActionFailed(m,A,a.getCoreModel().getProperty("TaskTitle",S[0]));};a.oDataManager.callFunctionImport(A,{method:"POST",urlParameters:l,success:k,error:E},true);}};
sap.uiext.inbox.Inbox.prototype.processTaskActionBatchResponse=function(s,d,a,f){var b=d.__batchResponses;var i,j,B,l,t,e;var n=0,N=0,c=[],C=[];for(i=0,l=b.length;i<l;i++){var g=b[i].__changeResponses;if(g){for(j=0,B=g.length;j<B;j++){var o=g[j];if(B===1){t=o.data.TaskDefinitionName;}e=!(o.statusCode>=200&&o.statusCode<=202);if(e){n=n+1;}else{N=N+1;}}}else{n=n+1;}}if(this.clientUpdate===undefined){this.applyFilterOnResponse(s);}this.displayMessageAfterExecutingAction(a,t,n,N,f);};
sap.uiext.inbox.Inbox.prototype.displayMessageAfterExecutingAction=function(a,t,n,N,f){if(n>0){var e=(n===1)?this._oBundle.getText("INBOX_MSG_ACTION_FAILED",[a,n]):this._oBundle.getText("INBOX_MSG_ACTION_FAILED_MULTIPLE_TASKS",[a,n]);this.showMessage("error",e);}if(N===1){var m=a==="Forward"?this._oBundle.getText("INBOX_MSG_FORWARD_ACTION_SUCCESS",[t,f]):this._oBundle.getText("INBOX_MSG_ACTION_SUCCESS",[a,t]);this.showMessage("success",m);}if(N>1){this.showMessage("success",this._oBundle.getText("INBOX_MSG_ACTION_SUCCESS_MULTIPLE_TASKS",[a,N]));}};
sap.uiext.inbox.Inbox.prototype.fillAttributes=function(){var a=this;var f=sap.ui.getCore().byId(this.getId()+'--'+'filterFacet');if(f!=undefined){var t=a.applyTaskCategoryFilter?a.constants.aDrillDownFilterMetadata[1].attributes:a.bShowNoDueDateFilter?a.constants.aFilterMetaDataWithNoDueDate[0].attributes:a.constants.aFilterMetaData[0].attributes;var b=a.applyTaskCategoryFilter?f.getLists()[1]:f.getLists()[0];if(b===undefined||b===null)return;var c=b.getItems();jQuery.each(c,function(i,d){var e=a.inboxUtils.inArray(d.getKey(),t);if(d.getKey()!='sapUiFacetFilter_ALL'){if(e===-1){b.removeItem(d);}else{t.splice(e,1);}}});if(t.length>0){jQuery.each(t,function(i,d){var e=a.inboxUtils.scrub(d.key);var A=sap.ui.getCore().byId(a.getId()+'--'+e);if(A===undefined)A=new sap.ui.core.ListItem(a.getId()+'--'+e,{text:d.value,key:d.key}).data("InstanceID",d.instanceID).data("SAP__Origin",d.sap__Origin);b.addItem(A);});}}};
sap.uiext.inbox.Inbox.prototype.resetFilterView=function(c){var a;if(this.filtersToApply.dropDownFilter){a=this.filtersToApply.dropDownFilter;}else if(this.filtersToApply.resStat!=undefined||this.filtersToApply.readyStat!=undefined||this.filtersToApply.InProStat!=undefined){a=new sap.ui.model.Filter("Status",sap.ui.model.FilterOperator.NE,"COMPLETED");}this.filtersToApply={};if(a!=undefined){this.filtersToApply.dropDownFilter=a;}var f=this.bShowNoDueDateFilter?sap.uiext.inbox.InboxConstants.aFilterMetaDataWithNoDueDate:sap.uiext.inbox.InboxConstants.aFilterMetaData;for(var i=0;i<f.length;i++){var b=sap.ui.getCore().byId(this.getId()+'--'+f[i].name);if(b!=undefined)b.setSelectedKeys(["sapUiFacetFilter_ALL"]);}if(c)this.applyFilterOnResponse(null);};
sap.uiext.inbox.Inbox.prototype.getlistTableSelectedIndices=function(){var l=sap.ui.getCore().byId(this.getId()+'--'+'listViewTable');return l.getSelectedIndices();};
sap.uiext.inbox.Inbox.prototype.getCoreModel=function(){if(!this._oModel){this._oModel=sap.ui.getCore().byId(this.getId()+'--'+'listViewTable').getModel();}return this._oModel;};
sap.uiext.inbox.Inbox.prototype.getnavigateTaskExecMetadata=function(){var l=sap.ui.getCore().byId(this.getId()+'--'+'listViewTable');var t=[];var a=[];var b=[];var T=[];var s=[];var c=this.getlistTableSelectedIndices();var m=this.getCoreModel();jQuery.each(c,function(i,e){var r=l.getContextByIndex(e);s.push(r);a.push(m.getProperty("InstanceID",r));b.push(m.getProperty("TaskTitle",r));T.push(m.getProperty("SAP__Origin",r));});if(this.getTaskExecutionURLCallBack!=""&&this.getTaskExecutionURLCallBack!=undefined&&this.getTaskExecutionURLCallBack!==null){var d=this.getTaskExecutionURLCallBack(a[0],T[0]);if(d!==null&&d.replace(/\s/g,"").length>0){t.push(d);}}else{t.push("");}return{aSelectedContexts:s,arrayURLs:t,arrayIDs:a,arrayTitles:b,aTaskSAPOrigins:T};};
sap.uiext.inbox.Inbox.prototype.getlistTableSelectedContexts=function(){var s=[];var a=this.getlistTableSelectedIndices();var l=sap.ui.getCore().byId(this.getId()+'--'+'listViewTable');jQuery.each(a,function(i,b){s.push(l.getContextByIndex(b));});return s;};
sap.uiext.inbox.Inbox.prototype.showBusyLoader=function(){sap.ui.core.BusyIndicator.show(0);var b=jQuery.sap.byId("busy_loader");b.css('position','absolute');b.css('top',"50%");b.css('left',"50%");b.css('display','');b.show();b.css('z-index',99);};
sap.uiext.inbox.Inbox.prototype.hideBusyLoader=function(){sap.ui.core.BusyIndicator.hide();var b=jQuery.sap.byId("busy_loader");b.css('display','none');b.css('z-index',-1);};
sap.uiext.inbox.Inbox.prototype.resetSearchCriteria=function(){var s=sap.ui.getCore().byId(this.getId()+'--'+'searchField');s.setValue("");};
sap.uiext.inbox.Inbox.prototype.loadExecImages=function(){var r=this._imgResourcePath+sap.uiext.inbox.InboxConstants.prevBtnImage;var a=this._imgResourcePath+sap.uiext.inbox.InboxConstants.nxtBtnImage;jQuery.ajax({url:r,type:"GET",async:true,success:function(d,t,X){},error:function(X,t,e){}});jQuery.ajax({url:a,type:"GET",async:true,success:function(d,t,X){},error:function(X,t,e){}});};
sap.uiext.inbox.Inbox.prototype.setNoOfRowsOnTable=function(v){var t=sap.ui.getCore().byId(this.getId()+'--'+'listViewTable');if(t!=undefined)t.setVisibleRowCount(parseInt(v,10));};
sap.uiext.inbox.Inbox.prototype.showMessage=function(m,a){var t=this;var n=sap.ui.getCore().byId(this.getId()+'--'+'notificationBar');var M=sap.ui.getCore().byId(this.getId()+'--'+'messageNotifier');if(n!=undefined){n.setVisibleStatus(sap.ui.ux3.NotificationBarStatus.Default);var b=new Date();var d=sap.ui.core.format.DateFormat.getDateTimeInstance({style:"medium"});var f=d.format(b);var o=new sap.ui.core.Message({text:a,timestamp:f});if(m==="success"){o.setLevel(sap.ui.core.MessageType.Success);}else if(m==="info"){o.setLevel(sap.ui.core.MessageType.Information);}else if(m==="error"){o.setLevel(sap.ui.core.MessageType.Error);}else if(m==="warning"){o.setLevel(sap.ui.core.MessageType.Warning);}M.addMessage(o);n.setMessageNotifier(M);jQuery.sap.delayedCall(0,this,function(){n._oItemNavigation.focusItem(1);});}};
sap.uiext.inbox.Inbox.prototype.deleteMessage=function(e,i){if(i===undefined)i=this;var n=sap.ui.getCore().byId(i.getId()+'--'+'notificationBar');var m=sap.ui.ux3.NotificationBarStatus.Min;if(n!=undefined&&n.hasItems()){n.setVisibleStatus(m);}};
sap.uiext.inbox.Inbox.prototype.getFormattedDateTimeOff=function(s,i){var m=new Date();m.setDate(m.getDate()-s);if(!i){m.setHours(0);m.setSeconds(0);m.setMinutes(m.getTimezoneOffset());}return m;};
sap.uiext.inbox.Inbox.prototype.getFormattedDueDateTimeOff=function(s){var m=new Date();m.setDate(m.getDate()+s);m.setHours(0);m.setSeconds(0);m.setMinutes(m.getTimezoneOffset());return m;};
sap.uiext.inbox.Inbox.prototype.refreshTaskTypes=function(){if(this.dynamicTaskTypeFilterCallBack){if(this.applyTaskCategoryFilter){this.constants.aDrillDownFilterMetadata[1].attributes=this.dynamicTaskTypeFilterCallBack();}else if(this.bShowNoDueDateFilter){this.constants.aFilterMetaDataWithNoDueDate[0].attributes=this.dynamicTaskTypeFilterCallBack();}else{this.constants.aFilterMetaData[0].attributes=this.dynamicTaskTypeFilterCallBack();}this.fillAttributes();return;}var t=sap.ui.getCore().byId(this.getId()+'--'+'listViewTable');var T=[];var m={};var o;if(this.getHandleBindings()){var l=this._currentViewElement().getBinding("rows");var c=this._currentViewElement().getBinding("rows").getContexts(null,l.iLength);var M=this.getCoreModel();jQuery.each(c,function(i,C){o={"key":M.getProperty("TaskDefinitionID",C),"value":M.getProperty("TaskDefinitionName",C),"sap__Origin":M.getProperty("SAP__Origin",C)};if(!m[o.key]){m[o.key]=true;T.push(o);}});}else{var L=this._currentViewElement().getBinding("rows");if(L&&L.oList){jQuery.each(L.oList,function(i,e){o={"key":e.TaskDefinitionID,"value":e.TaskDefinitionName};if(!m[o.key]){m[o.key]=true;T.push(o);}});}}if(T.length>0){if(this.applyTaskCategoryFilter){this.constants.aDrillDownFilterMetadata[1].attributes=T;}else if(this.bShowNoDueDateFilter){this.constants.aFilterMetaDataWithNoDueDate[0].attributes=T;}else{this.constants.aFilterMetaData[0].attributes=T;}this.fillAttributes();}};
sap.uiext.inbox.Inbox.prototype.onAfterRendering=function(){var t=sap.ui.getCore().byId(this.getId()+'--'+'listViewTable').$();t.find("a:disabled").addClass("sapUiExtInboxLnkDsbl");};
sap.uiext.inbox.Inbox.prototype._getComponent=function(c){return sap.ui.getCore().byId(this.getId()+'--'+c);};
sap.uiext.inbox.Inbox.prototype._removeParentID=function(c){var p=this.getId();return c.replace(this.getId()+"--","");};
sap.uiext.inbox.Inbox.prototype.populateViewButtonsContainer=function(v){var l=new sap.ui.commons.layout.MatrixLayoutCell({id:this.getId()+'--'+"segmentedButtonCell"});var s=new sap.ui.commons.SegmentedButton({id:this.getId()+'--'+'viewSelectionSegBtn',buttons:[new sap.ui.commons.Button({id:this.getId()+'--'+'tableViewSelectionButton',height:"20px",lite:true,icon:this.constants.tableViewImageSelected,iconHovered:this.constants.tableViewImageSelected,iconSelected:this.constants.tableViewImageSelected,tooltip:this._oBundle.getText("INBOX_LIST_VIEW_TOOLTIP")}).addStyleClass("sapUiExtInboxSegmentedButtonTransparentSelected"),new sap.ui.commons.Button({id:this.getId()+'--'+'rrViewSelectionButton',height:"20px",lite:true,icon:this.constants.rrViewImageSelected,iconHovered:this.constants.rrViewImageSelected,iconSelected:this.constants.rrViewImageSelected,tooltip:this._oBundle.getText("INBOX_STREAM_VIEW_TOOLTIP")}).addStyleClass("sapUiExtInboxSegmentedButtonViewSelection")]});s.setSelectedButton(this.getId()+'--'+'tableViewSelectionButton');s.attachSelect(this,this.switchViews);s.addStyleClass("sapUiExtInboxToolBarContainerHeight");l.addContent(s);l.setPadding(sap.ui.commons.layout.Padding.None);v.createRow(l);};
sap.uiext.inbox.Inbox.prototype.updateStylingOnSwitchingView=function(b,e){var B=e.getSource().getButtons();var o;for(var i=0;i<B.length;i++){o=B[i];if(b.getId()!=o.getId()){o.addStyleClass("sapUiExtInboxSegmentedButtonViewSelection");o.removeStyleClass("sapUiExtInboxSegmentedButtonTransparentSelected");}else{o.removeStyleClass("sapUiExtInboxSegmentedButtonViewSelection");o.addStyleClass("sapUiExtInboxSegmentedButtonTransparentSelected");}}};
sap.uiext.inbox.Inbox.prototype.switchViews=function(e,i){var t=i;t.resetSearchCriteria();var p=t.currentView;var b=sap.ui.getCore().byId(e.getSource().getSelectedButton());var a=t.getId()+'--'+"tableViewSelectionButton";var r=t.getId()+'--'+"rrViewSelectionButton";var c=sap.ui.getCore().byId(t.getId()+'--'+'listViewTable');var d=sap.ui.getCore().byId(t.getId()+'--'+'tableRowSettingLayoutContainer');var T=sap.ui.getCore().byId(t.getId()+'--'+'tasksRowRepeater');var v=sap.ui.getCore().byId(t.getId()+'--'+'verticalLayoutContainer');var f=sap.ui.getCore().byId(t.getId()+'--'+'actionButtonsToolbarContainer');var g=sap.ui.getCore().byId(t.getId()+'--'+'rrToolbar');var h=sap.ui.getCore().byId(t.getId()+'--'+'rowRepeaterToolsMatLayout');var k=sap.ui.getCore().byId(t.getId()+'--'+"rowRepeaterPaginator");var l=t._currentViewElement();var m=l.getBinding('rows');var n=false,u=true,s;var S=t.oModel instanceof sap.ui.model.json.JSONModel;t.updateStylingOnSwitchingView(b,e);if(t.applyTaskCategoryFilter){if(b.getId()==a){t._modifyFacetFilterOnFilterCategory();}else if(b.getId()==r){t._modifyFacetFilterOnFilterCategory(true);}}if(m&&m.sFilterParams&&m.sFilterParams.indexOf('TaskDefinitionID')!==-1){n=true;var o=t._getComponent("INBOX_FILTER_TASK_TYPE");s=o.getSelectedKeys();}if(t.clientUpdate&&t._isTaskDefinitionFilterApplied()){n=true;var o=t._getComponent("INBOX_FILTER_TASK_TYPE");s=o.getSelectedKeys();}if(b.getId()===a){t.currentView=t.constants.tableView;b.setIcon(t.constants.tableViewImageSelected);var q=sap.ui.getCore().byId(r);q.setIcon(t.constants.rrViewImageSelected);f.setVisible(true);c.setVisible(true);g.setVisible(false);T.setVisible(false);h.setVisible(false);d.setVisible(true);if(n&&s&&s.length===1){var I=o.getItems();var w=s[0];var x=[];for(var j=0;j<I.length;j++){if(w===I[j].getKey()){x.push(I[j]);break;}}t._createCustomAttributes(x);}}if(b.getId()===r){t.currentView=t.constants.rowRepeaterView;if(t._isTableFiltered){t._removeTableFilters();}b.setIcon(t.constants.rrViewImageSelected);var y=sap.ui.getCore().byId(a);y.setIcon(t.constants.tableViewImageSelected);if(t.isCustomAttributesEnabled){var z=t._getComponent('customAttributesSegBtn');if(z&&!z.getVisible()){z.setVisible(true);}}f.setVisible(false);c.setVisible(false);d.setVisible(false);if(T.getModel()===undefined||T.getModel()===null){T.setModel(t.getModel());}g.setVisible(true);T.setVisible(true);h.setVisible(true);if(T.getBinding('rows')){var A=T.getBinding('rows').iLength;t._updatePaginator(A);}else{if(e.getParameters().triggeredFrom===undefined){var R=t._getComponent('rrMainMatrixLayout');var B=new sap.ui.model.Sorter("CreatedOn",true);var C=t._getFilterArray();if(t.isCustomActionsEnabled){t._deleteCustomActions();var D=t._isCompletedTasksSelected();if(!D&&n){if(s&&s.length===1){var I=o.getItems();var w=s[0];var E;for(var j=0;j<I.length;j++){if(w===I[j].getKey()){E=I[j].data("SAP__Origin");break;}}}}}var P=t._getBindingParameters();T.bindRows({path:t.sCollectionPath,template:R,parameters:P,sorter:B,filters:C});u=false;if(S){var F=T.getBinding('rows').iLength;t._updatePaginator(F);}}}}if(window.history.replaceState){var U=window.location.search;var G=t.constants.defaultView_URLParameter;if(U.indexOf(G)!=-1){U=U.replace(G+"="+p,G+"="+t.currentView);var H=window.location.pathname.substring(window.location.pathname.lastIndexOf("/")+1);window.history.replaceState(null,null,H+U);}}t.inboxUtils.setCookieValue(t.constants.defaultView_URLParameter,t.currentView,1);if(u){if(t.isCustomActionsEnabled){t._deleteCustomActions();var D=t._isCompletedTasksSelected();if(!D&&n){if(s&&s.length===1){var I=o.getItems();var w=s[0];var E;for(var j=0;j<I.length;j++){if(w===I[j].getKey()){E=I[j].data("SAP__Origin");break;}}}t.applyFilterOnResponse(null,true);}else{t.applyFilterOnResponse(null);}}else{if(e.getParameters().triggeredFrom===undefined){if(S&&(t.currentView===t.constants.rowRepeaterView)){t.applyFilterOnResponse(null,true);}else{t.applyFilterOnResponse(null);}}}}};
sap.uiext.inbox.Inbox.prototype.createOtherActions=function(i){var t=i;var a=new sap.ui.commons.ToggleButton({id:t.getId()+'--'+'attachmentsSegBtn',visible:false,lite:true,icon:t._imgResourcePath+sap.uiext.inbox.InboxConstants.attachmentsImage,tooltip:this._oBundle.getText("INBOX_SHOW_ATTACHMENTS")}).bindProperty("visible","SupportsAttachments",function(v){if(v)return v;else return false;}).attachPress(this,function(e,t){t._handleActionButtonToggleinRowRepeater(e);});var c=new sap.ui.commons.ToggleButton({id:t.getId()+'--'+'commentsSegBtn',visible:false,lite:true,icon:this.constants.commentsImage,tooltip:this._oBundle.getText("INBOX_SHOW_COMMENTS")}).addStyleClass("sapUiExtInboxRowRepCommentIconColor");var b=new sap.ui.commons.ToggleButton({id:t.getId()+'--'+'customAttributesSegBtn',enabled:true,pressed:false,lite:true,visible:false,tooltip:this._oBundle.getText("INBOX_SHOW_CUSTOM_ATTRIBUTES"),icon:this.constants.iconPool.getIconURI("expand")});b.bindProperty("visible",t.constants.TaskCollection.properties.instanceID,function(v){if(t.isCustomAttributesEnabled){return true;}if(v&&t.bCustomAttributesVisible){var d=this.getId();var R=(/\d+$/);var e=R.exec(d);var m=t.getCoreModel();var o=this.getBindingContext();var s=t.getModel().getProperty(t.constants.TaskDefinitionCollection.properties.taskDefnID,o);var S=t.getModel().getProperty(t.constants.TaskCollection.properties.instanceID,o);var f=t.getModel().getProperty(t.constants.sapOrigin,o);t._getCustomAttributeContentforRowRepeater(null,e[0],s,S,f);this.setIcon(t.constants.iconPool.getIconURI("collapse"));this.setTooltip(t._oBundle.getText("INBOX_HIDE_CUSTOM_ATTRIBUTES"));this.setPressed(true);return true;}return false;});var C=new sap.ui.commons.layout.MatrixLayoutCell(t.getId()+'--'+'rrCustomAttrButtonCell',{hAlign:sap.ui.commons.layout.HAlign.End,});C.addContent(b);var r=new sap.ui.commons.layout.MatrixLayout(t.getId()+'--'+'rrOtherActionsMatLay',{layoutFixed:false,columns:4,width:"5%"});r.createRow(a,c,C);b.attachPress(this,function(e,t){t._handleActionButtonToggleinRowRepeater(e);});return r;};
sap.uiext.inbox.Inbox.prototype._isOverDue=function(v){if(v===undefined||v===null||v==="")return false;var n=new Date().getTime();var o=(v.getTime()-n)<0?true:false;return o;};
sap.uiext.inbox.Inbox.prototype._currentView=function(){return this.currentView;};
sap.uiext.inbox.Inbox.prototype.createRowRepeaterToolBar=function(i){var t=i;var a=sap.ui.getCore().byId(this.getId()+'--'+'rrToolbar');var r=sap.ui.getCore().byId(this.getId()+'--'+'tasksRowRepeater');if(!a){var a=new sap.ui.commons.Toolbar(this.getId()+'--'+"rrToolbar");a.setDesign(sap.ui.commons.ToolbarDesign.Standard);a.addStyleClass("sapUiExtInboxActionButtonsToolbarContainer");var s=0;if(sap.ui.getCore().byId(this.getId()+'--'+'sortByLabel')===undefined){var b=new sap.ui.commons.Label(this.getId()+'--'+"sortByLabel",{text:this._oBundle.getText("INBOX_SORT_BY_LABEL")+sap.uiext.inbox.InboxConstants.COLON,design:sap.ui.commons.LabelDesign.Bold});a.insertItem(b,s);}var d=new sap.ui.commons.DropdownBox(this.getId()+'--'+"sortByFilterComboBox",{tooltip:this._oBundle.getText("INBOX_SORT_BY_LABEL"),items:[new sap.ui.core.ListItem(this.getId()+'--'+"li_creationDate",{text:this._oBundle.getText("INBOX_FILTER_CREATION_DATE"),tooltip:this._oBundle.getText("INBOX_SORT_BY_LABEL")+" "+this._oBundle.getText("INBOX_FILTER_CREATION_DATE")}),new sap.ui.core.ListItem(this.getId()+'--'+"li_taskTitle",{text:this._oBundle.getText("INBOX_TASK_TITLE"),tooltip:this._oBundle.getText("INBOX_SORT_BY_LABEL")+" "+this._oBundle.getText("INBOX_TASK_TITLE")}),new sap.ui.core.ListItem(this.getId()+'--'+"li_status",{text:this._oBundle.getText("INBOX_STATUS"),tooltip:this._oBundle.getText("INBOX_SORT_BY_LABEL")+" "+this._oBundle.getText("INBOX_STATUS")})]});d.setValue(this._oBundle.getText("INBOX_FILTER_CREATION_DATE"));d.addStyleClass("sapUiExtInboxRowRepeaterSortBy");var _=new sap.ui.commons.RowRepeaterSorter(this.getId()+'--'+'sortByStartDate',{sorter:new sap.ui.model.Sorter("CreatedOn",true)});var c=new sap.ui.commons.RowRepeaterSorter(this.getId()+'--'+'sortByTaskTitle',{sorter:new sap.ui.model.Sorter("TaskTitle",true)});var e=new sap.ui.commons.RowRepeaterSorter(this.getId()+'--'+'sortByStatus',{sorter:new sap.ui.model.Sorter("Status",true)});r.addSorter(_);r.addSorter(c);r.addSorter(e);d.attachChange(this,function(E,g){var o=g._getComponent('li_empty');if(this.indexOfItem(o)!==-1)this.removeItem(o);var l=E.getSource().getSelectedItemId();t.resetSearchCriteria();var h;if(l===g.getId()+'--'+"li_creationDate"){h=sap.ui.getCore().byId(t.getId()+'--'+'sortByStartDate').getSorter();h.bDescending=!h.bDescending;r.triggerSort(t.getId()+'--'+'sortByStartDate');}else if(l===g.getId()+'--'+"li_taskTitle"){h=sap.ui.getCore().byId(t.getId()+'--'+'sortByTaskTitle').getSorter();h.bDescending=!h.bDescending;r.triggerSort(t.getId()+'--'+'sortByTaskTitle');}else if(l===g.getId()+'--'+"li_status"){h=sap.ui.getCore().byId(t.getId()+'--'+'sortByStatus').getSorter();h.bDescending=!h.bDescending;r.triggerSort(t.getId()+'--'+'sortByStatus');}t._updateRowRepeaterSortImage(h.bDescending);});a.insertItem(d,s+1);var f=new sap.ui.commons.Button(this.getId()+'--'+"sortImage",{tooltip:this._oBundle.getText("INBOX_SORT_INDICATOR_DESC"),icon:sap.uiext.inbox.InboxConstants.sortDescImage});f.addStyleClass("sapUiExtInboxRefreshButtonHeight");f.attachPress(this,function(E,g){var S=g._getComponent('sortByFilterComboBox');var l=S.getSelectedItemId();var r=sap.ui.getCore().byId(g.getId()+'--'+'tasksRowRepeater');g.resetSearchCriteria();var h=g.constants.mRRSortMap[g._removeParentID(l)];var o=h?g._getComponent(h).getSorter():undefined;if(o){o.bDescending=!o.bDescending;r.triggerSort(g.getId()+'--'+h);g._updateRowRepeaterSortImage(o.bDescending);if(o.bDescending){this.setIcon(sap.uiext.inbox.InboxConstants.sortDescImage);this.setTooltip(g._oBundle.getText("INBOX_SORT_INDICATOR_DESC"));}else{this.setIcon(sap.uiext.inbox.InboxConstants.sortAscImage);this.setTooltip(g._oBundle.getText("INBOX_SORT_INDICATOR_ASC"));}}});a.insertItem(f,s+2);var T=sap.ui.getCore().byId(this.getId()+'--'+'toggleCustomAttributes');if(!T){var T=new sap.ui.commons.ToggleButton(this.getId()+'--'+"toggleCustomAttributes",{tooltip:this._oBundle.getText("INBOX_SHOW_ALL_CUSTOM_ATTRIBUTES"),icon:this.constants.iconPool.getIconURI("expand"),lite:true,visible:false,pressed:false});T.addStyleClass("sapUiExtInboxToggleButtonMarginRight");T.attachPress(t,t._toggleCustomAttributesVisibilityActionEvent);a.insertRightItem(T);}}return a;};
sap.uiext.inbox.Inbox.prototype.createRowRepeaterToolsContent=function(I){var t=I;var T=sap.ui.getCore().byId(t.getId()+'--'+'tasksRowRepeater');var r=new sap.ui.commons.layout.MatrixLayout(t.getId()+'--'+'rowRepeaterToolsMatLayout');var p=new sap.ui.commons.Paginator(t.getId()+'--'+"rowRepeaterPaginator");p.attachPage(t,function(e,i){i._handleRowRepeaterPaginatorClick(e);});var s=new sap.ui.commons.SegmentedButton({id:t.getId()+'--'+'rowRepeaterRowSettingsSegBtn',buttons:[new sap.ui.commons.Button({id:t.getId()+'--'+'5RowsSegBtn',lite:true,text:'5',tooltip:this._oBundle.getText("INBOX_SET_NUMBER_OF_ROWS_TO")+" "+this._oBundle.getText("INBOX_NUMBER_FIVE")}).addStyleClass("sapUiExtInboxSegmentedButtonTransparent"),new sap.ui.commons.Button({id:t.getId()+'--'+'10RowsSegBtn',lite:true,text:'10',tooltip:this._oBundle.getText("INBOX_SET_NUMBER_OF_ROWS_TO")+" "+this._oBundle.getText("INBOX_NUMBER_TEN")}).addStyleClass("sapUiExtInboxSegmentedButtonTransparent"),new sap.ui.commons.Button({id:t.getId()+'--'+'20RowsSegBtn',lite:true,text:'20',tooltip:this._oBundle.getText("INBOX_SET_NUMBER_OF_ROWS_TO")+" "+this._oBundle.getText("INBOX_NUMBER_TWENTY")}).addStyleClass("sapUiExtInboxSegmentedButtonTransparent")]});s.attachSelect(function(e){var c=parseInt(sap.ui.getCore().byId(e.getParameters().selectedButtonId).getText());var d=this.getButtons();for(var i=0;i<d.length;i++){d[i].removeStyleClass("sapUiExtInboxSegmentedButtonTransparentSelected");}sap.ui.getCore().byId(e.getParameters().selectedButtonId).addStyleClass("sapUiExtInboxSegmentedButtonTransparentSelected");T.setNumberOfRows(c);if(T.getBinding('rows')){var f=T.getBinding('rows').iLength;t._updatePaginator(f);}});if(t.rrViewRowCountValue!=null&&t.rrViewRowCountValue!=undefined){if(parseInt(t.rrViewRowCountValue)===5||parseInt(t.rrViewRowCountValue)===10||parseInt(t.rrViewRowCountValue)===20){s.fireSelect({selectedButtonId:t.getId()+'--'+parseInt(t.rrViewRowCountValue)+'RowsSegBtn'});s.setSelectedButton(t.getId()+'--'+parseInt(t.rrViewRowCountValue)+'RowsSegBtn');sap.ui.getCore().byId(s.getSelectedButton()).addStyleClass("sapUiExtInboxSegmentedButtonTransparentSelected");}else{T.setNumberOfRows(parseInt(t.rrViewRowCountValue));if(T.getBinding('rows')){var n=T.getBinding('rows').iLength;t._updatePaginator(n);}}}else{s.setSelectedButton(t.getId()+'--'+'5RowsSegBtn');sap.ui.getCore().byId(s.getSelectedButton()).addStyleClass("sapUiExtInboxSegmentedButtonTransparentSelected");}var a=new sap.ui.commons.layout.MatrixLayoutCell(t.getId()+'--'+"separatorRRViewCell");var b=new sap.ui.commons.TextView({id:t.getId()+'--'+'separator',text:"|"});a.addContent(b);a.setPadding(sap.ui.commons.layout.Padding.None);var B=new sap.ui.commons.layout.BorderLayout(t.getId()+'--'+'borderLayout',{width:"100%",height:"40px"});B.createArea(sap.ui.commons.layout.BorderLayoutAreaTypes.center,p);B.setAreaData(sap.ui.commons.layout.BorderLayoutAreaTypes.center,{size:"55%",contentAlign:"right",visible:true});B.createArea(sap.ui.commons.layout.BorderLayoutAreaTypes.end,s);B.setAreaData(sap.ui.commons.layout.BorderLayoutAreaTypes.end,{size:"45%",contentAlign:"right",visible:true});r.createRow(new sap.ui.commons.TextView({text:' '}));r.createRow(B);return r;};
sap.uiext.inbox.Inbox.prototype._createCustomAttributesLayoutForRRView=function(c,C,r){var t=this;var m=this.getCoreModel();var a=1;var n=c.length;var o=new sap.ui.commons.layout.MatrixLayout({layoutFixed:true,width:"100%"});var b=new sap.ui.commons.layout.MatrixLayout();var l,T,B,d={size:"33.33%",overflowX:'hidden',overflowY:'hidden',contentAlign:"left",visible:true};jQuery.each(c,function(i,f){if(C[f.Name]){var L=t.getId()+'--'+'customattr'+'-label-'+'-row-'+r+'-index-'+(a-1);var s=t.getId()+'--'+'customattr'+'-value-'+'-row-'+r+'-index-'+(a-1);l=t.oCore.byId(L)||new sap.ui.commons.Label({id:L,text:f.Label}).data("customAttrName",f.Name);T=t.oCore.byId(s)||new sap.ui.commons.TextView({id:s}).data("customAttrName",f.Name);T.setText(C[f.Name]);l.setLabelFor(T);var g=t._createLabelValueMatrixLayout(l,T);var p=a%3;var A=(p===1)?sap.ui.commons.layout.BorderLayoutAreaTypes.begin:((p===2)?sap.ui.commons.layout.BorderLayoutAreaTypes.center:sap.ui.commons.layout.BorderLayoutAreaTypes.end);B=(p===1)?new sap.ui.commons.layout.BorderLayout({width:"100%",height:"18px"}):B;B.createArea(A,g);B.setAreaData(A,d);if(p===2&&a===n){B.createArea(sap.ui.commons.layout.BorderLayoutAreaTypes.end,new sap.ui.commons.TextView({text:' '}));B.setAreaData(sap.ui.commons.layout.BorderLayoutAreaTypes.end,d);}if(p===0||a===n){var h=new sap.ui.commons.layout.MatrixLayoutCell();h.addStyleClass("sapUiExtInboxPaddingBottom");h.addContent(B);b.createRow(h);}a++;}});var e=new sap.ui.commons.layout.MatrixLayoutCell().addContent(b).addStyleClass('sapUIExtInboxCustomAttributesBorder');o.createRow(e);return o;};
sap.uiext.inbox.Inbox.prototype._currentViewElement=function(){var t=sap.ui.getCore().byId(this.getId()+'--'+'listViewTable');var r=sap.ui.getCore().byId(this.getId()+'--'+'tasksRowRepeater');var b,c;if(this.currentView===sap.uiext.inbox.InboxConstants.tableView){c=t;}else if(this.currentView===sap.uiext.inbox.InboxConstants.rowRepeaterView){c=r;}return c;};
sap.uiext.inbox.Inbox.prototype._updatePaginator=function(l){var p=this._getComponent('rowRepeaterPaginator'),s=this._getComponent('rowRepeaterRowSettingsSegBtn'),t=this._getComponent('tasksRowRepeater');if(!p){var p=new sap.ui.commons.Paginator(this.getId()+'--'+"rowRepeaterPaginator");p.attachPage(this,function(e,i){i._handleRowRepeaterPaginatorClick(e);});var b=this._getComponent('borderLayout');if(b){var r=b.getCenter();if(r){r.addContent(p);}}}if(this.rrViewRowCountValue!=null&&this.rrViewRowCountValue!=undefined){p.setNumberOfPages(Math.ceil(l/parseInt(this.rrViewRowCountValue)));}else{var a=sap.ui.getCore().byId(s.getSelectedButton()).getText();p.setNumberOfPages(Math.ceil(l/a));}p.setCurrentPage(1);t.gotoPage(1);};
sap.uiext.inbox.Inbox.prototype._createLabelValueMatrixLayout=function(l,v){l.addStyleClass("sapUiExtInboxCustomAttLabel").setWrapping(false);v.addStyleClass("sapUiExtInboxCustomAttValue").setWrapping(false);var m=new sap.ui.commons.layout.MatrixLayoutCell({hAlign:sap.ui.commons.layout.HAlign.Right,vAlign:sap.ui.commons.layout.VAlign.Top,padding:sap.ui.commons.layout.Padding.End,content:[l]});var M=new sap.ui.commons.layout.MatrixLayoutCell({hAlign:sap.ui.commons.layout.HAlign.Left,vAlign:sap.ui.commons.layout.VAlign.Top,padding:sap.ui.commons.layout.Padding.Begin,content:[v]});return new sap.ui.commons.layout.MatrixLayout().createRow(m,M);};
sap.uiext.inbox.Inbox.prototype._getCustomActionsDefinition=function(i,s,a,c,S){var t=this;var C=sap.uiext.inbox.InboxConstants.taskInstanceDecisionOptionsMap;var b=C[i];if(b===undefined&&i){var u={InstanceID:"'"+decodeURIComponent(i)+"'",SAP__Origin:"'"+s+"'",$format:"json"};var f=function(d,r){t.selectedContexts=S;b=C[i]=d.results;if(c){c(b);}else{t._displayCustomActions(b,a);}};var e=function(E){t.showMessage("error",t._oBundle.getText("INBOX_MSG_FETCH_CUSTOM_ACTION_FAILS"));};this.oDataManager.readData(t.constants.decisionOptionsFunctionImport,{urlParameters:u,success:f,error:e});}else{if(c){c(b);}else{t._displayCustomActions(b,a);}}};
sap.uiext.inbox.Inbox.prototype._fetchCustomActionsUsingAsyncCall=function(I,s,a,S){var t=this;var T=I.length+a.length;var c=[];var C=sap.uiext.inbox.InboxConstants.taskInstanceDecisionOptionsMap;jQuery.each(I,function(i,b){var u={InstanceID:"'"+decodeURIComponent(b)+"'",SAP__Origin:"'"+s+"'",$format:"json"};var f=function(d,r){t.selectedContexts=S;c=C[b]=d.results;a.push(c);if(a.length==T){t._displayCustomActions(c,a);}};var e=function(E){t.showMessage("error",t._oBundle.getText("INBOX_MSG_FETCH_CUSTOM_ACTION_FAILS"));};t.oDataManager.readData(t.constants.decisionOptionsFunctionImport,{urlParameters:u,success:f,error:e});});};
sap.uiext.inbox.Inbox.prototype._displayCustomActions=function(c,a){this._deleteCustomActionsForTableView();if(c&&c.length>0){a.push(c);}function b(l){if(l.length==0)return[];else if(l.length==1)return l[0];var I=l[0];for(var i=1;i<l.length;i++){I=d(I,l[i]);}return I;}function d(A,e){var r=[];var i,j;var f=A.length;var g=e.length;for(i=0;i<f;i++){for(j=0;j<g;j++){if(A[i].DecisionKey===e[j].DecisionKey){r.push(A[i]);}}}return r;}var C=b(a);if(C&&C.length>0)this._createCustomActionsForTableView(C,true);};
sap.uiext.inbox.Inbox.prototype._executeCustomAction=function(s,c){var d=s.data("key");var a=s.getText();var b=this;var v=this.currentView;var l,r,m;var e=[],f=[],g=[];var h=[];var k,n;var o=[];var p,q,t;b.resetSearchCriteria();var m=b.getCoreModel();if(v===b.constants.tableView){l=b._getComponent('listViewTable');var u=b.getlistTableSelectedIndices();jQuery.each(u,function(i,j){r=l.getContextByIndex(j);f.push(r);t=m.getProperty("TaskTitle",r);p=m.getProperty("InstanceID",r);q=m.getProperty("SAP__Origin",r);e.push(p);g.push(q);if(i==0){k=p;n=q;}else{k=k+";"+p;n=n+";"+q;}});}else if(v===b.constants.rowRepeaterView){var C=s.getBindingContext();t=m.getProperty("TaskTitle",r);p=m.getProperty("InstanceID",C);q=m.getProperty("SAP__Origin",C);e.push(p);g.push(q);k=p;n=q;f.push(C);var S=s.getParent().getParent().getParent().getParent().getParent().getParent();}var I,w,x,y,z,T;z=e.length;T=z;if((z>1)&&b.isBatchOperationSupported){var U=[];for(var i=0;i<z;i++){var A={};A.InstanceID="'"+e[i]+"'";A.SAP__Origin="'"+g[i]+"'";A.DecisionKey="'"+d+"'";if(c){A.Comments="'"+jQuery.sap.encodeURL(c)+"'";}U.push(A);}var B=function(F,G){var H=F.__batchResponses;var t=F.TaskTitle;var i,j,J,K;var N=0,L=0,M=[],O=[];for(i=0,K=H.length;i<K;i++){var P=H[i].__changeResponses;if(P){for(j=0,J=P.length;j<J;j++){var Q=P[j];var R=!(Q.statusCode>=200&&Q.statusCode<=202);if(R){N=N+1;}else{L=L+1;if(b.clientUpdate){b.selectedContexts=f;var V=Q.data;if(V.Status==='COMPLETED'){if(S){M.push({orow:S,context:f[i]});}else{M.push(f[i]);}}}}}}}if(b.clientUpdate){b._refreshLocal(M);}if(b.clientUpdate===undefined){b.applyFilterOnResponse(f);}if(N>0){if(N===1){b.showMessage("error",b._oBundle.getText("INBOX_MSG_ACTION_FAILED",[a,t]));}else{b.showMessage("error",b._oBundle.getText("INBOX_MSG_ACTION_FAILED_MULTIPLE_TASKS",[a,N]));}}else{if(L>1){b.showMessage("success",b._oBundle.getText("INBOX_MSG_ACTION_SUCCESS_MULTIPLE_TASKS",[a,L]));}else{b.showMessage("success",b._oBundle.getText("INBOX_MSG_ACTION_SUCCESS",[a,t]));}}};var E=function(j){b._handleErrorOnBatchRequests(j,a,T);};this.oDataManager.fireBatchRequest({sPath:b.constants.decisionExecutionFunctionImport,sMethod:"POST",sBatchGroupId:"customActionBatch",aUrlParameters:U,numberOfRequests:z,fnSuccess:B,fnError:E});}else{var D={};D.InstanceID=decodeURIComponent(k);D.SAP__Origin=n;D.DecisionKey=d;if(c)D.Comments=c;var B=function(j,F){if(b.clientUpdate&&j.Status==='COMPLETED'){b.selectedContexts=f;if(S)b._refreshLocal([{orow:S,context:f[0]}]);else b._refreshLocal([f]);}if(b.clientUpdate===undefined)b.applyFilterOnResponse(f);b.showMessage("success",b._oBundle.getText("INBOX_MSG_ACTION_SUCCESS",[a,j.TaskTitle]));};var E=function(j){b._handleErrorOnActionFailed(j,a,m.getProperty("TaskTitle",f[0]));};b.oDataManager.callFunctionImport(b.constants.decisionExecutionFunctionImport,{method:"POST",success:B,error:E,urlParameters:D,},true);}b.resetMessages=false;};
sap.uiext.inbox.Inbox.prototype._deleteCustomActions=function(c){if(this.currentView===this.constants.tableView){this._deleteCustomActionsForTableView();}else if(this.currentView===this.constants.rowRepeaterView){this._deleteCustomActionsForRowRepeaterView();}};
sap.uiext.inbox.Inbox.prototype._createCustomActionButtons=function(c,e){if(this.currentView===this.constants.tableView){this._createCustomActionsForTableView(c,e);}};
sap.uiext.inbox.Inbox.prototype._deleteCustomActionsForTableView=function(c){var t=this;var a=this._getActionButtonToolBarForTableView();var T=a.getItems();for(var i=0;i<T.length;i++){var o=T[i];if(o instanceof sap.ui.commons.Button&&o.data("type")===t.constants.customAction){a.removeItem(o);o.destroy();}if(o instanceof sap.ui.commons.ToolbarSeparator&&o.data("separatorFor")===t.constants.customAction){a.removeItem(o);o.destroy();}}};
sap.uiext.inbox.Inbox.prototype._createCustomActionsForTableView=function(c,e){var t=this;var a=this._getActionButtonToolBarForTableView();var n=c.length;var b=3;if(n>0){var s=new sap.ui.commons.ToolbarSeparator();s.data("separatorFor",t.constants.customAction);a.insertItem(s,b);b++;}for(var i=0;i<n;i++){var d=c[i];var D=!d.DecisionText?d.DecisionKey:d.DecisionText;var f=new sap.ui.commons.Button(this.getId()+'--'+d.DecisionKey+'button',{text:D,enabled:e,tooltip:d.Description}).data("type",t.constants.customAction).data("key",d.DecisionKey).data("text",d.DecisionText).data("commentsMandatory",d.CommentMandatory);f.attachPress({inbox:t,view:t.constants.tableView},jQuery.proxy(t._handleCustomActionClick,this));a.insertItem(f,b);b++;}};
sap.uiext.inbox.Inbox.prototype._deleteCustomActionsForRowRepeaterView=function(c){var t=this;var r=this._getComponent('rrMainMatrixLayout');var R=this._getComponent('taskActionMatrixLayout');var a=R.getRows()[0];var b=a.getCells();for(var i=0;i<b.length;i++){var A=b[i];var o=A.getContent()[0];if(o instanceof sap.ui.commons.Link&&o.data("type")===t.constants.customAction||o instanceof sap.ui.commons.Label&&o.data("separatorFor")===t.constants.customAction){a.removeCell(A);A.destroy();o.destroy();}}};
sap.uiext.inbox.Inbox.prototype._getActionButtonToolBarForTableView=function(){return this._getComponent("actionButtonsToolbarContainer");};
sap.uiext.inbox.Inbox.prototype._modifyListBindingForExpand=function(a,p){var c=this.constants;var b,l;if(this.currentView===this.constants.tableView){b=sap.ui.getCore().byId(this.getId()+'--'+'listViewTable');if(b!==undefined){l=b.getBinding('rows');}}else if(this.currentView===this.constants.rowRepeaterView){b=sap.ui.getCore().byId(this.getId()+'--'+'tasksRowRepeater');if(b!==undefined){l=b.getBinding('rows');}}var P=l.mParameters;if(!P){l.mParameters={expand:""};}var e=l.mParameters.expand;if(!e){e=l.mParameters.expand="";}if(a){if(e){if(e.indexOf(c.customAttributeNavigationParam)===-1){if(e.length>0){e=e+",";}e=e+p;}}else{e=p;}}else{if(e&&e.length>0){var i=e.indexOf(p);if(i>=0){e=e.charAt(i-1)===","?e.replace(","+p,''):e.replace(p,'');}}}if(e.length>0){l.mParameters.expand=e;}else{delete l.mParameters.expand;}function g(P){var C=[],s={expand:true,select:true};for(var n in P){if(n in s){C.push("$"+n+"="+jQuery.sap.encodeURL(P[n]));}}return C.join("&");}l.sCustomParams=g(l.mParameters);};
sap.uiext.inbox.Inbox.prototype.populateRefreshButtonContainer=function(r){var t=this;var a=new sap.ui.commons.layout.MatrixLayoutCell({id:this.getId()+'--'+"refreshButtonCell"});var b=new sap.ui.commons.Button(this.getId()+'--'+"refreshButton",{tooltip:this._oBundle.getText("INBOX_REFRESH_BUTTON_TOOLTIP")});b.setIcon(sap.uiext.inbox.InboxConstants.refreshImage);b.attachPress(t,t.refreshTaskList);b.addStyleClass("sapUiExtInboxRefreshButtonHeight");a.addContent(b);a.setPadding(sap.ui.commons.layout.Padding.None);var c=new sap.ui.commons.layout.MatrixLayoutCell({id:this.getId()+'--'+"refreshedOnTextCell",vAlign:sap.ui.commons.layout.VAlign.Bottom,padding:sap.ui.commons.layout.Padding.Top});var d=new sap.ui.commons.Label(this.getId()+'--'+"refreshOnText");t.lastRefreshedOnDateTime=new Date();var e=t._getFormattedRefreshOnDateTime();d.setText(t._oBundle.getText("INBOX_TEXT_ON")+sap.uiext.inbox.InboxConstants.SPACE+e);d.setTooltip(t._getFormattedTooltipForLastRefreshedTime());d.addStyleClass("sapUiExtInboxRefreshedOnStyle");c.addContent(d);r.createRow(a,new sap.ui.commons.Label({text:sap.uiext.inbox.InboxConstants.SPACE}),c);};
sap.uiext.inbox.Inbox.prototype._getFormattedRefreshOnDateTime=function(){var d=sap.ui.core.format.DateFormat.getDateTimeInstance({style:"medium"});return d.format(this.lastRefreshedOnDateTime);};
sap.uiext.inbox.Inbox.prototype._getFormattedTooltipForLastRefreshedTime=function(){var t=sap.ui.core.format.DateFormat.getDateTimeInstance({style:"medium"});return t.format(this.lastRefreshedOnDateTime);};
sap.uiext.inbox.Inbox.prototype._createRRSettingsButton=function(){var t=this;var s=sap.ui.getCore().byId(this.getId()+'--'+'rrSettingsButton');if(!s){s=new sap.ui.commons.Button(t.getId()+'--'+"rrSettingsButton",{tooltip:t._oBundle.getText("INBOX_MANAGE_SUBSTITUTION_RULES_TOOLTIP"),icon:this.constants.iconPool.getIconURI("workflow-tasks"),iconHovered:this._imgResourcePath+sap.uiext.inbox.InboxConstants.settingsImageHover,iconSelected:this._imgResourcePath+sap.uiext.inbox.InboxConstants.settingsImageHover,lite:true});s.addStyleClass("sapUiExtInboxSettingsButton");s.attachPress(t,t.onSubstitutionButtonPress);}return s;};
sap.uiext.inbox.Inbox.prototype._executeForwardAction=function(e,p){var l=e.getSource();var a=p.inbox;var d=a.getId()+'--';var f=sap.ui.getCore().byId(d+"forwardTasksPopUp");var t=sap.ui.getCore().byId(d+"userTable");if(f===undefined){var L=new sap.ui.commons.layout.MatrixLayout({id:d+'dLayout',layoutFixed:true,width:'100%'});var s=new sap.ui.commons.SearchField({id:d+'oSearch',enableListSuggest:false,startSuggestion:0,tooltip:a._oBundle.getText("SUBSTIUTION_RULE_SEARCH_FOR_USERS"),editable:true,width:'100%'});s.addDelegate({onAfterRendering:function(){var T=sap.ui.getCore().byId(d+'oSearch-tf');T.prop('placeholder',a._oBundle.getText("INBOX_SEARCH_FOR_A_COLLEAGUE"));}});s.attachSearch(a,function(e,g){e.oParentSource=l;t.setBusy(true);g._handleSearchUsersClickforForward(e);});s.attachSuggest(a,function(e,g){if(e.getParameter("value")===""){t.clearSelection();t.bindRows("");}});L.createRow(s);var u={collection:"UserInfoCollection",propertiesLabel:[a._oBundle.getText("SUBSTITUTION_USERS_PICKLIST_LOGONID"),a._oBundle.getText("SUBSTITUTION_USERS_PICKLIST_NAME")],properties:["UniqueName","DisplayName"]};if(t===undefined){t=new sap.ui.table.Table(d+"userTable",{selectionMode:sap.ui.table.SelectionMode.Single});}t.setVisibleRowCount(5);t.attachRowSelectionChange(function(){if(t.getSelectedIndices().length!==0){sap.ui.getCore().byId(d+"forwardTasksPopUpFrwBtn").setEnabled(true);}else{sap.ui.getCore().byId(d+"forwardTasksPopUpFrwBtn").setEnabled(false);}});t.bDynamic=true;for(var i=0;i<=u.properties.length-1;i++){t.addColumn(new sap.ui.table.Column().setLabel(new sap.ui.commons.Label({text:u.propertiesLabel[i],design:sap.ui.commons.LabelDesign.Bold})).setTemplate(new sap.ui.commons.TextField({editable:false,value:{path:u.properties[i]}})));}var b=new sap.ui.commons.layout.VerticalLayout(d+"userDialogVLayout",{width:"100%"});b.insertContent(L,0);b.insertContent(t,1);var c;f=new sap.ui.commons.Dialog(d+"forwardTasksPopUp",{modal:true,title:a._oBundle.getText("INBOX_FORWARD_SELECTED_TASKS"),content:[b],buttons:[new sap.ui.commons.Button(d+"forwardTasksPopUpFrwBtn",{enabled:false,text:a._oBundle.getText("INBOX_ACTION_BUTTON_FORWARD"),tooltip:a._oBundle.getText("INBOX_ACTION_BUTTON_FORWARD_TOOLTIP"),press:function(g){var h=sap.ui.getCore().byId(d+"userTable");var j=h.getSelectedIndex();var r=h.getContextByIndex(j);var k=sap.ui.getCore().byId(d+'userTable').getModel();var m=k.getProperty("DisplayName",r);if(m===null)m="";c=k.getProperty("UniqueName",r);var n=new sap.ui.base.Event();n.oSource=l;n.mParameters={};a.executeActionOnTask(n,{inbox:a,view:p.view,action:"Forward",forwardTo:jQuery.sap.encodeURL(c),source:l});f.close();}})]});}f.setWidth("500px");f.open();f.attachClosed(a,function(e,a){f.destroy();});f.setInitialFocus(s);};
sap.uiext.inbox.Inbox.prototype._getExpandParameters=function(){return this.oController.getExpandParameters();};
sap.uiext.inbox.Inbox.prototype._getFilterArray=function(){var f=[];for(var i in this.filtersToApply){var a=this.filtersToApply[i];if(jQuery.isArray(a)){f=f.concat(a)}else f.push(a);}return f;};
sap.uiext.inbox.Inbox.prototype._getSelectedItemfromKey=function(t,s){var i=t.getItems();var k=s;var a;for(var j=0;j<i.length;j++){if(k===i[j].getKey()){return i[j];}}};
sap.uiext.inbox.Inbox.prototype._resetFlags=function(){this.isSubstitutionEnabled=false;this.isCustomAttributesEnabled=false;this.isCustomActionsEnabled=false;this.showTaskDescription=false;this.showTaskCategory=false;};
sap.uiext.inbox.Inbox.prototype._createForwardActionLinkCell=function(){var t=this;var f=new sap.ui.commons.layout.MatrixLayoutCell({id:t.getId()+'--'+'forwardActionCell',hAlign:sap.ui.commons.layout.HAlign.Left,vAlign:sap.ui.commons.layout.VAlign.Bottom,colSpan:1});var a=new sap.ui.commons.Link(t.getId()+'--'+"rrViewForwardAction",{visible:false,enabled:false,tooltip:t._oBundle.getText("INBOX_ACTION_BUTTON_FORWARD")});a.addStyleClass("sapUiExtInboxLnkNoUnderline");a.setText(t._oBundle.getText("INBOX_ACTION_BUTTON_FORWARD"));a.attachPress({inbox:t,view:t.constants.rowRepeaterView},t._executeForwardAction);f.addContent(a);return f;};
sap.uiext.inbox.Inbox.prototype._setInboxFiltersVisibility=function(v){if(v===false||v===true){sap.ui.getCore().byId(this.getId()+'--'+"filterViewButton").setVisible(v);sap.ui.getCore().byId(this.getId()+'--'+"filterComboBox1").setVisible(v);sap.ui.getCore().byId(this.getId()+'--'+"filterComboBox2").setVisible(v);sap.ui.getCore().byId(this.getId()+'--'+"filterComboBox3").setVisible(v);}};
sap.uiext.inbox.Inbox.prototype._setInboxViewSelectionVisibility=function(v){if(v===false||v===true){sap.ui.getCore().byId(this.getId()+'--'+"tableViewImage").setVisible(v);sap.ui.getCore().byId(this.getId()+'--'+"rrViewImage").setVisible(v);}};
sap.uiext.inbox.Inbox.prototype.resizeColumns=function(){var t=this;var w=0;var T=sap.ui.getCore().byId(t.getId()+'--'+'listViewTable');var c=T.getColumns();var a="";jQuery.each(c,function(i,b){if(t.absId(b.getId())==="TaskTitle"){a=b;return false;}});if(a&&(a.getVisible()===true)&&((c.length)&&(100/c.length<25))){a.setWidth("20%");w=100/(c.length-1);jQuery.each(c,function(i,b){if(t.absId(b.getId())!=="TaskTitle"){b.setWidth(w+"%");}});}};
sap.uiext.inbox.Inbox.prototype._isCompletedTasksSelected=function(){var d=this._getComponent('filterComboBox2');var i=false;if(d.getSelectedItemId()===this.getId()+'--'+'li_completedTasks'){i=true;}return i;};
sap.uiext.inbox.Inbox.prototype._isDrillDownFilterSelected=function(f){var F=false;var c=this._currentViewElement();var a=c.getBinding('rows');if(a&&a.sFilterParams&&a.sFilterParams.indexOf(f)!==-1)F=true;return F;};
sap.uiext.inbox.Inbox.prototype._getDefaultSort=function(){if(!this._defaultSort){this._defaultSort=new sap.ui.model.Sorter("CreatedOn",true);}return this._defaultSort;};
sap.uiext.inbox.Inbox.prototype._clearCustomAttributeSort=function(){var t=this._getComponent('listViewTable');var b=t.getBinding("rows");if(b.sSortParams.indexOf(this.constants.customAttributeNavigationParam)!==-1){b.createSortParams(b.aSorters);}};
sap.uiext.inbox.Inbox.prototype._updateViewElementsOnRequestCompleted=function(l){if(this.currentView===this.constants.tableView){this._updateTableOnRequestCompleted();}else if(this.currentView===this.constants.rowRepeaterView){this._updateRowRepeaterOnRequestCompleted(l);}};
sap.uiext.inbox.Inbox.prototype._updateTableOnRequestCompleted=function(){if(this.clientUpdate&&this.currentView===this.constants.tableView){this._currentViewElement().clearSelection();}var r,s=[];var S={aSupportsClaim:[],aSupportsRelease:[],aSupportsForward:[]};var c=this._currentViewElement();var a=this.selectedContexts;var I=this._getTableIndicesByContext(a,c);var m=c.getModel();var t=this;jQuery.each(I,function(i,b){r=c.getContextByIndex(b);s.push(m.getProperty("Status",r));S.aSupportsClaim.push(m.getProperty("SupportsClaim",r));S.aSupportsRelease.push(m.getProperty("SupportsRelease",r));if(t.isForwardActionEnabled){S.aSupportsForward.push(m.getProperty("SupportsForward",r));}});this.inboxUtils.reselectRowsinTable(I,c);this.disableActionButtonsOnMultiStatus(s,S);};
sap.uiext.inbox.Inbox.prototype._updateRowRepeaterOnRequestCompleted=function(l){this._updatePaginator(l);};
sap.uiext.inbox.Inbox.prototype._getTableIndicesByContext=function(c,t){var I=[];var b=t.getBinding('rows');var B=b.getContexts(0,b.iLength);var m=t.getModel();var a=-1;jQuery.each(c,function(i,C){jQuery.each(B,function(j,o){if(C.sPath===o.sPath){a=j;return false;}});if(a>-1){I.push(a);}});return I;};
sap.uiext.inbox.Inbox.prototype._isTaskDefinitionFilterApplied=function(){var c=this._currentViewElement();var C=c.getBinding('rows');if(this.clientUpdate){var f=false;var F=C.aFilters.concat(C.aApplicationFilters);if(F&&F.length>0){jQuery.each(F,function(j,o){if(o.sPath==='TaskDefinitionID'){f=true;return false;}});}return f;}return(C.sFilterParams.indexOf('TaskDefinitionID')!==-1);};
sap.uiext.inbox.Inbox.prototype._handleRequestSent=function(e){if(this.bRefreshStartFlag){this.bRefreshStartFlag=false;var r=this._getComponent('refreshButton');r.setIcon(sap.uiext.inbox.InboxConstants.refreshImage);}};
sap.uiext.inbox.Inbox.prototype._handleRequestCompleted=function(e){var l=0;var p=e.getParameters();if(p.url.indexOf(this.constants.UserInfoCollection)!==-1){return;}else if(!p.success){if(this.currentView===this.constants.tableView){this._getComponent('listViewTable').getModel().updateBindings();}if(p.errorobject===undefined||(p.errorobject!==undefined&&p.errorobject.statusCode===401)){window.location.reload(true);}}else if(p.success){var t=this._getComponent("INBOX_FILTER_TASK_TYPE");var i=t?this._isInitialFilterAppliedforTaskType():false;if((i||!this._isTaskDefinitionFilterApplied())&&this.bRefreshTaskTypes){this.refreshTaskTypes();}if(i){if(this._setInitialFilterKeysforTaskType(t)){if(t&&t.getSelectedKeys()!==["sapUiFacetFilter_ALL"]){if(t.getSelectedKeys().length===1){var e=new sap.ui.base.Event();var s=t.getItems();e.mParameters={all:false,selectedItems:s};this.applyDrillDownFilterForTaskType(e,this);}}}}if(this.bSorted){var c=this._currentViewElement();c._originalKeys=c.getBinding('rows').aKeys;this.bSorted=false;}this.bRefreshTaskTypes=true;l=this._getCurrentViewElementBindingLength();var c=this._currentViewElement();var r=c.bRowsRebinded;if(r===null||r===undefined||!c.bRowsRebinded){this._displayMessageOnRequestCompleted(l);}else{c.bRowsRebinded=false;}}this.hideBusyLoader();this._updateViewElementsOnRequestCompleted(l);var R=this._getComponent('refreshButton');R.setIcon(this.constants.refreshImage);var d=e.getParameters();d.bindingLength=l;d.appliedFilter=this._getComponent('filterComboBox2').getValue();;this.fireODataRequestCompleted(d);this._applySearch();if(this.currentView===this.constants.tableView&&this._isTableFiltered())this._preserveTableFilters();if(this.currentView===this.constants.tableView){this._preserveTableSort();}};
sap.uiext.inbox.Inbox.prototype._applySearch=function(){var s=this._getComponent('searchField');var S=s.getValue();if(S!==""&&S!==null){s.fireSearch({query:S});}};
sap.uiext.inbox.Inbox.prototype._displayMessageOnRequestCompleted=function(l){if(l<=0){this.showMessage("info",this._oBundle.getText("INBOX_MSG_FOR_NO_DATA"));}else{if(this.resetMessages===true){this.deleteMessage();}else{this.resetMessages=true;}}};
sap.uiext.inbox.Inbox.prototype._getCurrentViewElementBindingLength=function(){var c=this._currentViewElement();var C=c.getBinding('rows');return C.iLength;};
sap.uiext.inbox.Inbox.prototype._selectParentRowforElement=function(i){var I=-1;var $=jQuery.sap.byId(i);var a=$.closest(".sapUiTableCtrl>tbody>tr");if(a.length===1){I=parseInt(a.attr("data-sap-ui-rowindex"),10);}var t=this._getComponent('listViewTable');t.setSelectedIndex(I);};
sap.uiext.inbox.Inbox.prototype._handleTaskTitleLinkPress=function(e){this.showBusyLoader();var t=this;this._selectParentRowforElement(e.getSource().getId());var c=e.getSource().getBindingContext();var m=this.getCoreModel();var T=[],a=[],b=[],d=[];a.push(m.getProperty("InstanceID",c));b.push(m.getProperty("TaskTitle",c));d.push(m.getProperty("SAP__Origin",c));if(this.getTaskExecutionURLCallBack!=""&&this.getTaskExecutionURLCallBack!=undefined&&this.getTaskExecutionURLCallBack!==null){var f=this.getTaskExecutionURLCallBack(a[0],d[0]);if(f!==null&&f.replace(/\s/g,"").length>0){T.push(f);}}else{T.push("");}var g=e.getParameter("windowEvent");if(!g.ctrlKey&&!(g.button==1)&&!g.shiftKey&&!this.bOpenTaskUIInNewTab){this.populateTaskExecutionContent({aSelectedContexts:[c],arrayURLs:T,arrayIDs:a,arrayTitles:b,aTaskSAPOrigins:d});this.hideBusyLoader();}else{this.hideBusyLoader();var w=T[0];if(w!==null&&w.replace(/\s/g,"").length>0){var h=window.open(w);if(h){h.focus();}e.preventDefault();}}};
sap.uiext.inbox.Inbox.prototype._initFlagsByModel=function(){if(this.oModel instanceof sap.ui.model.json.JSONModel){this.typeOfModel="JSON";this.setHandleBindings(false);this._resetFlags();}else if(this.oModel instanceof sap.ui.model.odata.ODataModel||this.oModel instanceof sap.ui.model.odata.v2.ODataModel){this.typeOfModel="OData";this.attachTaskAction(this,this.defaultActionHandler);this.setHandleBindings(true);}else if(this.oModel instanceof sap.ui.model.xml.XMLModel){this.typeOfModel="xml";this.setHandleBindings(false);this._resetFlags();}};
sap.uiext.inbox.Inbox.prototype._handleRequestFailed=function(e){var E=e.mParameters;if((E.message!=="Request aborted")&&E.statusCode!==undefined){this.showMessage("error",this._oBundle.getText("INBOX_MSG_NO_ODATA_SRVC"));}this.hideBusyLoader();};
sap.uiext.inbox.Inbox.prototype._applySortOnView=function(s){var e=this.constants.mEntitiesToElements.taskMetadata;if(this.currentView===this.constants.tableView){this._applySortOnTableView(s,e);}else if(this.currentView===this.constants.rowRepeaterView){this._applySortOnRowRepeaterView(s,e);}};
sap.uiext.inbox.Inbox.prototype._applySortOnTableView=function(s,e){var c=e.sap_inbox_list.columnsMap;var L=this._getComponent('listViewTable');var C=L.getColumns();for(var i=0,l=C.length;i<l;i++){C[i].setSorted(false);}if(s){var o,a;var p=s.sPath;if(p.indexOf(this.constants.customAttributeNavigationParam)!==-1){a=p.replace(this.constants.customAttributeNavigationParam,"");a=a.replace(/^\//,"");}else{var a=c[p];}var o=a?this._getComponent(a):undefined;if(o){var b=s.bDescending?sap.ui.table.SortOrder.Descending:sap.ui.table.SortOrder.Ascending;o.setSortOrder(b);o.setSorted(true);}}};
sap.uiext.inbox.Inbox.prototype._applySortOnRowRepeaterView=function(s,e){var S=e.sap_inbox_stream.sorterMap;var r=this._getComponent('sortByFilterComboBox');if(s){var c,C;var p=s.sPath;var a=S[p];if(a){r.setSelectedItemId(this.getId()+'--'+a);this._updateRowRepeaterSortImage(s.bDescending);var a=this.constants.mRRSortMap[a];var R=this._getComponent(a).getSorter();if(R){R.bDescending=s.bDescending;}}else{var E=this._getComponent('li_empty');if(!E)E=new sap.ui.core.ListItem(this.getId()+'--'+"li_empty",{text:this._oBundle.getText("")});r.insertItem(E,0);r.setSelectedItemId(this.getId()+'--'+"li_empty");var b=this._getComponent('sortImage');b.setVisible(false);}}};
sap.uiext.inbox.Inbox.prototype._updateRowRepeaterSortImage=function(d){var s=this._getComponent('sortImage');s.setVisible(true);if(d){s.setIcon(this.constants.sortDescImage);s.setTooltip(this._oBundle.getText("INBOX_SORT_INDICATOR_DESC"));}else{s.setIcon(this.constants.sortAscImage);s.setTooltip(this._oBundle.getText("INBOX_SORT_INDICATOR_ASC"));}};
sap.uiext.inbox.Inbox.prototype._getFirstColumnContentTemplate=function(){var t=this;var f=this._getComponent('firstColumnLayout');f=f||new sap.uiext.inbox.composite.InboxTaskTitleControl({id:t.getId()+'--'+"firstColumnLayout",categoryIconURI:{path:"InstanceID",formatter:function(i){if(i!==null){this.setTooltip(t._oBundle.getText(t.constants.taskCategoryToolTip["TASK"]));return t.constants.taskCategoryImages["TASK"];}}}});f.setTitleLink(this._createTaskLink());f.bindProperty("hasAttachments","HasAttachments",function(v){var h=(v!=null)?v:false;return h;});f.bindProperty("hasComments","HasComments",function(v){var h=(v!=null)?v:false;return h;});return f;};
sap.uiext.inbox.Inbox.prototype._createTaskCategoryImage=function(){var t=this;var c=t._getComponent('taskCategoryImg');if(!c){c=new sap.ui.core.Icon({id:t.getId()+'--'+"taskCategoryImg",decorative:false,size:"15px",enable:false}).addStyleClass("sapUiExtInboxMarginForTableColumnStyle");}if(this.clientUpdate){c.setSrc(t.constants.taskCategoryImages["TASK"]);}else{c.bindProperty("src",t.constants.taskDefinitionNavigationParam,function(a){if(a!=null&&a!==""){var m=t.getCoreModel();var C=this.getBindingContext();var b=a[0];var d=m.oData[b];var e;if(d){e=d.Category;this.setVisible(true);}else{e=a.Category;this.setVisible(true);}e=e.toUpperCase();if(e=="TASK"||e=="NOTIFICATION"||e=="TODO"||e=="ALERT"){this.setTooltip(t._oBundle.getText(t.constants.taskCategoryToolTip[e]));return t.constants.taskCategoryImages[e];}}return t.constants.taskCategoryImage;});}return c;};
sap.uiext.inbox.Inbox.prototype._createTaskLink=function(){var t=this;var T=new sap.uiext.inbox.InboxLink().addStyleClass("sapUiExtInboxTaskTitleLink");T.addDelegate({onAfterRendering:function(){if(!this.getEnabled()){this.addStyleClass('sapUiExtInboxLnkDsbl');}}});var a=t._getCategoryMetadata().properties[0];T.bindProperty("text",a,function(v){if(this.getBindingContext()===undefined)return undefined;else return v;});T.bindProperty("overdue","CompletionDeadLine",function(v){return t._isOverDue(v);});T.bindProperty("tooltip",a);T.bindProperty("enabled","Status",function(v){if(!t.getOpenCompletedTasks()&&v==="COMPLETED"){this.addStyleClass("sapUiExtInboxLnkDsbl");return false;}this.removeStyleClass("sapUiExtInboxLnkDsbl");return true;});T.attachPress(this,function(e,t){t._handleTaskTitleLinkPress(e);});return T;};
sap.uiext.inbox.Inbox.prototype._handleTaskCategoryVisibility=function(){if(!this.showTaskCategory){var t=this._getComponent('taskCategoryImg');if(t){t.setVisible(false);}}};
sap.uiext.inbox.Inbox.prototype._setCommentsVisibility=function(){if(this.isCommentsEnabled){var c=this._getComponent("commentsSegBtn");c.bindProperty("visible","SupportsComments",function(v){if(v!=null&&v!==""){return v;}return false;});c.attachPress(this,function(e,t){t._handleActionButtonToggleinRowRepeater(e);});}};
sap.uiext.inbox.Inbox.prototype._initTableView=function(){var t=this._getComponent("listViewTable");t.setModel(this.oModel);return t;};
sap.uiext.inbox.Inbox.prototype._initRowRepeaterView=function(){var t=this._getComponent('tasksRowRepeater');t.setModel(this.oModel);var r=this._getComponent('rrMainMatrixLayout');return t;};
sap.uiext.inbox.Inbox.prototype._createCustomAttributes=function(a){if(this.isCustomAttributesEnabled){if(a.length===1&&(this.currentView===this.constants.tableView)){if(!(this.oController instanceof sap.uiext.inbox.controller.InboxControllerAsync)){this._modifyListBindingForExpand(true,this.constants.customAttributeNavigationParam);}this._getCustomAttributeMetaData(a[0].getKey(),a[0].data("SAP__Origin"));}else{if(!(this.oController instanceof sap.uiext.inbox.controller.InboxControllerAsync)){this._modifyListBindingForExpand(false,this.constants.customAttributeNavigationParam);}this._deleteCustomAttributeColumns(null);}}};
sap.uiext.inbox.Inbox.prototype._isCustomAttribute=function(c){if(c){if(c.data("ColumnType")=="CustomAttribute"){return true;}}return false;};
sap.uiext.inbox.Inbox.prototype._selectInitialValueinDropDown=function(p){var t=this._getComponent("filterComboBox2");var P=p?p.getFilter():undefined;var T=P?P.key:"li_openTasks";T=this.getId()+'--'+T;if(t.getSelectedItemId()!==T){t.setSelectedItemId(T);var s=sap.ui.getCore().byId(T);t.fireChange({oSource:t,newValue:s.getText(),selectedItem:s});}};
sap.uiext.inbox.Inbox.prototype._addFilterToFilterMetadata=function(f,F){if(jQuery.isArray(f)){F=F.concat(f);}else{F.push(f);}return F;};
sap.uiext.inbox.Inbox.prototype._selectFilterValuesinFacetFilterView=function(s,f,a){var b=s.getFilterUIKeys();var F=sap.ui.getCore().byId(this.getId()+'--'+"filterFacet");var p=sap.ui.getCore().byId(this.getId()+'--'+"INBOX_FILTER_PRIORITY");var c=sap.ui.getCore().byId(this.getId()+'--'+"INBOX_FILTER_STATUS");var d=sap.ui.getCore().byId(this.getId()+'--'+"INBOX_FILTER_CREATION_DATE");var t=sap.ui.getCore().byId(this.getId()+'--'+"INBOX_FILTER_TASK_TYPE");var e=sap.ui.getCore().byId(this.getId()+'--'+"INBOX_FILTER_DUE_DATETIME");var T=[];if(t&&F.indexOfList(t)!==-1&&b.TaskType&&b.TaskType.length>0){t.data("initialFilterKeysToSelect",b.TaskType);if(f.TaskType!==undefined&&f.TaskType.length>0){T.push(f.TaskType);}}else{this.clearFiltersForTaskType();}if(p&&F.indexOfList(p)!==-1&&b.Priority&&b.Priority.length>0){p.setSelectedKeys(b.Priority);if(f.Priority!==undefined&&f.Priority.length>0){T.push(f.Priority);}}else{this.clearFiltersForPriority();}if(c&&F.indexOfList(c)!==-1&&b.Status&&b.Status.length>0){c.setSelectedKeys(b.Status);if(f.Status!==undefined&&f.Status.length>0){if((a.sPath==="Status")&&(a.sOperator==="NE")){a=undefined;delete this.filtersToApply.dropDownFilter;}T.push(f.Status);}}else{this.clearFiltersForStatus();}if(d&&F.indexOfList(d)!==-1&&b.StartDate&&b.StartDate.length>0){d.setSelectedKeys(b.StartDate);if(f.StartDate!==undefined){T.push(f.StartDate);}}else{this.clearFiltersForDateTime();}if(e&&F.indexOfList(e)!==-1&&b.DueDate&&b.DueDate.length>0){e.setSelectedKeys(b.DueDate);if(f.DueDate!==undefined){T.push(f.DueDate);}}else{this.clearFiltersForDueDate();}var g=[];for(var i=0;i<T.length;i++){var o=T[i];g=this._addFilterToFilterMetadata(o,g);}if(a){g=this._addFilterToFilterMetadata(a,g);this.filtersToApply.dropDownFilter=a;}return g;};
sap.uiext.inbox.Inbox.prototype._setInitialFilterKeysforTaskType=function(t){if(t.getItems().length>0&&t.data("initialFilterKeysToSelect")!=null){t.setSelectedKeys(t.data("initialFilterKeysToSelect"));t.data(null);return true;}else{return false;}};
sap.uiext.inbox.Inbox.prototype._isInitialFilterAppliedforTaskType=function(){var t=this._getComponent("INBOX_FILTER_TASK_TYPE");return t?((t.data("initialFilterKeysToSelect")!=null)?true:false):false;};
sap.uiext.inbox.Inbox.prototype._getTaskStatus=function(s,a){if(s||a){var S=this.oTcmMetadata.serviceSupportsFilterOption;if(S&&a){return a;}if(s){var b=sap.uiext.inbox.InboxConstants.statusMap[s];if(b){return this._oBundle.getText(b);}return s;}}return"";};
sap.uiext.inbox.Inbox.prototype._manageVisibilityOfSettingsButton=function(s){if(s!=null){var a=false;if(this.getSubstitutionEnabled()){a=true;}s.setVisible(a);}};
sap.uiext.inbox.Inbox.prototype._handleRowRepeaterPaginatorClick=function(e){var n=e.getParameter("targetPage");var o=e.getParameter("srcPage");var t=this._getComponent('tasksRowRepeater');if(t){t.gotoPage(n);}};
sap.uiext.inbox.Inbox.prototype._getCustomAttributeContentforRowRepeater=function(c,r,s,S,a){var t=this;if(this.currentView==="sap_inbox_stream"){if(c){var s=t.getModel().getProperty("TaskDefinitionID",c.getParent().getBindingContext());var S=t.getModel().getProperty("InstanceID",c.getParent().getBindingContext());var a=t.getModel().getProperty("SAP__Origin",c.getParent().getBindingContext());}var b=t.constants;var C=b.oTaskInstanceCustomAttributeValuesMap;var o=C[S];var d=b.oTaskDefinitionCustomAttributesMap;var e=d[s];if((o&&jQuery.isEmptyObject(o))||(e&&e.length==0)){this._addActionContentinRowRepeater(r,"customAttributes",this._createNoDataLabel(this._oBundle.getText("INBOX_MSG_NO_TASK_DETAILS")));return;}if(!jQuery.isEmptyObject(o)&&e&&e.length>0){t._displayCustomAttributes(s,S,r);}else if(o&&!e){t._getCustomAttributeMetaData(s,a,r,S);}else if(!o&&e){t._getCustomAttributeData(S,a,r,s);}else{if(t.bUseBatch){var p,P;var T=b.TaskDefinitionCollection;var f=b.TaskCollection;p=b.forwardSlash+T.entityName+"("+T.properties.taskDefnID+"='"+s+"',"+b.sapOrigin+"='"+a+"')"+b.forwardSlash+T.navParam.customAttrDefn;P=b.forwardSlash+f.entityName+"("+f.properties.instanceID+"='"+S+"',"+b.sapOrigin+"='"+a+"')"+b.forwardSlash+f.navParam.customAttrValues;var g=jQuery.proxy(function(h,i){this._processCustomAtrributesBatchResponse(h,i,s,S,r);},t);t.oDataManager.fireBatchRequest({aPaths:[p,P],sMethod:"GET",sBatchGroupId:"customAttributesBatch",numberOfRequests:2,fnSuccess:g,fnError:function(h){t.showMessage("error",t._oBundle.getText("INBOX_MSG_FETCH_CUSTOM_ATTRIBUTES_FAILS"));}});}else{t._getCustomAttributeMetaData(s,a,r,S);t._getCustomAttributeData(S,a,r,s);}}}};
sap.uiext.inbox.Inbox.prototype._processCustomAtrributesBatchResponse=function(d,r,D,t,a){var b=d.__batchResponses;var c=[];var C={};var e=b[0].data.results;for(var i=0;i<e.length;i++){var o={};o.Name=e[i].Name;o.Type=e[i].Type;o.Label=e[i].Label;c.push(o);}this.constants.oTaskDefinitionCustomAttributesMap[D]=c;var f=b[1].data.results;for(var i=0;i<f.length;i++){C[f[i].Name]=f[i].Value;}this.constants.oTaskInstanceCustomAttributeValuesMap[t]=C;this._displayCustomAttributes(D,t,a);};
sap.uiext.inbox.Inbox.prototype._getCommentsContentforRowRepeater=function(c,r){var m=this.getModel();var C=c.getParent().getBindingContext();var s=m.getProperty("InstanceID",C);var S=m.getProperty("SAP__Origin",C);var a=m.getProperty("Status",C).toUpperCase();var b=false;if(a==="COMPLETED"){var b=true;}var i=this._getComponent("comments-"+r);if(!i){var i=new sap.uiext.inbox.composite.InboxTaskComments(this.getId()+"--"+"comments-"+r,{showFeeder:!b});i.attachCommentSubmit(this,this.handleCommentAdded);if(this.loggedInUserName){i.setFeederThumbnailSrc(this.inboxUtils.getUserMediaResourceURL(this.bpmSvcUrl,S,this.loggedInUserName));}}i.data("instanceID",s);i.data("SapOrigin",S);i.setShowHeader(false);i.showBusy(true);var o=new sap.ui.commons.layout.MatrixLayout({layoutFixed:true,width:"100%"});var d=new sap.ui.commons.layout.MatrixLayoutCell();d.addContent(i);d.addStyleClass('sapUIExtInboxCommentsBorder');o.createRow(d);this._addActionContentinRowRepeater(r,"comments",o);this._getComments(s,S,r);};
sap.uiext.inbox.Inbox.prototype._handleActionButtonToggleinRowRepeater=function(e){var b=e.getSource(),a=e.getParameters().id;var t='tasksRowRepeater-';var i=a.indexOf(t)+t.length;var r=a.substring(i,a.length);var A=this._removeParentID(a).replace("-"+this.getId()+"--"+t+r,"");if(b.getPressed()){this.inboxUtils.deSelectOtherActionButtonsinStreamView(b);b.setTooltip(this._oBundle.getText(this.constants.mTooltipforActionButtonsinRR.hide[A]));var c,d;if(A==="customAttributesSegBtn"){b.setIcon('');b.setIcon(this.constants.iconPool.getIconURI("collapse"));c=this._getCustomAttributeContentforRowRepeater(b,r);d="customAttributes";}else if(A==="commentsSegBtn"){c=this._getCommentsContentforRowRepeater(b,r);}else if(A==="attachmentsSegBtn"){this._getAttachments(b,r);}this.data("previousSelection",a);}else{if(A==="customAttributesSegBtn"){b.setIcon('');b.setIcon(this.constants.iconPool.getIconURI("expand"));}b.setTooltip(this._oBundle.getText(this.constants.mTooltipforActionButtonsinRR.show[A]));this._removeActionContentinRowRepeater(r);}};
sap.uiext.inbox.Inbox.prototype.handleCommentAdded=function(e,i){var f=e.getSource();var m=i.getCoreModel();var a=decodeURIComponent(this.data("instanceID"));var c=e.getParameter('text');var s=this.data("SapOrigin");var A={};A.InstanceID=a;A.SAP__Origin=s;A.Text=c;i.oDataManager.callFunctionImport(i.constants.addCommentFunctionImport,{method:"POST",urlParameters:A,success:function(d,r){var C=d.CreatedByName;var b=d.CreatedBy;var g=d.SAP__Origin;var h=i.loggedInUserName;C?f.setFeederSender(C):f.setFeederSender("");var n=new sap.uiext.inbox.composite.InboxComment(f.getId()+'-new-'+f.getComments().length,{text:d.Text,timestamp:i.tooltipFormatForDateTime(d.CreatedAt),createdBy:h,sapOrigin:g,sender:C,thumbnailSrc:i.inboxUtils.getUserMediaResourceURL(i.bpmSvcUrl,g,b)});f.addComment(n);i.showMessage("success",i._oBundle.getText("INBOX_MSG_COMMENT_ADD_SUCCESS"));},error:function(b){i.showMessage("error",i._oBundle.getText("INBOX_MSG_COMMENT_ADD_ERROR"));}});};
sap.uiext.inbox.Inbox.prototype._getComments=function(t,s,r){var c=this.constants;var a=this;var T=c.TaskCollection;var u=c.forwardSlash+T.entityName+"("+T.properties.instanceID+"='"+t+"',"+c.sapOrigin+"='"+s+"')"+c.forwardSlash+T.navParam.comments;var R=this.bpmSvcUrl+u;var m=this.getCoreModel(),C=[];var o={async:true,requestUri:R,method:"GET",headers:{Accept:c.acceptHeaderforJSON,"x-csrf-token":m.oHeaders["x-csrf-token"]}};OData.request(o,function(d,b){C=d.results;if(C){a._displayComments(C,r);}},function(e){var i=a._getComponent("comments-"+r);i.showBusy(false);this.showMessage("error",this._oBundle.getText("INBOX_MSG_FETCH_COMMENTS_FAILS"));});};
sap.uiext.inbox.Inbox.prototype._displayComments=function(c,r){var C=new sap.ui.model.json.JSONModel();C.setData(c);var i=this._getComponent("comments-"+r);i.setModel(C);var o=new sap.uiext.inbox.composite.InboxComment({sender:"{CreatedByName}",text:"{Text}",createdBy:"{CreatedBy}",sapOrigin:"{SAP__Origin}"});sap.uiext.inbox.composite.InboxComment.bpmSvcUrl=this.bpmSvcUrl;o.bindProperty("timestamp","CreatedAt",this.tooltipFormatForDateTime);i.showBusy(false);i.setShowHeader(true);i.bindAggregation("comments",{path:"/",template:o});};
sap.uiext.inbox.Inbox.prototype._removeActionContentinRowRepeater=function(r){var t=this.getId()+'--'+'rrMainMatrixLayout'+'-'+this.getId()+'--'+'tasksRowRepeater-';var R=sap.ui.getCore().byId(t+r);if(R){var l=this.getId()+'--'+'lastRowOfRowRepeater-'+r;var L=sap.ui.getCore().byId(l);if(L){var s=this.getId()+'--'+'lastRowCell-'+r;var o=sap.ui.getCore().byId(s);if(o){o.removeAllContent();}R.removeRow(l);}}return R;};
sap.uiext.inbox.Inbox.prototype._addActionContentinRowRepeater=function(r,a,c){var R=this._removeActionContentinRowRepeater(r);if(R){var l=this.getId()+'--'+'lastRowOfRowRepeater-'+r;var L=sap.ui.getCore().byId(l);if(!L){L=new sap.ui.commons.layout.MatrixLayoutRow({id:l});}var s=this.getId()+'--'+'lastRowCell-'+r;var o=sap.ui.getCore().byId(s);if(!o){o=new sap.ui.commons.layout.MatrixLayoutCell({id:s,vAlign:sap.ui.commons.layout.VAlign.Middle,colSpan:2});}o.addStyleClass('sapUIExtInboxLastRowPadding');o.addContent(c);L.addCell(o);R.addRow(L);}};
sap.uiext.inbox.Inbox.prototype._searchText=function(t,s){return t.toLowerCase().indexOf(s.toLowerCase())>=0?true:false;};
sap.uiext.inbox.Inbox.prototype._getValuePresent=function(d,n,N,s){var a,o,b;if(!n){return false;}if(n.__list instanceof Array){o=n.__list[0];}else{o=n.__ref;}b=d[o];if(o){var c=b?b[N]:"";if(c){return this._searchText(c,s);}}return false;};
sap.uiext.inbox.Inbox.prototype._searchUsers=function(s){var t=this;var f=this.oTCMModel.getFunctionImportHandler();var d=t.getId()+'--';var T=sap.ui.getCore().byId(d+"userTable");f.setServiceURL(this.bpmSvcUrl);f.setHeaders({Accept:this.constants.acceptHeaderforJSON,"x-csrf-token":this.oModel.oHeaders["x-csrf-token"]});var S=s.sSearchTerm;var m=s.iMaxResults;var a=s.sSAPOrigin;var r;this.oPendingSearchRequest=f.callSearchUsers({SearchPattern:jQuery.sap.encodeURL(S),MaxResults:m,SAP__Origin:a},function(D,b){r=D;t.displaySearchResults(r,m,T);T.setBusy(false);t.oPendingSearchRequest=undefined;},function(e){T.setBusy(true);if(e.response!==undefined){t.showMessage("error",t._oBundle.getText("INBOX_MSG_NO_USER_FOUND",[S]));T.setBusy(false);}t.oPendingSearchRequest=undefined;});};
sap.uiext.inbox.Inbox.prototype.displaySearchResults=function(r,m,t){if(r){var M=new sap.ui.model.json.JSONModel();M.setData(r);t.clearSelection();t.setModel(M);t.bindRows("/results");if(r.results.length>0){t.setSelectedIndex(0);if(r.results.length===m){this.showMessage("warning",this._oBundle.getText("INBOX_TOP_MAX_USER",[m]));}}else if(r.results.length===0){this.showMessage("error",this._oBundle.getText("INBOX_MSG_FOR_NO_DATA"));}}};
sap.uiext.inbox.Inbox.prototype._handleForwardButtonVisibilityOnRowSelection=function(s,S){var f=this._getComponent('forwardActionButton');var c=this._isCompletedTasksSelected();if(this.isForwardActionEnabled&&!c&&!jQuery.isEmptyObject(S.aSupportsForward)&&jQuery.inArray(false,S.aSupportsForward)===-1){f.setEnabled(true).data("SAP__Origin",s);}else{f.setEnabled(false);}};
sap.uiext.inbox.Inbox.prototype.setConfiguration=function(c){this.oConfiguration=c;};
sap.uiext.inbox.Inbox.prototype._handleSearchUsersClickforForward=function(e){var f=e.oParentSource;var s=f.data("SAP__Origin");if(!s){var c=f.getBindingContext();s=this.getCoreModel().getProperty("SAP__Origin",c);}if(typeof(s)==="object"&&s.length>1){s=s[0];}var m=this.oConfiguration?this.oConfiguration.getSearchUersMaxLimit():100;if(this.oPendingSearchRequest!==undefined){this.oPendingSearchRequest.abort();}return this._searchUsers({sSearchTerm:jQuery.trim(this._getComponent('oSearch').getValue()),iMaxResults:m,sSAPOrigin:s});};
sap.uiext.inbox.Inbox.prototype._bindTaskActionsProperties=function(t,p){t.setVisible(true);t.bindProperty("enabled",p);};
sap.uiext.inbox.Inbox.prototype._bindTaskActions=function(e){var c=this._getComponent('claimActionButton');var r=this._getComponent('releaseActionButton');var a=this._getComponent('openActionButton');var f=this._getComponent('forwardActionButton');var b=this._getComponent('rrViewClaimAction');var d=this._getComponent('rrViewReleaseAction');var g=this._getComponent('rrViewForwardAction');if(this.typeOfModel==="OData"){var t=this.constants.ENTITY_NAME_TASK_COLLECTION;if(this.oTcmMetadata._isPropertyAvailable(t,"SupportsClaim")){this._bindTaskActionsProperties(c,"SupportsClaim");this._bindTaskActionsProperties(b,"SupportsClaim");}if(this.oTcmMetadata._isPropertyAvailable(t,"SupportsRelease")){this._bindTaskActionsProperties(r,"SupportsRelease");this._bindTaskActionsProperties(d,"SupportsRelease");this._setVisibility('dotSeparator',true);}if(this.oTcmMetadata._isPropertyAvailable(t,"SupportsForward")&&this.isForwardActionEnabled){this._bindTaskActionsProperties(f,"SupportsForward");this._bindTaskActionsProperties(g,"SupportsForward");this._setVisibility('dotSeparator2',true);}else if(!this.isForwardActionEnabled){var A=this._getComponent("taskActionMatrixLayout");var o=A.getRows()[0];var D=o.getCells()[3];var F=o.getCells()[4];o.removeCell(D);o.removeCell(F);}}else{this.showAllActions();b.bindProperty("enabled","SupportsClaim");d.bindProperty("enabled","SupportsRelease");if(this.isForwardActionEnabled){g.bindProperty("enabled","SupportsForward");}}};
sap.uiext.inbox.Inbox.prototype._refreshLocal=function(c,a,f){if(this.currentView===this.constants.tableView){this._refreshLocalTableView(c,a,f);}else{this._refreshLocalRowRepeaterView(c,a,f);}var p=new sap.ui.base.Event();p.mParameters={url:'/TaskCollection'};this._handleRequestCompleted(p);};
sap.uiext.inbox.Inbox.prototype._refreshLocalTableView=function(c,a,f){var C=this._currentViewElement();var m=C.getModel();var I=this._getTableIndicesByContext(c,C),t=this;if(c&&c.length>0){jQuery.each(c,function(i,o){t._deleteTaskEntry(o,m,I[i],C,f);});C.rerender();}if(a){this._changeTaskData(a,m,C);}};
sap.uiext.inbox.Inbox.prototype._refreshLocalRowRepeaterView=function(c,a,f){var C=this._currentViewElement();var m=C.getModel();if(c&&c.length>0){var i=C.indexOfRow(c[0].orow);if(i>-1){this._deleteTaskEntry(c[0].context,m,i,C,f);C.updateRows(false);}}if(a){this._changeTaskData(a,m,C);}};
sap.uiext.inbox.Inbox.prototype._deleteTaskEntry=function(c,f,i,F,b){if(!b){f.deleteCreatedEntry(c);}var o=F.mBindingInfos['rows'].binding;if(o){o.aKeys.splice(jQuery.inArray(c.getPath().substr(1),o.aKeys),1);o.iLength=o.iLength-1;}};
sap.uiext.inbox.Inbox.prototype._changeTaskData=function(c,m,C){var M=m.oData,t=this;jQuery.each(c,function(i,o){var a=o.context;var k=o.keys;var s=a.getPath().substr(1);var e=M[s];if(t._currentView()===t.constants.tableView){C.rerender();}jQuery.each(k,function(i,K){e[K.key]=K.value;if(e.Status==='RESERVED'){e.SupportsClaim=false;e.SupportsRelease=true;}else if(e.Status==='READY'){e.SupportsClaim=true;e.SupportsRelease=false;}});if(t._currentView()===t.constants.rowRepeaterView){C.updateRows(false);}});};
sap.uiext.inbox.Inbox.prototype._getAppliedStatusFilterValues=function(c,m,C){var C=this._currentViewElement(),a=this._currentViewElement().getBinding('rows');var b=a.aFilters.concat(a.aApplicationFilters);if(a&&b&&b.length>0){var s=[];if(this.inboxUtils._hasFilter(b,'Status','EQ','READY')){s.push("READY");}if(this.inboxUtils._hasFilter(b,'Status','EQ','RESERVED')){s.push("RESERVED");}if(this.inboxUtils._hasFilter(b,'Status','EQ','IN_PROGRESS')){s.push("IN_PROGRESS");}return s;}};
sap.uiext.inbox.Inbox.prototype._handleErrorOnBatchRequests=function(e,a,t){this.hideBusyLoader();this.showMessage("error",this._oBundle.getText("INBOX_MSG_ACTION_FAILED_MULTIPLE_TASKS",[a,t]));};
sap.uiext.inbox.Inbox.prototype._handleErrorOnActionFailed=function(e,a,t){this.hideBusyLoader();this.showMessage("error",this._oBundle.getText("INBOX_MSG_ACTION_FAILED",[a,t]));};
sap.uiext.inbox.Inbox.prototype.storeFilterState=function(k){var t=this;var f=this.bShowNoDueDateFilter?this.constants.filterKeysMetaMapWithNoDueDate:this.constants.filterKeysMetaMap;var K=f[k];jQuery.each(K,function(i,s){if(t.filtersToApply[s]!=undefined){var F=t.filtersToApply[s];if(t.filterState[k]===undefined){t.filterState[k]={};t.filterState[k].filters={};}t.filterState[k].filters[s]=F;}});};
sap.uiext.inbox.Inbox.prototype.retrieveFilterState=function(k){var t=this;if(t.filterState[k]){var f=t.filterState[k].filters;jQuery.each(f,function(k,v){t.filtersToApply[k]=v;delete f[k];});delete t.filterState[k];}};
sap.uiext.inbox.Inbox.prototype._toggleCustomAttributesVisibilityActionEvent=function(e,i){var b=e.getSource();var p=b.getPressed();i._toggleCustomAttributesIcon(b,p);b.setTooltip(i._oBundle.getText(p?"INBOX_HIDE_ALL_CUSTOM_ATTRIBUTES":"INBOX_SHOW_ALL_CUSTOM_ATTRIBUTES"));i.bCustomAttributesVisible=p;p?i._addCustomAttributes(i):i._removeCustomAttributes();};
sap.uiext.inbox.Inbox.prototype._addCustomAttributes=function(i){var t=i._getComponent('tasksRowRepeater');var r=t.getRows();var a=i.getId();jQuery.each(r,function(b,R){i._updateActionButtonsContent(true,b);var s=i.getModel().getProperty(i.constants.TaskCollection.properties.instanceID,R.getBindingContext());var S=i.getModel().getProperty(i.constants.sapOrigin,R.getBindingContext());if(!(s&&S))return false;var c=i.getModel().getProperty(i.constants.TaskDefinitionCollection.properties.taskDefnID,R.getBindingContext());i._getCustomAttributeContentforRowRepeater(null,b,c,s,S);});};
sap.uiext.inbox.Inbox.prototype._removeCustomAttributes=function(){var r=this._getComponent('tasksRowRepeater').getRows();var t=this;jQuery.each(r,function(R,o){t._removeActionContentinRowRepeater(R);t._updateActionButtonsContent(false,R);});};
sap.uiext.inbox.Inbox.prototype._updateActionButtonsContent=function(p,r){var s=sap.ui.getCore().byId(this.getId()+"--customAttributesSegBtn-"+this.getId()+"--tasksRowRepeater-"+r);this.inboxUtils.deSelectOtherActionButtonsinStreamView(s);s.setPressed(p);s.setIcon('');s.setIcon(this.constants.iconPool.getIconURI(p?"collapse":"expand"));s.setTooltip(this._oBundle.getText(p?"INBOX_HIDE_CUSTOM_ATTRIBUTES":"INBOX_SHOW_CUSTOM_ATTRIBUTES"));};
sap.uiext.inbox.Inbox.prototype._toggleCustomAttributesIcon=function(b,p){b.setIcon(sap.ui.core.IconPool.getIconURI(""));b.setIcon(this.constants.iconPool.getIconURI(p?"collapse":"expand"));};
sap.uiext.inbox.Inbox.prototype._createNoDataLabel=function(t){var l=new sap.ui.commons.Label({text:t,tooltip:t,width:'100%',textAlign:sap.ui.core.TextAlign.Center});l.addStyleClass("sapUIExtInboxCustomAttributesBorder");return l;};
sap.uiext.inbox.Inbox.prototype.setOpenTaskUIInNewTab=function(v){this.bOpenTaskUIInNewTab=v;};
sap.uiext.inbox.Inbox.prototype._applySortOnTableColumn=function(c,d,e,f){this._resetStateBeforeSearch();var M=this.getCoreModel();var g=this._currentViewElement();var j=g._originalKeys;if(this._isTableFiltered(null)){j=this._getCurrentBindingKeysForTableColumnFilters(M._original_data,g._originalKeys,null);}var o=new Array();for(var i=0;i<j.length;i++){var v=M._original_data[j[i]];var C=v.CustomAttributeData.__list;var l=null;for(var k=0;k<C.length;k++){var n=C[k];if(n.indexOf(d)>0){l=M._original_data[n].Value;break;}}var p={key:j[i],type:e,dir:f,val:l};o.push(p);}var q=function(a,b){var t={parse:function(v){if(!v||v.length==0)return NaN;var D=v.split(':');if(D.length!=3)return NaN;var h=parseInt(D[0]);if(isNaN(h))return NaN;var m=parseInt(D[1]);if(isNaN(m))return NaN;var E=parseInt(D[2]);var F=E.indexOf('.');if(F>=0)E=E.substring(0,F);var s=parseInt(E);if(isNaN(s))return NaN;return h*60*60+m*60+s;}};var u={parse:function(v){var h=0;var m=0;var s=0;var D=new String(v);var E=D.indexOf('T');if(E>=0){D=D.substring(E+1,D.length);var H=D.indexOf('H');var F=D.indexOf('M');var S=D.indexOf('S');if(H>=0){h=D.substring(0,H);if(isNaN(h))h=0;}if(F>=0){m=D.substring(H+1,F);if(isNaN(m))m=0;}if(S>=0){s=D.substring(F+1,S);if(isNaN(s))s=0;}}return h*60*60+m*60+s;}};var w=a.type.toLowerCase();var x=(a.dir.toLowerCase().indexOf("ascending")>=0)?1:-1;if(w.indexOf("boolean")>=0){var B=((a.val+"").toLowerCase()=='true')?true:false;var y=((b.val+"").toLowerCase()=='true')?true:false;if(B==y)return 0;return x*(B?-1:1);}else if(w.indexOf("date")>=0||w.indexOf("time")>=0){var T=Date.parse(a.val);var z=Date.parse(b.val);if(isNaN(T)){T=t.parse(a.val);}if(isNaN(T)){T=u.parse(a.val);}if(isNaN(z)){z=t.parse(b.val);}if(isNaN(z)){z=u.parse(b.val);}if(T==z)return 0;return x*((T<z)?-1:1);}else if(w.indexOf("decimal")>=0||w.indexOf("float")>=0||w.indexOf("integer")>=0||w.indexOf("long")>=0){var N=0;var A=0;if(isFinite(a.val)){N=Number(a.val);if(isNaN(N))N=0;}if(isFinite(b.val)){A=Number(b.val);if(isNaN(A))A=0;}if(N.valueOf()==A.valueOf())return 0;return x*((N.valueOf()<A.valueOf())?-1:1);}return x*((a.val+"").localeCompare((b.val+"")));};o.sort(q);var r=new Array();for(var i=0;i<o.length;i++){r[r.length]=o[i].key;}this._renderTableAfterSort(c,f,r,M._original_data,M);};
sap.uiext.inbox.Inbox.prototype._applyFilterOnTableColumns=function(c,v){var s=v.toLowerCase();var m=this.getCoreModel();var a=this._currentViewElement();var f=[];var r=[];this._resetStateBeforeSearch();var C=this._getBindingKeysForTableColumnFilter(c,m._original_data,a._originalKeys,s);f.push(C);if(this._isTableFiltered(c)){f.push(this._getCurrentBindingKeysForTableColumnFilters(m._original_data,a._originalKeys,c));}var l=this._getLocalSearchText();if(l){f.push(this._getBindingKeysOnLocalSearch(l,m._original_data,a._originalKeys));}r=this.inboxUtils._getUniqueArray(f);c.setFiltered(!!s);c.setFilterValue(s);this._renderTableAfterSearch(r,m._original_data,m);};
sap.uiext.inbox.Inbox.prototype._getBindingKeysForTableColumnFilter=function(c,s,S,t){var a=[];var f=c.getProperty("filterProperty");for(var l in S){var v=false;var b,d;for(var j in s){if(S[l]==j){var e=s[j];if(c.data("ColumnType")=="StandardAttribute"){for(var k=0;k<this._getCategoryMetadata().properties.length;k++){d=this._getCategoryMetadata().properties[k];if(d===f){var b=e[d];if(!b&&d==="TaskTitle"){b=this._oBundle.getText("INBOX_TASK_TITLE_NOTAVAILABLE_MSG");}if(b!=null){if(jQuery.type(b)==="date"){b=(this.inboxUtils.dateTimeFormat(b));}b=b.toLowerCase();if(b.indexOf(t)>=0){v=true;break;}}}}}else if(c.data("ColumnType")=="CustomAttribute"){var C=e.CustomAttributeData.__list;if(C!==undefined){for(var i=0;i<C.length;i++){var g=C[i];if(f&&g.indexOf(f)>0){var b=s[g].Value;if(b!=null||b!=undefined){b=b.toLowerCase();if(b.indexOf(t)>=0){v=true;break;}}}}}}if(v){var h=j;a.push(h);}}}}return a;};
sap.uiext.inbox.Inbox.prototype._preserveTableFilters=function(){var m=this.getCoreModel();var b,c;var c=this._currentViewElement();this._resetStateBeforeSearch();var f=this._getCurrentBindingKeysForTableColumnFilters(m._original_data,c._originalKeys);if(f)this._renderTableAfterSearch(f,m._original_data,m);};
sap.uiext.inbox.Inbox.prototype._preserveTableSort=function(){var t=this._getComponent('listViewTable');var c=t.getColumns();for(var i=0;i<c.length;i++){var C=c[i];if(C.getSorted()){if(this._isCustomAttribute(C)){C.sort((C.getSortOrder()===sap.ui.table.SortOrder.Descending),false);}}}};
sap.uiext.inbox.Inbox.prototype._renderTableAfterSort=function(c,s,r,d,m){var a=this._currentViewElement();var b=a.mBindingInfos["rows"];var e={};for(var i in r){e[r[i]]=d[r[i]];}m.oData=e;if(b&&b.binding){b.binding.iLength=r.length;b.binding.aKeys=r;this.currentView===this.constants.tableView?a.rerender():a.updateRows(false);}var R=a.getBinding('rows').iLength;if(R<=0)this.showMessage("info",this._oBundle.getText("INBOX_MSG_FOR_NO_DATA"));else this.deleteMessage();var t=c.getParent();var C=t.getColumns();for(var i=0,l=C.length;i<l;i++){if(C[i]!==c){C[i].setProperty("sorted",false,true);C[i].setProperty("sortOrder",sap.ui.table.SortOrder.Ascending,true);C[i]._renderSortIcon();delete C[i]._oSorter;}}c.setProperty("sorted",true,true);c.setProperty("sortOrder",s,true);c._oSorter=new sap.ui.model.Sorter(c.getSortProperty(),c.getSortOrder()===sap.ui.table.SortOrder.Descending);if(c._afterSort){c._afterSort();}c._renderSortIcon();};
sap.uiext.inbox.Inbox.prototype._renderTableAfterSearch=function(r,d,m){var c=this._currentViewElement();var b=c.mBindingInfos["rows"];var a={};for(var i in r){a[r[i]]=d[r[i]];}m.oData=a;if(b&&b.binding){b.binding.iLength=r.length;b.binding.aKeys=r;this.currentView===this.constants.tableView?c.rerender():c.updateRows(false);c._updateBindingContexts(undefined,undefined,"change");}var R=c.getBinding('rows').iLength;if(R<=0)this.showMessage("info",this._oBundle.getText("INBOX_MSG_FOR_NO_DATA"));else this.deleteMessage();this.fireODataRequestCompleted({bindingLength:R,appliedFilter:this._oBundle.getText("INBOX_SEARCH_RESULTS_TEXT")});};
sap.uiext.inbox.Inbox.prototype._getCurrentBindingKeysForTableColumnFilters=function(s,S,c){var t=this._getComponent('listViewTable');var C=t.getColumns();var f=[];var o,T,i;if(c){var a=c.getId();for(i=0;i<C.length;i++){var o=C[i];if(o.getFiltered()&&o.getId()!==a){var T=o.getFilterValue();f.push(this._getBindingKeysForTableColumnFilter(o,s,S,T));}}}else{for(i=0;i<C.length;i++){o=C[i];if(o.getFiltered()){T=o.getFilterValue();f.push(this._getBindingKeysForTableColumnFilter(o,s,S,T));}}}return this.inboxUtils._getUniqueArray(f);};
sap.uiext.inbox.Inbox.prototype._isTableFiltered=function(c){var t=this._getComponent('listViewTable');var C=t.getColumns();if(c){var s=c.getId();jQuery.each(C,function(i,o){if(o.getId()===s){C.splice(i,1);return false;}});}for(var i=0;i<C.length;i++){var o=C[i];if(o.getFiltered()){return true;}}return false;};
sap.uiext.inbox.Inbox.prototype._getLocalSearchText=function(){var s=this._getComponent('searchField');var S=s.getValue();if(S!==""&&S!==null){S=S.toLowerCase();return S;}return;};
sap.uiext.inbox.Inbox.prototype._removeTableFilters=function(){var t=this._getComponent('listViewTable');var c=t.getColumns();jQuery.each(c,function(i,C){if(C.getFiltered()){C.setFiltered(false);C.setFilterValue("");}});};
sap.uiext.inbox.Inbox.prototype._resetStateBeforeSearch=function(){var m=this.getCoreModel();var c=this._currentViewElement();if(this.modelRefreshed){m._original_data=m.oData;this.modelRefreshed=false;}if(!c._originalKeys){c._originalKeys=c.getBinding('rows').aKeys;}};
sap.uiext.inbox.Inbox.prototype._handleCustomActionClick=function(e,p){var c=e.getSource().data('commentsMandatory');var C=(c==true)?this.oCustomActionToolPopupCommentsMand:this.oCustomActionToolPopup;if(C&&C.getOpener()===e.getSource().getId()){var o=C.getContent()[0];if(o){o.setValue("");if(c==true){sap.ui.getCore().byId(this.getId()+'--'+"toolPopupButton-CommentsMand").setEnabled(false);}}C.isOpen()?C.close():C.open(sap.ui.core.Popup.Dock.BeginTop,sap.ui.core.Popup.Dock.BeginBottom);}else this._openCustomActionToolPopup(e.getSource(),p);};
sap.uiext.inbox.Inbox.prototype._openCustomActionToolPopup=function(c,p){var C=c.data('key'),b=c.data('commentsMandatory'),s=this.getId()+'--'+'toolPopupButton',a=this.getId()+'--'+'addCommentsinCustomActionPopup';if(b==true){var o=this.oCore.byId(a+"-CommentsMand");var d=this.oCore.byId(s+"-CommentsMand");}else{var o=this.oCore.byId(a);var e=this.oCore.byId(s);}if(b==false){if(!e){e=new sap.ui.commons.Button(s,{press:jQuery.proxy(function(E){var f=o.getValue();var g=sap.ui.getCore().byId(this.oCustomActionToolPopup.getOpener());this._executeCustomAction(g,jQuery.sap._sanitizeHTML(f));this.oCustomActionToolPopup.close();},this)});}if(!this.oCustomActionToolPopup){o=new sap.ui.commons.TextArea(a).setWidth('300px');this.oCustomActionToolPopup=new sap.ui.ux3.ToolPopup(this.getId()+'--'+'customActionToolPopup',{inverted:false,content:[o],buttons:[e],title:this._oBundle.getText('INBOX_ADD_COMMENT'),autoClose:true});}this._resetCustomActionToolPopupContent(o,e,c.data('text'),C);this.oCustomActionToolPopup.setOpener(c);if(!this.oCustomActionToolPopup.isOpen()){this.oCustomActionToolPopup.open(sap.ui.core.Popup.Dock.BeginTop,sap.ui.core.Popup.Dock.BeginBottom);}}else if(b==true){if(!d){d=new sap.ui.commons.Button(s+"-CommentsMand",{press:jQuery.proxy(function(E){var f=o.getValue();var g=sap.ui.getCore().byId(this.oCustomActionToolPopupCommentsMand.getOpener());this._executeCustomAction(g,jQuery.sap._sanitizeHTML(f));this.oCustomActionToolPopupCommentsMand.close();},this)});}if(!this.oCustomActionToolPopupCommentsMand){o=new sap.ui.commons.TextArea(a+"-CommentsMand",{liveChange:function(E){var v=E.getSource().getLiveValue();(v.trim().length>0)?d.setEnabled(true):d.setEnabled(false);}}).setWidth('300px');this.oCustomActionToolPopupCommentsMand=new sap.ui.ux3.ToolPopup(this.getId()+'--'+'customActionToolPopup-CommentsMand',{inverted:false,content:[o],buttons:[d],title:this._oBundle.getText('INBOX_ADD_COMMENT'),autoClose:true});}d.setEnabled(false);this._resetCustomActionToolPopupContent(o,d,c.data('text'),C);this.oCustomActionToolPopupCommentsMand.setOpener(c);if(!this.oCustomActionToolPopupCommentsMand.isOpen()){this.oCustomActionToolPopupCommentsMand.open(sap.ui.core.Popup.Dock.BeginTop,sap.ui.core.Popup.Dock.BeginBottom);}}};
sap.uiext.inbox.Inbox.prototype._resetCustomActionToolPopupContent=function(c,C,s,a){if(c){c.setValue('');}var b=s||a;C.setText(b);C.setTooltip(b);C.data('key',a);};
sap.uiext.inbox.Inbox.prototype._getAttachments=function(a,r){var t=this;var c=a.getParent().getBindingContext();var R=this._getAttachmentsUrl(c);var m=this.getCoreModel();var o={async:true,requestUri:R,method:"GET",headers:{Accept:t.constants.acceptHeaderforJSON,"x-csrf-token":m.oHeaders["x-csrf-token"]}};OData.request(o,function(d,b){var A=d.results;t._displayAttachments(A,r,c);},function(e){t.showMessage("error",t._oBundle.getText("INBOX_MSG_FETCH_ATTACHMENTS_FAILS"));});};
sap.uiext.inbox.Inbox.prototype._displayAttachments=function(a,r,c){var t=this;var s=this.getModel().getProperty("Status",c);var C=(s==="COMPLETED");var u=sap.ui.Device.browser.msie&&sap.ui.Device.browser.version<10;var S=!(C||u);if(!S&&a&&a.length<1){this._addActionContentinRowRepeater(r,"attachments",this._createNoDataLabel(this._oBundle.getText("INBOX_MSG_FOR_NO_DATA")));}else{var A=new sap.ui.model.json.JSONModel(a);var o=this._createAttachmentContainer(r,c,S);o.setModel(A);var b=this._createAttachmentTileTemplate(C);o.bindAggregation("attachments",{path:"/",template:b});var d=new sap.ui.commons.layout.MatrixLayout({layoutFixed:true,width:"100%"});var e=new sap.ui.commons.layout.MatrixLayoutCell();e.addContent(o);e.addStyleClass('sapUIExtInboxCommentsBorder');d.createRow(e);this._addActionContentinRowRepeater(r,"attachments",d);}};
sap.uiext.inbox.Inbox.prototype._createAttachmentContainer=function(r,c,s){var t=this;var m=this.getCoreModel();var a=this._getComponent("attachmentContainer-"+r);if(!a){a=new sap.uiext.inbox.composite.InboxAttachmentsTileContainer(this.getId()+"--"+"attachmentContainer-"+r,{showAddTile:s,uploadUrl:t._getAttachmentsUrl(c),uploadButtonPress:function(e){t._addParametersBeforeUpload(e);this.triggerUpload();},uploadSuccess:function(e){var A=this.getModel();A.oData.push(JSON.parse(e.getParameter("attachmentResponse")).d);A.checkUpdate(false);if(this.bTokenRefreshed)this.bTokenRefreshed=false;t.showMessage("success",t._oBundle.getText("INBOX_MSG_UPLOAD_ATTACHMENT_SUCCESS"));},uploadFailed:function(e){var b=e.getParameter("statusCode");if(b&&b==403){var T=e.getParameter("securityToken");if(!this.bTokenRefreshed&&T&&T.toLowerCase()=="required"){t.getCoreModel().refreshSecurityToken();this.bTokenRefreshed=true;var h=e.getParameter("headerParameters");this.removeUploadHeader("x-csrf-token");this.addUploadHeader("x-csrf-token",m.oHeaders["x-csrf-token"]);this.triggerUpload();}else{this.bTokenRefreshed=false;t.showMessage("error",t._oBundle.getText("INBOX_MSG_UPLOAD_ATTACHMENT_FAILURE"));}}else{this.bTokenRefreshed=false;t.showMessage("error",t._oBundle.getText("INBOX_MSG_UPLOAD_ATTACHMENT_FAILURE"));}}});}return a;};
sap.uiext.inbox.Inbox.prototype._createAttachmentTileTemplate=function(c){var t=this;var T=new sap.uiext.inbox.composite.InboxAttachmentTile({fileName:"{FileName}",createdBy:{parts:[{path:"CreatedByName"},{path:"CreatedBy"}],formatter:function(f,u){if(f&&f!=="")return f;else if(u&&u!=="")return u;}},fileDescription:"{FileDisplayName}",creationDate:{path:"CreatedAt",formatter:function(d){return t.inboxUtils.dateTimeFormat(d,true);}},fileTypeIcon:{path:"mime_type",formatter:t.inboxUtils._getFileTypeIcon},fileSize:{path:"FileSize",formatter:t.inboxUtils._getFileSize},downloadUrl:{parts:[{path:"InstanceID"},{path:"SAP__Origin"},{path:"ID"}],formatter:function(s,S,a){return(t.bpmSvcUrl+t._getAttachmentValueUrl(s,S,a));}},showDeleteButton:!c}).attachDeleteAttachment(this,this._deleteAttachment);return T;};
sap.uiext.inbox.Inbox.prototype._addParametersBeforeUpload=function(e){var a=e.getSource();var t=this;if(a.getIsFileSelected()){var m=this.getCoreModel();a.addUploadHeader("slug",a.getFileName());a.addUploadHeader("Content-Type",a.getFileType());a.addUploadHeader("Accept",this.constants.acceptHeaderforJSON);a.addUploadHeader("x-csrf-token",m.oHeaders["x-csrf-token"]);}};
sap.uiext.inbox.Inbox.prototype._deleteAttachment=function(e,i){var t=this;var a=this.getModel();var c=this.getBindingContext();var T=i.constants.TaskCollection;var s=a.getProperty("InstanceID",c);var S=a.getProperty("SAP__Origin",c);var A=a.getProperty("ID",c);var r=i._getAttachmentValueUrl(s,S,A);var m=i.getCoreModel();i.oDataManager.removeData(i._getAttachmentValueUrl(s,S,A),{success:function(d,b){var p=c.getPath().split("/");a.oData.splice(p[1],1);a.checkUpdate(false);i.showMessage("success",i._oBundle.getText("INBOX_MSG_DELETE_ATTACHMENT_SUCCESS"));},error:function(b){i.showMessage("error",i._oBundle.getText("INBOX_MSG_DELETE_ATTACHMENT_FAILURE"));}},true);};
sap.uiext.inbox.Inbox.prototype._getAttachmentsUrl=function(c){var a=this.constants;var t=a.TaskCollection;var m=this.getModel();var T=m.getProperty("InstanceID",c);var s=m.getProperty("SAP__Origin",c);var A=this.bpmSvcUrl+a.forwardSlash+t.entityName+"("+t.properties.instanceID+"='"+T+"',"+a.sapOrigin+"='"+s+"')"+a.forwardSlash+a.attachmentCollection.navParam.attachment;return A;};
sap.uiext.inbox.Inbox.prototype._getAttachmentValueUrl=function(t,s,a){var c=this.constants;var T=c.TaskCollection;var A=c.attachmentCollection;var b=c.forwardSlash+A.entityName+"("+T.properties.instanceID+"='"+t+"',"+c.sapOrigin+"='"+s+"',"+A.properties.id+"='"+a+"')"+c.forwardSlash+A.navParam.value;return b;};
sap.uiext.inbox.Inbox.prototype._initODataModel=function(){var t=this;this.oModel.refreshSecurityToken(null,null,true);this.oModel.attachMetadataLoaded(function(e){var s=this.getServiceMetadata();if(this.sServiceUrl&&s){t.oTcmMetadata.setServiceMetadata(s);}t._bindTaskActions();});if(this.getHandleBindings()){this.bpmSvcUrl=this.oModel.sServiceUrl;}};
sap.uiext.inbox.Inbox.prototype._getBindingParameters=function(){var p={};var e=this._getExpandParameters();if(this.typeOfModel==="OData"){p.countMode=sap.ui.model.odata.CountMode.InlineRepeat;p.faultTolerant=true;}if(e.length>0){p.expand=e;}return p;};
